(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const Ss=!1;var Vn=Array.isArray,ua=Array.prototype.indexOf,Mr=Array.from,Qn=Object.defineProperty,zt=Object.getOwnPropertyDescriptor,xs=Object.getOwnPropertyDescriptors,da=Object.prototype,fa=Array.prototype,Ar=Object.getPrototypeOf,es=Object.isExtensible;function Rn(e){return typeof e=="function"}const Zt=()=>{};function va(e){return e()}function Zn(e){for(var t=0;t<e.length;t++)e[t]()}function pa(){var e,t,n=new Promise((r,s)=>{e=r,t=s});return{promise:n,resolve:e,reject:t}}const bt=2,Or=4,or=8,Gn=16,Ht=32,dn=64,ks=128,xt=256,er=512,tt=1024,kt=2048,Jt=4096,It=8192,fn=16384,Nr=32768,lr=65536,ts=1<<17,ma=1<<18,Rr=1<<19,$r=1<<20,xr=1<<21,Dr=1<<22,sn=1<<23,Dt=Symbol("$state"),Ts=Symbol("legacy props"),Pr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function ga(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function cr(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function ha(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function _a(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ya(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function ba(e){throw new Error("https://svelte.dev/e/effect_orphan")}function wa(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Sa(e){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function xa(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function ka(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ta(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ca(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const ur=1,dr=2,Cs=4,Ea=8,Ia=16,Ma=2,Aa=4,Oa=8,Na=1,Ra=2,Ze=Symbol(),$a="http://www.w3.org/1999/xhtml";function Da(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let Pa=!1;function Es(e){return e===this.v}function Is(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Ms(e){return!Is(e,this.v)}let An=!1,La=!1;function Ba(){An=!0}let De=null;function tr(e){De=e}function vt(e,t=!1,n){De={p:De,c:null,e:null,s:e,x:null,l:An&&!t?{s:null,u:null,$:[]}:null}}function pt(e){var t=De,n=t.e;if(n!==null){t.e=null;for(var r of n)js(r)}return e!==void 0&&(t.x=e),De=t.p,e??{}}function On(){return!An||De!==null&&De.l===null}const Ua=new WeakMap;function Fa(e){var t=ye;if(t===null)return ke.f|=sn,e;if((t.f&Nr)===0){if((t.f&ks)===0)throw!t.parent&&e instanceof Error&&As(e),e;t.b.error(e)}else Lr(e,t)}function Lr(e,t){for(;t!==null;){if((t.f&ks)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e instanceof Error&&As(e),e}function As(e){const t=Ua.get(e);t&&(Qn(e,"message",{value:t.message}),Qn(e,"stack",{value:t.stack}))}let nr=[];function ja(){var e=nr;nr=[],Zn(e)}function Br(e){nr.length===0&&queueMicrotask(ja),nr.push(e)}function qa(){for(var e=ye.b;e!==null&&!e.has_pending_snippet();)e=e.parent;return e===null&&ga(),e}function Ur(e){var t=bt|kt,n=ke!==null&&(ke.f&bt)!==0?ke:null;return ye===null||n!==null&&(n.f&xt)!==0?t|=xt:ye.f|=Rr,{ctx:De,deps:null,effects:null,equals:Es,f:t,fn:e,reactions:null,rv:0,v:Ze,wv:0,parent:n??ye,ac:null}}function za(e,t){let n=ye;n===null&&ha();var r=n.b,s=void 0,a=Fn(Ze),l=null,c=!ke;return ni(()=>{try{var o=e()}catch(m){o=Promise.reject(m)}var u=()=>o;s=l?.then(u,u)??Promise.resolve(o),l=s;var g=Oe,p=r.pending;c&&(r.update_pending_count(1),p||g.increment());const x=(m,w=void 0)=>{l=null,p||g.activate(),w?w!==Pr&&(a.f|=sn,Cn(a,w)):((a.f&sn)!==0&&(a.f^=sn),Cn(a,m)),c&&(r.update_pending_count(-1),p||g.decrement()),Rs()};if(s.then(x,m=>x(null,m||"unknown")),g)return()=>{queueMicrotask(()=>g.neuter())}}),new Promise(o=>{function u(g){function p(){g===s?o(a):u(s)}g.then(p,p)}u(s)})}function Nt(e){const t=Ur(e);return t.equals=Ms,t}function Os(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Gt(t[n])}}function Va(e){for(var t=e.parent;t!==null;){if((t.f&bt)===0)return t;t=t.parent}return null}function Fr(e){var t,n=ye;tn(Va(e));try{Os(e),t=Qs(e)}finally{tn(n)}return t}function Ns(e){var t=Fr(e);if(e.equals(t)||(e.v=t,e.wv=Ys()),!pn)if(kn!==null)kn.set(e,e.v);else{var n=(Qt||(e.f&xt)!==0)&&e.deps!==null?Jt:tt;lt(e,n)}}function Ga(e,t,n){const r=On()?Ur:Nt;if(t.length===0){n(e.map(r));return}var s=Oe,a=ye,l=Wa(),c=qa();Promise.all(t.map(o=>za(o))).then(o=>{s?.activate(),l();try{n([...e.map(r),...o])}catch(u){(a.f&fn)===0&&Lr(u,a)}s?.deactivate(),Rs()}).catch(o=>{c.error(o)})}function Wa(){var e=ye,t=ke,n=De;return function(){tn(e),Lt(t),tr(n)}}function Rs(){tn(null),Lt(null),tr(null)}const $n=new Set;let Oe=null,Xn=null,kn=null,ns=new Set,rr=[];function $s(){const e=rr.shift();rr.length>0&&queueMicrotask($s),e()}let Un=[],jr=null,kr=!1;class Tn{current=new Map;#e=new Map;#n=new Set;#t=0;#s=null;#u=!1;#a=[];#o=[];#i=[];#r=[];#l=[];#d=[];#f=[];skipped_effects=new Set;process(t){Un=[],Xn=null;var n=null;if($n.size>1){n=new Map,kn=new Map;for(const[a,l]of this.current)n.set(a,{v:a.v,wv:a.wv}),a.v=l;for(const a of $n)if(a!==this)for(const[l,c]of a.#e)n.has(l)||(n.set(l,{v:l.v,wv:l.wv}),l.v=c)}for(const a of t)this.#p(a);if(this.#a.length===0&&this.#t===0){this.#v();var r=this.#i,s=this.#r;this.#i=[],this.#r=[],this.#l=[],Xn=Oe,Oe=null,rs(r),rs(s),Oe===null?Oe=this:$n.delete(this),this.#s?.resolve()}else this.#c(this.#i),this.#c(this.#r),this.#c(this.#l);if(n){for(const[a,{v:l,wv:c}]of n)a.wv<=c&&(a.v=l);kn=null}for(const a of this.#a)Sn(a);for(const a of this.#o)Sn(a);this.#a=[],this.#o=[]}#p(t){t.f^=tt;for(var n=t.first;n!==null;){var r=n.f,s=(r&(Ht|dn))!==0,a=s&&(r&tt)!==0,l=a||(r&It)!==0||this.skipped_effects.has(n);if(!l&&n.fn!==null){if(s)n.f^=tt;else if((r&tt)===0)if((r&Or)!==0)this.#r.push(n);else if((r&Dr)!==0){var c=n.b?.pending?this.#o:this.#a;c.push(n)}else Wn(n)&&((n.f&Gn)!==0&&this.#l.push(n),Sn(n));var o=n.first;if(o!==null){n=o;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}}#c(t){for(const n of t)((n.f&kt)!==0?this.#d:this.#f).push(n),lt(n,tt);t.length=0}capture(t,n){this.#e.has(t)||this.#e.set(t,n),this.current.set(t,t.v)}activate(){Oe=this}deactivate(){Oe=null,Xn=null;for(const t of ns)if(ns.delete(t),t(),Oe!==null)break}neuter(){this.#u=!0}flush(){Un.length>0?Ha():this.#v(),Oe===this&&(this.#t===0&&$n.delete(this),this.deactivate())}#v(){if(!this.#u)for(const t of this.#n)t();this.#n.clear()}increment(){this.#t+=1}decrement(){if(this.#t-=1,this.#t===0){for(const t of this.#d)lt(t,kt),ln(t);for(const t of this.#f)lt(t,Jt),ln(t);this.#i=[],this.#r=[],this.flush()}else this.deactivate()}add_callback(t){this.#n.add(t)}settled(){return(this.#s??=pa()).promise}static ensure(){if(Oe===null){const t=Oe=new Tn;$n.add(Oe),Tn.enqueue(()=>{Oe===t&&t.flush()})}return Oe}static enqueue(t){rr.length===0&&queueMicrotask($s),rr.unshift(t)}}function Ha(){var e=wn;kr=!0;try{var t=0;for(is(!0);Un.length>0;){var n=Tn.ensure();if(t++>1e3){var r,s;Ja()}n.process(Un),an.clear()}}finally{kr=!1,is(e),jr=null}}function Ja(){try{wa()}catch(e){Lr(e,jr)}}function rs(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(fn|It))===0&&Wn(r)){var s=Oe?Oe.current.size:0;if(Sn(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Gs(r):r.fn=null),Oe!==null&&Oe.current.size>s&&(r.f&$r)!==0)break}}for(;n<t;)ln(e[n++])}}function ln(e){for(var t=jr=e;t.parent!==null;){t=t.parent;var n=t.f;if(kr&&t===ye&&(n&Gn)!==0)return;if((n&(dn|Ht))!==0){if((n&tt)===0)return;t.f^=tt}}Un.push(t)}const an=new Map;function Fn(e,t){var n={f:0,v:e,reactions:null,equals:Es,rv:0,wv:0};return n}function Yt(e,t){const n=Fn(e);return ai(n),n}function z(e,t=!1,n=!0){const r=Fn(e);return t||(r.equals=Ms),An&&n&&De!==null&&De.l!==null&&(De.l.s??=[]).push(r),r}function je(e,t){return _(e,D(()=>i(e))),t}function _(e,t,n=!1){ke!==null&&(!Rt||(ke.f&ts)!==0)&&On()&&(ke.f&(bt|Gn|Dr|ts))!==0&&!Vt?.includes(e)&&Ca();let r=n?bn(t):t;return Cn(e,r)}function Cn(e,t){if(!e.equals(t)){var n=e.v;pn?an.set(e,t):an.set(e,n),e.v=t;var r=Tn.ensure();r.capture(e,n),(e.f&bt)!==0&&((e.f&kt)!==0&&Fr(e),lt(e,(e.f&xt)===0?tt:Jt)),e.wv=Ys(),Ds(e,kt),On()&&ye!==null&&(ye.f&tt)!==0&&(ye.f&(Ht|dn))===0&&(St===null?ii([e]):St.push(e))}return t}function _r(e){_(e,e.v+1)}function Ds(e,t){var n=e.reactions;if(n!==null)for(var r=On(),s=n.length,a=0;a<s;a++){var l=n[a],c=l.f;if(!(!r&&l===ye)){var o=(c&kt)===0;o&&lt(l,t),(c&bt)!==0?Ds(l,Jt):o&&ln(l)}}}function bn(e){if(typeof e!="object"||e===null||Dt in e)return e;const t=Ar(e);if(t!==da&&t!==fa)return e;var n=new Map,r=Vn(e),s=Yt(0),a=on,l=c=>{if(on===a)return c();var o=ke,u=on;Lt(null),ls(a);var g=c();return Lt(o),ls(u),g};return r&&n.set("length",Yt(e.length)),new Proxy(e,{defineProperty(c,o,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&ka();var g=n.get(o);return g===void 0?g=l(()=>{var p=Yt(u.value);return n.set(o,p),p}):_(g,u.value,!0),!0},deleteProperty(c,o){var u=n.get(o);if(u===void 0){if(o in c){const g=l(()=>Yt(Ze));n.set(o,g),_r(s)}}else _(u,Ze),_r(s);return!0},get(c,o,u){if(o===Dt)return e;var g=n.get(o),p=o in c;if(g===void 0&&(!p||zt(c,o)?.writable)&&(g=l(()=>{var m=bn(p?c[o]:Ze),w=Yt(m);return w}),n.set(o,g)),g!==void 0){var x=i(g);return x===Ze?void 0:x}return Reflect.get(c,o,u)},getOwnPropertyDescriptor(c,o){var u=Reflect.getOwnPropertyDescriptor(c,o);if(u&&"value"in u){var g=n.get(o);g&&(u.value=i(g))}else if(u===void 0){var p=n.get(o),x=p?.v;if(p!==void 0&&x!==Ze)return{enumerable:!0,configurable:!0,value:x,writable:!0}}return u},has(c,o){if(o===Dt)return!0;var u=n.get(o),g=u!==void 0&&u.v!==Ze||Reflect.has(c,o);if(u!==void 0||ye!==null&&(!g||zt(c,o)?.writable)){u===void 0&&(u=l(()=>{var x=g?bn(c[o]):Ze,m=Yt(x);return m}),n.set(o,u));var p=i(u);if(p===Ze)return!1}return g},set(c,o,u,g){var p=n.get(o),x=o in c;if(r&&o==="length")for(var m=u;m<p.v;m+=1){var w=n.get(m+"");w!==void 0?_(w,Ze):m in c&&(w=l(()=>Yt(Ze)),n.set(m+"",w))}if(p===void 0)(!x||zt(c,o)?.writable)&&(p=l(()=>Yt(void 0)),_(p,bn(u)),n.set(o,p));else{x=p.v!==Ze;var T=l(()=>bn(u));_(p,T)}var N=Reflect.getOwnPropertyDescriptor(c,o);if(N?.set&&N.set.call(g,u),!x){if(r&&typeof o=="string"){var B=n.get("length"),U=Number(o);Number.isInteger(U)&&U>=B.v&&_(B,U+1)}_r(s)}return!0},ownKeys(c){i(s);var o=Reflect.ownKeys(c).filter(p=>{var x=n.get(p);return x===void 0||x.v!==Ze});for(var[u,g]of n)g.v!==Ze&&!(u in c)&&o.push(u);return o},setPrototypeOf(){Ta()}})}function ss(e){try{if(e!==null&&typeof e=="object"&&Dt in e)return e[Dt]}catch{}return e}function Ka(e,t){return Object.is(ss(e),ss(t))}var jn,Ps,Ls,Bs;function Ya(){if(jn===void 0){jn=window,Ps=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Ls=zt(t,"firstChild").get,Bs=zt(t,"nextSibling").get,es(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),es(n)&&(n.__t=void 0)}}function vn(e=""){return document.createTextNode(e)}function $t(e){return Ls.call(e)}function fr(e){return Bs.call(e)}function d(e,t){return $t(e)}function Ce(e,t){{var n=$t(e);return n instanceof Comment&&n.data===""?fr(n):n}}function y(e,t=1,n=!1){let r=e;for(;t--;)r=fr(r);return r}function Xa(e){e.textContent=""}function qr(){return!1}let as=!1;function Qa(){as||(as=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function vr(e){var t=ke,n=ye;Lt(null),tn(null);try{return e()}finally{Lt(t),tn(n)}}function Us(e,t,n,r=n){e.addEventListener(t,()=>vr(n));const s=e.__on_r;s?e.__on_r=()=>{s(),r(!0)}:e.__on_r=()=>r(!0),Qa()}function Fs(e){ye===null&&ke===null&&ba(),ke!==null&&(ke.f&xt)!==0&&ye===null&&ya(),pn&&_a()}function Za(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Bt(e,t,n,r=!0){var s=ye;s!==null&&(s.f&It)!==0&&(e|=It);var a={ctx:De,deps:null,nodes_start:null,nodes_end:null,f:e|kt,first:null,fn:t,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Sn(a),a.f|=Nr}catch(o){throw Gt(a),o}else t!==null&&ln(a);var l=n&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&Rr)===0;if(!l&&r&&(s!==null&&Za(a,s),ke!==null&&(ke.f&bt)!==0&&(e&dn)===0)){var c=ke;(c.effects??=[]).push(a)}return a}function pr(e){const t=Bt(or,null,!1);return lt(t,tt),t.teardown=e,t}function Tr(e){Fs();var t=ye.f,n=!ke&&(t&Ht)!==0&&(t&Nr)===0;if(n){var r=De;(r.e??=[]).push(e)}else return js(e)}function js(e){return Bt(Or|$r,e,!1)}function ei(e){return Fs(),Bt(or|$r,e,!0)}function ti(e){Tn.ensure();const t=Bt(dn,e,!0);return(n={})=>new Promise(r=>{n.outro?gr(t,()=>{Gt(t),r(void 0)}):(Gt(t),r(void 0))})}function zr(e){return Bt(Or,e,!1)}function Le(e,t){var n=De,r={effect:null,ran:!1,deps:e};n.l.$.push(r),r.effect=mr(()=>{e(),!r.ran&&(r.ran=!0,D(t))})}function nn(){var e=De;mr(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&tt)!==0&&lt(n,Jt),Wn(n)&&Sn(n),t.ran=!1}})}function ni(e){return Bt(Dr|Rr,e,!0)}function mr(e,t=0){return Bt(or|t,e,!0)}function ne(e,t=[],n=[]){Ga(t,n,r=>{Bt(or,()=>e(...r.map(i)),!0)})}function Vr(e,t=0){var n=Bt(Gn|t,e,!0);return n}function En(e,t=!0){return Bt(Ht,e,!0,t)}function qs(e){var t=e.teardown;if(t!==null){const n=pn,r=ke;os(!0),Lt(null);try{t.call(null)}finally{os(n),Lt(r)}}}function zs(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const s=n.ac;s!==null&&vr(()=>{s.abort(Pr)});var r=n.next;(n.f&dn)!==0?n.parent=null:Gt(n,t),n=r}}function ri(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&Ht)===0&&Gt(t),t=n}}function Gt(e,t=!0){var n=!1;(t||(e.f&ma)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Vs(e.nodes_start,e.nodes_end),n=!0),zs(e,t&&!n),sr(e,0),lt(e,fn);var r=e.transitions;if(r!==null)for(const a of r)a.stop();qs(e);var s=e.parent;s!==null&&s.first!==null&&Gs(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Vs(e,t){for(;e!==null;){var n=e===t?null:fr(e);e.remove(),e=n}}function Gs(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function gr(e,t){var n=[];Gr(e,n,!0),Ws(n,()=>{Gt(e),t&&t()})}function Ws(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var s of e)s.out(r)}else t()}function Gr(e,t,n){if((e.f&It)===0){if(e.f^=It,e.transitions!==null)for(const l of e.transitions)(l.is_global||n)&&t.push(l);for(var r=e.first;r!==null;){var s=r.next,a=(r.f&lr)!==0||(r.f&Ht)!==0;Gr(r,t,a?n:!1),r=s}}}function Wr(e){Hs(e,!0)}function Hs(e,t){if((e.f&It)!==0){e.f^=It,(e.f&tt)===0&&(lt(e,kt),ln(e));for(var n=e.first;n!==null;){var r=n.next,s=(n.f&lr)!==0||(n.f&Ht)!==0;Hs(n,s?t:!1),n=r}if(e.transitions!==null)for(const a of e.transitions)(a.is_global||t)&&a.in()}}let yn=null;function si(e){var t=yn;try{if(yn=new Set,D(e),t!==null)for(var n of yn)t.add(n);return yn}finally{yn=t}}function Js(e){for(var t of si(e))Cn(t,t.v)}let wn=!1;function is(e){wn=e}let pn=!1;function os(e){pn=e}let ke=null,Rt=!1;function Lt(e){ke=e}let ye=null;function tn(e){ye=e}let Vt=null;function ai(e){ke!==null&&(Vt===null?Vt=[e]:Vt.push(e))}let ot=null,_t=0,St=null;function ii(e){St=e}let Ks=1,qn=0,on=qn;function ls(e){on=e}let Qt=!1;function Ys(){return++Ks}function Wn(e){var t=e.f;if((t&kt)!==0)return!0;if((t&Jt)!==0){var n=e.deps,r=(t&xt)!==0;if(n!==null){var s,a,l=(t&er)!==0,c=r&&ye!==null&&!Qt,o=n.length;if((l||c)&&(ye===null||(ye.f&fn)===0)){var u=e,g=u.parent;for(s=0;s<o;s++)a=n[s],(l||!a?.reactions?.includes(u))&&(a.reactions??=[]).push(u);l&&(u.f^=er),c&&g!==null&&(g.f&xt)===0&&(u.f^=xt)}for(s=0;s<o;s++)if(a=n[s],Wn(a)&&Ns(a),a.wv>e.wv)return!0}(!r||ye!==null&&!Qt)&&lt(e,tt)}return!1}function Xs(e,t,n=!0){var r=e.reactions;if(r!==null&&!Vt?.includes(e))for(var s=0;s<r.length;s++){var a=r[s];(a.f&bt)!==0?Xs(a,t,!1):t===a&&(n?lt(a,kt):(a.f&tt)!==0&&lt(a,Jt),ln(a))}}function Qs(e){var t=ot,n=_t,r=St,s=ke,a=Qt,l=Vt,c=De,o=Rt,u=on,g=e.f;ot=null,_t=0,St=null,Qt=(g&xt)!==0&&(Rt||!wn||ke===null),ke=(g&(Ht|dn))===0?e:null,Vt=null,tr(e.ctx),Rt=!1,on=++qn,e.ac!==null&&(vr(()=>{e.ac.abort(Pr)}),e.ac=null);try{e.f|=xr;var p=e.fn,x=p(),m=e.deps;if(ot!==null){var w;if(sr(e,_t),m!==null&&_t>0)for(m.length=_t+ot.length,w=0;w<ot.length;w++)m[_t+w]=ot[w];else e.deps=m=ot;if(!Qt||(g&bt)!==0&&e.reactions!==null)for(w=_t;w<m.length;w++)(m[w].reactions??=[]).push(e)}else m!==null&&_t<m.length&&(sr(e,_t),m.length=_t);if(On()&&St!==null&&!Rt&&m!==null&&(e.f&(bt|Jt|kt))===0)for(w=0;w<St.length;w++)Xs(St[w],e);return s!==null&&s!==e&&(qn++,St!==null&&(r===null?r=St:r.push(...St))),(e.f&sn)!==0&&(e.f^=sn),x}catch(T){return Fa(T)}finally{e.f^=xr,ot=t,_t=n,St=r,ke=s,Qt=a,Vt=l,tr(c),Rt=o,on=u}}function oi(e,t){let n=t.reactions;if(n!==null){var r=ua.call(n,e);if(r!==-1){var s=n.length-1;s===0?n=t.reactions=null:(n[r]=n[s],n.pop())}}n===null&&(t.f&bt)!==0&&(ot===null||!ot.includes(t))&&(lt(t,Jt),(t.f&(xt|er))===0&&(t.f^=er),Os(t),sr(t,0))}function sr(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)oi(e,n[r])}function Sn(e){var t=e.f;if((t&fn)===0){lt(e,tt);var n=ye,r=wn;ye=e,wn=!0;try{(t&Gn)!==0?ri(e):zs(e),qs(e);var s=Qs(e);e.teardown=typeof s=="function"?s:null,e.wv=Ks;var a;Ss&&La&&(e.f&kt)!==0&&e.deps}finally{wn=r,ye=n}}}function i(e){var t=e.f,n=(t&bt)!==0;if(yn?.add(e),ke!==null&&!Rt){var r=ye!==null&&(ye.f&fn)!==0;if(!r&&!Vt?.includes(e)){var s=ke.deps;if((ke.f&xr)!==0)e.rv<qn&&(e.rv=qn,ot===null&&s!==null&&s[_t]===e?_t++:ot===null?ot=[e]:(!Qt||!ot.includes(e))&&ot.push(e));else{(ke.deps??=[]).push(e);var a=e.reactions;a===null?e.reactions=[ke]:a.includes(ke)||a.push(ke)}}}else if(n&&e.deps===null&&e.effects===null){var l=e,c=l.parent;c!==null&&(c.f&xt)===0&&(l.f^=xt)}if(pn){if(an.has(e))return an.get(e);if(n){l=e;var o=l.v;return((l.f&tt)===0&&l.reactions!==null||Zs(l))&&(o=Fr(l)),an.set(l,o),o}}else if(n){if(l=e,kn?.has(l))return kn.get(l);Wn(l)&&Ns(l)}if((e.f&sn)!==0)throw e.v;return e.v}function Zs(e){if(e.v===Ze)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(an.has(t)||(t.f&bt)!==0&&Zs(t))return!0;return!1}function D(e){var t=Rt;try{return Rt=!0,e()}finally{Rt=t}}const li=-7169;function lt(e,t){e.f=e.f&li|t}function ce(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Dt in e)Cr(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Dt in n&&Cr(n)}}}function Cr(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{Cr(e[r],t)}catch{}const n=Ar(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=xs(n);for(let s in r){const a=r[s].get;if(a)try{a.call(e)}catch{}}}}}const ci=["touchstart","touchmove"];function ui(e){return ci.includes(e)}const di=new Set,cs=new Set;function fi(e,t,n,r={}){function s(a){if(r.capture||Dn.call(t,a),!a.cancelBubble)return vr(()=>n?.call(this,a))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Br(()=>{t.addEventListener(e,s,r)}):t.addEventListener(e,s,r),s}function X(e,t,n,r,s){var a={capture:r,passive:s},l=fi(e,t,n,a);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&pr(()=>{t.removeEventListener(e,l,a)})}let us=null;function Dn(e){var t=this,n=t.ownerDocument,r=e.type,s=e.composedPath?.()||[],a=s[0]||e.target;us=e;var l=0,c=us===e&&e.__root;if(c){var o=s.indexOf(c);if(o!==-1&&(t===document||t===window)){e.__root=t;return}var u=s.indexOf(t);if(u===-1)return;o<=u&&(l=o)}if(a=s[l]||e.target,a!==t){Qn(e,"currentTarget",{configurable:!0,get(){return a||n}});var g=ke,p=ye;Lt(null),tn(null);try{for(var x,m=[];a!==null;){var w=a.assignedSlot||a.parentNode||a.host||null;try{var T=a["__"+r];if(T!=null&&(!a.disabled||e.target===a))if(Vn(T)){var[N,...B]=T;N.apply(a,[e,...B])}else T.call(a,e)}catch(U){x?m.push(U):x=U}if(e.cancelBubble||w===t||w===null)break;a=w}if(x){for(let U of m)queueMicrotask(()=>{throw U});throw x}}finally{e.__root=t,delete e.currentTarget,Lt(g),tn(p)}}}function Hr(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function In(e,t){var n=ye;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function F(e,t){var n=(t&Na)!==0,r=(t&Ra)!==0,s,a=!e.startsWith("<!>");return()=>{s===void 0&&(s=Hr(a?e:"<!>"+e),n||(s=$t(s)));var l=r||Ps?document.importNode(s,!0):s.cloneNode(!0);if(n){var c=$t(l),o=l.lastChild;In(c,o)}else In(l,l);return l}}function vi(e,t,n="svg"){var r=!e.startsWith("<!>"),s=`<${n}>${r?e:"<!>"+e}</${n}>`,a;return()=>{if(!a){var l=Hr(s),c=$t(l);a=$t(c)}var o=a.cloneNode(!0);return In(o,o),o}}function Jr(e,t){return vi(e,t,"svg")}function Pt(e=""){{var t=vn(e+"");return In(t,t),t}}function qe(){var e=document.createDocumentFragment(),t=document.createComment(""),n=vn();return e.append(t,n),In(t,n),e}function C(e,t){e!==null&&e.before(t)}function Z(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function pi(e,t){return mi(e,t)}const gn=new Map;function mi(e,{target:t,anchor:n,props:r={},events:s,context:a,intro:l=!0}){Ya();var c=new Set,o=p=>{for(var x=0;x<p.length;x++){var m=p[x];if(!c.has(m)){c.add(m);var w=ui(m);t.addEventListener(m,Dn,{passive:w});var T=gn.get(m);T===void 0?(document.addEventListener(m,Dn,{passive:w}),gn.set(m,1)):gn.set(m,T+1)}}};o(Mr(di)),cs.add(o);var u=void 0,g=ti(()=>{var p=n??t.appendChild(vn());return En(()=>{if(a){vt({});var x=De;x.c=a}s&&(r.$$events=s),u=e(p,r)||{},a&&pt()}),()=>{for(var x of c){t.removeEventListener(x,Dn);var m=gn.get(x);--m===0?(document.removeEventListener(x,Dn),gn.delete(x)):gn.set(x,m)}cs.delete(o),p!==n&&p.parentNode?.removeChild(p)}});return gi.set(u,g),u}let gi=new WeakMap;function K(e,t,n=!1){var r=e,s=null,a=null,l=Ze,c=n?lr:0,o=!1;const u=(m,w=!0)=>{o=!0,x(w,m)};var g=null;function p(){g!==null&&(g.lastChild.remove(),r.before(g),g=null);var m=l?s:a,w=l?a:s;m&&Wr(m),w&&gr(w,()=>{l?a=null:s=null})}const x=(m,w)=>{if(l!==(l=m)){var T=qr(),N=r;if(T&&(g=document.createDocumentFragment(),g.append(N=vn())),l?s??=w&&En(()=>w(N)):a??=w&&En(()=>w(N)),T){var B=Oe,U=l?s:a,v=l?a:s;U&&B.skipped_effects.delete(U),v&&B.skipped_effects.add(v),B.add_callback(p)}else p()}};Vr(()=>{o=!1,t(u),o||x(null,null)},c)}function ar(e,t){return t}function hi(e,t,n){for(var r=e.items,s=[],a=t.length,l=0;l<a;l++)Gr(t[l].e,s,!0);var c=a>0&&s.length===0&&n!==null;if(c){var o=n.parentNode;Xa(o),o.append(n),r.clear(),Ot(e,t[0].prev,t[a-1].next)}Ws(s,()=>{for(var u=0;u<a;u++){var g=t[u];c||(r.delete(g.k),Ot(e,g.prev,g.next)),Gt(g.e,!c)}})}function Mt(e,t,n,r,s,a=null){var l=e,c={flags:t,items:new Map,first:null},o=(t&Cs)!==0;if(o){var u=e;l=u.appendChild(vn())}var g=null,p=!1,x=new Map,m=Nt(()=>{var B=n();return Vn(B)?B:B==null?[]:Mr(B)}),w,T;function N(){_i(T,w,c,x,l,s,t,r,n),a!==null&&(w.length===0?g?Wr(g):g=En(()=>a(l)):g!==null&&gr(g,()=>{g=null}))}Vr(()=>{T??=ye,w=i(m);var B=w.length;if(!(p&&B===0)){p=B===0;var U,v,R,S;if(qr()){var h=new Set,f=Oe;for(v=0;v<B;v+=1){R=w[v],S=r(R,v);var E=c.items.get(S)??x.get(S);E?(t&(ur|dr))!==0&&ea(E,R,v,t):(U=ta(null,c,null,null,R,S,v,s,t,n,!0),x.set(S,U)),h.add(S)}for(const[H,P]of c.items)h.has(H)||f.skipped_effects.add(P.e);f.add_callback(N)}else N();i(m)}})}function _i(e,t,n,r,s,a,l,c,o){var u=(l&Ea)!==0,g=(l&(ur|dr))!==0,p=t.length,x=n.items,m=n.first,w=m,T,N=null,B,U=[],v=[],R,S,h,f;if(u)for(f=0;f<p;f+=1)R=t[f],S=c(R,f),h=x.get(S),h!==void 0&&(h.a?.measure(),(B??=new Set).add(h));for(f=0;f<p;f+=1){if(R=t[f],S=c(R,f),h=x.get(S),h===void 0){var E=r.get(S);if(E!==void 0){r.delete(S),x.set(S,E);var H=N?N.next:w;Ot(n,N,E),Ot(n,E,H),yr(E,H,s),N=E}else{var P=w?w.e.nodes_start:s;N=ta(P,n,N,N===null?n.first:N.next,R,S,f,a,l,o)}x.set(S,N),U=[],v=[],w=N.next;continue}if(g&&ea(h,R,f,l),(h.e.f&It)!==0&&(Wr(h.e),u&&(h.a?.unfix(),(B??=new Set).delete(h))),h!==w){if(T!==void 0&&T.has(h)){if(U.length<v.length){var J=v[0],A;N=J.prev;var $=U[0],W=U[U.length-1];for(A=0;A<U.length;A+=1)yr(U[A],J,s);for(A=0;A<v.length;A+=1)T.delete(v[A]);Ot(n,$.prev,W.next),Ot(n,N,$),Ot(n,W,J),w=J,N=W,f-=1,U=[],v=[]}else T.delete(h),yr(h,w,s),Ot(n,h.prev,h.next),Ot(n,h,N===null?n.first:N.next),Ot(n,N,h),N=h;continue}for(U=[],v=[];w!==null&&w.k!==S;)(w.e.f&It)===0&&(T??=new Set).add(w),v.push(w),w=w.next;if(w===null)continue;h=w}U.push(h),N=h,w=h.next}if(w!==null||T!==void 0){for(var j=T===void 0?[]:Mr(T);w!==null;)(w.e.f&It)===0&&j.push(w),w=w.next;var L=j.length;if(L>0){var be=(l&Cs)!==0&&p===0?s:null;if(u){for(f=0;f<L;f+=1)j[f].a?.measure();for(f=0;f<L;f+=1)j[f].a?.fix()}hi(n,j,be)}}u&&Br(()=>{if(B!==void 0)for(h of B)h.a?.apply()}),e.first=n.first&&n.first.e,e.last=N&&N.e;for(var Se of r.values())Gt(Se.e);r.clear()}function ea(e,t,n,r){(r&ur)!==0&&Cn(e.v,t),(r&dr)!==0?Cn(e.i,n):e.i=n}function ta(e,t,n,r,s,a,l,c,o,u,g){var p=(o&ur)!==0,x=(o&Ia)===0,m=p?x?z(s,!1,!1):Fn(s):s,w=(o&dr)===0?l:Fn(l),T={i:w,v:m,k:a,a:null,e:null,prev:n,next:r};try{if(e===null){var N=document.createDocumentFragment();N.append(e=vn())}return T.e=En(()=>c(e,m,w,u),Pa),T.e.prev=n&&n.e,T.e.next=r&&r.e,n===null?g||(t.first=T):(n.next=T,n.e.next=T.e),r!==null&&(r.prev=T,r.e.prev=T.e),T}finally{}}function yr(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,s=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==null&&a!==r;){var l=fr(a);s.before(a),a=l}}function Ot(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function ds(e,t,n=!1,r=!1,s=!1){var a=e,l="";ne(()=>{var c=ye;if(l!==(l=t()??"")&&(c.nodes_start!==null&&(Vs(c.nodes_start,c.nodes_end),c.nodes_start=c.nodes_end=null),l!=="")){var o=l+"";n?o=`<svg>${o}</svg>`:r&&(o=`<math>${o}</math>`);var u=Hr(o);if((n||r)&&(u=$t(u)),In($t(u),u.lastChild),n||r)for(;$t(u);)a.before($t(u));else a.before(u)}})}function yi(e,t,n,r,s){var a=t.$$slots?.[n],l=!1;a===!0&&(a=t.children,l=!0),a===void 0||a(e,l?()=>r:r)}function bi(e){const t={};e.children&&(t.default=!0);for(const n in e.$$slots)t[n]=!0;return t}function wi(e,t,n){var r=e,s,a,l=null,c=null;function o(){a&&(gr(a),a=null),l&&(l.lastChild.remove(),r.before(l),l=null),a=c,c=null}Vr(()=>{if(s!==(s=t())){var u=qr();if(s){var g=r;u&&(l=document.createDocumentFragment(),l.append(g=vn()),a&&Oe.skipped_effects.add(a)),c=En(()=>n(g,s))}u?Oe.add_callback(o):o()}},lr)}const fs=[...` 	
\r\f \v\uFEFF`];function Si(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var s in n)if(n[s])r=r?r+" "+s:s;else if(r.length)for(var a=s.length,l=0;(l=r.indexOf(s,l))>=0;){var c=l+a;(l===0||fs.includes(r[l-1]))&&(c===r.length||fs.includes(r[c]))?r=(l===0?"":r.substring(0,l))+r.substring(c+1):l=c}}return r===""?null:r}function xi(e,t){return e==null?null:String(e)}function Xe(e,t,n,r,s,a){var l=e.__className;if(l!==n||l===void 0){var c=Si(n,r,a);c==null?e.removeAttribute("class"):e.className=c,e.__className=n}else if(a&&s!==a)for(var o in a){var u=!!a[o];(s==null||u!==!!s[o])&&e.classList.toggle(o,u)}return a}function cn(e,t,n,r){var s=e.__style;if(s!==t){var a=xi(t);a==null?e.removeAttribute("style"):e.style.cssText=a,e.__style=t}return r}function na(e,t,n=!1){if(e.multiple){if(t==null)return;if(!Vn(t))return Da();for(var r of e.options)r.selected=t.includes(Bn(r));return}for(r of e.options){var s=Bn(r);if(Ka(s,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function ki(e){var t=new MutationObserver(()=>{na(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),pr(()=>{t.disconnect()})}function ra(e,t,n=t){var r=!0;Us(e,"change",s=>{var a=s?"[selected]":":checked",l;if(e.multiple)l=[].map.call(e.querySelectorAll(a),Bn);else{var c=e.querySelector(a)??e.querySelector("option:not([disabled])");l=c&&Bn(c)}n(l)}),zr(()=>{var s=t();if(na(e,s,r),r&&s===void 0){var a=e.querySelector(":checked");a!==null&&(s=Bn(a),n(s))}e.__value=s,r=!1}),ki(e)}function Bn(e){return"__value"in e?e.__value:e.value}const Ti=Symbol("is custom element"),Ci=Symbol("is html");function vs(e,t){var n=sa(e);n.checked!==(n.checked=t??void 0)&&(e.checked=t)}function Ei(e,t,n,r){var s=sa(e);s[t]!==(s[t]=n)&&(n==null?e.removeAttribute(t):typeof n!="string"&&Ii(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function sa(e){return e.__attributes??={[Ti]:e.nodeName.includes("-"),[Ci]:e.namespaceURI===$a}}var ps=new Map;function Ii(e){var t=ps.get(e.nodeName);if(t)return t;ps.set(e.nodeName,t=[]);for(var n,r=e,s=Element.prototype;s!==r;){n=xs(r);for(var a in n)n[a].set&&t.push(a);r=Ar(r)}return t}function qt(e,t,n=t){var r=On(),s=new WeakSet;Us(e,"input",a=>{var l=a?e.defaultValue:e.value;if(l=br(e)?wr(l):l,n(l),Oe!==null&&s.add(Oe),r&&l!==(l=t())){var c=e.selectionStart,o=e.selectionEnd;e.value=l??"",o!==null&&(e.selectionStart=c,e.selectionEnd=Math.min(o,e.value.length))}}),D(t)==null&&e.value&&(n(br(e)?wr(e.value):e.value),Oe!==null&&s.add(Oe)),mr(()=>{var a=t();if(e===document.activeElement){var l=Xn??Oe;if(s.has(l))return}br(e)&&a===wr(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function br(e){var t=e.type;return t==="number"||t==="range"}function wr(e){return e===""?null:+e}function Jn(e,t,n){var r=zt(e,t);r&&r.set&&(e[t]=n,pr(()=>{e[t]=null}))}class Kr{#e=new WeakMap;#n;#t;static entries=new WeakMap;constructor(t){this.#t=t}observe(t,n){var r=this.#e.get(t)||new Set;return r.add(n),this.#e.set(t,r),this.#s().observe(t,this.#t),()=>{var s=this.#e.get(t);s.delete(n),s.size===0&&(this.#e.delete(t),this.#n.unobserve(t))}}#s(){return this.#n??(this.#n=new ResizeObserver(t=>{for(var n of t){Kr.entries.set(n.target,n);for(var r of this.#e.get(n.target)||[])r(n)}}))}}var Mi=new Kr({box:"border-box"});function ms(e,t,n){var r=Mi.observe(e,()=>n(e[t]));zr(()=>(D(()=>n(e[t])),r))}function gs(e,t){return e===t||e?.[Dt]===t}function en(e={},t,n,r){return zr(()=>{var s,a;return mr(()=>{s=a,a=[],D(()=>{e!==n(...a)&&(t(e,...a),s&&gs(n(...s),e)&&t(null,...s))})}),()=>{Br(()=>{a&&gs(n(...a),e)&&t(null,...a)})}}),e}function Ai(e){return function(...t){var n=t[0];n.target===this&&e?.apply(this,t)}}function aa(e){return function(...t){var n=t[0];return n.preventDefault(),e?.apply(this,t)}}function wt(e=!1){const t=De,n=t.l.u;if(!n)return;let r=()=>ce(t.s);if(e){let s=0,a={};const l=Ur(()=>{let c=!1;const o=t.s;for(const u in o)o[u]!==a[u]&&(a[u]=o[u],c=!0);return c&&s++,s});r=()=>i(l)}n.b.length&&ei(()=>{hs(t,r),Zn(n.b)}),Tr(()=>{const s=D(()=>n.m.map(va));return()=>{for(const a of s)typeof a=="function"&&a()}}),n.a.length&&Tr(()=>{hs(t,r),Zn(n.a)})}function hs(e,t){if(e.l.s)for(const n of e.l.s)i(n);t()}function Yr(e,t,n){if(e==null)return t(void 0),n&&n(void 0),Zt;const r=D(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const hn=[];function ia(e,t){return{subscribe:mt(e,t).subscribe}}function mt(e,t=Zt){let n=null;const r=new Set;function s(c){if(Is(e,c)&&(e=c,n)){const o=!hn.length;for(const u of r)u[1](),hn.push(u,e);if(o){for(let u=0;u<hn.length;u+=2)hn[u][0](hn[u+1]);hn.length=0}}}function a(c){s(c(e))}function l(c,o=Zt){const u=[c,o];return r.add(u),r.size===1&&(n=t(s,a)||Zt),c(e),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:s,update:a,subscribe:l}}function Xr(e,t,n){const r=!Array.isArray(e),s=r?[e]:e;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=t.length<2;return ia(n,(l,c)=>{let o=!1;const u=[];let g=0,p=Zt;const x=()=>{if(g)return;p();const w=t(r?u[0]:u,l,c);a?l(w):p=typeof w=="function"?w:Zt},m=s.map((w,T)=>Yr(w,N=>{u[T]=N,g&=~(1<<T),o&&x()},()=>{g|=1<<T}));return o=!0,x(),function(){Zn(m),p(),o=!1}})}function Nn(e){let t;return Yr(e,n=>t=n)(),t}let Kn=!1,Er=Symbol();function et(e,t,n){const r=n[t]??={store:null,source:z(void 0),unsubscribe:Zt};if(r.store!==e&&!(Er in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=Zt;else{var s=!0;r.unsubscribe=Yr(e,a=>{s?r.source.v=a:_(r.source,a)}),s=!1}return e&&Er in n?Nn(e):i(r.source)}function Oi(e,t){return e.set(t),t}function Hn(){const e={};function t(){pr(()=>{for(var n in e)e[n].unsubscribe();Qn(e,Er,{enumerable:!1,value:!0})})}return[e,t]}function Ni(e){var t=Kn;try{return Kn=!1,[e(),Kn]}finally{Kn=t}}const Ri={get(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(Rn(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r)return r[t]}},set(e,t,n){let r=e.props.length;for(;r--;){let s=e.props[r];Rn(s)&&(s=s());const a=zt(s,t);if(a&&a.set)return a.set(n),!0}return!1},getOwnPropertyDescriptor(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(Rn(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r){const s=zt(r,t);return s&&!s.configurable&&(s.configurable=!0),s}}},has(e,t){if(t===Dt||t===Ts)return!1;for(let n of e.props)if(Rn(n)&&(n=n()),n!=null&&t in n)return!0;return!1},ownKeys(e){const t=[];for(let n of e.props)if(Rn(n)&&(n=n()),!!n){for(const r in n)t.includes(r)||t.push(r);for(const r of Object.getOwnPropertySymbols(n))t.includes(r)||t.push(r)}return t}};function $i(...e){return new Proxy({props:e},Ri)}function Me(e,t,n,r){var s=!An||(n&Ma)!==0,a=(n&Oa)!==0,l=r,c=!0,o=()=>(c&&(c=!1,l=r),l),u;{var g=Dt in e||Ts in e;u=zt(e,t)?.set??(g&&t in e?U=>e[t]=U:void 0)}var p,x=!1;[p,x]=Ni(()=>e[t]),p===void 0&&r!==void 0&&(p=o(),u&&(s&&xa(),u(p)));var m;if(s?m=()=>{var U=e[t];return U===void 0?o():(c=!0,U)}:m=()=>{var U=e[t];return U!==void 0&&(l=void 0),U===void 0?l:U},s&&(n&Aa)===0)return m;if(u){var w=e.$$legacy;return(function(U,v){return arguments.length>0?((!s||!v||w||x)&&u(v?m():U),U):m()})}var T=!1,N=Nt(()=>(T=!1,m()));i(N);var B=ye;return(function(U,v){if(arguments.length>0){const R=v?i(N):s&&a?bn(U):U;return _(N,R),T=!0,l!==void 0&&(l=R),U}return pn&&T||(B.f&fn)!==0?N.v:i(N)})}function Wt(e){De===null&&cr(),An&&De.l!==null?oa(De).m.push(e):Tr(()=>{const t=D(e);if(typeof t=="function")return t})}function Qr(e){De===null&&cr(),Wt(()=>()=>D(e))}function Di(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}function mn(){const e=De;return e===null&&cr(),(t,n,r)=>{const s=e.s.$$events?.[t];if(s){const a=Vn(s)?s.slice():[s],l=Di(t,n,r);for(const c of a)c.call(e.x,l);return!l.defaultPrevented}return!0}}function Pi(e){De===null&&cr(),De.l===null&&Sa(),oa(De).a.push(e)}function oa(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const Li="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Li);Ba();const Bi="modulepreload",Ui=function(e){return"/"+e},_s={},Xt=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let u=function(g){return Promise.all(g.map(p=>Promise.resolve(p).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};var l=u;document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),o=c?.nonce||c?.getAttribute("nonce");s=u(n.map(g=>{if(g=Ui(g),g in _s)return;_s[g]=!0;const p=g.endsWith(".css"),x=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${x}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":Bi,p||(m.as="script"),m.crossOrigin="",m.href=g,o&&m.setAttribute("nonce",o),document.head.appendChild(m),p)return new Promise((w,T)=>{m.addEventListener("load",w),m.addEventListener("error",()=>T(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(c){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=c,window.dispatchEvent(o),!o.defaultPrevented)throw c}return s.then(c=>{for(const o of c||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};class Fi{constructor(){this.store=mt({serverTime:null,clientTime:null,timeOffset:0,lastSync:null}),this.subscribe=this.store.subscribe,this.update=this.store.update,this.set=this.store.set}updateServerTime(t){const n=new Date(t),r=new Date,s=n.getTime()-r.getTime();this.update(a=>({...a,serverTime:n,clientTime:r,timeOffset:s,lastSync:r}))}getServerTime(){let t;if(this.subscribe(r=>t=r)(),!t.lastSync)return new Date;const n=new Date;return new Date(n.getTime()+t.timeOffset)}formatTimeElapsed(t){const n=new Date,r=new Date(t),s=n.getTime()-r.getTime(),a=Math.floor(s/(1e3*60));return a>0?a:0}resetTimeOffset(){this.update(t=>({...t,timeOffset:0,lastSync:null}))}}const zn=new Fi,Ir=Xr(zn,(e,t)=>{const n=()=>{const s=zn.getServerTime();t(s)};n();const r=setInterval(n,1e3);return()=>clearInterval(r)},new Date),ji=Xr(Ir,(e,t)=>{let n=null;return Ir.subscribe(r=>{const s=r.getMinutes();n!==s&&(n=s,t({time:r,minute:s}))})},{time:new Date,minute:new Date().getMinutes()});function qi(){const{subscribe:e,set:t,update:n}=mt({connected:!1,isConnected:!1,lastMessage:null,error:null,sessionId:null,currentServer:null,serverIndex:0,connectionAttempts:0}),r=()=>{const h=window.location.hostname;return window.location.protocol==="https:"?[h]:[`${h}:3030`]};let s=null,a=null,l=0,c=0,o=null;const u=new Map,g=10,p=new Map;function x(){r().forEach(f=>{p.has(f)||p.set(f,{successfulConnections:0,failedConnections:0,averageResponseTime:0,lastConnectionTime:null,reliability:1})})}function m(h){const f=h.successfulConnections+h.failedConnections;if(f===0)return 1;const E=h.successfulConnections/f,H=h.averageResponseTime<1e3?.1:0;return Math.min(E+H,1)}function w(){const h=r();if(h.length===1)return 0;const f=h.map(P=>{const J=p.get(P);return J?J.reliability:1}),E=f.reduce((P,J)=>P+J,0);let H=Math.random()*E;for(let P=0;P<f.length;P++)if(H-=f[P],H<=0)return P;return Math.floor(Math.random()*h.length)}function T(){x(),l=w();const h=r();console.log(`Initialized with smart-selected server index: ${l} (${h[l]})`),console.log("Server reliability scores:",Array.from(p.entries()).map(([f,E])=>`${f}: ${(E.reliability*100).toFixed(1)}%`).join(", "))}function N(){const h=localStorage.getItem("ecKasse-session-id");h?a=h:(a=R(),localStorage.setItem("ecKasse-session-id",a)),n(f=>({...f,sessionId:a})),console.log("Session ID initialized:",a)}function B(){const h=r(),f=h[l];return l=(l+1)%h.length,f}function U(h=0){if(o&&(clearTimeout(o),o=null),h>=g){console.error("Max reconnection attempts reached. Stopping reconnection."),n(f=>({...f,connected:!1,isConnected:!1,error:"Failed to connect to any server after maximum attempts",connectionAttempts:h}));return}try{const f=B(),H=`${window.location.protocol==="https:"?"wss:":"ws:"}//${f}`;console.log(`Attempting WebSocket connection to ${H} (attempt ${h+1}/${g})`),n(A=>({...A,currentServer:f,serverIndex:l,connectionAttempts:h+1,error:null})),s=new WebSocket(H);const P=Date.now();s.onopen=()=>{const A=Date.now()-P;if(console.log(`WebSocket connected to ${f} (${A}ms)`),p.has(f)){const $=p.get(f);$.successfulConnections++,$.lastConnectionTime=A,$.averageResponseTime=$.averageResponseTime===0?A:($.averageResponseTime+A)/2,$.reliability=m($),p.set(f,$)}c=0,n($=>({...$,connected:!0,isConnected:!0,error:null,connectionAttempts:0}))},s.onmessage=A=>{try{const $=JSON.parse(A.data);if(console.log("WebSocket message received:",$),$.serverTime&&zn.updateServerTime($.serverTime),n(W=>({...W,lastMessage:$})),$.command==="ui-refresh-request"){console.log("UI refresh request received, reloading page..."),window.location.reload();return}if($.command==="displayAgentMessage"){console.log("🌐 [WebSocket] Received displayAgentMessage:",{timestamp:$.payload?.timestamp,type:$.payload?.type,message:$.payload?.message?.substring(0,100)+($.payload?.message?.length>100?"...":""),style:$.payload?.style,hasStyle:!!$.payload?.style,fullPayload:$.payload}),Xt(async()=>{const{agentStore:W}=await Promise.resolve().then(()=>Ln);return{agentStore:W}},void 0).then(({agentStore:W})=>{console.log("🌐 [WebSocket] Calling agentStore.addMessage with payload"),W.addMessage($.payload)});return}if($.operationId&&u.has($.operationId)){const W=u.get($.operationId);u.delete($.operationId),W($)}}catch($){console.error("Error parsing WebSocket message:",$)}},s.onclose=A=>{if(console.log(`WebSocket disconnected from ${f} (code: ${A.code}, reason: ${A.reason})`),A.code!==1e3&&p.has(f)){const W=p.get(f);W.failedConnections++,W.reliability=m(W),p.set(f,W),console.log(`Updated reliability for ${f}: ${(W.reliability*100).toFixed(1)}%`)}n(W=>({...W,connected:!1,isConnected:!1}));const $=Math.min(1e3*Math.pow(2,Math.floor(h/3)),3e4);console.log(`Reconnecting in ${$}ms to next server...`),o=setTimeout(()=>{U(h+1)},$)},s.onerror=A=>{if(console.error(`WebSocket error on ${f}:`,A),p.has(f)){const $=p.get(f);$.failedConnections++,$.reliability=m($),p.set(f,$)}n($=>({...$,error:`Connection error: ${f}`}))};const J=setTimeout(()=>{s&&s.readyState===WebSocket.CONNECTING&&(console.log(`Connection timeout for ${f}, trying next server...`),s.close())},1e4);s.onopen=(A=>function(...$){return clearTimeout(J),A.apply(this,$)})(s.onopen)}catch(f){console.error("Failed to create WebSocket connection:",f),n(E=>({...E,error:f.message})),o=setTimeout(()=>{U(h+1)},2e3)}}function v(h){if(console.log("[wsStore] send() called with:",h),console.log("[wsStore] WebSocket state:",{exists:!!s,readyState:s?s.readyState:"N/A",readyStateText:s?s.readyState===0?"CONNECTING":s.readyState===1?"OPEN":s.readyState===2?"CLOSING":"CLOSED":"N/A",sessionId:a}),s&&s.readyState===WebSocket.OPEN){const f={operationId:R(),...h,payload:{...h.payload,sessionId:a}};return h.command==="getCategories"&&(console.log("🔍 [wsStore] SENDING getCategories command:",f),console.log("🔍 [wsStore] WebSocket ready state confirmed OPEN for getCategories")),console.log("Sending WebSocket message:",f),s.send(JSON.stringify(f)),new Promise(E=>{u.set(f.operationId,E),setTimeout(()=>{u.has(f.operationId)&&(u.delete(f.operationId),h.command==="getCategories"&&console.error("❌ [wsStore] getCategories TIMEOUT after 10 seconds"),E({error:"Timeout waiting for response"}))},1e4),h.command==="getCategories"&&console.log("🔍 [wsStore] getCategories promise created, waiting for response...")})}else{const f="WebSocket not connected";return console.log(`❌ [wsStore] ${f}:`,{command:h.command,wsExists:!!s,readyState:s?s.readyState:"N/A"}),h.command==="getCategories"&&console.error("❌ [wsStore] getCategories FAILED - WebSocket not connected!"),Promise.resolve({error:f})}}function R(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(h){const f=Math.random()*16|0;return(h==="x"?f:f&3|8).toString(16)})}return T(),N(),U(),{subscribe:e,send:v,connect:U,getSessionId:()=>a,getCurrentServer:()=>S({subscribe:e}).currentServer,getConnectionStats:()=>{const h=S({subscribe:e});return{currentServer:h.currentServer,serverIndex:h.serverIndex,connectionAttempts:h.connectionAttempts,availableServers:r(),serverStats:Array.from(p.entries()).map(([f,E])=>({server:f,reliability:Math.round(E.reliability*100),successfulConnections:E.successfulConnections,failedConnections:E.failedConnections,averageResponseTime:Math.round(E.averageResponseTime),lastConnectionTime:E.lastConnectionTime}))}},forceReconnect:()=>{s&&s.close(),l=0,c=0,U()},switchToBestServer:()=>{s&&s.close(),l=w(),c=0,console.log("Switching to best performing server..."),U()},resetServerStats:()=>{p.clear(),x(),console.log("Server statistics reset")}};function S(h){let f;return h.subscribe(E=>f=E)(),f}}const le=qi(),zi=Object.freeze(Object.defineProperty({__proto__:null,wsStore:le},Symbol.toStringTag,{value:"Module"})),Vi=mt([]);function Gi(e){if(!e||typeof e!="object")return{};const t={};for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];["string","number","boolean"].includes(typeof r)?t[n]=r:r instanceof Error?t[n]={message:r.message,stack:r.stack}:t[n]=JSON.stringify(r,null,2)}return t}function G(e,t,n={}){const r=new Date().toISOString().slice(0,19).replace("T"," ");Vi.update(a=>[...a.slice(-100),{timestamp:r,level:e,message:t,context:n}]);let s;le.subscribe(a=>s=a)(),le&&s&&s.connected&&le.send({command:"logClientEvent",payload:{level:e,message:t,context:Gi(n)}})}const Yn={isAuthenticated:!1,currentUser:null,sessionId:null,users:[],selectedUser:null,loginState:"user_selection",error:null,isLoading:!1};function Wi(){const{subscribe:e,set:t,update:n}=mt(Yn);return{subscribe:e,async fetchUsers(){try{n(s=>({...s,isLoading:!0,error:null}));const r=await le.send({command:"getLoginUsers",payload:{}});if(r.status==="success")n(s=>({...s,users:r.payload||[],isLoading:!1})),G("INFO",`Fetched ${r.payload?.length||0} users for login`);else throw new Error(r.payload?.error||"Failed to fetch users")}catch(r){G("ERROR",`Failed to fetch users: ${r.message}`),n(s=>({...s,error:r.message,isLoading:!1}))}},selectUser(r){n(s=>({...s,selectedUser:r,loginState:"pin_entry",error:null})),G("INFO",`Selected user: ${r.username}`)},backToUserSelection(){n(r=>({...r,selectedUser:null,loginState:"user_selection",error:null}))},async login(r,s){try{n(l=>({...l,isLoading:!0,loginState:"authenticating",error:null}));const a=await le.send({command:"login",payload:{username:r,password:s,ipAddress:"localhost",userAgent:navigator.userAgent}});if(a.status==="success"&&a.payload.success){const{user:l,session:c}=a.payload;try{await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:r,password:s})})}catch(u){G("WARN",`HTTP session establishment failed: ${u.message}`)}const o={...l,permissions:["all","order.change_price","order.reduce_quantity"]};return n(u=>({...u,isAuthenticated:!0,currentUser:o,sessionId:c.sessionId,loginState:"authenticated",isLoading:!1,error:null,selectedUser:null})),G("SUCCESS",`User ${r} authenticated successfully`),{success:!0}}else{const l=a.payload?.error||"Authentication failed";throw new Error(l)}}catch(a){return G("ERROR",`Authentication failed: ${a.message}`),n(l=>({...l,error:a.message,loginState:"pin_entry",isLoading:!1})),{success:!1,error:a.message}}},async logout(){try{const r={...Yn};let s=null;if(n(a=>(s=a.sessionId,r)),s)try{await le.send({command:"logout",payload:{sessionId:s}}),G("INFO","User logged out successfully")}catch(a){G("WARN",`Logout request failed: ${a.message}`)}try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(a){G("WARN",`HTTP logout failed: ${a.message}`)}return t(r),{success:!0}}catch(r){return G("ERROR",`Logout failed: ${r.message}`),t(Yn),{success:!1,error:r.message}}},async getCurrentUser(){try{let r=null;if(n(a=>(r=a.sessionId,a)),!r)throw new Error("No active session");const s=await le.send({command:"getCurrentUser",payload:{sessionId:r}});if(s.status==="success"&&s.payload.success)return n(a=>({...a,currentUser:s.payload.user})),{success:!0,user:s.payload.user};throw new Error(s.payload?.error||"Failed to get current user")}catch(r){return G("ERROR",`Failed to get current user: ${r.message}`),{success:!1,error:r.message}}},clearError(){n(r=>({...r,error:null}))},reset(){t(Yn)},async checkSession(){try{n(s=>({...s,isLoading:!0}));const r=await fetch("/api/session/status",{credentials:"include"});if(r.ok){const s=await r.json();if(s.authenticated&&s.user){const a={...s.user,permissions:["all","order.change_price","order.reduce_quantity"]};return n(l=>({...l,isAuthenticated:!0,currentUser:a,sessionId:null,loginState:"authenticated",isLoading:!1,error:null,selectedUser:null})),G("SUCCESS",`Session restored for user: ${s.user.username}`),{success:!0,user:s.user}}}return n(s=>({...s,isLoading:!1})),{success:!1,error:"No valid session"}}catch(r){return G("ERROR",`Failed to check session: ${r.message}`),n(s=>({...s,isLoading:!1,error:r.message})),{success:!1,error:r.message}}},establishSession(r){try{const{user:s,session:a}=r,l={...s,permissions:["all","order.change_price","order.reduce_quantity"]};return n(c=>({...c,isAuthenticated:!0,currentUser:l,sessionId:a.sessionId,loginState:"authenticated",isLoading:!1,error:null,selectedUser:null})),G("SUCCESS",`Demo mode: Auto-authenticated as ${s.username}`),{success:!0}}catch(s){return G("ERROR",`Failed to establish demo session: ${s.message}`),{success:!1,error:s.message}}}}}const un=Wi(),ys=Object.freeze(Object.defineProperty({__proto__:null,authStore:un},Symbol.toStringTag,{value:"Module"})),ft=mt("agent");Xr(ft,e=>{const t=["order","receipts","agent"],n=t.indexOf(e);return[...t.slice(n),...t.slice(0,n)]});function Hi(){const{subscribe:e,set:t,update:n}=mt({transactionId:null,uuid:null,items:[],total:0,tax:0,status:"idle",paymentType:null,paymentAmount:null,metadata:{},activeTransactionItemId:null});let r=null,s=[];function a(){t({transactionId:null,uuid:null,items:[],total:0,tax:0,status:"idle",paymentType:null,paymentAmount:null,metadata:{},activeTransactionItemId:null}),r=null,s=[],G("INFO","Order reset and ready for new transaction.")}le.subscribe(v=>{let R;if(e(S=>R=S)(),v.lastMessage?.command==="orderUpdated"&&v.lastMessage.status==="success"&&v.lastMessage.payload){const S=v.lastMessage.payload,h=(S.items||[]).map(P=>{const J=R.items.find(A=>A.id===P.id);return{...P,isEdited:J?.isEdited||!1}}),f=P=>{const J=[];return P.created_at&&J.push(new Date(P.created_at)),P.updated_at&&J.push(new Date(P.updated_at)),J.length>0?Math.max(...J):0};let E=null;h.length>0&&(E=[...h].sort((J,A)=>{const $=f(J),W=f(A);return $!==W?W-$:A.id-J.id})[0].id);const H=[...h].sort((P,J)=>{const A=f(P),$=f(J);return A!==$?A-$:P.id-J.id});if(n(P=>({...P,transactionId:S.id,uuid:S.uuid,items:H,total:parseFloat(S.total_amount),tax:parseFloat(S.tax_amount),status:"active",metadata:S.metadata?typeof S.metadata=="string"?JSON.parse(S.metadata):S.metadata:{},activeTransactionItemId:E})),G("INFO",`Order ${S.id} updated.`),R.status==="initializing"&&s.length>0){const P=[...s];s=[],P.forEach(({itemId:J,quantity:A,userId:$})=>{G("INFO",`Adding queued item ${J} to transaction ${S.id}`),le.send({command:"addItemToTransaction",payload:{transactionId:S.id,itemId:J,quantity:A,userId:$}})})}}else if(v.lastMessage?.command==="transactionFinished"&&v.lastMessage.status==="success"){const S=v.lastMessage.payload;S.printStatus&&(S.printStatus.status==="failed"?G("ERROR",`Receipt print failed: ${S.printStatus.error}`):S.printStatus.status==="success"&&G("SUCCESS","Receipt printed successfully")),S.transaction?(n(h=>({...h,transactionId:S.transaction.id,uuid:S.transaction.uuid,items:S.transaction.items||[],total:parseFloat(S.transaction.total_amount),tax:parseFloat(S.transaction.tax_amount),status:"finished",paymentType:S.transaction.payment_type,paymentAmount:parseFloat(S.transaction.payment_amount),metadata:S.transaction.metadata?typeof S.transaction.metadata=="string"?JSON.parse(S.transaction.metadata):S.transaction.metadata:{},activeTransactionItemId:null})),G("SUCCESS",`Transaction ${S.transaction.id} finished successfully.`)):(G("SUCCESS",`Transaction ${R.transactionId} finished successfully.`),n(h=>({...h,status:"finished"}))),setTimeout(()=>{G("INFO","Auto-resetting order for next transaction."),a()},2e3)}});function l(){const v=Nn(un)?.currentUser;if(!v?.id)throw new Error("User must be authenticated to perform this action");return v.id}async function c(v={}){if(r)return r;const R=l();return n(S=>({...S,status:"initializing"})),G("INFO","Initializing new order..."),r=new Promise((S,h)=>{let f;f=le.subscribe(E=>{E.lastMessage?.command==="orderUpdated"&&E.lastMessage.status==="success"?(f&&f(),S(E.lastMessage.payload)):E.lastMessage?.command==="orderUpdated"&&E.lastMessage.status==="error"&&(f&&f(),n(H=>({...H,status:"error"})),h(new Error(E.lastMessage.payload?.message||"Failed to initialize order")))})}),le.send({command:"findOrCreateActiveTransaction",payload:{criteria:{metadata:v},userId:R}}),r}async function o(v,R=1){ft.set("order");const S=l();let h;if(e(f=>h=f)(),h.status==="idle"){G("INFO",`First item click detected. Initializing order and queuing item ${v}...`),s.push({itemId:v,quantity:R,userId:S});try{await c(S)}catch(f){G("ERROR",`Failed to initialize order: ${f.message}`),s=[];return}return}if(h.status==="initializing"){G("INFO",`Order initializing. Queuing item ${v}...`),s.push({itemId:v,quantity:R,userId:S});return}if(h.status==="active"&&h.transactionId){const f=h.items.find(E=>E.item_id===v&&!E.notes?.includes("Custom price:")&&!E.isEdited);if(f){const E=parseFloat(f.quantity)+R;G("INFO",`Item ${v} already exists and not edited, updating quantity to ${E}`),N(f.id,E,!1);return}G("INFO",`Adding new item ${v} to transaction ${h.transactionId}`),le.send({command:"addItemToTransaction",payload:{transactionId:h.transactionId,itemId:v,quantity:R,userId:S}});return}G("ERROR","Cannot add item: invalid order state.")}async function u(v){const R=l();let S;if(e(h=>S=h)(),!S.transactionId||S.status!=="active"){G("ERROR","No active order to finish.");return}G("INFO",`Finishing transaction ${S.transactionId}...`),le.send({command:"finishTransaction",payload:{transactionId:S.transactionId,paymentData:v,userId:R}})}async function g(v,R=!0){const S=l();let h;if(e(f=>h=f)(),!h.transactionId||h.status!=="active"){G("ERROR","No active order to park.");return}return G("INFO",`Parking transaction ${h.transactionId} to table ${v} (updateTime: ${R})...`),new Promise(async(f,E)=>{const H=le.subscribe(async P=>{P.lastMessage?.command==="parkTransactionResponse"&&P.lastMessage.status==="success"?(H(),a(),G("SUCCESS",`Order parked to table ${v}`),f(P.lastMessage.payload)):P.lastMessage?.command==="parkTransactionResponse"&&P.lastMessage.status==="error"&&(H(),G("ERROR",`Failed to park order: ${P.lastMessage.payload?.message||"Unknown error"}`),E(new Error(P.lastMessage.payload?.message||"Failed to park order")))});le.send({command:"parkTransaction",payload:{transactionId:h.transactionId,tableIdentifier:v,userId:S,updateTimestamp:R}})})}function p(v){ft.set("order"),G("INFO",`Loading order ${v.id}...`),n(R=>({...R,transactionId:v.id,uuid:v.uuid,items:v.items||[],total:parseFloat(v.total_amount),tax:parseFloat(v.tax_amount),status:"active",metadata:v.metadata?typeof v.metadata=="string"?JSON.parse(v.metadata):v.metadata:{},activeTransactionItemId:null})),G("SUCCESS",`Order ${v.id} loaded successfully`)}async function x(v){const R=l();let S;if(e(h=>S=h)(),!S.transactionId||S.status!=="active")throw G("ERROR","No active order to assign table number to."),new Error("No active order to assign table number to.");G("INFO",`Checking availability and assigning table ${v} to transaction ${S.transactionId}...`);try{const h=Math.random().toString(36).substring(2,15),f=await new Promise((H,P)=>{const J=setTimeout(()=>{A&&A(),P(new Error("Table availability check timeout"))},5e3);let A;A=le.subscribe($=>{$.lastMessage?.command==="checkTableAvailabilityResponse"&&$.lastMessage?.operationId===h&&(clearTimeout(J),A&&A(),H($.lastMessage))}),le.send({operationId:h,command:"checkTableAvailability",payload:{tableNumber:v,excludeTransactionId:S.transactionId}})});if(console.log("Table availability check result:",f),f.status==="success"&&f.payload.isInUse)return G("ERROR",`Table ${v} is already in use by another order`),{tableInUse:!0};n(H=>({...H,metadata:{...H.metadata,table:v}}));const E=Math.random().toString(36).substring(2,15);await new Promise((H,P)=>{const J=setTimeout(()=>{A&&A(),P(new Error("Metadata update timeout"))},5e3);let A;A=le.subscribe($=>{$.lastMessage?.command==="updateTransactionMetadataResponse"&&$.lastMessage?.operationId===E&&(clearTimeout(J),A&&A(),$.lastMessage.status==="success"?H($.lastMessage):P(new Error($.lastMessage.payload?.message||"Failed to update metadata")))}),le.send({operationId:E,command:"updateTransactionMetadata",payload:{transactionId:S.transactionId,metadata:{...S.metadata,table:v},userId:R}})}),G("SUCCESS",`Table ${v} assigned to order`)}catch(h){throw G("ERROR",`Failed to assign table ${v}: ${h.message}`),h}}async function m(){G("INFO","Clearing active order view"),a()}function w(v,R){const S=l();let h;if(e(f=>h=f)(),h.status!=="active"||!h.transactionId){G("ERROR","Cannot update quantity: no active transaction");return}G("INFO",`Updating item quantity for item ${v} to ${R}`),le.send({command:"updateItemQuantity",payload:{transactionId:h.transactionId,transactionItemId:v,newQuantity:R,userId:S}})}function T(v,R,S=1){const h=l();let f;if(e(E=>f=E)(),f.status!=="active"||!f.transactionId){G("ERROR","Cannot add custom price item: no active transaction");return}G("INFO",`Adding custom price item ${v} with price ${R} and quantity ${S}`),le.send({command:"addCustomPriceItem",payload:{transactionId:f.transactionId,itemId:v,customPrice:R,quantity:S,userId:h}})}async function N(v,R,S=!0){const h=l();let f;if(e(E=>f=E)(),f.status!=="active"||!f.transactionId){G("ERROR","Cannot update quantity: no active transaction");return}S&&n(E=>({...E,items:E.items.map(H=>H.id===v?{...H,isEdited:!0}:H)})),G("INFO",`Updating item quantity for item ${v} to ${R}${S?" (marked as edited)":""}`),le.send({command:"updateItemQuantity",payload:{transactionId:f.transactionId,transactionItemId:v,newQuantity:R,userId:h}})}async function B(v,R,S=!1){const h=l();let f;if(e(E=>f=E)(),f.status!=="active"||!f.transactionId){G("ERROR","Cannot update price: no active transaction");return}n(E=>({...E,items:E.items.map(H=>H.id===v?{...H,isEdited:!0}:H)})),G("INFO",`Updating item price for item ${v} to ${R} (marked as edited)`),le.send({command:"updateItemPrice",payload:{transactionId:f.transactionId,transactionItemId:v,newPrice:R,isTotalPrice:S,userId:h}})}function U(){n(v=>({...v,activeTransactionItemId:null})),G("INFO","Item deselected from order view")}return{subscribe:e,set:t,update:n,initializeOrder:c,addItem:o,updateQuantity:w,updateItemQuantity:N,updateItemPrice:B,addWithCustomPrice:T,finishOrder:u,resetOrder:a,parkCurrentOrder:g,assignTableNumber:x,loadOrder:p,clearActiveOrderView:m,deselectItem:U}}const Ye=Hi();function Ji(e){if(typeof e=="object"&&e!==null)return e;if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}function Ki(){const{subscribe:e,set:t,update:n}=mt({receipts:[],loading:!1,error:null,lastUpdated:null});le.subscribe(a=>{if(a.lastMessage?.command==="getRecentReceiptsResponse")if(a.lastMessage.status==="success"){const l=a.lastMessage.payload;if(l.success&&l.transactions){const c=l.transactions.map(o=>({...o,metadata:o.metadata?Ji(o.metadata):{}}));n(o=>({...o,receipts:c,loading:!1,error:null,lastUpdated:new Date})),G("INFO",`Loaded ${l.transactions.length} recent receipts.`)}else n(c=>({...c,loading:!1,error:l.message||"Failed to load receipts"})),G("ERROR",`Failed to load receipts: ${l.message||"Unknown error"}`)}else n(l=>({...l,loading:!1,error:a.lastMessage.payload?.message||"Failed to load receipts"})),G("ERROR",`Failed to load receipts: ${a.lastMessage.payload?.message||"Unknown error"}`)});function r(a=20){n(c=>({...c,loading:!0,error:null})),G("INFO",`Loading recent receipts (limit: ${a})...`);let l;le.subscribe(c=>l=c)(),l&&l.connected?le.send({command:"getRecentReceipts",payload:{limit:a}}):(G("WARNING","WebSocket not connected, skipping receipt load"),n(c=>({...c,loading:!1,error:"WebSocket connection not available"})))}function s(){G("INFO","Refreshing receipts..."),r()}return{subscribe:e,loadReceipts:r,refresh:s}}const ir=Ki();class Yi{constructor(){this.store=mt([]),this.subscribe=this.store.subscribe,this.set=this.store.set,this.update=this.store.update}async refreshParkedOrders(){try{G("DEBUG","Requesting parked transactions...");const t=this.generateUUID();G("DEBUG",`Generated operationId: ${t}`);const n=await this.sendRequestWithFallback(t,"getParkedTransactions",{});G("DEBUG",`Parked transactions response: ${JSON.stringify(n)}`),n.status==="success"?(G("DEBUG",`Setting parked orders: ${JSON.stringify(n.payload)}`),this.set(n.payload||[])):(G("ERROR",`Failed to fetch parked orders: ${JSON.stringify(n)}`),this.set([]))}catch(t){G("ERROR",`Error fetching parked orders: ${t.message}`),this.set([])}}async sendRequestWithFallback(t,n,r){try{return await this.sendWebSocketRequest(t,n,r)}catch(s){G("WARNING",`WebSocket request failed, trying HTTP fallback: ${s.message}`);try{return await this.sendHttpRequest(t,n,r)}catch(a){throw G("ERROR",`Both WebSocket and HTTP requests failed: ${a.message}`),a}}}sendWebSocketRequest(t,n,r){return new Promise((s,a)=>{let l;if(le.subscribe(u=>l=u)(),!l||!l.connected){a(new Error("WebSocket is not connected"));return}const c=setTimeout(()=>{o(),a(new Error("WebSocket request timeout"))},3e3),o=le.subscribe(u=>{u.lastMessage&&u.lastMessage.operationId===t&&(clearTimeout(c),o(),s(u.lastMessage))});le.send({operationId:t,command:n,payload:r})})}async sendHttpRequest(t,n,r){const s=await fetch("/api/websocket-fallback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operationId:t,command:n,payload:r})});if(!s.ok)throw new Error(`HTTP request failed: ${s.status}`);return await s.json()}refresh(){return this.refreshParkedOrders()}async activateOrder(t,n=!1){try{const r=this.generateUUID(),s=await this.sendRequestWithFallback(r,"activateTransaction",{transactionId:t,userId:1,updateTimestamp:n});if(s.status==="success")return n&&await this.refreshParkedOrders(),s.payload;throw new Error(s.payload?.message||"Failed to activate order")}catch(r){throw G("ERROR",`Error activating order: ${r.message}`),r}}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const n=Math.random()*16|0;return(t==="x"?n:n&3|8).toString(16)})}}const Pn=new Yi,_n={DE:[["q","w","e","r","t","z","u","i","o","p","ü","ß"],["a","s","d","f","g","h","j","k","l","ö","ä"],["y","x","c","v","b","n","m"]],EN:[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m"]],RU:[["й","ц","у","к","е","н","г","ш","щ","з","х","ъ"],["ф","ы","в","а","п","р","о","л","д","ж","э"],["я","ч","с","м","и","т","ь","б","ю"]]};function Xi(){const{subscribe:e,set:t,update:n}=mt({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:_n});return{subscribe:e,activate(r,s,a,l="numeric"){t({isActive:!0,mode:r,layout:l,liveValue:l==="alpha"?{text:"",cursor:0}:"",confirmCallback:s,cancelCallback:a,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:_n})},deactivate(){t({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:_n})},append(r,s=null){n(a=>{if(!a.isActive)return a;if(a.layout==="alpha"){const l=a.liveValue.text,c=a.liveValue.cursor,o=l.slice(0,c)+r+l.slice(c),u={text:o,cursor:c+1};return a.mode==="agent"&&s&&s.updateDraftMessage(o),{...a,liveValue:u,errorMessage:null}}else return{...a,liveValue:a.liveValue+r,errorMessage:null}})},backspace(r=null){n(s=>{if(!s.isActive)return s;if(s.layout==="alpha"){const a=s.liveValue.text,l=s.liveValue.cursor;if(l>0){const c=a.slice(0,l-1)+a.slice(l),o={text:c,cursor:l-1};return s.mode==="agent"&&r&&r.updateDraftMessage(c),{...s,liveValue:o,errorMessage:null}}return{...s,errorMessage:null}}else return{...s,liveValue:s.liveValue.slice(0,-1),errorMessage:null}})},clear(r=null){n(s=>s.isActive?(s.mode==="agent"&&r&&r.updateDraftMessage(""),{...s,liveValue:s.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null}):s)},async confirm(){let r,s;if(n(c=>(r=c,c)),!r.isActive)return;s=r.layout==="alpha"?r.liveValue.text:r.liveValue;let a;if(Ye.subscribe(c=>a=c)(),a.activeTransactionItemId&&r.layout==="numeric"&&r.mode!=="agent"&&r.mode!=="table"){const c=s.trim();if(!c){this.deactivate();return}const o=a.items.find(u=>u.id===a.activeTransactionItemId);if(o){const{authStore:u}=await Xt(async()=>{const{authStore:x}=await Promise.resolve().then(()=>ys);return{authStore:x}},void 0);let g;u.subscribe(x=>g=x)();const p=g.currentUser?.permissions||[];if(c.includes(".")||c.includes(",")){const x=parseFloat(c.replace(",","."));if(!isNaN(x)&&x>0){const m=parseFloat(o.unit_price);let w=null;if(x<m&&(w="order.change_price"),p.includes("all")||(w?p.includes(w):!0)){const B=parseFloat(o.quantity)>1;Ye.updateItemPrice(o.id,x,B),Ye.deselectItem()}else{n(N=>({...N,errorMessage:"Permission denied to change price."}));return}}}else{const x=parseInt(c);if(!isNaN(x)&&x>0){const m=parseFloat(o.quantity);let w=null;if(x<m&&(w="order.reduce_quantity"),p.includes("all")||(w?p.includes(w):!0))Ye.updateItemQuantity(o.id,x),Ye.deselectItem();else{n(N=>({...N,errorMessage:"Permission denied to reduce quantity."}));return}}}}n(u=>({...u,liveValue:u.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null})),this.deactivate();return}if(r.mode==="agent"){if(r.layout==="numeric"&&/^\d{4,6}$/.test(s)){const{authStore:o}=await Xt(async()=>{const{authStore:u}=await Promise.resolve().then(()=>ys);return{authStore:u}},void 0);try{if((await o.login(null,s)).success){const{agentStore:g}=await Xt(async()=>{const{agentStore:m}=await Promise.resolve().then(()=>Ln);return{agentStore:m}},void 0);let p;o.subscribe(m=>p=m)();const x=`✅ Erfolgreich angemeldet als ${p.currentUser.full_name}!

⏰ Überprüfe Systemzeit...
🔍 Prüfe ausstehende Transaktionen...

Bitte warten Sie einen Moment...`;g.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:x}),g.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`🤖 KI-Assistent bereit!

Verfügbare Tools:
• findProduct - Produkte suchen und finden
• createProduct - Neue Produkte erstellen
• updateProduct - Produktdaten aktualisieren
• getSalesReport - Verkaufsberichte abrufen
• generateDsfinvkExport - DSFinV-K konforme Datenexporte erstellen

Ich wähle automatisch das richtige Tool für Ihre Anfrage aus. Stellen Sie einfach Ihre Frage!`}),setTimeout(async()=>{await this.checkSystemStatus(p.currentUser,g)},1e3),n(m=>({...m,liveValue:m.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null})),this.deactivate();return}else{const{agentStore:g}=await Xt(async()=>{const{agentStore:p}=await Promise.resolve().then(()=>Ln);return{agentStore:p}},void 0);g.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`❌ Ungültige PIN-Eingabe!

Bitte überprüfen Sie Ihre PIN und versuchen Sie es erneut. Sie können eine 4-6 stellige PIN über das Tastenfeld eingeben.`}),n(p=>({...p,liveValue:p.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null}));return}}catch{console.log("Direct login failed, falling back to agent message")}}const{agentStore:c}=await Xt(async()=>{const{agentStore:o}=await Promise.resolve().then(()=>Ln);return{agentStore:o}},void 0);try{await c.sendMessage(s),n(o=>({...o,liveValue:o.layout==="alpha"?{text:"",cursor:0}:""}))}catch(o){console.error("Agent message send failed:",o),n(u=>({...u,liveValue:u.layout==="alpha"?{text:"",cursor:0}:""}))}return}if(!r.confirmCallback)return;const l=r.confirmCallback;try{await l(s),n(()=>({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:_n}))}catch(c){console.error("Pinpad confirm callback failed:",c),n(()=>({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:_n}))}},cancel(r=null){n(s=>{const a=Date.now();if(a-s.lastRedClickTime<300){const c=s.cancelCallback;s.mode==="agent"&&Xt(async()=>{const{agentStore:u}=await Promise.resolve().then(()=>Ln);return{agentStore:u}},void 0).then(({agentStore:u})=>{u.cancelDraftMessage()});const o={isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:_n};return c&&setTimeout(()=>c(),0),o}else return s.mode==="agent"&&r&&r.updateDraftMessage(""),{...s,liveValue:s.layout==="alpha"?{text:"",cursor:0}:"",lastRedClickTime:a,errorMessage:null}})},activateTableEntry(){ft.set("order"),this.activate("table",async r=>{if(r&&r.trim())try{const s=await Ye.assignTableNumber(r.trim());if(s&&s.tableInUse){n(a=>({...a,liveValue:a.layout==="alpha"?{text:"",cursor:0}:""}));return}return s}catch(s){throw s}},()=>{})},activateTableEntryWithAutoCollapse(){ft.set("order"),this.activate("table",async r=>{if(r&&r.trim())try{const s=await Ye.assignTableNumber(r.trim());if(s&&s.tableInUse){n(o=>({...o,liveValue:o.layout==="alpha"?{text:"",cursor:0}:""}));return}let a;Ye.subscribe(o=>a=o)();const l=a.items&&a.items.length>0,c=a.metadata&&a.metadata.table;return l&&c?(await Ye.parkCurrentOrder(c,1,!1),await Pn.refresh(),Ye.resetOrder(),window.dispatchEvent(new CustomEvent("autoCollapseComplete")),{autoCollapsed:!0}):s}catch(s){throw s}},()=>{})},activateAlphaInput(r,s,a=null){a&&a.startDraftMessage(),this.activate("agent",r,s,"alpha")},moveCursorLeft(){n(r=>{if(!r.isActive||r.layout!=="alpha")return r;const s=Math.max(0,r.liveValue.cursor-1);return{...r,liveValue:{...r.liveValue,cursor:s}}})},moveCursorRight(){n(r=>{if(!r.isActive||r.layout!=="alpha")return r;const s=Math.min(r.liveValue.text.length,r.liveValue.cursor+1);return{...r,liveValue:{...r.liveValue,cursor:s}}})},switchLanguage(r=null){n(s=>{const a=Object.keys(s.layouts);if(r&&a.includes(r))return{...s,currentLanguage:r};if(!s.isActive||s.layout!=="alpha"){const u=(a.indexOf(s.currentLanguage)+1)%a.length;return{...s,currentLanguage:a[u]}}const c=(a.indexOf(s.currentLanguage)+1)%a.length;return{...s,currentLanguage:a[c]}})},async checkSystemStatus(r,s){try{const{wsStore:a}=await Xt(async()=>{const{wsStore:u}=await Promise.resolve().then(()=>zi);return{wsStore:u}},void 0);let l=0,c=!0;try{const u=await a.send({command:"systemTimeCheck",payload:{clientTime:new Date().toISOString()}});u.status==="success"?(l=u.payload.timeDifferenceSeconds,c=Math.abs(l)<=30):c=!1}catch{c=!1}if(c){s.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`✅ Erfolgreich angemeldet als ${r.full_name}!`});return}let o=`🎉 Willkommen zurück, ${r.full_name}!

`;if(c||(l!==0?o+=`⚠️ Zeitabweichung erkannt: ${Math.abs(l)} Sekunden ${l>0?"voraus":"zurück"}
`:o+=`⚠️ Zeitprüfung fehlgeschlagen
`),r.permissions.includes("all")||r.permissions.includes("manage_transactions"))try{const u=await a.send({command:"getPendingTransactions",payload:{}});u.status==="success"&&u.payload.length>0?(o+=`
🔄 ${u.payload.length} ausstehende Transaktionen gefunden!

`,o+=`Als ${r.role} können Sie diese Transaktionen verwalten:
`,o+=`• Fiskalisieren (abschließen)
`,o+=`• Stornieren (rückgängig machen)
`,o+=`• Verschieben (später bearbeiten)

`,o+="Möchten Sie diese jetzt bearbeiten? Verwenden Sie die entsprechenden Schaltflächen oder fragen Sie mich nach Hilfe."):o+=`
✅ Keine ausstehenden Transaktionen
`}catch{o+=`
⚠️ Konnte ausstehende Transaktionen nicht überprüfen
`}else o+=`
📋 Ihre Rolle: ${r.role}
`,o+=`Sie haben Zugriff auf grundlegende Kassenfunktionen.
`;o+=`
🚀 System ist bereit! Sie können mit der Arbeit beginnen.`,s.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:o})}catch(a){s.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`❌ Systemprüfung fehlgeschlagen: ${a.message}

Sie können trotzdem mit der Arbeit beginnen, aber einige Funktionen sind möglicherweise eingeschränkt.`})}}}}const Je=Xi();function Qi(){const e=parseInt(void 0)||160;return ia({MIN_BUTTON_WIDTH:e})}const la=Qi(),Sr={hasNotification:!1,style:null};function Zi(){const{subscribe:e,set:t,update:n}=mt(Sr);return{subscribe:e,setNotification:r=>{console.log("🟡 [NotificationStore] setNotification called with style:",r),n(s=>{console.log("🟡 [NotificationStore] Previous state:",s);const a={hasNotification:!0,style:r};return console.log("🟡 [NotificationStore] New state:",a),a})},clearNotification:()=>{console.log("🟠 [NotificationStore] clearNotification called"),console.log("🟠 [NotificationStore] Clearing notification, setting to initial state:",Sr),t(Sr)}}}const xn=Zi();function eo(){const{subscribe:e,set:t,update:n}=mt({history:[],messages:[{timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Willkommen bei ecKasse!

Eine Kasse, die hilft – nicht kostet.

👥 Verfügbare Benutzer:
• Admin (Vollzugriff)
• Kassier (Kassenfunktionen)
• Aushilfe (Grundfunktionen)

⏰ Überprüfe Systemzeit und ausstehende Transaktionen...

💡 Geben Sie einfach Ihre 4-6 stellige PIN ein - das System erkennt Sie automatisch. Bei neuer oder Testkasse: Admin-PIN ist 1234`}],draftMessage:null,shouldActivatePinpad:!0});return le.subscribe(r=>{if(r.lastMessage&&r.lastMessage.command==="firstRunAdminCreated"){const s=r.lastMessage.payload;n(a=>({...a,messages:[{timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:s.message||`Willkommen! Admin-Benutzer '${s.username}' wurde erstellt mit PIN: ${s.password}`}]}))}if(r.lastMessage&&r.lastMessage.command==="getEntityJsonResponse"){const s=r.lastMessage.payload;if(s.success&&s.entity){const a=JSON.stringify(s.entity,null,2);n(l=>({...l,messages:[...l.messages,{timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"system",message:`JSON for viewing ${s.entityType} ID ${s.entityId}. For editing, use AI commands like 'update price to 29.99' or 'change name to Super Widget Pro':
\`\`\`json
${a}
\`\`\``}]}))}}}),{subscribe:e,addMessage:r=>{console.log("🔔 [AgentStore] addMessage called:",{timestamp:r.timestamp,type:r.type,message:r.message?.substring(0,100)+(r.message?.length>100?"...":""),style:r.style,hasStyle:!!r.style}),n(s=>({...s,messages:[...s.messages,r]})),r.style?(console.log("🟢 [AgentStore] Message has style, triggering notification:",r.style),xn.setNotification(r.style)):console.log("🔴 [AgentStore] Message has NO style, no notification triggered")},setHistory:r=>{n(s=>({...s,history:r}))},getHistory:()=>{let r;return e(s=>r=s.history)(),r},clearMessages:()=>{n(r=>({...r,messages:[]}))},startDraftMessage:()=>{n(r=>({...r,draftMessage:{id:"draft-"+Date.now(),timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"user",message:"",isDraft:!0}}))},updateDraftMessage:r=>{n(s=>({...s,draftMessage:s.draftMessage?{...s.draftMessage,message:r}:null}))},finalizeDraftMessage:()=>{n(r=>{if(!r.draftMessage)return r;const s={...r.draftMessage,isDraft:!1};return{...r,messages:[...r.messages,s],draftMessage:null}})},cancelDraftMessage:()=>{n(r=>({...r,draftMessage:null}))},sendMessage:async r=>{if(!(!r||!r.trim()))try{const a=Nn(un).sessionId,l={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"user",message:r};let c;e(p=>c=p)(),n(p=>({...p,messages:[...p.messages,l],draftMessage:null}));const o=await fetch("/api/llm/ping-gemini",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:r,history:c.history,sessionId:a})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const u=await o.json(),g={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:u.gemini_response_text};n(p=>({...p,messages:[...p.messages,g],history:u.history}))}catch(s){console.error("Failed to send message to AI:",s);const a={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"Sorry, I encountered an error. Please try again."};n(l=>({...l,messages:[...l.messages,a]}))}},shouldActivatePinpadOnLoad(){let r=!1;return n(s=>(r=s.shouldActivatePinpad,{...s,shouldActivatePinpad:!1})),r}}}const pe=eo(),Ln=Object.freeze(Object.defineProperty({__proto__:null,agentStore:pe},Symbol.toStringTag,{value:"Module"})),to=()=>typeof localStorage<"u"&&localStorage.getItem("app-locale")||"de-DE",Mn=mt(to());Mn.subscribe(e=>{typeof localStorage<"u"&&localStorage.setItem("app-locale",e)});const no=e=>{Mn.set(e)},yt=(e,t="EUR")=>{const n=Nn(Mn);return e==null||isNaN(e)?new Intl.NumberFormat(n,{style:"currency",currency:t}).format(0):new Intl.NumberFormat(n,{style:"currency",currency:t}).format(e)},ro=(e,t={})=>{const n=Nn(Mn);if(!e)return"";const r=typeof e=="string"?new Date(e):e;if(isNaN(r.getTime()))return"";const s={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",...t};return new Intl.DateTimeFormat(n,s).format(r)};var so=F('<div class="loading svelte-1dtcyze">Loading receipts...</div>'),ao=F('<div class="error svelte-1dtcyze"> </div>'),io=F('<div class="empty svelte-1dtcyze">No receipts found.</div>'),oo=F('<span class="receipt-table-large svelte-1dtcyze"> </span>'),lo=F('<div><span class="item-qty svelte-1dtcyze"> </span> <span> </span> <span> </span></div>'),co=F('<div class="receipt-details svelte-1dtcyze"><div class="items-list svelte-1dtcyze"></div> <div class="receipt-totals svelte-1dtcyze"><div class="total-row svelte-1dtcyze"><span>Tax:</span> <span class="price svelte-1dtcyze"> </span></div> <div class="total-row total svelte-1dtcyze"><span>Total:</span> <span class="price svelte-1dtcyze"> </span></div></div> <div class="receipt-actions svelte-1dtcyze"><button class="action-button svelte-1dtcyze">🖨️ Reprint</button></div></div>'),uo=F('<div><button class="receipt-summary svelte-1dtcyze"><div class="receipt-left svelte-1dtcyze"><div class="receipt-main-line svelte-1dtcyze"><span class="receipt-id-large svelte-1dtcyze"> </span> <!></div> <div class="receipt-date svelte-1dtcyze"> </div> <div class="receipt-payment svelte-1dtcyze"> </div></div> <div class="receipt-right svelte-1dtcyze"><div class="receipt-price svelte-1dtcyze"><span class="price svelte-1dtcyze"> </span></div> <div class="receipt-meta svelte-1dtcyze"><div class="receipt-items-count svelte-1dtcyze"> </div></div></div> <div class="expand-icon svelte-1dtcyze"> </div></button> <!></div>'),fo=F('<div class="receipt-list svelte-1dtcyze"></div>'),vo=F('<div class="receipt-feed svelte-1dtcyze"><!></div>');function po(e,t){vt(t,!1);const[n,r]=Hn(),s=()=>et(ir,"$receiptsStore",n);let a=Me(t,"autoExpandLatest",8,!1),l=z(null),c=z(!1),o=z();Wt(()=>{ir.loadReceipts()});function u(v){_(c,!0),_(l,i(l)===v?null:v)}function g(v){return ro(v)}function p(v){return v.notes==="STORNO"&&v.display_names&&v.display_names.menu&&v.display_names.menu.de?`STORNO: ${v.display_names.menu.de}`:v.notes==="DISCOUNT"?"DISCOUNT":v.notes==="SURCHARGE"?"SURCHARGE":v.display_names&&v.display_names.menu&&v.display_names.menu.de?v.display_names.menu.de:"Unnamed Item"}function x(v){return v.notes==="STORNO"||v.notes==="DISCOUNT"||v.notes==="SURCHARGE"}function m(v){if(v.notes==="DISCOUNT"||v.notes==="SURCHARGE")return"";const R=parseFloat(v.quantity);return R===1?"":R+"x"}async function w(v){G("INFO",`Reprint requested for receipt №${v.id}`),pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Reprint initiated for receipt №${v.id}`,style:"info"}),le.send("reprintReceipt",{transactionId:v.id})}Le(()=>ce(a()),()=>{a()&&_(c,!1)}),Le(()=>(ce(a()),i(c),s(),i(l)),()=>{if(a()&&!i(c)&&s().receipts.length>0){const R=s().receipts.sort((S,h)=>new Date(h.fiscal_timestamp||h.updated_at)-new Date(S.fiscal_timestamp||S.updated_at))[0]?.id;R&&i(l)!==R&&_(l,R)}}),nn(),wt();var T=vo(),N=d(T);{var B=v=>{var R=so();C(v,R)},U=v=>{var R=qe(),S=Ce(R);{var h=E=>{var H=ao(),P=d(H);ne(()=>Z(P,`Error: ${s(),D(()=>s().error)??""}`)),C(E,H)},f=E=>{var H=qe(),P=Ce(H);{var J=$=>{var W=io();C($,W)},A=$=>{var W=fo();Mt(W,5,()=>(s(),D(()=>s().receipts.sort((j,L)=>new Date(j.fiscal_timestamp||j.updated_at)-new Date(L.fiscal_timestamp||L.updated_at)))),j=>j.id,(j,L)=>{var be=uo();let Se;var Ne=d(be),ee=d(Ne),I=d(ee),k=d(I),q=d(k),te=y(k,2);{var Y=O=>{var M=oo(),se=d(M);ne(()=>Z(se,`#${i(L),D(()=>i(L).metadata.table)??""}`)),C(O,M)};K(te,O=>{i(L),D(()=>i(L).metadata?.table)&&O(Y)})}var Q=y(I,2),re=d(Q),ie=y(Q,2),oe=d(ie),ue=y(ee,2),ae=d(ue),de=d(ae),ve=d(de),we=y(ae,2),Ie=d(we),Ee=d(Ie),Te=y(ue,2),me=d(Te),he=y(Ne,2);{var _e=O=>{var M=co(),se=d(M);Mt(se,5,()=>(i(L),D(()=>i(L).items)),We=>We.id,(We,Re)=>{var Be=lo();let Ge;var dt=d(Be),ht=d(dt),Ut=y(dt,2);let $e;var He=d(Ut),at=y(Ut,2);let Ke;var Ue=d(at);ne((Ft,At,Kt,Tt,b,V)=>{Ge=Xe(Be,1,"item-row svelte-1dtcyze",null,Ge,Ft),Z(ht,At),$e=Xe(Ut,1,"item-name svelte-1dtcyze",null,$e,Kt),Z(He,Tt),Ke=Xe(at,1,"item-price svelte-1dtcyze",null,Ke,b),Z(Ue,V)},[()=>({"modification-item":x(i(Re))}),()=>(i(Re),D(()=>m(i(Re)))),()=>({"modification-name":x(i(Re))}),()=>(i(Re),D(()=>p(i(Re)))),()=>({"negative-price":parseFloat(i(Re).total_price)<0}),()=>(ce(yt),i(Re),D(()=>yt(i(Re).total_price)))]),C(We,Be)});var ge=y(se,2),ze=d(ge),gt=y(d(ze),2),nt=d(gt),ct=y(ze,2),Ve=y(d(ct),2),rt=d(Ve),st=y(ge,2),ut=d(st);ne((We,Re)=>{Z(nt,We),Z(rt,Re)},[()=>(ce(yt),i(L),D(()=>yt(i(L).tax_amount))),()=>(ce(yt),i(L),D(()=>yt(i(L).total_amount)))]),X("click",ut,()=>w(i(L))),C(O,M)};K(he,O=>{i(l),i(L),D(()=>i(l)===i(L).id)&&O(_e)})}ne((O,M,se)=>{Se=Xe(be,1,"receipt-item svelte-1dtcyze",null,Se,O),Z(q,`№${i(L),D(()=>i(L).id)??""}`),Z(re,M),Z(oe,(i(L),D(()=>i(L).payment_type||"Unknown"))),Z(ve,se),Z(Ee,`${i(L),D(()=>i(L).items?.length||0)??""} items`),Z(me,(i(l),i(L),D(()=>i(l)===i(L).id?"▼":"▶")))},[()=>({expanded:i(l)===i(L).id}),()=>(i(L),D(()=>g(i(L).fiscal_timestamp||i(L).updated_at))),()=>(ce(yt),i(L),D(()=>yt(i(L).total_amount)))]),X("click",Ne,()=>u(i(L).id)),C(j,be)}),en(W,j=>_(o,j),()=>i(o)),C($,W)};K(P,$=>{s(),D(()=>s().receipts.length===0)?$(J):$(A,!1)},!0)}C(E,H)};K(S,E=>{s(),D(()=>s().error)?E(h):E(f,!1)},!0)}C(v,R)};K(N,v=>{s(),D(()=>s().loading)?v(B):v(U,!1)})}C(e,T),pt(),r()}var mo=F('<button class="order-item svelte-1gswy6n"><div class="table-number svelte-1gswy6n"> </div> <div class="order-stats svelte-1gswy6n"><div class="stat-price svelte-1gswy6n"> </div> <div class="stat-open svelte-1gswy6n"> </div> <div class="stat-activity svelte-1gswy6n"> </div></div></button>'),go=F('<div class="parked-orders-container svelte-1gswy6n"><div class="orders-list svelte-1gswy6n"></div></div>');function ho(e,t){vt(t,!1);let n=z([]),r,s,a=!1;Wt(async()=>{r=Pn.subscribe(m=>{_(n,m)}),s=le.subscribe(async m=>{m.connected&&!a&&(a=!0,await Pn.refreshParkedOrders())})}),Qr(()=>{r&&r(),s&&s()});async function l(m){try{let w;if(Ye.subscribe(N=>w=N)(),w.transactionId&&w.status==="active"){const N=w.items&&w.items.length>0,B=w.metadata&&w.metadata.table;if(N&&B)await Ye.parkCurrentOrder(B,1,!1),await Pn.refreshParkedOrders();else if(N&&!B){ft.set("order"),Je.activateTableEntry();return}else Ye.resetOrder()}const T=await Pn.activateOrder(m.id,!1);Ye.loadOrder(T)}catch(w){console.error("Failed to switch to order:",w)}}function c(m){const T=(m.metadata||{}).table||m.id.toString();return T.length>3?`#${T.substring(0,3)}`:`#${T}`}function o(m){return zn.formatTimeElapsed(m)}function u(m){const w=o(m.created_at),T=o(m.updated_at);return{price:yt(m.total_amount),openMinutes:w,activityMinutes:T}}wt();var g=qe(),p=Ce(g);{var x=m=>{var w=go(),T=d(w);Mt(T,5,()=>i(n),N=>N.id,(N,B)=>{var U=mo(),v=d(U),R=d(v),S=y(v,2),h=d(S),f=d(h),E=y(h,2),H=d(E),P=y(E,2),J=d(P);ne((A,$,W,j)=>{Z(R,A),Z(f,$),Z(H,`${W??""}min`),Z(J,`${j??""}min`)},[()=>c(i(B)),()=>u(i(B)).price,()=>u(i(B)).openMinutes,()=>u(i(B)).activityMinutes]),X("click",U,()=>l(i(B))),C(N,U)}),C(m,w)};K(p,m=>{i(n).length>0&&m(x)})}C(e,g),pt()}var _o=Jr(`<svg viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: 100%;"><defs><filter height="150%" id="sh0" width="150%" x="-0.25" y="-0.25"><feConvolveMatrix id="3_|_y" in="SourceAlpha" result="19y" order="1,17" divisor="6632" bias="0" preserveAlpha="false" kernelMatrix=" 10 30 77 169 320 527 752 931 1000 931 752 527 320 169 77 30 10"></feConvolveMatrix><feConvolveMatrix id="3_|_x" result="19x" order="17,1" divisor="6632" bias="0" preserveAlpha="false" kernelMatrix=" 10 30 77 169 320 527 752 931 1000 931 752 527 320 169 77 30 10"></feConvolveMatrix><feConvolveMatrix id="9_|_y" in="SourceAlpha" result="49y" order="1,47" divisor="19856" bias="0" preserveAlpha="false" kernelMatrix=" 15 21 30 42 57 77 101 132 169 212 263 320 384 453 527 603 678 752 820 881 931 968 992 1000 992 968 931 881 820 752 678 603 527 453 384 320 263 212 169 132 101 77 57 42 30 21 15"></feConvolveMatrix><feConvolveMatrix id="9_|_x" result="49x" order="47,1" divisor="19856" bias="0" preserveAlpha="false" kernelMatrix=" 15 21 30 42 57 77 101 132 169 212 263 320 384 453 527 603 678 752 820 881 931 968 992 1000 992 968 931 881 820 752 678 603 527 453 384 320 263 212 169 132 101 77 57 42 30 21 15"></feConvolveMatrix><feTurbulence class="seed" result="noise" type="fractalNoise" stitchTiles="stitch" seed="43" baseFrequency="0.06 0.08 " numOctaves="3"></feTurbulence><feMorphology operator="erode" radius="1.2"></feMorphology><feComposite in="noise" operator="arithmetic" k1="0" k2="8" k3="0" k4="-3"></feComposite><feComposite in="49x" result="49noise" operator="arithmetic" k1="0" k2="2" k3="-0.2" k4="-1"></feComposite><feComposite in="49noise" in2="19x" operator="arithmetic" k1="0" k2="0.5" k3="1.5" k4="-1"></feComposite><feDiffuseLighting surfaceScale="2" lighting-color="#fff"><feDistantLight azimuth="240" elevation="20"></feDistantLight></feDiffuseLighting><feComposite in2="SourceGraphic" operator="arithmetic" k1="1" k2="0" k3="0" k4="0"></feComposite></filter><filter height="170%" id="sh2" width="170%" x="-0.2" y="-0.2"><feOffset dx="0" dy="0" in="SourceAlpha"></feOffset><feGaussianBlur stdDeviation="1.2"></feGaussianBlur><feColorMatrix result="out" type="matrix" values=" 
               0 0 0 0 0.4         
               0 0 0 0 0.4                    
               0 0 0 0 0.4                
               0 0 0 10 0 "></feColorMatrix><feMerge><feMergeNode in="out"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter><filter height="130%" id="sh1" width="130%" x="-0.2" y="-0.2"><feOffset dx="3" dy="4" in="SourceAlpha"></feOffset><feGaussianBlur stdDeviation="3"></feGaussianBlur><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.8 0"></feColorMatrix><feBlend in="SourceGraphic"></feBlend></filter><linearGradient id="svg_66" x1="0" x2="1" y1="0" y2="0"><stop offset="0" stop-color="hsl(40, 23%, 35%)"></stop><stop offset="0.4" stop-color="hsl(40, 23%, 60%)"></stop><stop offset="0.65" stop-color="hsl(40, 23%, 70%)"></stop><stop offset="0.75" stop-color="hsl(40, 23%, 60%)"></stop><stop offset="1" stop-color="hsl(40, 23%, 35%)"></stop></linearGradient><circle id="bell" fill="#070" stroke="#030" r="5.5" filter="url(#sh0)"></circle><g id="cap" filter="url(#sh2)"><path id="capPath" fill="#070" filter="url(#sh0)" stroke="#030" d="M72,89 C78.6,68 67.2,30.7 89,68 C86.9,37.6 66.91,32 62,61 C58,44.1 67.5,38.8 52,10 C53.6,47 46.91,36.2 45,61 C39.3,43.4 22,46.6 13,43 C32.9,55.8 35.7,66.62 32,89 C35,97.9 68.6,99 72,89 Z"></path><use id="bell1" x="13" y="43" href="#bell"></use><use id="bell2" x="52" y="10" href="#bell"></use><use id="bell3" x="89" y="68" href="#bell"></use><ellipse cx="52.19" cy="90.01" fill="url(#svg_66)" rx="14.76" ry="3.56"></ellipse><path d="M34,86.5C36,82,53.5,81,60,83C54,81,34,81.5,34,86.5Z" fill="none" stroke="hsl(40, 23%, 60%)"></path></g></defs><use href="#cap"></use></svg>`);function yo(e){var t=_o();C(e,t)}var bo=F('<div class="slot-container svelte-12whdgj"><!></div>'),wo=F('<div class="button-icon-wrapper svelte-12whdgj"><div class="button-icon svelte-12whdgj"><!></div></div>'),So=F('<div class="button-icon-wrapper svelte-12whdgj"><span class="button-icon svelte-12whdgj"><!></span></div>'),xo=F("<div></div>"),ko=F("<!> <!>",1),To=F('<span class="button-text svelte-12whdgj"><!></span>'),Co=F('<button><div class="button-shape svelte-12whdgj"><!></div></button>');function ca(e,t){const n=bi(t);vt(t,!1);const r=z(),s=z(),a=z();let l=Me(t,"label",8,""),c=Me(t,"icon",8,""),o=Me(t,"component",8,null),u=Me(t,"color",8,"#666666"),g=Me(t,"textColor",8,""),p=Me(t,"backgroundStyle",8,""),x=Me(t,"customStyle",8,""),m=Me(t,"disabled",8,!1),w=Me(t,"data",8,null),T=Me(t,"width",8,120),N=Me(t,"height",8,80),B=Me(t,"shape",8,"rect"),U=Me(t,"side",8,""),v=Me(t,"active",8,!1),R=Me(t,"showShape",8,""),S=Me(t,"notificationStyle",8,null);const h=mn();let f,E=!1;function H(){!m()&&!E&&h("click",{data:w(),label:l()})}function P(ee){m()||(ee.preventDefault(),h("secondaryaction",{data:w(),label:l(),mouseX:ee.clientX,mouseY:ee.clientY,originalEvent:ee}))}function J(ee){!m()&&ee.button===0&&(E=!1,f=setTimeout(()=>{E=!0,h("secondaryaction",{data:w(),label:l(),mouseX:ee.clientX,mouseY:ee.clientY,originalEvent:ee})},500))}function A(){clearTimeout(f),setTimeout(()=>{E=!1},10)}function $(){clearTimeout(f),E=!1}Le(()=>ce(U()),()=>{_(r,U()==="left"||U()==="right")}),Le(()=>ce(l()),()=>{_(s,l())}),Le(()=>(ce(B()),i(r),ce(U())),()=>{_(a,B()==="hex"&&i(r)?U()==="left"?"polygon(0% 0%, 100% 25%, 100% 75%, 0% 100%)":"polygon(0% 25%, 100% 0%, 100% 100%, 0% 75%)":B()==="hex"?"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)":"none")}),nn(),wt();var W=Co();let j;var L=d(W),be=d(L);{var Se=ee=>{var I=bo(),k=d(I);yi(k,t,"default",{}),C(ee,I)},Ne=ee=>{var I=qe(),k=Ce(I);{var q=Y=>{var Q=ko(),re=Ce(Q);{var ie=de=>{var ve=wo(),we=d(ve),Ie=d(we);wi(Ie,o,(Ee,Te)=>{Te(Ee,{})}),C(de,ve)},oe=de=>{var ve=qe(),we=Ce(ve);{var Ie=Ee=>{var Te=So(),me=d(Te),he=d(me);ds(he,c),C(Ee,Te)};K(we,Ee=>{c()&&Ee(Ie)},!0)}C(de,ve)};K(re,de=>{o()?de(ie):de(oe,!1)})}var ue=y(re,2);{var ae=de=>{var ve=xo();ne(()=>Xe(ve,1,`shape-overlay ${R()??""}`,"svelte-12whdgj")),C(de,ve)};K(ue,de=>{R()&&de(ae)})}C(Y,Q)},te=Y=>{var Q=qe(),re=Ce(Q);{var ie=oe=>{var ue=To(),ae=d(ue);ds(ae,()=>i(s)),ne(()=>cn(ue,x())),C(oe,ue)};K(re,oe=>{l()&&oe(ie)},!0)}C(Y,Q)};K(k,Y=>{o()||c()||R()?Y(q):Y(te,!1)},!0)}C(ee,I)};K(be,ee=>{D(()=>n.default)?ee(Se):ee(Ne,!1)})}ne(ee=>{j=Xe(W,1,`universal-button ${B()??""}`,"svelte-12whdgj",j,ee),cn(W,`
    --button-width: ${T()??""}px; 
    --button-height: ${N()??""}px; 
    --button-color: ${u()??""};
    ${g()?`--button-text-color: ${g()};`:""}
    ${p()?`--button-background-style: ${p()};`:""}
    --clip-path: ${i(a)??""};
  `)},[()=>({disabled:m(),half:i(r),left:U()==="left",right:U()==="right",active:v(),notification:!!S(),error:S()==="error",warning:S()==="warning",success:S()==="success",print:S()?.startsWith("print")})]),X("click",W,H),X("contextmenu",W,P),X("mousedown",W,J),X("mouseup",W,A),X("mouseleave",W,$),C(e,W),pt()}var Eo=F('<span class="table-number svelte-x88uh0"> </span>'),Io=F('<div class="pinpad-error-message svelte-x88uh0"> </div>'),Mo=F('<span class="qty svelte-x88uh0"> </span>'),Ao=F('<span class="input-overlay svelte-x88uh0"> </span>'),Oo=F('<li><!> <div class="name-container svelte-x88uh0"><span> </span> <!></div> <span class="price svelte-x88uh0"> </span></li>'),No=F('<div class="view-content order-view svelte-x88uh0"><div class="orders-stack svelte-x88uh0"><div class="parked-orders-section svelte-x88uh0"><!></div> <div class="active-order-section svelte-x88uh0"><div class="order-content svelte-x88uh0"><h2 class="svelte-x88uh0"><span class="order-number svelte-x88uh0"> </span><!></h2> <!> <div class="scrollable-items-content svelte-x88uh0"><ul class="item-list svelte-x88uh0"></ul></div> <div class="spacer svelte-x88uh0"></div> <div class="total svelte-x88uh0"><span class="svelte-x88uh0">Total:</span> <span class="price svelte-x88uh0"> </span></div></div></div></div></div>'),Ro=F('<div class="view-content receipts-view svelte-x88uh0"><div class="receipts-stack svelte-x88uh0"><!></div></div>'),$o=F('<div class="agent-header-icon svelte-x88uh0"><!></div>'),Do=F('<div class="message-actions svelte-x88uh0"></div>'),Po=F('<div><div class="message-header svelte-x88uh0"><span class="message-timestamp svelte-x88uh0"> </span> <span class="message-type svelte-x88uh0"> </span></div> <div class="message-content svelte-x88uh0"> </div> <!></div>'),Lo=F(' <span class="cursor svelte-x88uh0">|</span>',1),Bo=F(' <span class="cursor svelte-x88uh0">|</span>',1),Uo=F('<span class="cursor svelte-x88uh0">|</span>'),Fo=F('<div class="agent-message user draft svelte-x88uh0"><div class="message-header svelte-x88uh0"><span class="message-timestamp svelte-x88uh0"> </span> <span class="message-type svelte-x88uh0">User</span></div> <div class="message-content svelte-x88uh0"><!></div></div>'),jo=F('<div class="view-content agent-view svelte-x88uh0"><!> <div class="scroll-content svelte-x88uh0"><div class="agent-messages svelte-x88uh0"><!> <!></div></div></div>'),qo=F('<div class="console-view svelte-x88uh0"><div class="content-area svelte-x88uh0"><!></div></div>');function zo(e,t){vt(t,!1);const[n,r]=Hn(),s=()=>et(Ye,"$orderStore",n),a=()=>et(ft,"$currentView",n),l=()=>et(ir,"$receiptsStore",n),c=()=>et(pe,"$agentStore",n),o=()=>et(Je,"$pinpadStore",n),u=()=>et(la,"$uiConstantsStore",n),g=mn();let p=z(),x=z(),m=z(),w=!1,T=z(!1),N=!1,B=z(!1),U=z("order"),v=z(!1),R=z(s().status),S=z(s().items.length),h=z(s().transactionId),f=z(s().metadata?.table),E=z(a());Wt(()=>{setTimeout(()=>{if(N||($(),A(),N=!0),a()==="agent"&&pe.shouldActivatePinpadOnLoad()&&Je.activate("agent",()=>{},()=>{},"numeric"),i(p)){const k=new ResizeObserver(()=>{i(p)&&_(B,i(p).scrollHeight>i(p).clientHeight)});return k.observe(i(p)),_(B,i(p).scrollHeight>i(p).clientHeight),()=>{k.disconnect()}}},200)}),Pi(()=>{if(!i(T)){let k=null;a()==="order"?k=i(x):a()==="agent"?k=i(p):a()==="receipts"&&(k=i(m)),k&&setTimeout(()=>{if(k&&!i(T)){if(A(),a()==="agent"&&i(p)){const q=i(p).scrollHeight>i(p).clientHeight;q!==i(B)&&_(B,q)}w||(_(T,!0),k.scrollTop=k.scrollHeight,setTimeout(()=>{_(T,!1),A()},100))}},50)}});function H(k){if(typeof k=="object"&&k!==null)return k;if(typeof k=="string")try{return JSON.parse(k)}catch{return k}return k}function P(){const q={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"Select language / Sprache auswählen / Выберите язык:",actions:[{id:"lang-de",label:"DE",action:"selectLanguage",param:"DE"},{id:"lang-en",label:"EN",action:"selectLanguage",param:"EN"},{id:"lang-ru",label:"RU",action:"selectLanguage",param:"RU"}]};pe.addMessage(q),setTimeout(()=>{i(p)&&(je(p,i(p).scrollTop=i(p).scrollHeight),A())},100)}function J(k,q){if(k==="selectLanguage"){Je.switchLanguage(q);const te=c().messages.filter(re=>!re.actions);pe.clearMessages(),te.forEach(re=>pe.addMessage(re));const Q={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Language changed to ${q}`};pe.addMessage(Q),setTimeout(()=>{i(p)&&(je(p,i(p).scrollTop=i(p).scrollHeight),A())},100)}}function A(){if(!i(T)){let k=null;if(a()==="order"?k=i(x):a()==="agent"?k=i(p):a()==="receipts"&&(k=i(m)),k){const te=k.scrollTop,Y=k.clientHeight,Q=k.scrollHeight;w=te+Y>=Q-1}else w=!0;g("scrollstate",w)}}function $(){let k=null;a()==="order"?k=i(x):a()==="agent"?k=i(p):a()==="receipts"&&(k=i(m)),k&&(k.scrollTop=k.scrollHeight,w=!0)}function W(){if(Nn(xn).hasNotification){ft.set("agent");return}let q;switch(i(U)){case"order":q=["order","receipts","agent"];break;case"receipts":q=["receipts","order","agent"];break;case"agent":q=["agent","order","receipts"];break;default:q=["order","receipts","agent"]}const Y=(q.indexOf(a())+1)%q.length,Q=q[Y];a()==="receipts"&&Q!=="receipts"&&_(v,!1),ft.set(Q)}function j(){return w}Wt(()=>{const k=le.subscribe(q=>{if(q.lastMessage?.command==="menu-import-progress"){const te=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});pe.addMessage({timestamp:te,type:"agent",message:q.lastMessage.payload.message}),setTimeout(()=>{i(p)&&a()==="agent"&&(je(p,i(p).scrollTop=i(p).scrollHeight),A())},100)}});return()=>{k()}}),typeof window<"u"&&window.electronAPI&&window.electronAPI.onImportComplete&&window.electronAPI.onImportComplete((k,q)=>{const te=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});pe.addMessage({timestamp:te,type:"agent",message:q}),k&&(G("INFO","Refreshing categories after successful menu import"),le.send({command:"getCategories"}),setTimeout(()=>{const Y=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});pe.addMessage({timestamp:Y,type:"agent",message:"Menu import completed successfully! Your new menu structure is now ready for use. You can navigate back to the selection area to explore the imported categories and products."}),setTimeout(()=>{i(p)&&a()==="agent"&&(je(p,i(p).scrollTop=i(p).scrollHeight),A())},100)},1e3)),setTimeout(()=>{i(p)&&a()==="agent"&&(je(p,i(p).scrollTop=i(p).scrollHeight),A())},100)}),Le(()=>(a(),i(E),xn),()=>{a()==="agent"&&i(E)!=="agent"?(console.log("🔵 [ConsoleView] User switched TO agent view, will clear notification in 100ms"),console.log("🔵 [ConsoleView] Previous view:",i(E),"Current view:",a()),setTimeout(()=>{console.log("🔵 [ConsoleView] Clearing notification now"),xn.clearNotification()},100)):a()==="agent"&&i(E)==="agent"?console.log("🔵 [ConsoleView] Already in agent view, NOT clearing notification"):a()!=="agent"&&console.log("🔵 [ConsoleView] Not in agent view, NOT clearing notification. Current view:",a()),_(E,a())}),Le(()=>(i(R),s(),i(m)),()=>{i(R)==="finished"&&s().status==="idle"&&(_(U,"receipts"),_(v,!0),ft.set("receipts"),ir.refresh(),setTimeout(()=>{i(m)&&(je(m,i(m).scrollTop=i(m).scrollHeight),A())},300)),_(R,s().status)}),Le(()=>(l(),i(m),a()),()=>{l().receipts&&i(m)&&a()==="receipts"&&setTimeout(()=>{A()},100)}),Le(()=>(c(),i(p),a(),i(B)),()=>{c().messages&&i(p)&&a()==="agent"&&setTimeout(()=>{if(i(p)){const k=i(p).scrollHeight>i(p).clientHeight;k!==i(B)&&_(B,k)}},100)}),Le(()=>(a(),i(x),s(),i(S),i(h),i(f)),()=>{if(a()==="order"&&i(x)){const k=s().items.length,q=s().transactionId,te=s().metadata?.table;(k!==i(S)||q!==i(h)||te!==i(f))&&setTimeout(()=>{i(x)&&je(x,i(x).scrollTop=i(x).scrollHeight)},100),_(S,k),_(h,q),_(f,te)}}),nn(),wt();var L=qo(),be=d(L),Se=d(be);{var Ne=k=>{var q=No(),te=d(q),Y=d(te),Q=d(Y);ho(Q,{});var re=y(Y,2),ie=d(re),oe=d(ie),ue=d(oe),ae=d(ue),de=y(ue);{var ve=O=>{var M=Eo(),se=d(M);ne(()=>Z(se,`#${o(),s(),D(()=>o().isActive&&o().mode==="table"?o().liveValue:s().metadata?.table)??""}`)),C(O,M)};K(de,O=>{s(),o(),D(()=>s().metadata?.table||o().isActive&&o().mode==="table")&&O(ve)})}var we=y(oe,2);{var Ie=O=>{var M=Io(),se=d(M);ne(()=>Z(se,(o(),D(()=>o().errorMessage)))),C(O,M)};K(we,O=>{o(),D(()=>o().errorMessage)&&O(Ie)})}var Ee=y(we,2),Te=d(Ee);Mt(Te,5,()=>(s(),D(()=>s().items)),O=>O.id,(O,M)=>{var se=Oo();let ge;var ze=d(se);{var gt=Be=>{var Ge=Mo(),dt=d(Ge);ne(ht=>Z(dt,`${ht??""}x`),[()=>(i(M),D(()=>parseFloat(i(M).quantity)))]),C(Be,Ge)};K(ze,Be=>{i(M),D(()=>parseFloat(i(M).quantity)>1)&&Be(gt)})}var nt=y(ze,2),ct=d(nt);let Ve;var rt=d(ct),st=y(ct,2);{var ut=Be=>{var Ge=Ao(),dt=d(Ge);ne(()=>Z(dt,(o(),D(()=>o().liveValue)))),C(Be,Ge)};K(st,Be=>{s(),i(M),o(),D(()=>s().activeTransactionItemId===i(M).id&&o().isActive&&o().mode!=="agent"&&o().liveValue)&&Be(ut)})}var We=y(nt,2),Re=d(We);ne((Be,Ge,dt,ht)=>{ge=Xe(se,1,"svelte-x88uh0",null,ge,Be),Ve=Xe(ct,1,"name svelte-x88uh0",null,Ve,Ge),Z(rt,dt),Z(Re,ht)},[()=>({active:s().activeTransactionItemId===i(M).id}),()=>({"input-mode":s().activeTransactionItemId===i(M).id&&o().isActive&&o().mode!=="agent"&&o().liveValue}),()=>(i(M),D(()=>i(M).display_names?H(i(M).display_names).menu.de||"N/A":"Loading...")),()=>(ce(yt),i(M),D(()=>yt(parseFloat(i(M).total_price))))]),C(O,se)});var me=y(Ee,4),he=y(d(me),2),_e=d(he);en(te,O=>_(x,O),()=>i(x)),ne(O=>{Z(ae,`Order №${s(),D(()=>s().transactionId||"...")??""}`),Z(_e,O)},[()=>(ce(yt),s(),D(()=>yt(s().total)))]),X("scroll",te,()=>!i(T)&&A()),C(k,q)},ee=k=>{var q=qe(),te=Ce(q);{var Y=re=>{var ie=Ro(),oe=d(ie),ue=d(oe);po(ue,{get autoExpandLatest(){return i(v)}}),en(oe,ae=>_(m,ae),()=>i(m)),X("scroll",oe,()=>!i(T)&&A()),C(re,ie)},Q=re=>{var ie=qe(),oe=Ce(ie);{var ue=ae=>{var de=jo(),ve=d(de);{var we=_e=>{var O=$o(),M=d(O);yo(M),C(_e,O)};K(ve,_e=>{i(B)||_e(we)})}var Ie=y(ve,2),Ee=d(Ie),Te=d(Ee);Mt(Te,1,()=>(c(),D(()=>c().messages)),ar,(_e,O)=>{var M=Po();let se;var ge=d(M),ze=d(ge),gt=d(ze),nt=y(ze,2),ct=d(nt),Ve=y(ge,2),rt=d(Ve),st=y(Ve,2);{var ut=We=>{var Re=Do();Mt(Re,5,()=>(i(O),D(()=>i(O).actions)),ar,(Be,Ge)=>{{let dt=Nt(()=>(i(Ge),D(()=>({display:i(Ge).label,action:()=>J(i(Ge).action,i(Ge).param)})))),ht=Nt(()=>(u(),D(()=>({width:u().MIN_BUTTON_WIDTH,height:Math.round(u().MIN_BUTTON_WIDTH*.4)}))));ca(Be,{get content(){return i(dt)},get size(){return i(ht)},style:"rectangular"})}}),C(We,Re)};K(st,We=>{i(O),D(()=>i(O).actions)&&We(ut)})}ne(We=>{se=Xe(M,1,"agent-message svelte-x88uh0",null,se,We),Z(gt,(i(O),D(()=>i(O).timestamp))),Z(ct,(i(O),D(()=>i(O).type==="user"?"User":"Agent"))),Z(rt,(i(O),D(()=>i(O).message)))},[()=>({user:i(O).type==="user",agent:i(O).type==="agent",error:i(O).style==="error",success:i(O).style==="success",warning:i(O).style==="warning",print:i(O).style?.startsWith("print")})]),C(_e,M)});var me=y(Te,2);{var he=_e=>{var O=Fo(),M=d(O),se=d(M),ge=d(se),ze=y(M,2),gt=d(ze);{var nt=Ve=>{var rt=Lo(),st=Ce(rt);ne(ut=>Z(st,ut),[()=>(o(),D(()=>"*".repeat(o().liveValue.length)))]),C(Ve,rt)},ct=Ve=>{var rt=qe(),st=Ce(rt);{var ut=Re=>{var Be=Bo(),Ge=Ce(Be);ne(()=>Z(Ge,(c(),D(()=>c().draftMessage.message)))),C(Re,Be)},We=Re=>{var Be=Uo();C(Re,Be)};K(st,Re=>{o(),c(),D(()=>o().layout==="alpha"&&c().draftMessage)?Re(ut):Re(We,!1)},!0)}C(Ve,rt)};K(gt,Ve=>{o(),D(()=>o().layout==="numeric")?Ve(nt):Ve(ct,!1)})}ne(Ve=>Z(ge,Ve),[()=>D(()=>new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}))]),C(_e,O)};K(me,_e=>{o(),D(()=>o().isActive&&o().mode==="agent")&&_e(he)})}en(Ie,_e=>_(p,_e),()=>i(p)),X("scroll",Ie,()=>!i(T)&&A()),C(ae,de)};K(oe,ae=>{a()==="agent"&&ae(ue)},!0)}C(re,ie)};K(te,re=>{a()==="receipts"?re(Y):re(Q,!1)},!0)}C(k,q)};K(Se,k=>{a()==="order"?k(Ne):k(ee,!1)})}C(e,L),Jn(t,"scrollToBottom",$),Jn(t,"cycleViews",W),Jn(t,"getIsAtBottom",j),Jn(t,"displayLanguageSelector",P);var I=pt({scrollToBottom:$,cycleViews:W,getIsAtBottom:j,displayLanguageSelector:P});return r(),I}const Zr=mt(!1);function Vo(){Zr.update(e=>!e)}function Go(){Zr.set(!1)}var Wo=F('<div class="pinpad-grid numeric svelte-l3qs12"><button class="numpad-key svelte-l3qs12">1</button> <button class="numpad-key svelte-l3qs12">2</button> <button class="numpad-key svelte-l3qs12">3</button> <button class="function-key key-cancel svelte-l3qs12" aria-label="Cancel">X</button> <button class="numpad-key svelte-l3qs12">4</button> <button class="numpad-key svelte-l3qs12">5</button> <button class="numpad-key svelte-l3qs12">6</button> <button class="function-key key-correct svelte-l3qs12" aria-label="Correct">←</button> <button class="numpad-key svelte-l3qs12">7</button> <button class="numpad-key svelte-l3qs12">8</button> <button class="numpad-key svelte-l3qs12">9</button> <button class="function-key key-enter svelte-l3qs12" aria-label="Enter">↵</button> <button class="numpad-key function-key key-plus svelte-l3qs12">.99</button> <button class="numpad-key svelte-l3qs12">0</button> <button class="numpad-key function-key key-minus svelte-l3qs12">.</button></div>'),Ho=F('<button class="alpha-key letter-key svelte-l3qs12"> </button>'),Jo=F('<div class="alpha-row svelte-l3qs12"></div>'),Ko=F('<div class="pinpad-grid alpha svelte-l3qs12"><!> <div class="alpha-bottom-row svelte-l3qs12"><button class="alpha-key space-key svelte-l3qs12" aria-label="Space">space</button> <button class="function-key cursor-key svelte-l3qs12" aria-label="Move cursor left">←</button> <button class="function-key cursor-key svelte-l3qs12" aria-label="Move cursor right">→</button> <button class="function-key language-key svelte-l3qs12" aria-label="Switch language"> </button> <button class="function-key key-cancel svelte-l3qs12" aria-label="Cancel">X</button> <button class="function-key key-correct svelte-l3qs12" aria-label="Backspace">⌫</button> <button class="function-key key-enter key-enter-large svelte-l3qs12" aria-label="Enter">↵</button></div></div>'),Yo=F('<div class="pinpad-wrapper svelte-l3qs12"><!></div>');function Xo(e,t){vt(t,!1);const[n,r]=Hn(),s=()=>et(Je,"$pinpadStore",n);let a=Me(t,"onClose",8,()=>{}),l=Me(t,"minButtonSize",8,160),c=z(0),o=z(0),u=z(80),g=z(107),p=z(50),x=z(50),m=null,w=null;const T=6;let N=z(0),B=z(null),U=z(null),v=z(null),R=z(null);function S(ee){Je.append(ee,pe)}function h(){Je.backspace(pe)}function f(){Je.confirm()}function E(){Je.cancel(pe)}function H(){a()()}function P(ee){w=ee,m=setTimeout(()=>{w===ee&&(Je.append(ee.toUpperCase(),pe),w=null)},500)}function J(){m&&(clearTimeout(m),m=null),w&&(Je.append(w.toLowerCase(),pe),w=null)}function A(){m&&(clearTimeout(m),m=null),w=null}function $(){Je.moveCursorLeft()}function W(){Je.moveCursorRight()}function j(){Je.switchLanguage()}Le(()=>(i(o),i(N),i(B)),()=>{i(o)>0&&Math.abs(i(o)-i(N))>5&&(i(B)&&clearTimeout(i(B)),_(B,setTimeout(()=>{_(N,i(o))},50)))}),Le(()=>(s(),i(N),i(U),i(v),i(R),ce(l()),i(p),i(g)),()=>{const ee=s().layout,I=s().currentLanguage;if(i(N)>0&&(i(U)!==ee||i(v)!==I||i(R)!==l()||i(U)===null&&i(v)===null)){if(ee==="alpha"&&s().layouts&&I){const k=s().layouts[I],q=Math.max(...k.map(re=>re.length)),te=i(N)-T*(q-1);let Y=Math.floor(te/q);const Q=l();Y>Q&&(Y=Q),_(p,Y),_(x,Math.floor(i(p)*(3/4)))}else if(ee==="numeric"){const q=i(N)-T*3;let te=Math.floor(q/4);const Y=l();te>Y&&(te=Y),_(g,te),_(u,Math.floor(i(g)*(3/4)))}_(U,ee),_(v,I),_(R,l())}}),nn(),wt();var L=Yo(),be=d(L);{var Se=ee=>{var I=Wo(),k=d(I),q=y(k,2),te=y(q,2),Y=y(te,2),Q=y(Y,2),re=y(Q,2),ie=y(re,2),oe=y(ie,2),ue=y(oe,2),ae=y(ue,2),de=y(ae,2),ve=y(de,2),we=y(ve,2),Ie=y(we,2),Ee=y(Ie,2);ne(()=>cn(I,`--button-height: ${i(u)??""}px; --button-width: ${i(g)??""}px;`)),X("click",k,()=>S("1")),X("click",q,()=>S("2")),X("click",te,()=>S("3")),X("click",Y,E),X("dblclick",Y,H),X("click",Q,()=>S("4")),X("click",re,()=>S("5")),X("click",ie,()=>S("6")),X("click",oe,h),X("click",ue,()=>S("7")),X("click",ae,()=>S("8")),X("click",de,()=>S("9")),X("click",ve,f),X("click",we,()=>S(".99")),X("click",Ie,()=>S("0")),X("click",Ee,()=>S(".")),C(ee,I)},Ne=ee=>{var I=qe(),k=Ce(I);{var q=te=>{var Y=Ko(),Q=d(Y);Mt(Q,1,()=>(s(),D(()=>s().layouts[s().currentLanguage])),ar,(Ee,Te)=>{var me=Jo();Mt(me,5,()=>i(Te),ar,(he,_e)=>{var O=Ho(),M=d(O);ne(()=>{Ei(O,"aria-label",`Letter ${i(_e)??""}`),Z(M,i(_e))}),X("mousedown",O,()=>P(i(_e))),X("mouseup",O,J),X("mouseleave",O,A),C(he,O)}),C(Ee,me)});var re=y(Q,2),ie=d(re),oe=y(ie,2),ue=y(oe,2),ae=y(ue,2),de=d(ae),ve=y(ae,2),we=y(ve,2),Ie=y(we,2);ne(()=>{cn(Y,`--alpha-button-width: ${i(p)??""}px; --alpha-button-height: ${i(x)??""}px;`),Z(de,(s(),D(()=>s().currentLanguage)))}),X("click",ie,()=>S(" ")),X("click",oe,$),X("click",ue,W),X("click",ae,j),X("click",ve,E),X("dblclick",ve,H),X("click",we,h),X("click",Ie,f),C(te,Y)};K(k,te=>{s(),D(()=>s().layout==="alpha")&&te(q)},!0)}C(ee,I)};K(be,ee=>{s(),D(()=>s().layout==="numeric")?ee(Se):ee(Ne,!1)})}ms(L,"clientHeight",ee=>_(c,ee)),ms(L,"clientWidth",ee=>_(o,ee)),C(e,L),pt(),r()}var Qo=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Description:</span> <span class="value svelte-yjty9j"> </span></div>'),Zo=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Allergens:</span> <span class="value svelte-yjty9j"> </span></div>'),el=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Dietary:</span> <span class="value svelte-yjty9j"> </span></div>'),tl=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Category:</span> <span class="value svelte-yjty9j"> </span></div>'),nl=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Status:</span> <span class="value svelte-yjty9j"> </span></div>'),rl=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Last Modified:</span> <span class="value svelte-yjty9j"> </span></div>'),sl=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Product ID:</span> <span class="value svelte-yjty9j"> </span></div>'),al=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Price:</span> <span class="value svelte-yjty9j"> </span></div> <!> <!> <!> <!> <!> <!> <!>',1),il=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Type:</span> <span class="value svelte-yjty9j"> </span></div>'),ol=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Category ID:</span> <span class="value svelte-yjty9j"> </span></div>'),ll=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Parent Category:</span> <span class="value svelte-yjty9j"> </span></div>'),cl=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Main Group:</span> <span class="value svelte-yjty9j"> </span></div>'),ul=F('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Source ID:</span> <span class="value svelte-yjty9j"> </span></div>'),dl=F("<!> <!> <!> <!> <!>",1),fl=F('<div class="context-menu svelte-yjty9j"><div class="menu-header svelte-yjty9j"><h3 class="svelte-yjty9j"><!></h3></div> <div class="menu-content svelte-yjty9j"><!></div> <div class="menu-footer svelte-yjty9j"><button class="edit-button svelte-yjty9j">Edit</button> <button class="advanced-edit-button svelte-yjty9j">View</button> <button class="close-button svelte-yjty9j">Close</button></div></div>');function vl(e,t){vt(t,!1);const n=z(),r=z(),s=z();let a=Me(t,"item",8,null),l=Me(t,"x",8,0),c=Me(t,"y",8,0),o=Me(t,"visible",8,!1);const u=mn();let g=z(),p=z(0),x=z(0);Wt(()=>{function f(H){i(g)&&!i(g).contains(H.target)&&u("close")}function E(H){H.key==="Escape"&&u("close")}return o()&&(document.addEventListener("click",f),document.addEventListener("keydown",E)),()=>{document.removeEventListener("click",f),document.removeEventListener("keydown",E)}});function m(f){return typeof f=="number"?`€${f.toFixed(2)}`:a()&&a().item_price_value&&typeof a().item_price_value=="number"?`€${a().item_price_value.toFixed(2)}`:f||"N/A"}function w(f){try{const E=JSON.parse(f);return E.menu?.de||E.button?.de||E.de||"Unnamed"}catch{return f||"Unnamed"}}function T(f){try{return JSON.parse(f).de||"Unnamed Category"}catch{return f||"Unnamed Category"}}function N(f){try{return JSON.parse(f)}catch{return{}}}function B(){if(!i(g))return;const f=i(g).getBoundingClientRect(),E=window.innerWidth,H=window.innerHeight;if(f.width===0||f.height===0){setTimeout(()=>B(),10);return}const P=10,J=10,A=f.width>E-P*2,$=f.height>H-P*2;let W,j;A&&$?(W=P,j=P):A?(W=P,j=c()+J,j+f.height>H-P&&(j=c()-f.height-J),j<P&&(j=P)):$?(j=P,W=l()+J,W+f.width>E-P&&(W=l()-f.width-J),W<P&&(W=P)):(W=l()+J,j=c()+J,W+f.width>E-P&&(W=l()-f.width-J),j+f.height>H-P&&(j=c()-f.height-J),W<P&&(W=P),j<P&&(j=P)),_(p,W),_(x,j)}function U(){u("edit",{item:a()}),u("close")}function v(){u("advanced-edit",{item:a()}),u("close")}Le(()=>ce(a()),()=>{_(n,a()&&a().category_names)}),Le(()=>ce(a()),()=>{_(r,a()&&a().display_names)}),Le(()=>(i(r),ce(a())),()=>{_(s,i(r)&&a().additional_item_attributes?N(a().additional_item_attributes):{})}),Le(()=>(ce(o()),i(g)),()=>{o()&&i(g)&&requestAnimationFrame(()=>B())}),nn(),wt();var R=qe(),S=Ce(R);{var h=f=>{var E=fl(),H=d(E),P=d(H),J=d(P);{var A=k=>{var q=Pt();ne(te=>Z(q,te),[()=>(ce(a()),D(()=>T(a().category_names)))]),C(k,q)},$=k=>{var q=qe(),te=Ce(q);{var Y=re=>{var ie=Pt();ne(oe=>Z(ie,oe),[()=>(ce(a()),D(()=>w(a().display_names)))]),C(re,ie)},Q=re=>{var ie=Pt("Item Details");C(re,ie)};K(te,re=>{i(r)?re(Y):re(Q,!1)},!0)}C(k,q)};K(J,k=>{i(n)?k(A):k($,!1)})}var W=y(H,2),j=d(W);{var L=k=>{var q=al(),te=Ce(q),Y=y(d(te),2),Q=d(Y),re=y(te,2);{var ie=O=>{var M=Qo(),se=y(d(M),2),ge=d(se);ne(()=>Z(ge,(i(s),D(()=>i(s).description)))),C(O,M)};K(re,O=>{i(s),D(()=>i(s).description)&&O(ie)})}var oe=y(re,2);{var ue=O=>{var M=Zo(),se=y(d(M),2),ge=d(se);ne(ze=>Z(ge,ze),[()=>(i(s),D(()=>i(s).allergens.join(", ")))]),C(O,M)};K(oe,O=>{i(s),D(()=>i(s).allergens&&i(s).allergens.length>0)&&O(ue)})}var ae=y(oe,2);{var de=O=>{var M=el(),se=y(d(M),2),ge=d(se);ne(ze=>Z(ge,ze),[()=>(i(s),D(()=>i(s).dietary_info.join(", ")))]),C(O,M)};K(ae,O=>{i(s),D(()=>i(s).dietary_info&&i(s).dietary_info.length>0)&&O(de)})}var ve=y(ae,2);{var we=O=>{var M=tl(),se=y(d(M),2),ge=d(se);ne(()=>Z(ge,(ce(a()),D(()=>a().associated_category_unique_identifier)))),C(O,M)};K(ve,O=>{ce(a()),D(()=>a().associated_category_unique_identifier)&&O(we)})}var Ie=y(ve,2);{var Ee=O=>{var M=nl(),se=y(d(M),2),ge=d(se);ne(()=>Z(ge,(ce(a()),D(()=>a().item_flags.is_sellable?"Available":"Not Available")))),C(O,M)};K(Ie,O=>{ce(a()),D(()=>a().item_flags&&a().item_flags.is_sellable!==void 0)&&O(Ee)})}var Te=y(Ie,2);{var me=O=>{var M=rl(),se=y(d(M),2),ge=d(se);ne(ze=>Z(ge,ze),[()=>(ce(a()),D(()=>new Date(a().audit_trail.updated_at||a().audit_trail.created_at).toLocaleDateString()))]),C(O,M)};K(Te,O=>{ce(a()),D(()=>a().audit_trail)&&O(me)})}var he=y(Te,2);{var _e=O=>{var M=sl(),se=y(d(M),2),ge=d(se);ne(()=>Z(ge,(ce(a()),D(()=>a().id)))),C(O,M)};K(he,O=>{ce(a()),D(()=>a().id)&&O(_e)})}ne(O=>Z(Q,O),[()=>(ce(a()),D(()=>m(a().item_price_value)))]),C(k,q)},be=k=>{var q=qe(),te=Ce(q);{var Y=Q=>{var re=dl(),ie=Ce(re);{var oe=me=>{var he=il(),_e=y(d(he),2),O=d(_e);ne(()=>Z(O,(ce(a()),D(()=>a().category_type)))),C(me,he)};K(ie,me=>{ce(a()),D(()=>a().category_type)&&me(oe)})}var ue=y(ie,2);{var ae=me=>{var he=ol(),_e=y(d(he),2),O=d(_e);ne(()=>Z(O,(ce(a()),D(()=>a().id)))),C(me,he)};K(ue,me=>{ce(a()),D(()=>a().id)&&me(ae)})}var de=y(ue,2);{var ve=me=>{var he=ll(),_e=y(d(he),2),O=d(_e);ne(()=>Z(O,(ce(a()),D(()=>a().parent_category_unique_identifier)))),C(me,he)};K(de,me=>{ce(a()),D(()=>a().parent_category_unique_identifier)&&me(ve)})}var we=y(de,2);{var Ie=me=>{var he=cl(),_e=y(d(he),2),O=d(_e);ne(()=>Z(O,(ce(a()),D(()=>a().default_linked_main_group_unique_identifier)))),C(me,he)};K(we,me=>{ce(a()),D(()=>a().default_linked_main_group_unique_identifier)&&me(Ie)})}var Ee=y(we,2);{var Te=me=>{var he=ul(),_e=y(d(he),2),O=d(_e);ne(()=>Z(O,(ce(a()),D(()=>a().source_unique_identifier)))),C(me,he)};K(Ee,me=>{ce(a()),D(()=>a().source_unique_identifier)&&me(Te)})}C(Q,re)};K(te,Q=>{i(n)&&Q(Y)},!0)}C(k,q)};K(j,k=>{i(r)?k(L):k(be,!1)})}var Se=y(W,2),Ne=d(Se),ee=y(Ne,2),I=y(ee,2);en(E,k=>_(g,k),()=>i(g)),ne(()=>cn(E,`left: ${(i(p)||l())??""}px; top: ${(i(x)||c())??""}px;`)),X("click",Ne,()=>U()),X("click",ee,()=>v()),X("click",I,()=>u("close")),C(f,E)};K(S,f=>{o()&&a()&&f(h)})}C(e,R),pt()}var pl=F('<span class="error-message svelte-eqo6fo"> </span>'),ml=F('<span class="error-message svelte-eqo6fo"> </span>'),gl=F('<span class="error-message svelte-eqo6fo"> </span>'),hl=F('<span class="error-message svelte-eqo6fo"> </span>'),_l=F('<span class="error-message svelte-eqo6fo"> </span>'),yl=F('<div class="modal-overlay svelte-eqo6fo" role="dialog" tabindex="-1"><div class="modal-content svelte-eqo6fo"><div class="modal-header svelte-eqo6fo"><h2 class="svelte-eqo6fo">Edit Product</h2> <button class="close-button svelte-eqo6fo" aria-label="Close">×</button></div> <form class="product-form svelte-eqo6fo"><div class="form-group svelte-eqo6fo"><label for="product-name-menu" class="svelte-eqo6fo">Name (Menu)</label> <input id="product-name-menu" type="text" placeholder="Enter menu name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-name-button" class="svelte-eqo6fo">Name (Button)</label> <input id="product-name-button" type="text" placeholder="Enter button name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-name-receipt" class="svelte-eqo6fo">Name (Receipt)</label> <input id="product-name-receipt" type="text" placeholder="Enter receipt name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-price" class="svelte-eqo6fo">Price (€)</label> <input id="product-price" type="number" step="0.01" min="0" placeholder="0.00"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-category" class="svelte-eqo6fo">Category</label> <input id="product-category" type="text" placeholder="Enter category name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-description" class="svelte-eqo6fo">Description</label> <textarea id="product-description" placeholder="Enter product description (optional)" rows="3" class="svelte-eqo6fo"></textarea></div> <div class="form-actions svelte-eqo6fo"><button type="button" class="btn-cancel svelte-eqo6fo">Cancel</button> <button type="submit" class="btn-save svelte-eqo6fo"><!></button></div></form></div></div>');function bl(e,t){vt(t,!1);const n=mn();let r=Me(t,"visible",8,!1),s=Me(t,"product",8,null),a=z({name_menu:"",name_button:"",name_receipt:"",price:"",categoryName:"",description:""}),l=z({}),c=z(!1),o=z(!1),u=z({});function g(v){if(typeof v=="object"&&v!==null)return v;if(typeof v=="string")try{return JSON.parse(v)}catch{return v}return v}function p(){if(_(u,{}),i(a).name_menu.trim()||je(u,i(u).name_menu="Menu name is required"),i(a).name_button.trim()||je(u,i(u).name_button="Button name is required"),i(a).name_receipt.trim()||je(u,i(u).name_receipt="Receipt name is required"),!i(a).price.trim())je(u,i(u).price="Price is required");else{const v=parseFloat(i(a).price);(isNaN(v)||v<0)&&je(u,i(u).price="Price must be a valid positive number")}return i(a).categoryName.trim()||je(u,i(u).categoryName="Category is required"),Object.keys(i(u)).length===0}async function x(){if(p()){_(o,!0);try{const v={};i(a).name_menu!==i(l).name_menu&&(v.name_menu=i(a).name_menu.trim()),i(a).name_button!==i(l).name_button&&(v.name_button=i(a).name_button.trim()),i(a).name_receipt!==i(l).name_receipt&&(v.name_receipt=i(a).name_receipt.trim()),i(a).price!==i(l).price&&(v.price=parseFloat(i(a).price)),i(a).categoryName!==i(l).categoryName&&(v.categoryName=i(a).categoryName.trim()),i(a).description!==i(l).description&&(v.description=i(a).description.trim()),Object.keys(v).length>0&&n("save",{productId:s().id,updates:v}),m()}catch(v){console.error("Error saving product:",v)}finally{_(o,!1)}}}function m(){n("close")}function w(v){v.target===v.currentTarget&&m()}function T(v){v.key==="Escape"&&m()}Le(()=>(ce(s()),ce(r()),i(a)),()=>{if(s()&&r()){const v=s().display_names?g(s().display_names):{},R=v.menu?.de||s().name||"",S=v.button?.de||v.menu?.de||s().name||"",h=v.receipt?.de||v.menu?.de||s().name||"";let f="Unknown Category";s().category_name?f=s().category_name:s().categoryName?f=s().categoryName:f=`Category ID: ${s().associated_category_unique_identifier||"N/A"}`,_(a,{name_menu:R,name_button:S,name_receipt:h,price:(s().item_price_value||s().price||0).toString(),categoryName:f,description:s().description||R}),_(l,{...i(a)}),_(c,!1),_(u,{})}}),Le(()=>(ce(r()),i(a),i(l)),()=>{_(c,r()&&(i(a).name_menu!==i(l).name_menu||i(a).name_button!==i(l).name_button||i(a).name_receipt!==i(l).name_receipt||i(a).price!==i(l).price||i(a).categoryName!==i(l).categoryName||i(a).description!==i(l).description))}),nn(),wt();var N=qe();X("keydown",jn,T);var B=Ce(N);{var U=v=>{var R=yl(),S=d(R),h=d(S),f=y(d(h),2),E=y(h,2),H=d(E),P=y(d(H),2);let J;var A=y(P,2);{var $=M=>{var se=pl(),ge=d(se);ne(()=>Z(ge,(i(u),D(()=>i(u).name_menu)))),C(M,se)};K(A,M=>{i(u),D(()=>i(u).name_menu)&&M($)})}var W=y(H,2),j=y(d(W),2);let L;var be=y(j,2);{var Se=M=>{var se=ml(),ge=d(se);ne(()=>Z(ge,(i(u),D(()=>i(u).name_button)))),C(M,se)};K(be,M=>{i(u),D(()=>i(u).name_button)&&M(Se)})}var Ne=y(W,2),ee=y(d(Ne),2);let I;var k=y(ee,2);{var q=M=>{var se=gl(),ge=d(se);ne(()=>Z(ge,(i(u),D(()=>i(u).name_receipt)))),C(M,se)};K(k,M=>{i(u),D(()=>i(u).name_receipt)&&M(q)})}var te=y(Ne,2),Y=y(d(te),2);let Q;var re=y(Y,2);{var ie=M=>{var se=hl(),ge=d(se);ne(()=>Z(ge,(i(u),D(()=>i(u).price)))),C(M,se)};K(re,M=>{i(u),D(()=>i(u).price)&&M(ie)})}var oe=y(te,2),ue=y(d(oe),2);let ae;var de=y(ue,2);{var ve=M=>{var se=_l(),ge=d(se);ne(()=>Z(ge,(i(u),D(()=>i(u).categoryName)))),C(M,se)};K(de,M=>{i(u),D(()=>i(u).categoryName)&&M(ve)})}var we=y(oe,2),Ie=y(d(we),2),Ee=y(we,2),Te=d(Ee),me=y(Te,2),he=d(me);{var _e=M=>{var se=Pt("Saving...");C(M,se)},O=M=>{var se=Pt("Save Changes");C(M,se)};K(he,M=>{i(o)?M(_e):M(O,!1)})}ne((M,se,ge,ze,gt,nt)=>{P.disabled=i(o),J=Xe(P,1,"svelte-eqo6fo",null,J,M),j.disabled=i(o),L=Xe(j,1,"svelte-eqo6fo",null,L,se),ee.disabled=i(o),I=Xe(ee,1,"svelte-eqo6fo",null,I,ge),Y.disabled=i(o),Q=Xe(Y,1,"svelte-eqo6fo",null,Q,ze),ue.disabled=i(o),ae=Xe(ue,1,"svelte-eqo6fo",null,ae,gt),Ie.disabled=i(o),Te.disabled=i(o),me.disabled=nt},[()=>({error:i(u).name_menu}),()=>({error:i(u).name_button}),()=>({error:i(u).name_receipt}),()=>({error:i(u).price}),()=>({error:i(u).categoryName}),()=>(i(c),i(o),i(u),D(()=>!i(c)||i(o)||Object.keys(i(u)).length>0))]),X("click",f,m),qt(P,()=>i(a).name_menu,M=>je(a,i(a).name_menu=M)),qt(j,()=>i(a).name_button,M=>je(a,i(a).name_button=M)),qt(ee,()=>i(a).name_receipt,M=>je(a,i(a).name_receipt=M)),qt(Y,()=>i(a).price,M=>je(a,i(a).price=M)),qt(ue,()=>i(a).categoryName,M=>je(a,i(a).categoryName=M)),qt(Ie,()=>i(a).description,M=>je(a,i(a).description=M)),X("click",Te,m),X("submit",E,aa(x)),X("click",R,w),X("keydown",R,T),C(v,R)};K(B,v=>{r()&&s()&&v(U)})}C(e,N),pt()}var wl=F('<div class="modal-overlay svelte-3d9wpg"><div class="modal-content svelte-3d9wpg"><div class="modal-header svelte-3d9wpg"><h2 class="svelte-3d9wpg">Edit Category</h2> <button class="close-button svelte-3d9wpg">×</button></div> <form class="product-form svelte-3d9wpg"><div class="form-group svelte-3d9wpg"><label for="category-name" class="svelte-3d9wpg">Category Name</label> <input id="category-name" type="text" class="svelte-3d9wpg"/></div> <div class="form-group svelte-3d9wpg"><label for="category-type" class="svelte-3d9wpg">Category Type</label> <select id="category-type" class="svelte-3d9wpg"><option>Food</option><option>Drink</option><option>Other</option></select></div> <div class="form-actions svelte-3d9wpg"><button type="button" class="btn-cancel svelte-3d9wpg">Cancel</button> <button type="submit" class="btn-save svelte-3d9wpg"> </button></div></form></div></div>');function Sl(e,t){vt(t,!1);let n=Me(t,"visible",8,!1),r=Me(t,"category",8,null);const s=mn();let a=z({name:"",type:"food"}),l=z({}),c=z(!1);async function o(){if(!i(a).name.trim()){alert("Category name is required.");return}_(c,!0);const T={};i(a).name!==i(l).name&&(T.name=i(a).name.trim()),i(a).type!==i(l).type&&(T.type=i(a).type),Object.keys(T).length>0&&s("save",{categoryId:r().id,updates:T}),u()}function u(){_(c,!1),s("close")}function g(T){T.target===T.currentTarget&&u()}function p(T){T.key==="Escape"&&u()}Le(()=>(ce(r()),ce(n()),i(a)),()=>{if(r()&&n()){const T=JSON.parse(r().category_names||"{}");_(a,{name:T.de||"",type:r().category_type||"food"}),_(l,{...i(a)})}}),nn(),wt();var x=qe();X("keydown",jn,p);var m=Ce(x);{var w=T=>{var N=wl(),B=d(N),U=d(B),v=y(d(U),2),R=y(U,2),S=d(R),h=y(d(S),2),f=y(S,2),E=y(d(f),2);ne(()=>{i(a),Js(()=>{i(c)})});var H=d(E);H.value=H.__value="food";var P=y(H);P.value=P.__value="drink";var J=y(P);J.value=J.__value="other";var A=y(f,2),$=d(A),W=y($,2),j=d(W);ne(()=>{h.disabled=i(c),E.disabled=i(c),$.disabled=i(c),W.disabled=i(c),Z(j,i(c)?"Saving...":"Save Changes")}),X("click",v,u),qt(h,()=>i(a).name,L=>je(a,i(a).name=L)),ra(E,()=>i(a).type,L=>je(a,i(a).type=L)),X("click",$,u),X("submit",R,aa(o)),X("click",N,g),C(T,N)};K(m,T=>{n()&&r()&&T(w)})}C(e,x),pt()}var xl=Jr(`<svg viewBox="-10 -10 120 120" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: 100%;"><defs><filter height="170%" id="sh2" width="170%" x="-0.2" y="-0.2"><feOffset dx="0" dy="0" in="SourceAlpha"></feOffset><feGaussianBlur stdDeviation="1.2"></feGaussianBlur><feColorMatrix result="out" type="matrix" values=" 
               0 0 0 0 0.2         
               0 0 0 0 0.2                    
               0 0 0 0 0.2                
               0 0 0 10 0 "></feColorMatrix><feMerge><feMergeNode in="out"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter></defs><g filter="url(#sh2)"><path fill="#2c2c2e" stroke="#666" stroke-width="1.5" d="M72,89 C78.6,68 67.2,30.7 89,68 C86.9,37.6 66.91,32 62,61 C58,44.1 67.5,38.8 52,10 C53.6,47 46.91,36.2 45,61 C39.3,43.4 22,46.6 13,43 C32.9,55.8 35.7,66.62 32,89 C35,97.9 68.6,99 72,89 Z"></path><circle fill="#2c2c2e" stroke="#666" stroke-width="1.5" cx="13" cy="43" r="5.5"></circle><circle fill="#2c2c2e" stroke="#666" stroke-width="1.5" cx="52" cy="10" r="5.5"></circle><circle fill="#2c2c2e" stroke="#666" stroke-width="1.5" cx="89" cy="68" r="5.5"></circle></g></svg>`);function kl(e){var t=xl();C(e,t)}var Tl=Jr('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 96" fill="none" class="svelte-1cmb9l6"><rect x="0" y="0" width="128" height="96" rx="8" ry="8" fill="#2A2A2A" stroke="none"></rect><g><rect x="7" y="6" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="24" y="19" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">1</text><rect x="47" y="6" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="64" y="19" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">2</text><rect x="87" y="6" width="34" height="24" rx="3" fill="#883333" stroke="#555555" stroke-width="0.5"></rect><text x="104" y="19" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">3</text><rect x="7" y="36" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="24" y="49" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">4</text><rect x="47" y="36" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="64" y="49" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">5</text><rect x="87" y="36" width="34" height="24" rx="3" fill="#885533" stroke="#555555" stroke-width="0.5"></rect><text x="104" y="49" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">6</text><rect x="7" y="66" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="24" y="79" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">7</text><rect x="47" y="66" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="64" y="79" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">8</text><rect x="87" y="66" width="34" height="24" rx="3" fill="#385b4a" stroke="#555555" stroke-width="0.5"></rect><text x="104" y="79" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">9</text></g></svg>');function Cl(e){var t=Tl();C(e,t)}class El{constructor(t,n,r=!0){this.row=t,this.col=n,this.content=null,this.isEmpty=!0,this.isUsable=r,this.priority=0,this.id=`slot-${t}-${n}`}setContent(t,n=1){this.content=t,this.isEmpty=!1,this.priority=n}clearContent(){this.content=null,this.isEmpty=!0,this.priority=0}}class Il{constructor(t,n){this.rows=t,this.cols=n,this.slots=[],this.contentSlots=[],this.initializeGrid()}initializeGrid(){for(let t=0;t<this.rows;t++){const n=[];for(let r=0;r<this.cols;r++){const s=t%2!==r%2,a=new El(t,r,s);n.push(a),this.contentSlots.push(a)}this.slots.push(n)}}getSlot(t,n){return t>=0&&t<this.rows&&n>=0&&n<this.cols?this.slots[t][n]:null}getAllSlots(){return this.contentSlots}getUsableEmptySlots(){return this.contentSlots.filter(t=>t.isUsable&&t.isEmpty)}getUsableFilledSlots(){return this.contentSlots.filter(t=>t.isUsable&&!t.isEmpty)}getUsableSlots(){return this.contentSlots.filter(t=>t.isUsable)}placeContentAt(t,n,r,s){const a=this.getSlot(t,n);return a&&a.isUsable&&(a.isEmpty||s>a.priority)?(a.setContent(r,s),!0):!1}clearAllContent(){this.contentSlots.forEach(t=>{t.clearContent()})}getPrioritizedSlots(){return this.contentSlots.filter(t=>t.isUsable).sort((t,n)=>n.priority-t.priority)}}function Ml(e,t,n){const{cellWidth:r=120,cellHeight:s=80,buttonGap:a=6,hexOffset:l=.5,shape:c="hex"}=n;return c==="hex"?Al(e,t,r,s,a):Ol(e,t,r,s,a)}function Al(e,t,n,r,s,a){const l=t%2===1,c=Math.floor(t/2),o=c*(n+s)+(l?(n+s)/2:0),u=r*.75,g=e*(u+s);return console.log(`🔮 [hexPositioning] row=${e}, col=${t}, isOddCol=${l}, visualCol=${c}, x=${o}, y=${g}, gap=${s}`),{x:o,y:g}}function Ol(e,t,n,r,s){const a=t*(n+s),l=e*(r+s);return console.log(`🔮 [rectPositioning] row=${e}, col=${t}, x=${a}, y=${l}, gap=${s}`),{x:a,y:l}}function Nl(e){return e?`translate(${e.x}px, ${e.y}px)`:"translate(0px, 0px)"}class Rl{constructor(t,n,r){this.id=t,this.type=n,this.logicalPosition=r,this.content=null,this.cssPosition=null,this.cssTransform=null,this.geometryMetadata={}}setContent(t){this.content=t}calculatePhysicalPosition(t){return this.cssPosition=Ml(this.logicalPosition.row,this.logicalPosition.col,t),this.cssTransform=Nl(this.cssPosition),this.cssPosition}}class $l{constructor(t={}){this.options={shape:"hex",cellWidth:t.cellWidth||120,cellHeight:t.cellHeight||80,buttonGap:t.buttonGap||6,...t}}renderContentGrid(t){const n=[],r=t.getUsableFilledSlots();for(const s of r){const a=new Rl(`full-slot-${s.row}-${s.col}`,"full",{row:s.row,col:s.col});a.setContent(s.content),a.geometryMetadata.priority=s.priority,a.calculatePhysicalPosition(this.options),n.push(a)}return n}}function bs(e={}){return new $l(e)}const ws={MAX_CONTENT:100,PAYMENT_BUTTON:90,TABLE_BUTTON:85,PINPAD_BUTTON:80,CATEGORY_NAVIGATION:70,DEFAULT:50,MIN:1};class Dl{constructor(t={}){this.config={dimensions:{rows:4,cols:12},rendering:{shape:"hex",cellWidth:120,cellHeight:80},...t},this.contentGrid=new Il(this.config.dimensions.rows,this.config.dimensions.cols),this.geometryRenderer=bs(this.config.rendering),this.renderCache=null,this.isDirty=!0,console.log("🎯 [GridManager] Initialized ContentGrid",this.config.dimensions)}clearAndReset(){this.contentGrid.clearAllContent(),this.markDirty()}placeItems(t,n=ws.DEFAULT,r=1/0){if(!t||t.length===0)return[];const s=this.contentGrid.getUsableEmptySlots();let a=0;const l=[];t.sort((c,o)=>(c.order_index||0)-(o.order_index||0));for(const c of t){if(a>=r)break;const o=s[a];o&&(o.setContent(c,n),a++,l.push({item:c,placed:!0,slot:o}))}return this.markDirty(),l}placeSystemElements(t){const n=[];for(const r of t){const s=this.contentGrid.placeContentAt(r.row,r.col,r.content,r.priority);n.push({element:r,placed:s})}return this.markDirty(),n}getRenderStructure(){return this.renderCache&&!this.isDirty?this.renderCache:(this.contentGrid.getUsableFilledSlots(),this.renderCache=this.geometryRenderer.renderContentGrid(this.contentGrid),this.isDirty=!1,this.renderCache)}getSvelteCompatibleCells(t){return this.geometryRenderer=bs(t),this.getRenderStructure().map(r=>({...r,cssTransform:r.cssTransform,data:r.content.data||r.content,label:r.content.label||r.content.category_names?.de||r.content.display_names?.button?.de}))}getDebugInfo(){return this.contentGrid.getDebugInfo()}getUsableSlotCount(){return this.contentGrid.getUsableSlots().length}markDirty(){this.isDirty=!0}getPriorities(){return ws}}var Pl=F("<div><div><!></div></div>"),Ll=F('<p class="status-message svelte-lb1vpy"> </p>'),Bl=F('<div class="empty-category-info svelte-lb1vpy"><p class="empty-message svelte-lb1vpy">No products in this category.</p> <p class="empty-hint svelte-lb1vpy">Try a different category or check the product catalog.</p></div>'),Ul=F('<div class="quantum-button svelte-lb1vpy"><!></div>'),Fl=F("<div><!> <!></div>"),jl=F('<div class="selection-area svelte-lb1vpy"><!> <!> <!> <!> <div class="grid-container svelte-lb1vpy"><!></div></div>');function ql(e,t){vt(t,!1);const[n,r]=Hn(),s=()=>et(un,"$authStore",n),a=()=>et(xn,"$notificationStore",n),l=()=>et(la,"$uiConstantsStore",n),c=()=>et(Ye,"$orderStore",n),o=()=>et(Je,"$pinpadStore",n),u=()=>et(ji,"$currentMinuteTime",n),g=z();let p=z([]),x=z([]),m=z("Connecting to backend..."),w=!1,T=z("categories"),N=null,B=z("6-6-6"),U=z(!1),v=z(null),R=z(0),S=z(0),h=z(!1),f=z(null),E=z(!1),H=z(null),P=z(0);Me(t,"isAtBottom",8,!1),Me(t,"consoleViewComponent",8,null);let J=z(0),A=z(null),$=z([]),W=Me(t,"handleSmartAction",8,()=>{}),j=z(null),L=z(null);const be=6,Se=6,Ne=6,ee=6;let I=z(i(g)),k=z(i(g)*.866),q=z(i(g)),te=z(i(g)),Y=1,Q=1,re=z(),ie,oe,ue=!1,ae;function de(b){if(!b)return{};if(typeof b=="string")try{return JSON.parse(b)}catch{return{}}return b}function ve(b){if(!b)return"Login";const V=b.split(" ");let xe;if(V.length===1)xe=V[0].length>12?V[0].substring(0,12)+"...":V[0];else if(V.length===2){const fe=V[0].length>8?V[0].substring(0,8)+".":V[0],Ae=V[1].length>8?V[1].substring(0,8)+".":V[1];xe=`${fe} ${Ae}`}else{const fe=V[0].length>6?V[0].substring(0,6)+".":V[0],Ae=V[V.length-1].length>6?V[V.length-1].substring(0,6)+".":V[V.length-1];xe=`${fe} ${Ae}`}return`Angemeldet als
${xe}`}function we(){ae&&clearInterval(ae),ae=setInterval(()=>{const b=new Date;new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes()+1,0,0),zn.update(V=>({...V,time:b})),he()},6e4),he()}Qr(()=>{ae&&clearInterval(ae)});function Ie(){const b=i(P),V=i(B)==="6-6-6"?Ne:ee,xe=i(J)-2*V,fe=i(B)==="6-6-6"?be:Se,Ae=i(g),Fe=i(B)==="6-6-6"?.866:.75;let Pe=Math.floor((b-fe)/(Ae+fe));Pe<1&&(Pe=1);const Qe=(b-(Pe+1)*fe)/Pe,jt=Qe*Fe;let Ct=Math.floor((xe+fe)/(jt+fe));Ct<1&&(Ct=1);const Et=(xe-(Ct-1)*fe)/Ct;return{columns:Pe,rows:Ct,buttonWidth:Qe,buttonHeight:Et}}function Ee(){const b=Ie();Y=b.columns,Q=b.rows,i(B)==="6-6-6"?(_(I,b.buttonWidth),_(k,b.buttonHeight)):(_(q,b.buttonWidth),_(te,b.buttonHeight)),_(A,new Dl({dimensions:{rows:Q,cols:Y*2},rendering:{shape:i(B)==="6-6-6"?"hex":"rect",cellWidth:i(B)==="6-6-6"?i(I):i(q),cellHeight:i(B)==="6-6-6"?i(k):i(te)}})),he()}function Te(){Ee()}function me(){const b=[];return i(j)&&b.push({row:0,col:0,content:i(j),priority:i(A).getPriorities().TABLE_BUTTON}),i(L)&&b.push({row:0,col:2,content:i(L),priority:i(A).getPriorities().PINPAD_BUTTON}),b}function he(){if(!i(A))return;i(A).clearAndReset();const b=i(A).getPriorities(),V=me();if(V.length>0&&i(A).placeSystemElements(V),c()&&c().items&&c().items.length>0){const fe=[{row:Q-1,col:Y*2-2,content:{type:"bar",label:"Bar",onClick:()=>nt("cash")},priority:b.PAYMENT_BUTTON},{row:Q-1,col:Y*2-4,content:{type:"karte",label:"Karte",onClick:()=>nt("card")},priority:b.PAYMENT_BUTTON}];i(A).placeSystemElements(fe)}const xe=[{row:Q-1,col:0,content:{type:"pinpad",label:"Pinpad"},priority:b.PINPAD_BUTTON}];i(A).placeSystemElements(xe),i(T)==="categories"?i(A).placeItems(i(p),b.CATEGORY_NAVIGATION):i(T)==="products"&&i(A).placeItems(i(x),b.MAX_CONTENT),_($,i(A).getSvelteCompatibleCells(i(A).config.rendering))}function _e(b){b.content?.onClick?b.content.onClick():b.data&&(i(T)==="categories"&&b.data.id?O({detail:{data:b.data}}):i(T)==="products"&&b.data.id&&M({detail:{data:b.data}}))}function O({detail:b}){b.data?.id&&(N=b.data,_(m,"Loading..."),le.send({command:"getItemsByCategory",payload:{categoryId:b.data.id}}))}async function M({detail:b}){b.data?.id&&await Ye.addItem(b.data.id,1)}function se(){_(T,"categories"),N=null,_(x,[]),_(m,"")}function ge(){_(B,i(B)==="6-6-6"?"4-4-4":"6-6-6")}function ze(){Vo()}async function gt(){if(s().isAuthenticated){const b=s().currentUser,V=`👤 **${b.full_name}** (${b.role})

🔐 **Status:** Erfolgreich angemeldet
💡 **Tipp:** Lange drücken zum Abmelden`;pe.addMessage({type:"agent",message:V}),G("INFO",`User ${b.username} viewed profile information`)}}function nt(b){let V;Ye.subscribe(xe=>V=xe)(),V&&V.total>0&&Ye.finishOrder({type:b.charAt(0).toUpperCase()+b.slice(1),amount:V.total})}function ct(){o().isActive?Je.deactivate():Je.activateAlphaInput(()=>{},()=>{},pe)}function Ve({detail:b}){b.data&&!b.data.isBackButton&&(_(v,b.data),_(R,b.mouseX),_(S,b.mouseY),_(U,!0))}function rt(){_(U,!1)}function st({detail:b}){b.item.category_names?(_(H,b.item),_(E,!0)):(_(f,b.item),_(h,!0)),_(U,!1)}async function ut({detail:b}){G("DEBUG",`Advanced edit requested for item: ${b.item.id}`),_(U,!1);const V=b.item,xe=!!V.category_names;let fe=`🔧 **Advanced Edit Mode**

`;if(fe+=`📝 **Type:** ${xe?"Category":"Product"}
`,fe+=`🆔 **ID:** ${V.id}
`,xe){const Ae=de(V.category_names);fe+=`📛 **Name:** ${Ae.de||"Unnamed"}
`,V.category_type&&(fe+=`🏷️ **Type:** ${V.category_type}
`)}else{const Ae=de(V.display_names);fe+=`📛 **Name:** ${Ae.button?.de||"Unnamed Product"}
`,V.price&&(fe+=`💰 **Price:** €${V.price}
`)}fe+=`
💡 **Available Actions:**
`,fe+=`• Standard Edit (Right-click → Edit)
`,fe+=`• Database Direct Access
`,fe+=`• Bulk Operations
`,fe+="• Advanced Properties",pe.addMessage({type:"agent",message:fe}),xe?(_(H,V),_(E,!0)):(_(f,V),_(h,!0))}async function We({detail:b}){try{(await le.send({command:"updateProduct",payload:{productId:b.productId,updates:b.updates,sessionId:"admin-session-placeholder"}})).status==="success"&&(G("INFO",`Product ${b.productId} updated successfully`),i(T)==="products"&&N&&le.send({command:"getItemsByCategory",payload:{categoryId:N.id}}))}catch(V){console.error("Product update error:",V),G("ERROR",`Failed to update product ${b.productId}: ${V.message}`)}_(h,!1)}async function Re({detail:b}){try{(await le.send({command:"updateCategory",payload:{categoryId:b.categoryId,updates:b.updates}})).status==="success"&&(G("INFO",`Category ${b.categoryId} updated successfully`),i(T)==="categories"&&le.send({command:"getCategories"}))}catch(V){console.error("Category update error:",V),G("ERROR",`Failed to update category ${b.categoryId}: ${V.message}`)}_(E,!1)}function Be(){_(h,!1)}function Ge(){_(E,!1)}xn.subscribe(b=>{b.style}),un.subscribe(b=>{}),Wt(()=>{i(re)&&(ie=new ResizeObserver(V=>{oe&&clearTimeout(oe),oe=setTimeout(()=>{for(let xe of V){const fe=xe.contentRect.width,Ae=xe.contentRect.height;(i(P)!==fe||i(J)!==Ae)&&(_(P,fe),_(J,Ae),Te())}},150)}),ie.observe(i(re)),setTimeout(()=>{_(P,i(re).clientWidth),_(J,i(re).clientHeight),Te()},100));const b=()=>{_(T,"categories"),N=null,ft.set("order")};return window.addEventListener("autoCollapseComplete",b),we(),()=>{ie?.disconnect(),window.removeEventListener("autoCollapseComplete",b),ae&&clearInterval(ae)}}),le.subscribe(b=>{w=b.isConnected,w&&!ue&&(ue=!0,_(m,"Loading categories..."),setTimeout(()=>{le.send({command:"getCategories"}).then(V=>{V.status==="success"&&Array.isArray(V.payload)?(_(p,V.payload),_(m,""),he()):(_(m,"Error: Could not load categories from backend."),console.error("Failed to load categories:",V))}).catch(V=>{_(m,"Error: Failed to get response for categories."),console.error("Error in getCategories promise:",V)})},500)),b.lastMessage?.command==="getItemsByCategoryResponse"&&(b.lastMessage.status==="success"&&Array.isArray(b.lastMessage.payload)?(_(x,b.lastMessage.payload),_(T,"products"),_(m,"")):(_(m,"Error: Could not load products from backend."),console.error("Failed to load products:",b.lastMessage)))});function dt(b){return b.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}function ht(b){if(b.content?.type==="pinpad")return{label:b.content.label,component:Cl,onClick:ct,active:!0};if(b.content?.type==="bar"||b.content?.type==="karte"){const Fe=c()&&c().total>0&&c().status==="active";return{label:b.content.label,onClick:b.content.onClick,active:Fe,disabled:!Fe,paymentButton:!0,color:Fe?b.content.type==="bar"?"#28a745":"#007bff":"#666"}}if(b.content.isUserButton)return i(j);if(b.content.isSmartNavigation)return i(L);if(b.content.isTimeButton){const Fe=dt(u().time),Pe=u().time.getDate().toString().padStart(2,"0"),Qe=(u().time.getMonth()+1).toString().padStart(2,"0");return{label:`${Fe}
${Pe}.${Qe}`,onClick:ze,active:!0,customStyle:"font-family: monospace; font-size: 14px; font-weight: bold; line-height: 1.2; text-align: center; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);"}}if(b.content.isLayoutToggle)return{label:i(B)==="6-6-6"?"6⬡6⬡6":"4▢4▢4",onClick:ge,active:!0,customStyle:"font-family: monospace; font-size: 16px; font-weight: bold; text-align: center;"};if(b.content.isBackButton)return{label:"⬅ Categories",onClick:se,active:!0,data:{isBackButton:!0},color:"#6c757d"};if(b.content.isKeyboardToggle)return{label:b.content.label||"⌨",icon:b.content.icon,color:b.content.color,textColor:b.content.textColor,onClick:ct,active:!0};if(b.content.isPaymentButton){const Fe=c().total>0&&c().status==="active";return{label:b.content.label,onClick:Fe?()=>nt(b.content.paymentType):void 0,active:Fe,disabled:!Fe,paymentButton:!0,color:Fe?b.content.color:"#666",icon:b.content.icon,textColor:Fe?b.content.textColor:void 0,backgroundStyle:Fe?b.content.backgroundStyle:void 0}}const V=i(T)==="categories",xe=V?de(b.content.category_names).de||"Unnamed":de(b.content.display_names).button.de||"Unnamed Product";let fe;!V&&b.content?.additional_item_attributes?.ui_suggestions?.background_color_hex?fe=b.content.additional_item_attributes.ui_suggestions.background_color_hex:V||(fe="#666666");const Ae={label:xe,data:b.content,active:!0};return V?(Ae.color="#3A2F20",Ae.backgroundStyle="radial-gradient(ellipse at center, #645540 0%, #5A4B35 30%, #4A3B28 70%, #3A2F20 100%)",Ae.textColor="#DDDDD0"):fe&&(Ae.color=fe),Ae}Le(()=>(s(),Je),()=>{_(j,(()=>{const b=s().currentUser;return b?{label:ve(b.full_name),data:{isUserButton:!0,authenticated:!0},onClick:gt,active:!0,color:"#28a745",textColor:"#666",customStyle:"font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; line-height: 1.1; white-space: pre-line; text-align: center; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);"}:{label:"Login",data:{isUserButton:!0,authenticated:!1},onClick:()=>Je.activate("agent",null,null,"numeric"),active:!0,color:"#6c757d",textColor:"#666",customStyle:"font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; line-height: 1.1; white-space: pre-line; text-align: center; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);"}})())}),Le(()=>(a(),ce(W())),()=>{_(L,(()=>{let b="#2c2c2e";if(a().style)switch(a().style){case"error":b="#d32f2f";break;case"warning":b="#f57c00";break;case"info":b="#1976d2";break;case"success":b="#388e3c";break;default:b="#2c2c2e"}return{icon:kl,showShape:!0,color:b,onClick:()=>W()("betrugerCap"),active:!0}})())}),Le(()=>l(),()=>{_(g,l().MIN_BUTTON_WIDTH)}),Le(()=>(i(P),i(J),i(B)),()=>{i(P)>0&&i(J)>0&&i(B)&&Te()}),Le(()=>(i(A),i(T),i(p),i(x)),()=>{i(A)&&(i(T)==="categories"&&i(p).length>=0||i(T)==="products"&&i(x).length>=0)&&he()}),Le(()=>(i(A),c()),()=>{i(A)&&c()&&he()}),Le(()=>(i(A),i(j),i(L)),()=>{i(A)&&(i(j)||i(L))&&he()}),nn(),wt();var Ut=jl(),$e=d(Ut);{var He=b=>{var V=Pl();let xe;var fe=d(V);let Ae;var Fe=d(fe);{let Pe=Nt(()=>i(g)/4*3);Xo(Fe,{onClose:()=>Je.deactivate(),get minButtonSize(){return i(Pe)}})}ne((Pe,Qe)=>{xe=Xe(V,1,"pinpad-overlay svelte-lb1vpy",null,xe,Pe),Ae=Xe(fe,1,"pinpad-container svelte-lb1vpy",null,Ae,Qe)},[()=>({numeric:o().layout==="numeric",alpha:o().layout==="alpha"}),()=>({numeric:o().layout==="numeric",alpha:o().layout==="alpha"})]),C(b,V)};K($e,b=>{o(),D(()=>o().isActive)&&b(He)})}var at=y($e,2);vl(at,{get item(){return i(v)},get x(){return i(R)},get y(){return i(S)},get visible(){return i(U)},$$events:{close:rt,edit:st,"advanced-edit":ut}});var Ke=y(at,2);bl(Ke,{get visible(){return i(h)},get product(){return i(f)},$$events:{save:We,close:Be}});var Ue=y(Ke,2);Sl(Ue,{get visible(){return i(E)},get category(){return i(H)},$$events:{save:Re,close:Ge}});var Ft=y(Ue,2),At=d(Ft);{var Kt=b=>{var V=Ll(),xe=d(V);ne(()=>Z(xe,i(m))),C(b,V)},Tt=b=>{var V=Fl();let xe;cn(V,"padding: 6px 0;");var fe=d(V);{var Ae=Pe=>{var Qe=Bl();C(Pe,Qe)};K(fe,Pe=>{i(T),i(x),D(()=>i(T)==="products"&&i(x).length===0)&&Pe(Ae)})}var Fe=y(fe,2);Mt(Fe,1,()=>i($),Pe=>Pe.id,(Pe,Qe)=>{var jt=Ul(),Ct=d(jt);{let Et=Nt(()=>i(B)==="6-6-6"?"hex":"rect"),it=Nt(()=>i(B)==="6-6-6"?i(I):i(q)),rn=Nt(()=>i(B)==="6-6-6"?i(k):i(te)),hr=Nt(()=>ht(i(Qe)));ca(Ct,$i({get shape(){return i(Et)},get width(){return i(it)},get height(){return i(rn)}},()=>i(hr),{$$events:{click:()=>_e(i(Qe)),secondaryaction:Ve}}))}ne(()=>cn(jt,`${i(Qe),D(()=>i(Qe).cssTransform)??""}; position: absolute;`)),C(Pe,jt)}),ne(Pe=>xe=Xe(V,1,"grid-container-unified svelte-lb1vpy",null,xe,Pe),[()=>({hex:i(B)==="6-6-6"})]),C(b,V)};K(At,b=>{i(m)?b(Kt):b(Tt,!1)})}en(Ut,b=>_(re,b),()=>i(re)),C(e,Ut),pt(),r()}var zl=F('<input type="file" accept=".pdf,.jpg,.jpeg,.png" multiple style="display: none;" class="svelte-1wvon5f"/>'),Vl=F('<div class="importing-indicator svelte-1wvon5f"><div class="spinner svelte-1wvon5f"></div> <p class="svelte-1wvon5f">Importing menu...</p></div>'),Gl=F('<div class="loading-files svelte-1wvon5f"><div class="spinner svelte-1wvon5f"></div> <p class="svelte-1wvon5f">Loading available files...</p></div>'),Wl=F('<div class="error-message svelte-1wvon5f"><p class="svelte-1wvon5f"> </p> <button class="retry-btn svelte-1wvon5f">Retry</button></div>'),Hl=F('<div class="upload-area svelte-1wvon5f"><div class="upload-prompt svelte-1wvon5f"><p class="svelte-1wvon5f">No files selected yet.</p> <button class="upload-btn svelte-1wvon5f"><svg class="upload-icon svelte-1wvon5f" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" class="svelte-1wvon5f"></path></svg> Choose Files</button> <p class="upload-hint svelte-1wvon5f">Select multiple PDF, JPG, or PNG files</p></div></div>'),Jl=F('<div class="no-files svelte-1wvon5f"><p class="svelte-1wvon5f">No menu files found in the menu_inputs directory.</p> <p class="svelte-1wvon5f">Please add PDF, JPG, or PNG files to the menu_inputs folder.</p></div>'),Kl=F('<span class="svelte-1wvon5f"> </span>'),Yl=F('<span class="svelte-1wvon5f"> </span>'),Xl=F('<button class="control-btn svelte-1wvon5f">Add More Files</button>'),Ql=F('<div class="size-warning svelte-1wvon5f"></div>'),Zl=F('<div><label class="file-checkbox svelte-1wvon5f"><input type="checkbox" class="svelte-1wvon5f"/> <div class="file-info svelte-1wvon5f"><div class="file-name svelte-1wvon5f"> </div> <div class="file-details svelte-1wvon5f"><span class="file-type svelte-1wvon5f"> </span> <span class="file-date svelte-1wvon5f"> </span></div> <!></div></label></div>'),ec=F('<span class="upload-status uploaded svelte-1wvon5f">✓ Uploaded</span>'),tc=F('<span class="upload-status pending svelte-1wvon5f">Pending upload</span>'),nc=F('<div><label class="file-checkbox svelte-1wvon5f"><input type="checkbox" class="svelte-1wvon5f"/> <div class="file-info svelte-1wvon5f"><div class="file-name svelte-1wvon5f"> </div> <div class="file-details svelte-1wvon5f"><span class="file-type svelte-1wvon5f"> </span> <!></div></div></label> <button class="remove-btn svelte-1wvon5f" title="Remove file"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-1wvon5f"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" class="svelte-1wvon5f"></path></svg></button></div>'),rc=F('<div class="file-controls svelte-1wvon5f"><div class="selection-info svelte-1wvon5f"><!></div> <div class="control-buttons svelte-1wvon5f"><!> <button class="control-btn svelte-1wvon5f">Select All Valid</button> <button class="control-btn svelte-1wvon5f">Clear Selection</button></div></div> <div class="file-list svelte-1wvon5f"><!></div> <div class="import-controls svelte-1wvon5f"><button class="import-btn svelte-1wvon5f"> </button></div>',1),sc=F('<div class="file-selector svelte-1wvon5f"><!></div>'),ac=F('<div class="menu-importer svelte-1wvon5f"><h3 class="svelte-1wvon5f">Menu Import</h3> <p class="svelte-1wvon5f"><!></p> <p class="size-limit svelte-1wvon5f"></p> <!> <!></div>');function ic(e,t){vt(t,!1);const n=mn();let r=z(!1),s=z([]),a=z(new Set),l=z(!0),c=z(null),o=z([]);const u=50*1024*1024,g=typeof window<"u"&&window.electronAPI,p=!g;let x=z();Wt(async()=>{g?await m():_(l,!1)});async function m(){if(g){_(l,!0),_(c,null);try{const I=await window.electronAPI.invoke("list-menu-files");I&&I.error?(_(c,I.error),_(s,[])):Array.isArray(I)?_(s,I):(_(c,"Unexpected response format"),_(s,[]))}catch(I){console.error("Error loading files:",I),_(c,I.message),_(s,[])}finally{_(l,!1)}}}async function w(I){const k=I.target.files;if(!(!k||k.length===0)){for(const q of k){if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(q.type)){pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`File "${q.name}" has unsupported format. Please select PDF, JPG, or PNG files.`});continue}const Y=u;if(q.size>Y){const re=Math.round(Y/1048576),ie=Math.round(q.size/(1024*1024)*100)/100;pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`File "${q.name}" (${ie}MB) exceeds maximum size of ${re}MB .`});continue}const Q={file:q,name:q.name,size:Math.round(q.size/(1024*1024)*100)/100,type:q.type.split("/")[1].toUpperCase(),selected:!0,uploaded:!1};_(o,[...i(o),Q])}i(x)&&je(x,i(x).value="")}}function T(){i(x)&&i(x).click()}function N(I){_(o,i(o).filter((k,q)=>q!==I))}function B(I){if(g)i(a).has(I.path)?i(a).delete(I.path):i(a).add(I.path),_(a,i(a));else{const k=i(o).findIndex(q=>q.name===I.name);k!==-1&&(je(o,i(o)[k].selected=!i(o)[k].selected),_(o,i(o)))}}function U(){if(g){const I=i(s).filter(k=>k.sizeValid);_(a,new Set(I.map(k=>k.path)))}else _(o,i(o).map(I=>({...I,selected:!0})))}function v(){g?_(a,new Set):_(o,i(o).map(I=>({...I,selected:!1})))}function R(){return g?i(a).size:i(o).filter(I=>I.selected).length}async function S(){const I=R();if(!(i(r)||I===0))if(g){const k=Array.from(i(a));await E(k)}else{const k=i(o).filter(q=>q.selected);await H(k)}}function h(I){return`${I.type} • ${I.size}MB`}function f(I){return new Date(I).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}async function E(I){if(i(r))return;_(r,!0),n("close"),ft.set("agent");const k=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),q=Array.isArray(I)?I.length:1,te=Array.isArray(I)?I.map(Y=>Y.split("/").pop()).join(", "):I.split("/").pop();pe.addMessage({timestamp:k,type:"agent",message:`Starting menu import from ${q} file(s): ${te}

This process will:
1. Parse the menu(s) with AI
2. Clean existing data
3. Import new menu structure
4. Create optimized layouts

Please wait...`});try{const Y=await window.electronAPI.invoke("start-menu-import",I);if(Y&&!Y.success&&Y.message){pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Import failed: ${Y.message}`}),_(r,!1);return}}catch(Y){console.error("Error starting import:",Y),pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Import failed: ${Y.message}`}),_(r,!1)}}async function H(I){if(i(r)||I.length===0)return;_(r,!0),n("close"),ft.set("agent");const k=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),q=I.map(te=>te.name).join(", ");pe.addMessage({timestamp:k,type:"agent",message:`Starting menu import from ${I.length} file(s): ${q}

This process will:
1. Upload files to server
2. Parse the menu(s) with AI
3. Clean existing data
4. Import new menu structure
5. Create optimized layouts

Please wait...`});try{const te=`${window.location.protocol}//${window.location.host}`;pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Uploading ${I.length} files...`});const Y=new FormData;I.forEach((oe,ue)=>{Y.append("menuFiles",oe.file)});const Q=new XMLHttpRequest,ie=await new Promise((oe,ue)=>{Q.upload.addEventListener("progress",ae=>{if(ae.lengthComputable){const de=Math.round(ae.loaded/ae.total*100);pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Uploading files: ${de}%`})}}),Q.onload=function(){if(Q.status>=200&&Q.status<300)try{const ae=JSON.parse(Q.responseText);oe(ae)}catch{ue(new Error("Invalid response format"))}else try{const ae=JSON.parse(Q.responseText);ue(new Error(ae.message||`HTTP ${Q.status}`))}catch{ue(new Error(`HTTP ${Q.status}: ${Q.statusText}`))}},Q.onerror=function(){ue(new Error("Network error occurred"))},Q.open("POST",`${te}/api/menu/upload-and-import`),Q.send(Y)});if(!ie.success)throw new Error(ie.message||"Upload failed");pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`All files uploaded successfully. Processing ${ie.fileCount} files: ${ie.filenames.join(", ")}`}),I.forEach(oe=>{oe.uploaded=!0}),pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`✅ Menu import completed successfully!

You can now navigate back to the selection area to see your new menu items.`}),G("INFO","Refreshing categories after successful menu import"),le.send({command:"getCategories"})}catch(te){console.error("Error uploading and importing files:",te),pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Import failed: ${te.message}`})}finally{_(r,!1)}}typeof window<"u"&&window.electronAPI&&window.electronAPI.onImportProgress&&(window.electronAPI.onImportProgress(I=>{const k=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});pe.addMessage({timestamp:k,type:"agent",message:I})}),window.electronAPI.onImportComplete((I,k)=>{const q=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});I&&(G("INFO","Refreshing categories after successful menu import"),le.send({command:"getCategories"})),pe.addMessage({timestamp:q,type:"agent",message:I?`✅ Import completed successfully!

${k}

You can now navigate back to the selection area to see your new menu items.`:`❌ Import failed: ${k}`}),_(r,!1)})),wt();var P=ac(),J=y(d(P),2),A=d(J);{var $=I=>{var k=Pt("Select one or more menu files from the menu_inputs directory");C(I,k)},W=I=>{var k=Pt("Upload and import menu files (PDF, JPG, PNG)");C(I,k)};K(A,I=>{g?I($):I(W,!1)})}var j=y(J,2);j.textContent="Max file size: 50MB";var L=y(j,2);{var be=I=>{var k=zl();en(k,q=>_(x,q),()=>i(x)),X("change",k,w),C(I,k)};K(L,I=>{p&&I(be)})}var Se=y(L,2);{var Ne=I=>{var k=Vl();C(I,k)},ee=I=>{var k=qe(),q=Ce(k);{var te=Q=>{var re=Gl();C(Q,re)},Y=Q=>{var re=qe(),ie=Ce(re);{var oe=ae=>{var de=Wl(),ve=d(de),we=d(ve),Ie=y(ve,2);ne(()=>Z(we,`Error loading files: ${i(c)??""}`)),X("click",Ie,m),C(ae,de)},ue=ae=>{var de=sc(),ve=d(de);{var we=Ee=>{var Te=Hl(),me=d(Te),he=y(d(me),2);X("click",he,T),C(Ee,Te)},Ie=Ee=>{var Te=qe(),me=Ce(Te);{var he=O=>{var M=Jl();C(O,M)},_e=O=>{var M=rc(),se=Ce(M),ge=d(se),ze=d(ge);{var gt=$e=>{var He=Kl(),at=d(He);ne(()=>Z(at,`${i(a).size??""} of ${i(s).length??""} files selected`)),C($e,He)},nt=$e=>{var He=Yl(),at=d(He);ne(Ke=>Z(at,`${Ke??""} of ${i(o).length??""} files selected`),[()=>i(o).filter(Ke=>Ke.selected).length]),C($e,He)};K(ze,$e=>{g?$e(gt):$e(nt,!1)})}var ct=y(ge,2),Ve=d(ct);{var rt=$e=>{var He=Xl();X("click",He,T),C($e,He)};K(Ve,$e=>{p&&$e(rt)})}var st=y(Ve,2),ut=y(st,2),We=y(se,2),Re=d(We);{var Be=$e=>{var He=qe(),at=Ce(He);Mt(at,1,()=>i(s),Ke=>Ke.path,(Ke,Ue)=>{var Ft=Zl();let At;var Kt=d(Ft),Tt=d(Kt),b=y(Tt,2),V=d(b),xe=d(V),fe=y(V,2),Ae=d(fe),Fe=d(Ae),Pe=y(Ae,2),Qe=d(Pe),jt=y(fe,2);{var Ct=Et=>{var it=Ql();it.textContent="File too large (max 50MB)",C(Et,it)};K(jt,Et=>{i(Ue).sizeValid||Et(Ct)})}ne((Et,it,rn,hr)=>{At=Xe(Ft,1,"file-item svelte-1wvon5f",null,At,Et),Tt.disabled=!i(Ue).sizeValid,vs(Tt,it),Z(xe,i(Ue).name),Z(Fe,rn),Z(Qe,`Modified: ${hr??""}`)},[()=>({invalid:!i(Ue).sizeValid,selected:i(a).has(i(Ue).path)}),()=>i(a).has(i(Ue).path),()=>h(i(Ue)),()=>f(i(Ue).lastModified)]),X("change",Tt,()=>B(i(Ue))),C(Ke,Ft)}),C($e,He)},Ge=$e=>{var He=qe(),at=Ce(He);Mt(at,3,()=>i(o),Ke=>Ke.name,(Ke,Ue,Ft)=>{var At=nc();let Kt;var Tt=d(At),b=d(Tt),V=y(b,2),xe=d(V),fe=d(xe),Ae=y(xe,2),Fe=d(Ae),Pe=d(Fe),Qe=y(Fe,2);{var jt=it=>{var rn=ec();C(it,rn)},Ct=it=>{var rn=tc();C(it,rn)};K(Qe,it=>{i(Ue).uploaded?it(jt):it(Ct,!1)})}var Et=y(Tt,2);ne(it=>{Kt=Xe(At,1,"file-item svelte-1wvon5f",null,Kt,it),vs(b,i(Ue).selected),Z(fe,i(Ue).name),Z(Pe,`${i(Ue).type??""} • ${i(Ue).size??""}MB`)},[()=>({selected:i(Ue).selected,uploaded:i(Ue).uploaded})]),X("change",b,()=>B(i(Ue))),X("click",Et,()=>N(i(Ft))),C(Ke,At)}),C($e,He)};K(Re,$e=>{g?$e(Be):$e(Ge,!1)})}var dt=y(We,2),ht=d(dt),Ut=d(ht);ne(($e,He,at,Ke)=>{st.disabled=$e,ut.disabled=He,ht.disabled=at,Z(Ut,`Import Selected Files (${Ke??""})`)},[()=>g?i(s).every($e=>!$e.sizeValid):i(o).length===0,()=>R()===0,()=>R()===0,R]),X("click",st,U),X("click",ut,v),X("click",ht,S),C(O,M)};K(me,O=>{g&&i(s).length===0?O(he):O(_e,!1)},!0)}C(Ee,Te)};K(ve,Ee=>{p&&i(o).length===0?Ee(we):Ee(Ie,!1)})}C(ae,de)};K(ie,ae=>{g&&i(c)?ae(oe):ae(ue,!1)},!0)}C(Q,re)};K(q,Q=>{g&&i(l)?Q(te):Q(Y,!1)},!0)}C(I,k)};K(Se,I=>{i(r)?I(Ne):I(ee,!1)})}C(e,P),pt()}var oc=F('<button class="download-btn svelte-1dlpwa7">📥 Download Export</button> <button class="reset-btn svelte-1dlpwa7">🔄 New Export</button>',1),lc=F('<button class="cancel-btn svelte-1dlpwa7">❌ Cancel</button>'),cc=F('<button class="export-btn svelte-1dlpwa7" disabled><!></button> <!>',1),uc=F('<button class="export-btn svelte-1dlpwa7">🚀 Generate Export</button>'),dc=F('<div class="error-message svelte-1dlpwa7"> <button class="retry-btn svelte-1dlpwa7">Try Again</button></div>'),fc=F('<div class="job-info svelte-1dlpwa7"><small> </small></div>'),vc=F('<div class="dsfinvk-exporter svelte-1dlpwa7"><h3 class="svelte-1dlpwa7">DSFinV-K Export</h3> <div class="date-range-picker svelte-1dlpwa7"><div class="date-input svelte-1dlpwa7"><label for="dsfinvk-start" class="svelte-1dlpwa7">Start Date:</label> <input type="date" id="dsfinvk-start" class="svelte-1dlpwa7"/></div> <div class="date-input svelte-1dlpwa7"><label for="dsfinvk-end" class="svelte-1dlpwa7">End Date:</label> <input type="date" id="dsfinvk-end" class="svelte-1dlpwa7"/></div></div> <div class="export-actions svelte-1dlpwa7"><!></div> <!> <!></div>');function pc(e,t){vt(t,!1);let n=z(new Date().toISOString().split("T")[0]),r=z(new Date().toISOString().split("T")[0]),s=z(!1),a=z(null),l=z(null),c=z(null),o=null,u=z(null);const g=typeof window<"u"&&window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1";async function p(){_(s,!0),_(a,null),_(c,null),_(u,null),pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`🚀 Starting DSFinV-K export for period ${i(n)} to ${i(r)}...`,style:"info"});try{g?await m():await x()}catch(j){pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`❌ DSFinV-K export failed: ${j.message}`,style:"error"}),_(a,"failed"),_(u,j.message)}finally{g||_(s,!1)}}async function x(){try{const j=await fetch("/api/export/dsfinvk/start",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({startDate:i(n),endDate:i(r)})});if(j.ok&&j.headers.get("content-type")?.includes("application/zip")){const L=await j.blob(),be=window.URL.createObjectURL(L),Se=`dsfinvk-export-${i(n)}-to-${i(r)}.zip`,Ne=document.createElement("a");Ne.href=be,Ne.download=Se,document.body.appendChild(Ne),Ne.click(),document.body.removeChild(Ne),window.URL.revokeObjectURL(be),pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`✅ DSFinV-K export complete! File downloaded as ${Se}`,style:"success"}),_(a,"complete")}else{const L=await j.json();if(!L.success)throw new Error(L.error||"Export failed")}}catch{const L=await le.send({command:"generateDsfinvkExport",payload:{startDate:i(n),endDate:i(r)}});if(L.status==="success"&&L.payload.success)pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`✅ DSFinV-K export complete! File available at: ${L.payload.path}`,style:"success"}),_(a,"complete");else throw new Error(L.payload?.message||L.error||"Unknown export error")}}async function m(){const L=await(await fetch("/api/export/dsfinvk/start",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({startDate:i(n),endDate:i(r)})})).json();if(!L.success)throw new Error(L.error||"Failed to start export job");_(l,L.jobId),_(a,L.status),pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`📊 Export job started (Job ID: ${i(l)}). Generating report...`,style:"info"}),w()}function w(){o&&clearInterval(o),o=setInterval(async()=>{try{const L=await(await fetch(`/api/export/dsfinvk/status/${i(l)}`,{credentials:"include"})).json();if(!L.success)throw new Error(L.error||"Failed to check job status");_(a,L.status.toLowerCase()),i(a)==="complete"?(clearInterval(o),o=null,_(c,L.downloadUrl),_(s,!1),pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"✅ DSFinV-K export complete! Ready for download.",style:"success"})):i(a)==="failed"?(clearInterval(o),o=null,_(s,!1),_(u,L.error||"Export job failed"),pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`❌ DSFinV-K export failed: ${i(u)}`,style:"error"})):i(a)==="processing"&&pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"⚙️ Export job is processing...",style:"info"})}catch(j){console.error("Error polling job status:",j),pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`⚠️ Error checking export status: ${j.message}`,style:"warning"})}},3e3)}function T(){i(c)&&(window.open(i(c),"_blank"),pe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"📥 Download initiated for DSFinV-K export.",style:"success"}))}function N(){o&&(clearInterval(o),o=null),_(s,!1),_(a,null),_(l,null),_(c,null),_(u,null)}Qr(()=>{o&&clearInterval(o)}),wt();var B=vc(),U=y(d(B),2),v=d(U),R=y(d(v),2),S=y(v,2),h=y(d(S),2),f=y(U,2),E=d(f);{var H=j=>{var L=oc(),be=Ce(L),Se=y(be,2);X("click",be,T),X("click",Se,N),C(j,L)},P=j=>{var L=qe(),be=Ce(L);{var Se=ee=>{var I=cc(),k=Ce(I),q=d(k);{var te=ie=>{var oe=Pt("⏳ Queued...");C(ie,oe)},Y=ie=>{var oe=qe(),ue=Ce(oe);{var ae=ve=>{var we=Pt("⚙️ Processing...");C(ve,we)},de=ve=>{var we=Pt("🔄 Generating...");C(ve,we)};K(ue,ve=>{i(a)==="processing"?ve(ae):ve(de,!1)},!0)}C(ie,oe)};K(q,ie=>{i(a)==="pending"?ie(te):ie(Y,!1)})}var Q=y(k,2);{var re=ie=>{var oe=lc();X("click",oe,N),C(ie,oe)};K(Q,ie=>{g&&ie(re)})}C(ee,I)},Ne=ee=>{var I=uc();X("click",I,p),C(ee,I)};K(be,ee=>{i(s)||i(a)==="pending"||i(a)==="processing"?ee(Se):ee(Ne,!1)},!0)}C(j,L)};K(E,j=>{i(a)==="complete"&&i(c)?j(H):j(P,!1)})}var J=y(f,2);{var A=j=>{var L=dc(),be=d(L),Se=y(be);ne(()=>Z(be,`❌ Export failed: ${i(u)??""} `)),X("click",Se,N),C(j,L)};K(J,j=>{i(a)==="failed"&&i(u)&&j(A)})}var $=y(J,2);{var W=j=>{var L=fc(),be=d(L),Se=d(be);ne(()=>Z(Se,`Job ID: ${i(l)??""}`)),C(j,L)};K($,j=>{g&&i(l)&&j(W)})}ne(()=>{R.disabled=i(s),h.disabled=i(s)}),qt(R,()=>i(n),j=>_(n,j)),qt(h,()=>i(r),j=>_(r,j)),C(e,B),pt()}var mc=F('<div class="control-center-overlay svelte-mpduov"><div class="control-center-panel svelte-mpduov"><div class="panel-header svelte-mpduov"><h2 class="svelte-mpduov">Control Center</h2> <button class="close-btn svelte-mpduov">×</button></div> <div class="panel-content svelte-mpduov"><div class="section svelte-mpduov"><h3 class="svelte-mpduov">System Time</h3> <div class="time-display svelte-mpduov"> </div> <p class="time-description svelte-mpduov">Current system time. Time synchronization is managed automatically.</p></div> <div class="section svelte-mpduov"><h3 class="svelte-mpduov">Language & Region</h3> <div class="locale-settings svelte-mpduov"><label for="locale-select" class="locale-label svelte-mpduov">Display Locale:</label> <select id="locale-select" class="locale-select svelte-mpduov"><option class="svelte-mpduov">Deutsch (Deutschland)</option><option class="svelte-mpduov">English (United States)</option><option class="svelte-mpduov">English (United Kingdom)</option></select></div> <p class="locale-description svelte-mpduov">Changes how numbers, currencies, and dates are displayed in the interface.</p></div> <div class="section svelte-mpduov"><!></div> <div class="section svelte-mpduov"><!></div> <div class="section svelte-mpduov"><h3 class="svelte-mpduov">System Information</h3> <div class="system-info svelte-mpduov"><div class="info-item svelte-mpduov"><span class="label svelte-mpduov">Status:</span> <span class="value connected svelte-mpduov">Connected</span></div> <div class="info-item svelte-mpduov"><span class="label svelte-mpduov">Mode:</span> <span class="value svelte-mpduov">Development</span></div></div></div></div></div></div>');function gc(e,t){vt(t,!1);const[n,r]=Hn(),s=()=>et(Zr,"$controlCenterVisible",n),a=()=>et(Ir,"$currentTime",n),l=()=>et(Mn,"$localeStore",n);mn();function c(){Go()}function o(T){return T.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}function u(){c()}function g(T){const N=T.target.value;no(N)}function p(T){T.key==="Escape"&&c()}wt();var x=qe();X("keydown",jn,p);var m=Ce(x);{var w=T=>{var N=mc(),B=d(N),U=d(B),v=y(d(U),2),R=y(U,2),S=d(R),h=y(d(S),2),f=d(h),E=y(S,2),H=y(d(E),2),P=y(d(H),2);ne(()=>{l(),Js(()=>{})});var J=d(P);J.value=J.__value="de-DE";var A=y(J);A.value=A.__value="en-US";var $=y(A);$.value=$.__value="en-GB";var W=y(E,2),j=d(W);ic(j,{$$events:{close:u}});var L=y(W,2),be=d(L);pc(be,{}),ne(Se=>Z(f,Se),[()=>o(a())]),X("click",v,c),ra(P,l,Se=>Oi(Mn,Se)),X("change",P,g),X("click",N,Ai(c)),C(T,N)};K(m,T=>{s()&&T(w)})}C(e,x),pt(),r()}var hc=F('<main class="pos-grid svelte-1ji6e50"><div class="grid-item-display svelte-1ji6e50"><!></div> <div class="grid-selection-area svelte-1ji6e50"><!></div></main> <!>',1);function _c(e,t){vt(t,!1);let n=z(),r=z(!1);Wt(async()=>{await un.checkSession();const m=le.subscribe(w=>{w.lastMessage?.command==="sessionEstablished"&&(console.log("Demo mode: Received session established message"),un.establishSession(w.lastMessage.payload))});return typeof window<"u"&&window.electronAPI&&window.electronAPI.onUiRefreshRequest&&window.electronAPI.onUiRefreshRequest(()=>{console.log("UI refresh requested - switching to selection view and refreshing data"),G("INFO","UI refresh requested after menu import"),ft.set("selection"),le.send({command:"getCategories"}),setTimeout(()=>{window.location.reload()},1e3)}),()=>{m()}});function s(m){_(r,m.detail)}function a(){i(n)&&typeof i(n).getIsAtBottom=="function"&&(i(n).getIsAtBottom()&&typeof i(n).cycleViews=="function"?i(n).cycleViews():typeof i(n).scrollToBottom=="function"&&i(n).scrollToBottom())}wt();var l=hc(),c=Ce(l),o=d(c),u=d(o);en(zo(u,{$$events:{scrollstate:s},$$legacy:!0}),m=>_(n,m),()=>i(n));var g=y(o,2),p=d(g);ql(p,{handleSmartAction:a,get isAtBottom(){return i(r)},get consoleViewComponent(){return i(n)}});var x=y(c,2);gc(x,{}),C(e,l),pt()}window.onerror=function(e,t,n,r,s){return G("ERROR","Unhandled Frontend Exception",{type:"window.onerror",message:e,source:t,lineno:n,colno:r,error:s?s.stack:"N/A"}),!0};window.addEventListener("unhandledrejection",e=>{G("ERROR","Unhandled Promise Rejection",{type:"unhandledrejection",reason:e.reason?e.reason.message||e.reason:"No reason provided",stack:e.reason?e.reason.stack:"N/A"})});pi(_c,{target:document.getElementById("app")});
