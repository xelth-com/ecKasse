(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();const Es=!1;var Ir=Array.isArray,qi=Array.prototype.indexOf,Ta=Array.from,jr=Object.defineProperty,an=Object.getOwnPropertyDescriptor,Is=Object.getOwnPropertyDescriptors,Vi=Object.prototype,Hi=Array.prototype,ka=Object.getPrototypeOf,ts=Object.isExtensible;function _r(e){return typeof e=="function"}const _n=()=>{};function Wi(e){return e()}function zr(e){for(var n=0;n<e.length;n++)e[n]()}function Zi(){var e,n,r=new Promise((s,a)=>{e=s,n=a});return{promise:r,resolve:e,reject:n}}const Nt=2,Ea=4,Kr=8,Mr=16,cn=32,Ln=64,Ms=128,Bt=256,Gr=512,pt=1024,Ut=2048,un=4096,zt=8192,Rn=16384,Ia=32768,Yr=65536,ns=1<<17,Ji=1<<18,Ma=1<<19,Aa=1<<20,ya=1<<21,$a=1<<22,En=1<<23,Kt=Symbol("$state"),As=Symbol("legacy props"),La=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Ki(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function Qr(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Yi(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Qi(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Xi(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function eo(e){throw new Error("https://svelte.dev/e/effect_orphan")}function to(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function no(e){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function ro(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function ao(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function so(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function io(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const Xr=1,ea=2,$s=4,oo=8,lo=16,co=2,uo=4,fo=8,vo=1,po=2,ft=Symbol(),go="http://www.w3.org/1999/xhtml";function mo(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let ho=!1;function Ls(e){return e===this.v}function Rs(e,n){return e!=e?n==n:e!==n||e!==null&&typeof e=="object"||typeof e=="function"}function Os(e){return!Rs(e,this.v)}let cr=!1,yo=!1;function _o(){cr=!0}let We=null;function qr(e){We=e}function Et(e,n=!1,r){We={p:We,c:null,e:null,s:e,x:null,l:cr&&!n?{s:null,u:null,$:[]}:null}}function It(e){var n=We,r=n.e;if(r!==null){n.e=null;for(var s of r)Hs(s)}return e!==void 0&&(n.x=e),We=n.p,e??{}}function ur(){return!cr||We!==null&&We.l===null}const bo=new WeakMap;function wo(e){var n=Re;if(n===null)return De.f|=En,e;if((n.f&Ia)===0){if((n.f&Ms)===0)throw!n.parent&&e instanceof Error&&Ns(e),e;n.b.error(e)}else Ra(e,n)}function Ra(e,n){for(;n!==null;){if((n.f&Ms)!==0)try{n.b.error(e);return}catch(r){e=r}n=n.parent}throw e instanceof Error&&Ns(e),e}function Ns(e){const n=bo.get(e);n&&(jr(e,"message",{value:n.message}),jr(e,"stack",{value:n.stack}))}let Vr=[];function Co(){var e=Vr;Vr=[],zr(e)}function Oa(e){Vr.length===0&&queueMicrotask(Co),Vr.push(e)}function xo(){for(var e=Re.b;e!==null&&!e.has_pending_snippet();)e=e.parent;return e===null&&Ki(),e}function Na(e){var n=Nt|Ut,r=De!==null&&(De.f&Nt)!==0?De:null;return Re===null||r!==null&&(r.f&Bt)!==0?n|=Bt:Re.f|=Ma,{ctx:We,deps:null,effects:null,equals:Ls,f:n,fn:e,reactions:null,rv:0,v:ft,wv:0,parent:r??Re,ac:null}}function So(e,n){let r=Re;r===null&&Yi();var s=r.b,a=void 0,i=Sr(ft),l=null,u=!De;return Do(()=>{try{var o=e()}catch(_){o=Promise.reject(_)}var c=()=>o;a=l?.then(c,c)??Promise.resolve(o),l=a;var v=qe,f=s.pending;u&&(s.update_pending_count(1),f||v.increment());const x=(_,C=void 0)=>{l=null,f||v.activate(),C?C!==La&&(i.f|=En,sr(i,C)):((i.f&En)!==0&&(i.f^=En),sr(i,_)),u&&(s.update_pending_count(-1),f||v.decrement()),Bs()};if(a.then(x,_=>x(null,_||"unknown")),v)return()=>{queueMicrotask(()=>v.neuter())}}),new Promise(o=>{function c(v){function f(){v===a?o(i):c(a)}v.then(f,f)}c(a)})}function ot(e){const n=Na(e);return n.equals=Os,n}function Ps(e){var n=e.effects;if(n!==null){e.effects=null;for(var r=0;r<n.length;r+=1)on(n[r])}}function To(e){for(var n=e.parent;n!==null;){if((n.f&Nt)===0)return n;n=n.parent}return null}function Pa(e){var n,r=Re;Cn(To(e));try{Ps(e),n=ri(e)}finally{Cn(r)}return n}function Ds(e){var n=Pa(e);if(e.equals(n)||(e.v=n,e.wv=ti()),!Nn)if(rr!==null)rr.set(e,e.v);else{var r=(yn||(e.f&Bt)!==0)&&e.deps!==null?un:pt;Tt(e,r)}}function ko(e,n,r){const s=ur()?Na:ot;if(n.length===0){r(e.map(s));return}var a=qe,i=Re,l=Eo(),u=xo();Promise.all(n.map(o=>So(o))).then(o=>{a?.activate(),l();try{r([...e.map(s),...o])}catch(c){(i.f&Rn)===0&&Ra(c,i)}a?.deactivate(),Bs()}).catch(o=>{u.error(o)})}function Eo(){var e=Re,n=De,r=We;return function(){Cn(e),Qt(n),qr(r)}}function Bs(){Cn(null),Qt(null),qr(null)}const br=new Set;let qe=null,Fr=null,rr=null,rs=new Set,Hr=[];function Us(){const e=Hr.shift();Hr.length>0&&queueMicrotask(Us),e()}let xr=[],Da=null,_a=!1;class ar{current=new Map;#e=new Map;#n=new Set;#t=0;#a=null;#u=!1;#s=[];#o=[];#i=[];#r=[];#l=[];#d=[];#f=[];skipped_effects=new Set;process(n){xr=[],Fr=null;var r=null;if(br.size>1){r=new Map,rr=new Map;for(const[i,l]of this.current)r.set(i,{v:i.v,wv:i.wv}),i.v=l;for(const i of br)if(i!==this)for(const[l,u]of i.#e)r.has(l)||(r.set(l,{v:l.v,wv:l.wv}),l.v=u)}for(const i of n)this.#p(i);if(this.#s.length===0&&this.#t===0){this.#v();var s=this.#i,a=this.#r;this.#i=[],this.#r=[],this.#l=[],Fr=qe,qe=null,as(s),as(a),qe===null?qe=this:br.delete(this),this.#a?.resolve()}else this.#c(this.#i),this.#c(this.#r),this.#c(this.#l);if(r){for(const[i,{v:l,wv:u}]of r)i.wv<=u&&(i.v=l);rr=null}for(const i of this.#s)tr(i);for(const i of this.#o)tr(i);this.#s=[],this.#o=[]}#p(n){n.f^=pt;for(var r=n.first;r!==null;){var s=r.f,a=(s&(cn|Ln))!==0,i=a&&(s&pt)!==0,l=i||(s&zt)!==0||this.skipped_effects.has(r);if(!l&&r.fn!==null){if(a)r.f^=pt;else if((s&pt)===0)if((s&Ea)!==0)this.#r.push(r);else if((s&$a)!==0){var u=r.b?.pending?this.#o:this.#s;u.push(r)}else Ar(r)&&((r.f&Mr)!==0&&this.#l.push(r),tr(r));var o=r.first;if(o!==null){r=o;continue}}var c=r.parent;for(r=r.next;r===null&&c!==null;)r=c.next,c=c.parent}}#c(n){for(const r of n)((r.f&Ut)!==0?this.#d:this.#f).push(r),Tt(r,pt);n.length=0}capture(n,r){this.#e.has(n)||this.#e.set(n,r),this.current.set(n,n.v)}activate(){qe=this}deactivate(){qe=null,Fr=null;for(const n of rs)if(rs.delete(n),n(),qe!==null)break}neuter(){this.#u=!0}flush(){xr.length>0?Io():this.#v(),qe===this&&(this.#t===0&&br.delete(this),this.deactivate())}#v(){if(!this.#u)for(const n of this.#n)n();this.#n.clear()}increment(){this.#t+=1}decrement(){if(this.#t-=1,this.#t===0){for(const n of this.#d)Tt(n,Ut),An(n);for(const n of this.#f)Tt(n,un),An(n);this.#i=[],this.#r=[],this.flush()}else this.deactivate()}add_callback(n){this.#n.add(n)}settled(){return(this.#a??=Zi()).promise}static ensure(){if(qe===null){const n=qe=new ar;br.add(qe),ar.enqueue(()=>{qe===n&&n.flush()})}return qe}static enqueue(n){Hr.length===0&&queueMicrotask(Us),Hr.unshift(n)}}function Io(){var e=er;_a=!0;try{var n=0;for(os(!0);xr.length>0;){var r=ar.ensure();if(n++>1e3){var s,a;Mo()}r.process(xr),In.clear()}}finally{_a=!1,os(e),Da=null}}function Mo(){try{to()}catch(e){Ra(e,Da)}}function as(e){var n=e.length;if(n!==0){for(var r=0;r<n;){var s=e[r++];if((s.f&(Rn|zt))===0&&Ar(s)){var a=qe?qe.current.size:0;if(tr(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null&&s.ac===null?Ks(s):s.fn=null),qe!==null&&qe.current.size>a&&(s.f&Aa)!==0)break}}for(;r<n;)An(e[r++])}}function An(e){for(var n=Da=e;n.parent!==null;){n=n.parent;var r=n.f;if(_a&&n===Re&&(r&Mr)!==0)return;if((r&(Ln|cn))!==0){if((r&pt)===0)return;n.f^=pt}}xr.push(n)}const In=new Map;function Sr(e,n){var r={f:0,v:e,reactions:null,equals:Ls,rv:0,wv:0};return r}function hn(e,n){const r=Sr(e);return Fo(r),r}function G(e,n=!1,r=!0){const s=Sr(e);return n||(s.equals=Os),cr&&r&&We!==null&&We.l!==null&&(We.l.s??=[]).push(s),s}function Qe(e,n){return y(e,T(()=>t(e))),n}function y(e,n,r=!1){De!==null&&(!Zt||(De.f&ns)!==0)&&ur()&&(De.f&(Nt|Mr|$a|ns))!==0&&!sn?.includes(e)&&io();let s=r?Qn(n):n;return sr(e,s)}function sr(e,n){if(!e.equals(n)){var r=e.v;Nn?In.set(e,n):In.set(e,r),e.v=n;var s=ar.ensure();s.capture(e,r),(e.f&Nt)!==0&&((e.f&Ut)!==0&&Pa(e),Tt(e,(e.f&Bt)===0?pt:un)),e.wv=ti(),Fs(e,Ut),ur()&&Re!==null&&(Re.f&pt)!==0&&(Re.f&(cn|Ln))===0&&(Dt===null?jo([e]):Dt.push(e))}return n}function fa(e){y(e,e.v+1)}function Fs(e,n){var r=e.reactions;if(r!==null)for(var s=ur(),a=r.length,i=0;i<a;i++){var l=r[i],u=l.f;if(!(!s&&l===Re)){var o=(u&Ut)===0;o&&Tt(l,n),(u&Nt)!==0?Fs(l,un):o&&An(l)}}}function Qn(e){if(typeof e!="object"||e===null||Kt in e)return e;const n=ka(e);if(n!==Vi&&n!==Hi)return e;var r=new Map,s=Ir(e),a=hn(0),i=Mn,l=u=>{if(Mn===i)return u();var o=De,c=Mn;Qt(null),cs(i);var v=u();return Qt(o),cs(c),v};return s&&r.set("length",hn(e.length)),new Proxy(e,{defineProperty(u,o,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&ao();var v=r.get(o);return v===void 0?v=l(()=>{var f=hn(c.value);return r.set(o,f),f}):y(v,c.value,!0),!0},deleteProperty(u,o){var c=r.get(o);if(c===void 0){if(o in u){const v=l(()=>hn(ft));r.set(o,v),fa(a)}}else y(c,ft),fa(a);return!0},get(u,o,c){if(o===Kt)return e;var v=r.get(o),f=o in u;if(v===void 0&&(!f||an(u,o)?.writable)&&(v=l(()=>{var _=Qn(f?u[o]:ft),C=hn(_);return C}),r.set(o,v)),v!==void 0){var x=t(v);return x===ft?void 0:x}return Reflect.get(u,o,c)},getOwnPropertyDescriptor(u,o){var c=Reflect.getOwnPropertyDescriptor(u,o);if(c&&"value"in c){var v=r.get(o);v&&(c.value=t(v))}else if(c===void 0){var f=r.get(o),x=f?.v;if(f!==void 0&&x!==ft)return{enumerable:!0,configurable:!0,value:x,writable:!0}}return c},has(u,o){if(o===Kt)return!0;var c=r.get(o),v=c!==void 0&&c.v!==ft||Reflect.has(u,o);if(c!==void 0||Re!==null&&(!v||an(u,o)?.writable)){c===void 0&&(c=l(()=>{var x=v?Qn(u[o]):ft,_=hn(x);return _}),r.set(o,c));var f=t(c);if(f===ft)return!1}return v},set(u,o,c,v){var f=r.get(o),x=o in u;if(s&&o==="length")for(var _=c;_<f.v;_+=1){var C=r.get(_+"");C!==void 0?y(C,ft):_ in u&&(C=l(()=>hn(ft)),r.set(_+"",C))}if(f===void 0)(!x||an(u,o)?.writable)&&(f=l(()=>hn(void 0)),y(f,Qn(c)),r.set(o,f));else{x=f.v!==ft;var S=l(()=>Qn(c));y(f,S)}var O=Reflect.getOwnPropertyDescriptor(u,o);if(O?.set&&O.set.call(v,c),!x){if(s&&typeof o=="string"){var j=r.get("length"),Z=Number(o);Number.isInteger(Z)&&Z>=j.v&&y(j,Z+1)}fa(a)}return!0},ownKeys(u){t(a);var o=Reflect.ownKeys(u).filter(f=>{var x=r.get(f);return x===void 0||x.v!==ft});for(var[c,v]of r)v.v!==ft&&!(c in u)&&o.push(c);return o},setPrototypeOf(){so()}})}function ss(e){try{if(e!==null&&typeof e=="object"&&Kt in e)return e[Kt]}catch{}return e}function Ao(e,n){return Object.is(ss(e),ss(n))}var Tr,js,zs,Gs;function $o(){if(Tr===void 0){Tr=window,js=/Firefox/.test(navigator.userAgent);var e=Element.prototype,n=Node.prototype,r=Text.prototype;zs=an(n,"firstChild").get,Gs=an(n,"nextSibling").get,ts(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),ts(r)&&(r.__t=void 0)}}function On(e=""){return document.createTextNode(e)}function Jt(e){return zs.call(e)}function ta(e){return Gs.call(e)}function p(e,n){return Jt(e)}function Se(e,n){{var r=Jt(e);return r instanceof Comment&&r.data===""?ta(r):r}}function w(e,n=1,r=!1){let s=e;for(;n--;)s=ta(s);return s}function Lo(e){e.textContent=""}function Ba(){return!1}let is=!1;function Ro(){is||(is=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const n of e.target.elements)n.__on_r?.()})},{capture:!0}))}function na(e){var n=De,r=Re;Qt(null),Cn(null);try{return e()}finally{Qt(n),Cn(r)}}function qs(e,n,r,s=r){e.addEventListener(n,()=>na(r));const a=e.__on_r;a?e.__on_r=()=>{a(),s(!0)}:e.__on_r=()=>s(!0),Ro()}function Vs(e){Re===null&&De===null&&eo(),De!==null&&(De.f&Bt)!==0&&Re===null&&Xi(),Nn&&Qi()}function Oo(e,n){var r=n.last;r===null?n.last=n.first=e:(r.next=e,e.prev=r,n.last=e)}function Xt(e,n,r,s=!0){var a=Re;a!==null&&(a.f&zt)!==0&&(e|=zt);var i={ctx:We,deps:null,nodes_start:null,nodes_end:null,f:e|Ut,first:null,fn:n,last:null,next:null,parent:a,b:a&&a.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{tr(i),i.f|=Ia}catch(o){throw on(i),o}else n!==null&&An(i);var l=r&&i.deps===null&&i.first===null&&i.nodes_start===null&&i.teardown===null&&(i.f&Ma)===0;if(!l&&s&&(a!==null&&Oo(i,a),De!==null&&(De.f&Nt)!==0&&(e&Ln)===0)){var u=De;(u.effects??=[]).push(i)}return i}function ra(e){const n=Xt(Kr,null,!1);return Tt(n,pt),n.teardown=e,n}function ba(e){Vs();var n=Re.f,r=!De&&(n&cn)!==0&&(n&Ia)===0;if(r){var s=We;(s.e??=[]).push(e)}else return Hs(e)}function Hs(e){return Xt(Ea|Aa,e,!1)}function No(e){return Vs(),Xt(Kr|Aa,e,!0)}function Po(e){ar.ensure();const n=Xt(Ln,e,!0);return(r={})=>new Promise(s=>{r.outro?sa(n,()=>{on(n),s(void 0)}):(on(n),s(void 0))})}function Ua(e){return Xt(Ea,e,!1)}function Ge(e,n){var r=We,s={effect:null,ran:!1,deps:e};r.l.$.push(s),s.effect=aa(()=>{e(),!s.ran&&(s.ran=!0,T(n))})}function xn(){var e=We;aa(()=>{for(var n of e.l.$){n.deps();var r=n.effect;(r.f&pt)!==0&&Tt(r,un),Ar(r)&&tr(r),n.ran=!1}})}function Do(e){return Xt($a|Ma,e,!0)}function aa(e,n=0){return Xt(Kr|n,e,!0)}function ce(e,n=[],r=[]){ko(n,r,s=>{Xt(Kr,()=>e(...s.map(t)),!0)})}function Fa(e,n=0){var r=Xt(Mr|n,e,!0);return r}function ir(e,n=!0){return Xt(cn,e,!0,n)}function Ws(e){var n=e.teardown;if(n!==null){const r=Nn,s=De;ls(!0),Qt(null);try{n.call(null)}finally{ls(r),Qt(s)}}}function Zs(e,n=!1){var r=e.first;for(e.first=e.last=null;r!==null;){const a=r.ac;a!==null&&na(()=>{a.abort(La)});var s=r.next;(r.f&Ln)!==0?r.parent=null:on(r,n),r=s}}function Bo(e){for(var n=e.first;n!==null;){var r=n.next;(n.f&cn)===0&&on(n),n=r}}function on(e,n=!0){var r=!1;(n||(e.f&Ji)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Js(e.nodes_start,e.nodes_end),r=!0),Zs(e,n&&!r),Wr(e,0),Tt(e,Rn);var s=e.transitions;if(s!==null)for(const i of s)i.stop();Ws(e);var a=e.parent;a!==null&&a.first!==null&&Ks(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Js(e,n){for(;e!==null;){var r=e===n?null:ta(e);e.remove(),e=r}}function Ks(e){var n=e.parent,r=e.prev,s=e.next;r!==null&&(r.next=s),s!==null&&(s.prev=r),n!==null&&(n.first===e&&(n.first=s),n.last===e&&(n.last=r))}function sa(e,n){var r=[];ja(e,r,!0),Ys(r,()=>{on(e),n&&n()})}function Ys(e,n){var r=e.length;if(r>0){var s=()=>--r||n();for(var a of e)a.out(s)}else n()}function ja(e,n,r){if((e.f&zt)===0){if(e.f^=zt,e.transitions!==null)for(const l of e.transitions)(l.is_global||r)&&n.push(l);for(var s=e.first;s!==null;){var a=s.next,i=(s.f&Yr)!==0||(s.f&cn)!==0;ja(s,n,i?r:!1),s=a}}}function za(e){Qs(e,!0)}function Qs(e,n){if((e.f&zt)!==0){e.f^=zt,(e.f&pt)===0&&(Tt(e,Ut),An(e));for(var r=e.first;r!==null;){var s=r.next,a=(r.f&Yr)!==0||(r.f&cn)!==0;Qs(r,a?n:!1),r=s}if(e.transitions!==null)for(const i of e.transitions)(i.is_global||n)&&i.in()}}let Yn=null;function Uo(e){var n=Yn;try{if(Yn=new Set,T(e),n!==null)for(var r of Yn)n.add(r);return Yn}finally{Yn=n}}function Xs(e){for(var n of Uo(e))sr(n,n.v)}let er=!1;function os(e){er=e}let Nn=!1;function ls(e){Nn=e}let De=null,Zt=!1;function Qt(e){De=e}let Re=null;function Cn(e){Re=e}let sn=null;function Fo(e){De!==null&&(sn===null?sn=[e]:sn.push(e))}let St=null,Lt=0,Dt=null;function jo(e){Dt=e}let ei=1,kr=0,Mn=kr;function cs(e){Mn=e}let yn=!1;function ti(){return++ei}function Ar(e){var n=e.f;if((n&Ut)!==0)return!0;if((n&un)!==0){var r=e.deps,s=(n&Bt)!==0;if(r!==null){var a,i,l=(n&Gr)!==0,u=s&&Re!==null&&!yn,o=r.length;if((l||u)&&(Re===null||(Re.f&Rn)===0)){var c=e,v=c.parent;for(a=0;a<o;a++)i=r[a],(l||!i?.reactions?.includes(c))&&(i.reactions??=[]).push(c);l&&(c.f^=Gr),u&&v!==null&&(v.f&Bt)===0&&(c.f^=Bt)}for(a=0;a<o;a++)if(i=r[a],Ar(i)&&Ds(i),i.wv>e.wv)return!0}(!s||Re!==null&&!yn)&&Tt(e,pt)}return!1}function ni(e,n,r=!0){var s=e.reactions;if(s!==null&&!sn?.includes(e))for(var a=0;a<s.length;a++){var i=s[a];(i.f&Nt)!==0?ni(i,n,!1):n===i&&(r?Tt(i,Ut):(i.f&pt)!==0&&Tt(i,un),An(i))}}function ri(e){var n=St,r=Lt,s=Dt,a=De,i=yn,l=sn,u=We,o=Zt,c=Mn,v=e.f;St=null,Lt=0,Dt=null,yn=(v&Bt)!==0&&(Zt||!er||De===null),De=(v&(cn|Ln))===0?e:null,sn=null,qr(e.ctx),Zt=!1,Mn=++kr,e.ac!==null&&(na(()=>{e.ac.abort(La)}),e.ac=null);try{e.f|=ya;var f=e.fn,x=f(),_=e.deps;if(St!==null){var C;if(Wr(e,Lt),_!==null&&Lt>0)for(_.length=Lt+St.length,C=0;C<St.length;C++)_[Lt+C]=St[C];else e.deps=_=St;if(!yn||(v&Nt)!==0&&e.reactions!==null)for(C=Lt;C<_.length;C++)(_[C].reactions??=[]).push(e)}else _!==null&&Lt<_.length&&(Wr(e,Lt),_.length=Lt);if(ur()&&Dt!==null&&!Zt&&_!==null&&(e.f&(Nt|un|Ut))===0)for(C=0;C<Dt.length;C++)ni(Dt[C],e);return a!==null&&a!==e&&(kr++,Dt!==null&&(s===null?s=Dt:s.push(...Dt))),(e.f&En)!==0&&(e.f^=En),x}catch(S){return wo(S)}finally{e.f^=ya,St=n,Lt=r,Dt=s,De=a,yn=i,sn=l,qr(u),Zt=o,Mn=c}}function zo(e,n){let r=n.reactions;if(r!==null){var s=qi.call(r,e);if(s!==-1){var a=r.length-1;a===0?r=n.reactions=null:(r[s]=r[a],r.pop())}}r===null&&(n.f&Nt)!==0&&(St===null||!St.includes(n))&&(Tt(n,un),(n.f&(Bt|Gr))===0&&(n.f^=Gr),Ps(n),Wr(n,0))}function Wr(e,n){var r=e.deps;if(r!==null)for(var s=n;s<r.length;s++)zo(e,r[s])}function tr(e){var n=e.f;if((n&Rn)===0){Tt(e,pt);var r=Re,s=er;Re=e,er=!0;try{(n&Mr)!==0?Bo(e):Zs(e),Ws(e);var a=ri(e);e.teardown=typeof a=="function"?a:null,e.wv=ei;var i;Es&&yo&&(e.f&Ut)!==0&&e.deps}finally{er=s,Re=r}}}function t(e){var n=e.f,r=(n&Nt)!==0;if(Yn?.add(e),De!==null&&!Zt){var s=Re!==null&&(Re.f&Rn)!==0;if(!s&&!sn?.includes(e)){var a=De.deps;if((De.f&ya)!==0)e.rv<kr&&(e.rv=kr,St===null&&a!==null&&a[Lt]===e?Lt++:St===null?St=[e]:(!yn||!St.includes(e))&&St.push(e));else{(De.deps??=[]).push(e);var i=e.reactions;i===null?e.reactions=[De]:i.includes(De)||i.push(De)}}}else if(r&&e.deps===null&&e.effects===null){var l=e,u=l.parent;u!==null&&(u.f&Bt)===0&&(l.f^=Bt)}if(Nn){if(In.has(e))return In.get(e);if(r){l=e;var o=l.v;return((l.f&pt)===0&&l.reactions!==null||ai(l))&&(o=Pa(l)),In.set(l,o),o}}else if(r){if(l=e,rr?.has(l))return rr.get(l);Ar(l)&&Ds(l)}if((e.f&En)!==0)throw e.v;return e.v}function ai(e){if(e.v===ft)return!0;if(e.deps===null)return!1;for(const n of e.deps)if(In.has(n)||(n.f&Nt)!==0&&ai(n))return!0;return!1}function T(e){var n=Zt;try{return Zt=!0,e()}finally{Zt=n}}const Go=-7169;function Tt(e,n){e.f=e.f&Go|n}function Q(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Kt in e)wa(e);else if(!Array.isArray(e))for(let n in e){const r=e[n];typeof r=="object"&&r&&Kt in r&&wa(r)}}}function wa(e,n=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!n.has(e)){n.add(e),e instanceof Date&&e.getTime();for(let s in e)try{wa(e[s],n)}catch{}const r=ka(e);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const s=Is(r);for(let a in s){const i=s[a].get;if(i)try{i.call(e)}catch{}}}}}const qo=["touchstart","touchmove"];function Vo(e){return qo.includes(e)}const Ho=new Set,us=new Set;function Wo(e,n,r,s={}){function a(i){if(s.capture||wr.call(n,i),!i.cancelBubble)return na(()=>r?.call(this,i))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Oa(()=>{n.addEventListener(e,a,s)}):n.addEventListener(e,a,s),a}function ne(e,n,r,s,a){var i={capture:s,passive:a},l=Wo(e,n,r,i);(n===document.body||n===window||n===document||n instanceof HTMLMediaElement)&&ra(()=>{n.removeEventListener(e,l,i)})}let ds=null;function wr(e){var n=this,r=n.ownerDocument,s=e.type,a=e.composedPath?.()||[],i=a[0]||e.target;ds=e;var l=0,u=ds===e&&e.__root;if(u){var o=a.indexOf(u);if(o!==-1&&(n===document||n===window)){e.__root=n;return}var c=a.indexOf(n);if(c===-1)return;o<=c&&(l=o)}if(i=a[l]||e.target,i!==n){jr(e,"currentTarget",{configurable:!0,get(){return i||r}});var v=De,f=Re;Qt(null),Cn(null);try{for(var x,_=[];i!==null;){var C=i.assignedSlot||i.parentNode||i.host||null;try{var S=i["__"+s];if(S!=null&&(!i.disabled||e.target===i))if(Ir(S)){var[O,...j]=S;O.apply(i,[e,...j])}else S.call(i,e)}catch(Z){x?_.push(Z):x=Z}if(e.cancelBubble||C===n||C===null)break;i=C}if(x){for(let Z of _)queueMicrotask(()=>{throw Z});throw x}}finally{e.__root=n,delete e.currentTarget,Qt(v),Cn(f)}}}function Ga(e){var n=document.createElement("template");return n.innerHTML=e.replaceAll("<!>","<!---->"),n.content}function or(e,n){var r=Re;r.nodes_start===null&&(r.nodes_start=e,r.nodes_end=n)}function W(e,n){var r=(n&vo)!==0,s=(n&po)!==0,a,i=!e.startsWith("<!>");return()=>{a===void 0&&(a=Ga(i?e:"<!>"+e),r||(a=Jt(a)));var l=s||js?document.importNode(a,!0):a.cloneNode(!0);if(r){var u=Jt(l),o=l.lastChild;or(u,o)}else or(l,l);return l}}function Zo(e,n,r="svg"){var s=!e.startsWith("<!>"),a=`<${r}>${s?e:"<!>"+e}</${r}>`,i;return()=>{if(!i){var l=Ga(a),u=Jt(l);i=Jt(u)}var o=i.cloneNode(!0);return or(o,o),o}}function qa(e,n){return Zo(e,n,"svg")}function Yt(e=""){{var n=On(e+"");return or(n,n),n}}function Ue(){var e=document.createDocumentFragment(),n=document.createComment(""),r=On();return e.append(n,r),or(n,r),e}function E(e,n){e!==null&&e.before(n)}function oe(e,n){var r=n==null?"":typeof n=="object"?n+"":n;r!==(e.__t??=e.nodeValue)&&(e.__t=r,e.nodeValue=r+"")}function Jo(e,n){return Ko(e,n)}const Wn=new Map;function Ko(e,{target:n,anchor:r,props:s={},events:a,context:i,intro:l=!0}){$o();var u=new Set,o=f=>{for(var x=0;x<f.length;x++){var _=f[x];if(!u.has(_)){u.add(_);var C=Vo(_);n.addEventListener(_,wr,{passive:C});var S=Wn.get(_);S===void 0?(document.addEventListener(_,wr,{passive:C}),Wn.set(_,1)):Wn.set(_,S+1)}}};o(Ta(Ho)),us.add(o);var c=void 0,v=Po(()=>{var f=r??n.appendChild(On());return ir(()=>{if(i){Et({});var x=We;x.c=i}a&&(s.$$events=a),c=e(f,s)||{},i&&It()}),()=>{for(var x of u){n.removeEventListener(x,wr);var _=Wn.get(x);--_===0?(document.removeEventListener(x,wr),Wn.delete(x)):Wn.set(x,_)}us.delete(o),f!==r&&f.parentNode?.removeChild(f)}});return Yo.set(c,v),c}let Yo=new WeakMap;function X(e,n,r=!1){var s=e,a=null,i=null,l=ft,u=r?Yr:0,o=!1;const c=(_,C=!0)=>{o=!0,x(C,_)};var v=null;function f(){v!==null&&(v.lastChild.remove(),s.before(v),v=null);var _=l?a:i,C=l?i:a;_&&za(_),C&&sa(C,()=>{l?i=null:a=null})}const x=(_,C)=>{if(l!==(l=_)){var S=Ba(),O=s;if(S&&(v=document.createDocumentFragment(),v.append(O=On())),l?a??=C&&ir(()=>C(O)):i??=C&&ir(()=>C(O)),S){var j=qe,Z=l?a:i,m=l?i:a;Z&&j.skipped_effects.delete(Z),m&&j.skipped_effects.add(m),j.add_callback(f)}else f()}};Fa(()=>{o=!1,n(c),o||x(null,null)},u)}function Er(e,n){return n}function Qo(e,n,r){for(var s=e.items,a=[],i=n.length,l=0;l<i;l++)ja(n[l].e,a,!0);var u=i>0&&a.length===0&&r!==null;if(u){var o=r.parentNode;Lo(o),o.append(r),s.clear(),Ht(e,n[0].prev,n[i-1].next)}Ys(a,()=>{for(var c=0;c<i;c++){var v=n[c];u||(s.delete(v.k),Ht(e,v.prev,v.next)),on(v.e,!u)}})}function Ot(e,n,r,s,a,i=null){var l=e,u={flags:n,items:new Map,first:null},o=(n&$s)!==0;if(o){var c=e;l=c.appendChild(On())}var v=null,f=!1,x=new Map,_=ot(()=>{var j=r();return Ir(j)?j:j==null?[]:Ta(j)}),C,S;function O(){Xo(S,C,u,x,l,a,n,s,r),i!==null&&(C.length===0?v?za(v):v=ir(()=>i(l)):v!==null&&sa(v,()=>{v=null}))}Fa(()=>{S??=Re,C=t(_);var j=C.length;if(!(f&&j===0)){f=j===0;var Z,m,U,k;if(Ba()){var b=new Set,g=qe;for(m=0;m<j;m+=1){U=C[m],k=s(U,m);var M=u.items.get(k)??x.get(k);M?(n&(Xr|ea))!==0&&si(M,U,m,n):(Z=ii(null,u,null,null,U,k,m,a,n,r,!0),x.set(k,Z)),b.add(k)}for(const[ee,F]of u.items)b.has(ee)||g.skipped_effects.add(F.e);g.add_callback(O)}else O();t(_)}})}function Xo(e,n,r,s,a,i,l,u,o){var c=(l&oo)!==0,v=(l&(Xr|ea))!==0,f=n.length,x=r.items,_=r.first,C=_,S,O=null,j,Z=[],m=[],U,k,b,g;if(c)for(g=0;g<f;g+=1)U=n[g],k=u(U,g),b=x.get(k),b!==void 0&&(b.a?.measure(),(j??=new Set).add(b));for(g=0;g<f;g+=1){if(U=n[g],k=u(U,g),b=x.get(k),b===void 0){var M=s.get(k);if(M!==void 0){s.delete(k),x.set(k,M);var ee=O?O.next:C;Ht(r,O,M),Ht(r,M,ee),va(M,ee,a),O=M}else{var F=C?C.e.nodes_start:a;O=ii(F,r,O,O===null?r.first:O.next,U,k,g,i,l,o)}x.set(k,O),Z=[],m=[],C=O.next;continue}if(v&&si(b,U,g,l),(b.e.f&zt)!==0&&(za(b.e),c&&(b.a?.unfix(),(j??=new Set).delete(b))),b!==C){if(S!==void 0&&S.has(b)){if(Z.length<m.length){var te=m[0],J;O=te.prev;var N=Z[0],V=Z[Z.length-1];for(J=0;J<Z.length;J+=1)va(Z[J],te,a);for(J=0;J<m.length;J+=1)S.delete(m[J]);Ht(r,N.prev,V.next),Ht(r,O,N),Ht(r,V,te),C=te,O=V,g-=1,Z=[],m=[]}else S.delete(b),va(b,C,a),Ht(r,b.prev,b.next),Ht(r,b,O===null?r.first:O.next),Ht(r,O,b),O=b;continue}for(Z=[],m=[];C!==null&&C.k!==k;)(C.e.f&zt)===0&&(S??=new Set).add(C),m.push(C),C=C.next;if(C===null)continue;b=C}Z.push(b),O=b,C=b.next}if(C!==null||S!==void 0){for(var A=S===void 0?[]:Ta(S);C!==null;)(C.e.f&zt)===0&&A.push(C),C=C.next;var z=A.length;if(z>0){var Ae=(l&$s)!==0&&f===0?a:null;if(c){for(g=0;g<z;g+=1)A[g].a?.measure();for(g=0;g<z;g+=1)A[g].a?.fix()}Qo(r,A,Ae)}}c&&Oa(()=>{if(j!==void 0)for(b of j)b.a?.apply()}),e.first=r.first&&r.first.e,e.last=O&&O.e;for(var Me of s.values())on(Me.e);s.clear()}function si(e,n,r,s){(s&Xr)!==0&&sr(e.v,n),(s&ea)!==0?sr(e.i,r):e.i=r}function ii(e,n,r,s,a,i,l,u,o,c,v){var f=(o&Xr)!==0,x=(o&lo)===0,_=f?x?G(a,!1,!1):Sr(a):a,C=(o&ea)===0?l:Sr(l),S={i:C,v:_,k:i,a:null,e:null,prev:r,next:s};try{if(e===null){var O=document.createDocumentFragment();O.append(e=On())}return S.e=ir(()=>u(e,_,C,c),ho),S.e.prev=r&&r.e,S.e.next=s&&s.e,r===null?v||(n.first=S):(r.next=S,r.e.next=S.e),s!==null&&(s.prev=S,s.e.prev=S.e),S}finally{}}function va(e,n,r){for(var s=e.next?e.next.e.nodes_start:r,a=n?n.e.nodes_start:r,i=e.e.nodes_start;i!==null&&i!==s;){var l=ta(i);a.before(i),i=l}}function Ht(e,n,r){n===null?e.first=r:(n.next=r,n.e.next=r&&r.e),r!==null&&(r.prev=n,r.e.prev=n&&n.e)}function fs(e,n,r=!1,s=!1,a=!1){var i=e,l="";ce(()=>{var u=Re;if(l!==(l=n()??"")&&(u.nodes_start!==null&&(Js(u.nodes_start,u.nodes_end),u.nodes_start=u.nodes_end=null),l!=="")){var o=l+"";r?o=`<svg>${o}</svg>`:s&&(o=`<math>${o}</math>`);var c=Ga(o);if((r||s)&&(c=Jt(c)),or(Jt(c),c.lastChild),r||s)for(;Jt(c);)i.before(Jt(c));else i.before(c)}})}function el(e,n,r,s,a){var i=n.$$slots?.[r],l=!1;i===!0&&(i=n.children,l=!0),i===void 0||i(e,l?()=>s:s)}function tl(e){const n={};e.children&&(n.default=!0);for(const r in e.$$slots)n[r]=!0;return n}function oi(e,n,r){var s=e,a,i,l=null,u=null;function o(){i&&(sa(i),i=null),l&&(l.lastChild.remove(),s.before(l),l=null),i=u,u=null}Fa(()=>{if(a!==(a=n())){var c=Ba();if(a){var v=s;c&&(l=document.createDocumentFragment(),l.append(v=On()),i&&qe.skipped_effects.add(i)),u=ir(()=>r(v,a))}c?qe.add_callback(o):o()}},Yr)}const vs=[...` 	
\r\fÂ \v\uFEFF`];function nl(e,n,r){var s=e==null?"":""+e;if(n&&(s=s?s+" "+n:n),r){for(var a in r)if(r[a])s=s?s+" "+a:a;else if(s.length)for(var i=a.length,l=0;(l=s.indexOf(a,l))>=0;){var u=l+i;(l===0||vs.includes(s[l-1]))&&(u===s.length||vs.includes(s[u]))?s=(l===0?"":s.substring(0,l))+s.substring(u+1):l=u}}return s===""?null:s}function rl(e,n){return e==null?null:String(e)}function it(e,n,r,s,a,i){var l=e.__className;if(l!==r||l===void 0){var u=nl(r,s,i);u==null?e.removeAttribute("class"):e.className=u,e.__className=r}else if(i&&a!==i)for(var o in i){var c=!!i[o];(a==null||c!==!!a[o])&&e.classList.toggle(o,c)}return i}function $n(e,n,r,s){var a=e.__style;if(a!==n){var i=rl(n);i==null?e.removeAttribute("style"):e.style.cssText=i,e.__style=n}return s}function li(e,n,r=!1){if(e.multiple){if(n==null)return;if(!Ir(n))return mo();for(var s of e.options)s.selected=n.includes(Cr(s));return}for(s of e.options){var a=Cr(s);if(Ao(a,n)){s.selected=!0;return}}(!r||n!==void 0)&&(e.selectedIndex=-1)}function al(e){var n=new MutationObserver(()=>{li(e,e.__value)});n.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ra(()=>{n.disconnect()})}function ci(e,n,r=n){var s=!0;qs(e,"change",a=>{var i=a?"[selected]":":checked",l;if(e.multiple)l=[].map.call(e.querySelectorAll(i),Cr);else{var u=e.querySelector(i)??e.querySelector("option:not([disabled])");l=u&&Cr(u)}r(l)}),Ua(()=>{var a=n();if(li(e,a,s),s&&a===void 0){var i=e.querySelector(":checked");i!==null&&(a=Cr(i),r(a))}e.__value=a,s=!1}),al(e)}function Cr(e){return"__value"in e?e.__value:e.value}const sl=Symbol("is custom element"),il=Symbol("is html");function ps(e,n){var r=ui(e);r.checked!==(r.checked=n??void 0)&&(e.checked=n)}function ol(e,n,r,s){var a=ui(e);a[n]!==(a[n]=r)&&(r==null?e.removeAttribute(n):typeof r!="string"&&ll(e).includes(n)?e[n]=r:e.setAttribute(n,r))}function ui(e){return e.__attributes??={[sl]:e.nodeName.includes("-"),[il]:e.namespaceURI===go}}var gs=new Map;function ll(e){var n=gs.get(e.nodeName);if(n)return n;gs.set(e.nodeName,n=[]);for(var r,s=e,a=Element.prototype;a!==s;){r=Is(s);for(var i in r)r[i].set&&n.push(i);s=ka(s)}return n}function rn(e,n,r=n){var s=ur(),a=new WeakSet;qs(e,"input",i=>{var l=i?e.defaultValue:e.value;if(l=pa(e)?ga(l):l,r(l),qe!==null&&a.add(qe),s&&l!==(l=n())){var u=e.selectionStart,o=e.selectionEnd;e.value=l??"",o!==null&&(e.selectionStart=u,e.selectionEnd=Math.min(o,e.value.length))}}),T(n)==null&&e.value&&(r(pa(e)?ga(e.value):e.value),qe!==null&&a.add(qe)),aa(()=>{var i=n();if(e===document.activeElement){var l=Fr??qe;if(a.has(l))return}pa(e)&&i===ga(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function pa(e){var n=e.type;return n==="number"||n==="range"}function ga(e){return e===""?null:+e}function Dr(e,n,r){var s=an(e,n);s&&s.set&&(e[n]=r,ra(()=>{e[n]=null}))}class Va{#e=new WeakMap;#n;#t;static entries=new WeakMap;constructor(n){this.#t=n}observe(n,r){var s=this.#e.get(n)||new Set;return s.add(r),this.#e.set(n,s),this.#a().observe(n,this.#t),()=>{var a=this.#e.get(n);a.delete(r),a.size===0&&(this.#e.delete(n),this.#n.unobserve(n))}}#a(){return this.#n??(this.#n=new ResizeObserver(n=>{for(var r of n){Va.entries.set(r.target,r);for(var s of this.#e.get(r.target)||[])s(r)}}))}}var cl=new Va({box:"border-box"});function ms(e,n,r){var s=cl.observe(e,()=>r(e[n]));Ua(()=>(T(()=>r(e[n])),s))}function hs(e,n){return e===n||e?.[Kt]===n}function bn(e={},n,r,s){return Ua(()=>{var a,i;return aa(()=>{a=i,i=[],T(()=>{e!==r(...i)&&(n(e,...i),a&&hs(r(...a),e)&&n(null,...a))})}),()=>{Oa(()=>{i&&hs(r(...i),e)&&n(null,...i)})}}),e}function ul(e){return function(...n){var r=n[0];r.target===this&&e?.apply(this,n)}}function di(e){return function(...n){var r=n[0];return r.preventDefault(),e?.apply(this,n)}}function Pt(e=!1){const n=We,r=n.l.u;if(!r)return;let s=()=>Q(n.s);if(e){let a=0,i={};const l=Na(()=>{let u=!1;const o=n.s;for(const c in o)o[c]!==i[c]&&(i[c]=o[c],u=!0);return u&&a++,a});s=()=>t(l)}r.b.length&&No(()=>{ys(n,s),zr(r.b)}),ba(()=>{const a=T(()=>r.m.map(Wi));return()=>{for(const i of a)typeof i=="function"&&i()}}),r.a.length&&ba(()=>{ys(n,s),zr(r.a)})}function ys(e,n){if(e.l.s)for(const r of e.l.s)t(r);n()}function Ha(e,n,r){if(e==null)return n(void 0),r&&r(void 0),_n;const s=T(()=>e.subscribe(n,r));return s.unsubscribe?()=>s.unsubscribe():s}const Zn=[];function fi(e,n){return{subscribe:ut(e,n).subscribe}}function ut(e,n=_n){let r=null;const s=new Set;function a(u){if(Rs(e,u)&&(e=u,r)){const o=!Zn.length;for(const c of s)c[1](),Zn.push(c,e);if(o){for(let c=0;c<Zn.length;c+=2)Zn[c][0](Zn[c+1]);Zn.length=0}}}function i(u){a(u(e))}function l(u,o=_n){const c=[u,o];return s.add(c),s.size===1&&(r=n(a,i)||_n),u(e),()=>{s.delete(c),s.size===0&&r&&(r(),r=null)}}return{set:a,update:i,subscribe:l}}function dr(e,n,r){const s=!Array.isArray(e),a=s?[e]:e;if(!a.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const i=n.length<2;return fi(r,(l,u)=>{let o=!1;const c=[];let v=0,f=_n;const x=()=>{if(v)return;f();const C=n(s?c[0]:c,l,u);i?l(C):f=typeof C=="function"?C:_n},_=a.map((C,S)=>Ha(C,O=>{c[S]=O,v&=~(1<<S),o&&x()},()=>{v|=1<<S}));return o=!0,x(),function(){zr(_),f(),o=!1}})}function xt(e){let n;return Ha(e,r=>n=r)(),n}let Br=!1,Ca=Symbol();function vt(e,n,r){const s=r[n]??={store:null,source:G(void 0),unsubscribe:_n};if(s.store!==e&&!(Ca in r))if(s.unsubscribe(),s.store=e??null,e==null)s.source.v=void 0,s.unsubscribe=_n;else{var a=!0;s.unsubscribe=Ha(e,i=>{a?s.source.v=i:y(s.source,i)}),a=!1}return e&&Ca in r?xt(e):t(s.source)}function dl(e,n){return e.set(n),n}function $r(){const e={};function n(){ra(()=>{for(var r in e)e[r].unsubscribe();jr(e,Ca,{enumerable:!1,value:!0})})}return[e,n]}function fl(e){var n=Br;try{return Br=!1,[e(),Br]}finally{Br=n}}const vl={get(e,n){let r=e.props.length;for(;r--;){let s=e.props[r];if(_r(s)&&(s=s()),typeof s=="object"&&s!==null&&n in s)return s[n]}},set(e,n,r){let s=e.props.length;for(;s--;){let a=e.props[s];_r(a)&&(a=a());const i=an(a,n);if(i&&i.set)return i.set(r),!0}return!1},getOwnPropertyDescriptor(e,n){let r=e.props.length;for(;r--;){let s=e.props[r];if(_r(s)&&(s=s()),typeof s=="object"&&s!==null&&n in s){const a=an(s,n);return a&&!a.configurable&&(a.configurable=!0),a}}},has(e,n){if(n===Kt||n===As)return!1;for(let r of e.props)if(_r(r)&&(r=r()),r!=null&&n in r)return!0;return!1},ownKeys(e){const n=[];for(let r of e.props)if(_r(r)&&(r=r()),!!r){for(const s in r)n.includes(s)||n.push(s);for(const s of Object.getOwnPropertySymbols(r))n.includes(s)||n.push(s)}return n}};function nn(...e){return new Proxy({props:e},vl)}function Fe(e,n,r,s){var a=!cr||(r&co)!==0,i=(r&fo)!==0,l=s,u=!0,o=()=>(u&&(u=!1,l=s),l),c;{var v=Kt in e||As in e;c=an(e,n)?.set??(v&&n in e?Z=>e[n]=Z:void 0)}var f,x=!1;[f,x]=fl(()=>e[n]),f===void 0&&s!==void 0&&(f=o(),c&&(a&&ro(),c(f)));var _;if(a?_=()=>{var Z=e[n];return Z===void 0?o():(u=!0,Z)}:_=()=>{var Z=e[n];return Z!==void 0&&(l=void 0),Z===void 0?l:Z},a&&(r&uo)===0)return _;if(c){var C=e.$$legacy;return(function(Z,m){return arguments.length>0?((!a||!m||C||x)&&c(m?_():Z),Z):_()})}var S=!1,O=ot(()=>(S=!1,_()));t(O);var j=Re;return(function(Z,m){if(arguments.length>0){const U=m?t(O):a&&i?Qn(Z):Z;return y(O,U),S=!0,l!==void 0&&(l=U),Z}return Nn&&S||(j.f&Rn)!==0?O.v:t(O)})}function ln(e){We===null&&Qr(),cr&&We.l!==null?pi(We).m.push(e):ba(()=>{const n=T(e);if(typeof n=="function")return n})}function vi(e){We===null&&Qr(),ln(()=>()=>T(e))}function pl(e,n,{bubbles:r=!1,cancelable:s=!1}={}){return new CustomEvent(e,{detail:n,bubbles:r,cancelable:s})}function Pn(){const e=We;return e===null&&Qr(),(n,r,s)=>{const a=e.s.$$events?.[n];if(a){const i=Ir(a)?a.slice():[a],l=pl(n,r,s);for(const u of i)u.call(e.x,l);return!l.defaultPrevented}return!0}}function gl(e){We===null&&Qr(),We.l===null&&no(),pi(We).a.push(e)}function pi(e){var n=e.l;return n.u??={a:[],b:[],m:[]}}const ml="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(ml);_o();const hl="modulepreload",yl=function(e){return"/"+e},_s={},Wt=function(n,r,s){let a=Promise.resolve();if(r&&r.length>0){let c=function(v){return Promise.all(v.map(f=>Promise.resolve(f).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};var l=c;document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),o=u?.nonce||u?.getAttribute("nonce");a=c(r.map(v=>{if(v=yl(v),v in _s)return;_s[v]=!0;const f=v.endsWith(".css"),x=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${x}`))return;const _=document.createElement("link");if(_.rel=f?"stylesheet":hl,f||(_.as="script"),_.crossOrigin="",_.href=v,o&&_.setAttribute("nonce",o),document.head.appendChild(_),f)return new Promise((C,S)=>{_.addEventListener("load",C),_.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${v}`)))})}))}function i(u){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=u,window.dispatchEvent(o),!o.defaultPrevented)throw u}return a.then(u=>{for(const o of u||[])o.status==="rejected"&&i(o.reason);return n().catch(i)})};class _l{constructor(){this.store=ut({serverTime:null,clientTime:null,timeOffset:0,lastSync:null}),this.subscribe=this.store.subscribe,this.update=this.store.update,this.set=this.store.set}updateServerTime(n){const r=new Date(n),s=new Date,a=r.getTime()-s.getTime();this.update(i=>({...i,serverTime:r,clientTime:s,timeOffset:a,lastSync:s}))}getServerTime(){let n;if(this.subscribe(s=>n=s)(),!n.lastSync)return new Date;const r=new Date;return new Date(r.getTime()+n.timeOffset)}formatTimeElapsed(n){const r=new Date,s=new Date(n),a=r.getTime()-s.getTime(),i=Math.floor(a/(1e3*60));return i>0?i:0}resetTimeOffset(){this.update(n=>({...n,timeOffset:0,lastSync:null}))}}const Zr=new _l,bs=dr(Zr,(e,n)=>{const r=()=>{const a=Zr.getServerTime();n(a)};r();const s=setInterval(r,1e3);return()=>clearInterval(s)},new Date),gi=dr(bs,(e,n)=>{let r=null;return bs.subscribe(s=>{const a=s.getMinutes();r!==a&&(r=a,n({time:s,minute:a}))})},{time:new Date,minute:new Date().getMinutes()});function bl(){const{subscribe:e,set:n,update:r}=ut({connected:!1,isConnected:!1,lastMessage:null,error:null,sessionId:null,currentServer:null,serverIndex:0,connectionAttempts:0}),s=()=>{const b=window.location.hostname;return window.location.protocol==="https:"?[b]:[`${b}:3030`]};let a=null,i=null,l=0,u=0,o=null;const c=new Map,v=10,f=new Map;function x(){s().forEach(g=>{f.has(g)||f.set(g,{successfulConnections:0,failedConnections:0,averageResponseTime:0,lastConnectionTime:null,reliability:1})})}function _(b){const g=b.successfulConnections+b.failedConnections;if(g===0)return 1;const M=b.successfulConnections/g,ee=b.averageResponseTime<1e3?.1:0;return Math.min(M+ee,1)}function C(){const b=s();if(b.length===1)return 0;const g=b.map(F=>{const te=f.get(F);return te?te.reliability:1}),M=g.reduce((F,te)=>F+te,0);let ee=Math.random()*M;for(let F=0;F<g.length;F++)if(ee-=g[F],ee<=0)return F;return Math.floor(Math.random()*b.length)}function S(){x(),l=C();const b=s();console.log(`Initialized with smart-selected server index: ${l} (${b[l]})`),console.log("Server reliability scores:",Array.from(f.entries()).map(([g,M])=>`${g}: ${(M.reliability*100).toFixed(1)}%`).join(", "))}function O(){const b=localStorage.getItem("ecKasse-session-id");b?i=b:(i=U(),localStorage.setItem("ecKasse-session-id",i)),r(g=>({...g,sessionId:i})),console.log("Session ID initialized:",i)}function j(){const b=s(),g=b[l];return l=(l+1)%b.length,g}function Z(b=0){if(o&&(clearTimeout(o),o=null),b>=v){console.error("Max reconnection attempts reached. Stopping reconnection."),r(g=>({...g,connected:!1,isConnected:!1,error:"Failed to connect to any server after maximum attempts",connectionAttempts:b}));return}try{const g=j(),ee=`${window.location.protocol==="https:"?"wss:":"ws:"}//${g}`;console.log(`Attempting WebSocket connection to ${ee} (attempt ${b+1}/${v})`),r(J=>({...J,currentServer:g,serverIndex:l,connectionAttempts:b+1,error:null})),a=new WebSocket(ee);const F=Date.now();a.onopen=()=>{const J=Date.now()-F;if(console.log(`WebSocket connected to ${g} (${J}ms)`),f.has(g)){const N=f.get(g);N.successfulConnections++,N.lastConnectionTime=J,N.averageResponseTime=N.averageResponseTime===0?J:(N.averageResponseTime+J)/2,N.reliability=_(N),f.set(g,N)}u=0,r(N=>({...N,connected:!0,isConnected:!0,error:null,connectionAttempts:0}))},a.onmessage=J=>{try{const N=JSON.parse(J.data);if(console.log("WebSocket message received:",N),N.serverTime&&Zr.updateServerTime(N.serverTime),r(V=>({...V,lastMessage:N})),N.command==="ui-refresh-request"){console.log("UI refresh request received, reloading page..."),window.location.reload();return}if(N.command==="displayAgentMessage"){console.log("ðŸŒ [WebSocket] Received displayAgentMessage:",{timestamp:N.payload?.timestamp,type:N.payload?.type,message:N.payload?.message?.substring(0,100)+(N.payload?.message?.length>100?"...":""),style:N.payload?.style,hasStyle:!!N.payload?.style,fullPayload:N.payload}),Wt(async()=>{const{agentStore:V}=await Promise.resolve().then(()=>kn);return{agentStore:V}},void 0).then(({agentStore:V})=>{console.log("ðŸŒ [WebSocket] Calling agentStore.addMessage with payload"),V.addMessage(N.payload)});return}if(N.operationId&&c.has(N.operationId)){const V=c.get(N.operationId);c.delete(N.operationId),V(N)}}catch(N){console.error("Error parsing WebSocket message:",N)}},a.onclose=J=>{if(console.log(`WebSocket disconnected from ${g} (code: ${J.code}, reason: ${J.reason})`),J.code!==1e3&&f.has(g)){const V=f.get(g);V.failedConnections++,V.reliability=_(V),f.set(g,V),console.log(`Updated reliability for ${g}: ${(V.reliability*100).toFixed(1)}%`)}r(V=>({...V,connected:!1,isConnected:!1}));const N=Math.min(1e3*Math.pow(2,Math.floor(b/3)),3e4);console.log(`Reconnecting in ${N}ms to next server...`),o=setTimeout(()=>{Z(b+1)},N)},a.onerror=J=>{if(console.error(`WebSocket error on ${g}:`,J),f.has(g)){const N=f.get(g);N.failedConnections++,N.reliability=_(N),f.set(g,N)}r(N=>({...N,error:`Connection error: ${g}`}))};const te=setTimeout(()=>{a&&a.readyState===WebSocket.CONNECTING&&(console.log(`Connection timeout for ${g}, trying next server...`),a.close())},1e4);a.onopen=(J=>function(...N){return clearTimeout(te),J.apply(this,N)})(a.onopen)}catch(g){console.error("Failed to create WebSocket connection:",g),r(M=>({...M,error:g.message})),o=setTimeout(()=>{Z(b+1)},2e3)}}function m(b){if(console.log("[wsStore] send() called with:",b),console.log("[wsStore] WebSocket state:",{exists:!!a,readyState:a?a.readyState:"N/A",readyStateText:a?a.readyState===0?"CONNECTING":a.readyState===1?"OPEN":a.readyState===2?"CLOSING":"CLOSED":"N/A",sessionId:i}),a&&a.readyState===WebSocket.OPEN){const g={operationId:U(),...b,payload:{...b.payload,sessionId:i}};return b.command==="getCategories"&&(console.log("ðŸ” [wsStore] SENDING getCategories command:",g),console.log("ðŸ” [wsStore] WebSocket ready state confirmed OPEN for getCategories")),console.log("Sending WebSocket message:",g),a.send(JSON.stringify(g)),new Promise(M=>{c.set(g.operationId,M),setTimeout(()=>{c.has(g.operationId)&&(c.delete(g.operationId),b.command==="getCategories"&&console.error("âŒ [wsStore] getCategories TIMEOUT after 10 seconds"),M({error:"Timeout waiting for response"}))},1e4),b.command==="getCategories"&&console.log("ðŸ” [wsStore] getCategories promise created, waiting for response...")})}else{const g="WebSocket not connected";return console.log(`âŒ [wsStore] ${g}:`,{command:b.command,wsExists:!!a,readyState:a?a.readyState:"N/A"}),b.command==="getCategories"&&console.error("âŒ [wsStore] getCategories FAILED - WebSocket not connected!"),Promise.resolve({error:g})}}function U(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){const g=Math.random()*16|0;return(b==="x"?g:g&3|8).toString(16)})}return S(),O(),Z(),{subscribe:e,send:m,connect:Z,getSessionId:()=>i,getCurrentServer:()=>k({subscribe:e}).currentServer,getConnectionStats:()=>{const b=k({subscribe:e});return{currentServer:b.currentServer,serverIndex:b.serverIndex,connectionAttempts:b.connectionAttempts,availableServers:s(),serverStats:Array.from(f.entries()).map(([g,M])=>({server:g,reliability:Math.round(M.reliability*100),successfulConnections:M.successfulConnections,failedConnections:M.failedConnections,averageResponseTime:Math.round(M.averageResponseTime),lastConnectionTime:M.lastConnectionTime}))}},forceReconnect:()=>{a&&a.close(),l=0,u=0,Z()},switchToBestServer:()=>{a&&a.close(),l=C(),u=0,console.log("Switching to best performing server..."),Z()},resetServerStats:()=>{f.clear(),x(),console.log("Server statistics reset")}};function k(b){let g;return b.subscribe(M=>g=M)(),g}}const ye=bl(),wl=Object.freeze(Object.defineProperty({__proto__:null,wsStore:ye},Symbol.toStringTag,{value:"Module"})),Cl=ut([]);function xl(e){if(!e||typeof e!="object")return{};const n={};for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)){const s=e[r];["string","number","boolean"].includes(typeof s)?n[r]=s:s instanceof Error?n[r]={message:s.message,stack:s.stack}:n[r]=JSON.stringify(s,null,2)}return n}function K(e,n,r={}){const s=new Date().toISOString().slice(0,19).replace("T"," ");Cl.update(i=>[...i.slice(-100),{timestamp:s,level:e,message:n,context:r}]);let a;ye.subscribe(i=>a=i)(),ye&&a&&a.connected&&ye.send({command:"logClientEvent",payload:{level:e,message:n,context:xl(r)}})}const Ur={isAuthenticated:!1,currentUser:null,sessionId:null,users:[],selectedUser:null,loginState:"user_selection",error:null,isLoading:!1};function Sl(){const{subscribe:e,set:n,update:r}=ut(Ur);return{subscribe:e,async fetchUsers(){try{r(a=>({...a,isLoading:!0,error:null}));const s=await ye.send({command:"getLoginUsers",payload:{}});if(s.status==="success")r(a=>({...a,users:s.payload||[],isLoading:!1})),K("INFO",`Fetched ${s.payload?.length||0} users for login`);else throw new Error(s.payload?.error||"Failed to fetch users")}catch(s){K("ERROR",`Failed to fetch users: ${s.message}`),r(a=>({...a,error:s.message,isLoading:!1}))}},selectUser(s){r(a=>({...a,selectedUser:s,loginState:"pin_entry",error:null})),K("INFO",`Selected user: ${s.username}`)},backToUserSelection(){r(s=>({...s,selectedUser:null,loginState:"user_selection",error:null}))},async login(s,a){try{r(l=>({...l,isLoading:!0,loginState:"authenticating",error:null}));const i=await ye.send({command:"login",payload:{username:s,password:a,ipAddress:"localhost",userAgent:navigator.userAgent}});if(i.status==="success"&&i.payload.success){const{user:l,session:u}=i.payload;try{await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:s,password:a})})}catch(c){K("WARN",`HTTP session establishment failed: ${c.message}`)}const o={...l,permissions:["all","order.change_price","order.reduce_quantity"]};return r(c=>({...c,isAuthenticated:!0,currentUser:o,sessionId:u.sessionId,loginState:"authenticated",isLoading:!1,error:null,selectedUser:null})),K("SUCCESS",`User ${s} authenticated successfully`),{success:!0}}else{const l=i.payload?.error||"Authentication failed";throw new Error(l)}}catch(i){return K("ERROR",`Authentication failed: ${i.message}`),r(l=>({...l,error:i.message,loginState:"pin_entry",isLoading:!1})),{success:!1,error:i.message}}},async logout(){try{const s={...Ur};let a=null;if(r(i=>(a=i.sessionId,s)),a)try{await ye.send({command:"logout",payload:{sessionId:a}}),K("INFO","User logged out successfully")}catch(i){K("WARN",`Logout request failed: ${i.message}`)}try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(i){K("WARN",`HTTP logout failed: ${i.message}`)}return n(s),{success:!0}}catch(s){return K("ERROR",`Logout failed: ${s.message}`),n(Ur),{success:!1,error:s.message}}},async getCurrentUser(){try{let s=null;if(r(i=>(s=i.sessionId,i)),!s)throw new Error("No active session");const a=await ye.send({command:"getCurrentUser",payload:{sessionId:s}});if(a.status==="success"&&a.payload.success)return r(i=>({...i,currentUser:a.payload.user})),{success:!0,user:a.payload.user};throw new Error(a.payload?.error||"Failed to get current user")}catch(s){return K("ERROR",`Failed to get current user: ${s.message}`),{success:!1,error:s.message}}},clearError(){r(s=>({...s,error:null}))},reset(){n(Ur)},async checkSession(){try{r(a=>({...a,isLoading:!0}));const s=await fetch("/api/session/status",{credentials:"include"});if(s.ok){const a=await s.json();if(a.authenticated&&a.user){const i={...a.user,permissions:["all","order.change_price","order.reduce_quantity"]};return r(l=>({...l,isAuthenticated:!0,currentUser:i,sessionId:null,loginState:"authenticated",isLoading:!1,error:null,selectedUser:null})),K("SUCCESS",`Session restored for user: ${a.user.username}`),{success:!0,user:a.user}}}return r(a=>({...a,isLoading:!1})),{success:!1,error:"No valid session"}}catch(s){return K("ERROR",`Failed to check session: ${s.message}`),r(a=>({...a,isLoading:!1,error:s.message})),{success:!1,error:s.message}}},establishSession(s){try{const{user:a,session:i}=s,l={...a,permissions:["all","order.change_price","order.reduce_quantity"]};return r(u=>({...u,isAuthenticated:!0,currentUser:l,sessionId:i.sessionId,loginState:"authenticated",isLoading:!1,error:null,selectedUser:null})),K("SUCCESS",`Demo mode: Auto-authenticated as ${a.username}`),{success:!0}}catch(a){return K("ERROR",`Failed to establish demo session: ${a.message}`),{success:!1,error:a.message}}}}}const wn=Sl(),ws=Object.freeze(Object.defineProperty({__proto__:null,authStore:wn},Symbol.toStringTag,{value:"Module"})),lt=ut("agent");dr(lt,e=>{const n=["order","receipts","agent"],r=n.indexOf(e);return[...n.slice(r),...n.slice(0,r)]});function Tl(){const{subscribe:e,set:n,update:r}=ut({transactionId:null,uuid:null,items:[],total:0,tax:0,status:"idle",paymentType:null,paymentAmount:null,metadata:{},activeTransactionItemId:null});let s=null,a=[];function i(){n({transactionId:null,uuid:null,items:[],total:0,tax:0,status:"idle",paymentType:null,paymentAmount:null,metadata:{},activeTransactionItemId:null}),s=null,a=[],K("INFO","Order reset and ready for new transaction.")}ye.subscribe(m=>{let U;if(e(k=>U=k)(),m.lastMessage?.command==="orderUpdated"&&m.lastMessage.status==="success"&&m.lastMessage.payload){const k=m.lastMessage.payload,b=(k.items||[]).map(F=>{const te=U.items.find(J=>J.id===F.id);return{...F,isEdited:te?.isEdited||!1}}),g=F=>{const te=[];return F.created_at&&te.push(new Date(F.created_at)),F.updated_at&&te.push(new Date(F.updated_at)),te.length>0?Math.max(...te):0};let M=null;b.length>0&&(M=[...b].sort((te,J)=>{const N=g(te),V=g(J);return N!==V?V-N:J.id-te.id})[0].id);const ee=[...b].sort((F,te)=>{const J=g(F),N=g(te);return J!==N?J-N:F.id-te.id});if(r(F=>({...F,transactionId:k.id,uuid:k.uuid,items:ee,total:parseFloat(k.total_amount),tax:parseFloat(k.tax_amount),status:"active",metadata:k.metadata?typeof k.metadata=="string"?JSON.parse(k.metadata):k.metadata:{},activeTransactionItemId:M})),K("INFO",`Order ${k.id} updated.`),U.status==="initializing"&&a.length>0){const F=[...a];a=[],F.forEach(({itemId:te,quantity:J,userId:N})=>{K("INFO",`Adding queued item ${te} to transaction ${k.id}`),ye.send({command:"addItemToTransaction",payload:{transactionId:k.id,itemId:te,quantity:J,userId:N}})})}}else if(m.lastMessage?.command==="transactionFinished"&&m.lastMessage.status==="success"){const k=m.lastMessage.payload;k.printStatus&&(k.printStatus.status==="failed"?K("ERROR",`Receipt print failed: ${k.printStatus.error}`):k.printStatus.status==="success"&&K("SUCCESS","Receipt printed successfully")),k.transaction?(r(b=>({...b,transactionId:k.transaction.id,uuid:k.transaction.uuid,items:k.transaction.items||[],total:parseFloat(k.transaction.total_amount),tax:parseFloat(k.transaction.tax_amount),status:"finished",paymentType:k.transaction.payment_type,paymentAmount:parseFloat(k.transaction.payment_amount),metadata:k.transaction.metadata?typeof k.transaction.metadata=="string"?JSON.parse(k.transaction.metadata):k.transaction.metadata:{},activeTransactionItemId:null})),K("SUCCESS",`Transaction ${k.transaction.id} finished successfully.`)):(K("SUCCESS",`Transaction ${U.transactionId} finished successfully.`),r(b=>({...b,status:"finished"}))),setTimeout(()=>{K("INFO","Auto-resetting order for next transaction."),i()},2e3)}});function l(){const m=xt(wn)?.currentUser;if(!m?.id)throw new Error("User must be authenticated to perform this action");return m.id}async function u(m={}){if(s)return s;const U=l();return r(k=>({...k,status:"initializing"})),K("INFO","Initializing new order..."),s=new Promise((k,b)=>{let g;g=ye.subscribe(M=>{M.lastMessage?.command==="orderUpdated"&&M.lastMessage.status==="success"?(g&&g(),k(M.lastMessage.payload)):M.lastMessage?.command==="orderUpdated"&&M.lastMessage.status==="error"&&(g&&g(),r(ee=>({...ee,status:"error"})),b(new Error(M.lastMessage.payload?.message||"Failed to initialize order")))})}),ye.send({command:"findOrCreateActiveTransaction",payload:{criteria:{metadata:m},userId:U}}),s}async function o(m,U=1){lt.set("order");const k=l();let b;if(e(g=>b=g)(),b.status==="idle"){K("INFO",`First item click detected. Initializing order and queuing item ${m}...`),a.push({itemId:m,quantity:U,userId:k});try{await u(k)}catch(g){K("ERROR",`Failed to initialize order: ${g.message}`),a=[];return}return}if(b.status==="initializing"){K("INFO",`Order initializing. Queuing item ${m}...`),a.push({itemId:m,quantity:U,userId:k});return}if(b.status==="active"&&b.transactionId){const g=b.items.find(M=>M.item_id===m&&!M.notes?.includes("Custom price:")&&!M.isEdited);if(g){const M=parseFloat(g.quantity)+U;K("INFO",`Item ${m} already exists and not edited, updating quantity to ${M}`),O(g.id,M,!1);return}K("INFO",`Adding new item ${m} to transaction ${b.transactionId}`),ye.send({command:"addItemToTransaction",payload:{transactionId:b.transactionId,itemId:m,quantity:U,userId:k}});return}K("ERROR","Cannot add item: invalid order state.")}async function c(m){const U=l();let k;if(e(b=>k=b)(),!k.transactionId||k.status!=="active"){K("ERROR","No active order to finish.");return}K("INFO",`Finishing transaction ${k.transactionId}...`),ye.send({command:"finishTransaction",payload:{transactionId:k.transactionId,paymentData:m,userId:U}})}async function v(m,U=!0){const k=l();let b;if(e(g=>b=g)(),!b.transactionId||b.status!=="active"){K("ERROR","No active order to park.");return}return K("INFO",`Parking transaction ${b.transactionId} to table ${m} (updateTime: ${U})...`),new Promise(async(g,M)=>{const ee=ye.subscribe(async F=>{F.lastMessage?.command==="parkTransactionResponse"&&F.lastMessage.status==="success"?(ee(),i(),K("SUCCESS",`Order parked to table ${m}`),g(F.lastMessage.payload)):F.lastMessage?.command==="parkTransactionResponse"&&F.lastMessage.status==="error"&&(ee(),K("ERROR",`Failed to park order: ${F.lastMessage.payload?.message||"Unknown error"}`),M(new Error(F.lastMessage.payload?.message||"Failed to park order")))});ye.send({command:"parkTransaction",payload:{transactionId:b.transactionId,tableIdentifier:m,userId:k,updateTimestamp:U}})})}function f(m){lt.set("order"),K("INFO",`Loading order ${m.id}...`),r(U=>({...U,transactionId:m.id,uuid:m.uuid,items:m.items||[],total:parseFloat(m.total_amount),tax:parseFloat(m.tax_amount),status:"active",metadata:m.metadata?typeof m.metadata=="string"?JSON.parse(m.metadata):m.metadata:{},activeTransactionItemId:null})),K("SUCCESS",`Order ${m.id} loaded successfully`)}async function x(m){const U=l();let k;if(e(b=>k=b)(),!k.transactionId||k.status!=="active")throw K("ERROR","No active order to assign table number to."),new Error("No active order to assign table number to.");K("INFO",`Checking availability and assigning table ${m} to transaction ${k.transactionId}...`);try{const b=Math.random().toString(36).substring(2,15),g=await new Promise((ee,F)=>{const te=setTimeout(()=>{J&&J(),F(new Error("Table availability check timeout"))},5e3);let J;J=ye.subscribe(N=>{N.lastMessage?.command==="checkTableAvailabilityResponse"&&N.lastMessage?.operationId===b&&(clearTimeout(te),J&&J(),ee(N.lastMessage))}),ye.send({operationId:b,command:"checkTableAvailability",payload:{tableNumber:m,excludeTransactionId:k.transactionId}})});if(console.log("Table availability check result:",g),g.status==="success"&&g.payload.isInUse)return K("ERROR",`Table ${m} is already in use by another order`),{tableInUse:!0};r(ee=>({...ee,metadata:{...ee.metadata,table:m}}));const M=Math.random().toString(36).substring(2,15);await new Promise((ee,F)=>{const te=setTimeout(()=>{J&&J(),F(new Error("Metadata update timeout"))},5e3);let J;J=ye.subscribe(N=>{N.lastMessage?.command==="updateTransactionMetadataResponse"&&N.lastMessage?.operationId===M&&(clearTimeout(te),J&&J(),N.lastMessage.status==="success"?ee(N.lastMessage):F(new Error(N.lastMessage.payload?.message||"Failed to update metadata")))}),ye.send({operationId:M,command:"updateTransactionMetadata",payload:{transactionId:k.transactionId,metadata:{...k.metadata,table:m},userId:U}})}),K("SUCCESS",`Table ${m} assigned to order`)}catch(b){throw K("ERROR",`Failed to assign table ${m}: ${b.message}`),b}}async function _(){K("INFO","Clearing active order view"),i()}function C(m,U){const k=l();let b;if(e(g=>b=g)(),b.status!=="active"||!b.transactionId){K("ERROR","Cannot update quantity: no active transaction");return}K("INFO",`Updating item quantity for item ${m} to ${U}`),ye.send({command:"updateItemQuantity",payload:{transactionId:b.transactionId,transactionItemId:m,newQuantity:U,userId:k}})}function S(m,U,k=1){const b=l();let g;if(e(M=>g=M)(),g.status!=="active"||!g.transactionId){K("ERROR","Cannot add custom price item: no active transaction");return}K("INFO",`Adding custom price item ${m} with price ${U} and quantity ${k}`),ye.send({command:"addCustomPriceItem",payload:{transactionId:g.transactionId,itemId:m,customPrice:U,quantity:k,userId:b}})}async function O(m,U,k=!0){const b=l();let g;if(e(M=>g=M)(),g.status!=="active"||!g.transactionId){K("ERROR","Cannot update quantity: no active transaction");return}k&&r(M=>({...M,items:M.items.map(ee=>ee.id===m?{...ee,isEdited:!0}:ee)})),K("INFO",`Updating item quantity for item ${m} to ${U}${k?" (marked as edited)":""}`),ye.send({command:"updateItemQuantity",payload:{transactionId:g.transactionId,transactionItemId:m,newQuantity:U,userId:b}})}async function j(m,U,k=!1){const b=l();let g;if(e(M=>g=M)(),g.status!=="active"||!g.transactionId){K("ERROR","Cannot update price: no active transaction");return}r(M=>({...M,items:M.items.map(ee=>ee.id===m?{...ee,isEdited:!0}:ee)})),K("INFO",`Updating item price for item ${m} to ${U} (marked as edited)`),ye.send({command:"updateItemPrice",payload:{transactionId:g.transactionId,transactionItemId:m,newPrice:U,isTotalPrice:k,userId:b}})}function Z(){r(m=>({...m,activeTransactionItemId:null})),K("INFO","Item deselected from order view")}return{subscribe:e,set:n,update:r,initializeOrder:u,addItem:o,updateQuantity:C,updateItemQuantity:O,updateItemPrice:j,addWithCustomPrice:S,finishOrder:c,resetOrder:i,parkCurrentOrder:v,assignTableNumber:x,loadOrder:f,clearActiveOrderView:_,deselectItem:Z}}const Je=Tl();function kl(e){if(typeof e=="object"&&e!==null)return e;if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}function El(){const{subscribe:e,set:n,update:r}=ut({receipts:[],loading:!1,error:null,lastUpdated:null});ye.subscribe(i=>{if(i.lastMessage?.command==="getRecentReceiptsResponse")if(i.lastMessage.status==="success"){const l=i.lastMessage.payload;if(l.success&&l.transactions){const u=l.transactions.map(o=>({...o,metadata:o.metadata?kl(o.metadata):{}}));r(o=>({...o,receipts:u,loading:!1,error:null,lastUpdated:new Date})),K("INFO",`Loaded ${l.transactions.length} recent receipts.`)}else r(u=>({...u,loading:!1,error:l.message||"Failed to load receipts"})),K("ERROR",`Failed to load receipts: ${l.message||"Unknown error"}`)}else r(l=>({...l,loading:!1,error:i.lastMessage.payload?.message||"Failed to load receipts"})),K("ERROR",`Failed to load receipts: ${i.lastMessage.payload?.message||"Unknown error"}`)});function s(i=20){r(u=>({...u,loading:!0,error:null})),K("INFO",`Loading recent receipts (limit: ${i})...`);let l;ye.subscribe(u=>l=u)(),l&&l.connected?ye.send({command:"getRecentReceipts",payload:{limit:i}}):(K("WARNING","WebSocket not connected, skipping receipt load"),r(u=>({...u,loading:!1,error:"WebSocket connection not available"})))}function a(){K("INFO","Refreshing receipts..."),s()}return{subscribe:e,loadReceipts:s,refresh:a}}const Jr=El();class Il{constructor(){this.store=ut([]),this.subscribe=this.store.subscribe,this.set=this.store.set,this.update=this.store.update}async refreshParkedOrders(){try{K("DEBUG","Requesting parked transactions...");const n=this.generateUUID();K("DEBUG",`Generated operationId: ${n}`);const r=await this.sendRequestWithFallback(n,"getParkedTransactions",{});K("DEBUG",`Parked transactions response: ${JSON.stringify(r)}`),r.status==="success"?(K("DEBUG",`Setting parked orders: ${JSON.stringify(r.payload)}`),this.set(r.payload||[])):(K("ERROR",`Failed to fetch parked orders: ${JSON.stringify(r)}`),this.set([]))}catch(n){K("ERROR",`Error fetching parked orders: ${n.message}`),this.set([])}}async sendRequestWithFallback(n,r,s){try{return await this.sendWebSocketRequest(n,r,s)}catch(a){K("WARNING",`WebSocket request failed, trying HTTP fallback: ${a.message}`);try{return await this.sendHttpRequest(n,r,s)}catch(i){throw K("ERROR",`Both WebSocket and HTTP requests failed: ${i.message}`),i}}}sendWebSocketRequest(n,r,s){return new Promise((a,i)=>{let l;if(ye.subscribe(c=>l=c)(),!l||!l.connected){i(new Error("WebSocket is not connected"));return}const u=setTimeout(()=>{o(),i(new Error("WebSocket request timeout"))},3e3),o=ye.subscribe(c=>{c.lastMessage&&c.lastMessage.operationId===n&&(clearTimeout(u),o(),a(c.lastMessage))});ye.send({operationId:n,command:r,payload:s})})}async sendHttpRequest(n,r,s){const a=await fetch("/api/websocket-fallback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operationId:n,command:r,payload:s})});if(!a.ok)throw new Error(`HTTP request failed: ${a.status}`);return await a.json()}refresh(){return this.refreshParkedOrders()}async activateOrder(n,r=!1){try{const s=this.generateUUID(),a=await this.sendRequestWithFallback(s,"activateTransaction",{transactionId:n,userId:1,updateTimestamp:r});if(a.status==="success")return r&&await this.refreshParkedOrders(),a.payload;throw new Error(a.payload?.message||"Failed to activate order")}catch(s){throw K("ERROR",`Error activating order: ${s.message}`),s}}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const r=Math.random()*16|0;return(n==="x"?r:r&3|8).toString(16)})}}const Xn=new Il,Jn={DE:[["q","w","e","r","t","z","u","i","o","p","Ã¼","ÃŸ"],["a","s","d","f","g","h","j","k","l","Ã¶","Ã¤"],["y","x","c","v","b","n","m"]],EN:[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m"]],RU:[["Ð¹","Ñ†","Ñƒ","Ðº","Ðµ","Ð½","Ð³","Ñˆ","Ñ‰","Ð·","Ñ…","ÑŠ"],["Ñ„","Ñ‹","Ð²","Ð°","Ð¿","Ñ€","Ð¾","Ð»","Ð´","Ð¶","Ñ"],["Ñ","Ñ‡","Ñ","Ð¼","Ð¸","Ñ‚","ÑŒ","Ð±","ÑŽ"]]};function Ml(){const{subscribe:e,set:n,update:r}=ut({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:Jn});return{subscribe:e,activate(s,a,i,l="numeric"){n({isActive:!0,mode:s,layout:l,liveValue:l==="alpha"?{text:"",cursor:0}:"",confirmCallback:a,cancelCallback:i,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:Jn})},deactivate(){n({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:Jn})},append(s,a=null){r(i=>{if(!i.isActive)return i;if(i.layout==="alpha"){const l=i.liveValue.text,u=i.liveValue.cursor,o=l.slice(0,u)+s+l.slice(u),c={text:o,cursor:u+1};return i.mode==="agent"&&a&&a.updateDraftMessage(o),{...i,liveValue:c,errorMessage:null}}else return{...i,liveValue:i.liveValue+s,errorMessage:null}})},backspace(s=null){r(a=>{if(!a.isActive)return a;if(a.layout==="alpha"){const i=a.liveValue.text,l=a.liveValue.cursor;if(l>0){const u=i.slice(0,l-1)+i.slice(l),o={text:u,cursor:l-1};return a.mode==="agent"&&s&&s.updateDraftMessage(u),{...a,liveValue:o,errorMessage:null}}return{...a,errorMessage:null}}else return{...a,liveValue:a.liveValue.slice(0,-1),errorMessage:null}})},clear(s=null){r(a=>a.isActive?(a.mode==="agent"&&s&&s.updateDraftMessage(""),{...a,liveValue:a.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null}):a)},async confirm(){let s,a;if(r(u=>(s=u,u)),!s.isActive)return;a=s.layout==="alpha"?s.liveValue.text:s.liveValue;let i;if(Je.subscribe(u=>i=u)(),i.activeTransactionItemId&&s.layout==="numeric"&&s.mode!=="agent"&&s.mode!=="table"){const u=a.trim();if(!u){this.deactivate();return}const o=i.items.find(c=>c.id===i.activeTransactionItemId);if(o){const{authStore:c}=await Wt(async()=>{const{authStore:x}=await Promise.resolve().then(()=>ws);return{authStore:x}},void 0);let v;c.subscribe(x=>v=x)();const f=v.currentUser?.permissions||[];if(u.includes(".")||u.includes(",")){const x=parseFloat(u.replace(",","."));if(!isNaN(x)&&x>0){const _=parseFloat(o.unit_price);let C=null;if(x<_&&(C="order.change_price"),f.includes("all")||(C?f.includes(C):!0)){const j=parseFloat(o.quantity)>1;Je.updateItemPrice(o.id,x,j),Je.deselectItem()}else{r(O=>({...O,errorMessage:"Permission denied to change price."}));return}}}else{const x=parseInt(u);if(!isNaN(x)&&x>0){const _=parseFloat(o.quantity);let C=null;if(x<_&&(C="order.reduce_quantity"),f.includes("all")||(C?f.includes(C):!0))Je.updateItemQuantity(o.id,x),Je.deselectItem();else{r(O=>({...O,errorMessage:"Permission denied to reduce quantity."}));return}}}}r(c=>({...c,liveValue:c.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null})),this.deactivate();return}if(s.mode==="agent"){if(s.layout==="numeric"&&/^\d{4,6}$/.test(a)){const{authStore:o}=await Wt(async()=>{const{authStore:c}=await Promise.resolve().then(()=>ws);return{authStore:c}},void 0);try{if((await o.login(null,a)).success){const{agentStore:v}=await Wt(async()=>{const{agentStore:_}=await Promise.resolve().then(()=>kn);return{agentStore:_}},void 0);let f;o.subscribe(_=>f=_)();const x=`âœ… Erfolgreich angemeldet als ${f.currentUser.full_name}!

â° ÃœberprÃ¼fe Systemzeit...
ðŸ” PrÃ¼fe ausstehende Transaktionen...

Bitte warten Sie einen Moment...`;v.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:x}),v.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`ðŸ¤– KI-Assistent bereit!

VerfÃ¼gbare Tools:
â€¢ findProduct - Produkte suchen und finden
â€¢ createProduct - Neue Produkte erstellen
â€¢ updateProduct - Produktdaten aktualisieren
â€¢ getSalesReport - Verkaufsberichte abrufen
â€¢ generateDsfinvkExport - DSFinV-K konforme Datenexporte erstellen

Ich wÃ¤hle automatisch das richtige Tool fÃ¼r Ihre Anfrage aus. Stellen Sie einfach Ihre Frage!`}),setTimeout(async()=>{await this.checkSystemStatus(f.currentUser,v)},1e3),r(_=>({..._,liveValue:_.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null})),this.deactivate();return}else{const{agentStore:v}=await Wt(async()=>{const{agentStore:f}=await Promise.resolve().then(()=>kn);return{agentStore:f}},void 0);v.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`âŒ UngÃ¼ltige PIN-Eingabe!

Bitte Ã¼berprÃ¼fen Sie Ihre PIN und versuchen Sie es erneut. Sie kÃ¶nnen eine 4-6 stellige PIN Ã¼ber das Tastenfeld eingeben.`}),r(f=>({...f,liveValue:f.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null}));return}}catch{console.log("Direct login failed, falling back to agent message")}}const{agentStore:u}=await Wt(async()=>{const{agentStore:o}=await Promise.resolve().then(()=>kn);return{agentStore:o}},void 0);try{await u.sendMessage(a),r(o=>({...o,liveValue:o.layout==="alpha"?{text:"",cursor:0}:""}))}catch(o){console.error("Agent message send failed:",o),r(c=>({...c,liveValue:c.layout==="alpha"?{text:"",cursor:0}:""}))}return}if(!s.confirmCallback)return;const l=s.confirmCallback;try{await l(a),r(()=>({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:Jn}))}catch(u){console.error("Pinpad confirm callback failed:",u),r(()=>({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:Jn}))}},cancel(s=null){r(a=>{const i=Date.now();if(i-a.lastRedClickTime<300){const u=a.cancelCallback;a.mode==="agent"&&Wt(async()=>{const{agentStore:c}=await Promise.resolve().then(()=>kn);return{agentStore:c}},void 0).then(({agentStore:c})=>{c.cancelDraftMessage()});const o={isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:Jn};return u&&setTimeout(()=>u(),0),o}else return a.mode==="agent"&&s&&s.updateDraftMessage(""),{...a,liveValue:a.layout==="alpha"?{text:"",cursor:0}:"",lastRedClickTime:i,errorMessage:null}})},activateTableEntry(){lt.set("order"),this.activate("table",async s=>{if(s&&s.trim())try{const a=await Je.assignTableNumber(s.trim());if(a&&a.tableInUse){r(i=>({...i,liveValue:i.layout==="alpha"?{text:"",cursor:0}:""}));return}return a}catch(a){throw a}},()=>{})},activateTableEntryWithAutoCollapse(){lt.set("order"),this.activate("table",async s=>{if(s&&s.trim())try{const a=await Je.assignTableNumber(s.trim());if(a&&a.tableInUse){r(o=>({...o,liveValue:o.layout==="alpha"?{text:"",cursor:0}:""}));return}let i;Je.subscribe(o=>i=o)();const l=i.items&&i.items.length>0,u=i.metadata&&i.metadata.table;return l&&u?(await Je.parkCurrentOrder(u,1,!1),await Xn.refresh(),Je.resetOrder(),window.dispatchEvent(new CustomEvent("autoCollapseComplete")),{autoCollapsed:!0}):a}catch(a){throw a}},()=>{})},activateAlphaInput(s,a,i=null){i&&i.startDraftMessage(),this.activate("agent",s,a,"alpha")},moveCursorLeft(){r(s=>{if(!s.isActive||s.layout!=="alpha")return s;const a=Math.max(0,s.liveValue.cursor-1);return{...s,liveValue:{...s.liveValue,cursor:a}}})},moveCursorRight(){r(s=>{if(!s.isActive||s.layout!=="alpha")return s;const a=Math.min(s.liveValue.text.length,s.liveValue.cursor+1);return{...s,liveValue:{...s.liveValue,cursor:a}}})},switchLanguage(s=null){r(a=>{const i=Object.keys(a.layouts);if(s&&i.includes(s))return{...a,currentLanguage:s};if(!a.isActive||a.layout!=="alpha"){const c=(i.indexOf(a.currentLanguage)+1)%i.length;return{...a,currentLanguage:i[c]}}const u=(i.indexOf(a.currentLanguage)+1)%i.length;return{...a,currentLanguage:i[u]}})},async checkSystemStatus(s,a){try{const{wsStore:i}=await Wt(async()=>{const{wsStore:c}=await Promise.resolve().then(()=>wl);return{wsStore:c}},void 0);let l=0,u=!0;try{const c=await i.send({command:"systemTimeCheck",payload:{clientTime:new Date().toISOString()}});c.status==="success"?(l=c.payload.timeDifferenceSeconds,u=Math.abs(l)<=30):u=!1}catch{u=!1}if(u){a.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`âœ… Erfolgreich angemeldet als ${s.full_name}!`});return}let o=`ðŸŽ‰ Willkommen zurÃ¼ck, ${s.full_name}!

`;if(u||(l!==0?o+=`âš ï¸ Zeitabweichung erkannt: ${Math.abs(l)} Sekunden ${l>0?"voraus":"zurÃ¼ck"}
`:o+=`âš ï¸ ZeitprÃ¼fung fehlgeschlagen
`),s.permissions.includes("all")||s.permissions.includes("manage_transactions"))try{const c=await i.send({command:"getPendingTransactions",payload:{}});c.status==="success"&&c.payload.length>0?(o+=`
ðŸ”„ ${c.payload.length} ausstehende Transaktionen gefunden!

`,o+=`Als ${s.role} kÃ¶nnen Sie diese Transaktionen verwalten:
`,o+=`â€¢ Fiskalisieren (abschlieÃŸen)
`,o+=`â€¢ Stornieren (rÃ¼ckgÃ¤ngig machen)
`,o+=`â€¢ Verschieben (spÃ¤ter bearbeiten)

`,o+="MÃ¶chten Sie diese jetzt bearbeiten? Verwenden Sie die entsprechenden SchaltflÃ¤chen oder fragen Sie mich nach Hilfe."):o+=`
âœ… Keine ausstehenden Transaktionen
`}catch{o+=`
âš ï¸ Konnte ausstehende Transaktionen nicht Ã¼berprÃ¼fen
`}else o+=`
ðŸ“‹ Ihre Rolle: ${s.role}
`,o+=`Sie haben Zugriff auf grundlegende Kassenfunktionen.
`;o+=`
ðŸš€ System ist bereit! Sie kÃ¶nnen mit der Arbeit beginnen.`,a.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:o})}catch(i){a.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`âŒ SystemprÃ¼fung fehlgeschlagen: ${i.message}

Sie kÃ¶nnen trotzdem mit der Arbeit beginnen, aber einige Funktionen sind mÃ¶glicherweise eingeschrÃ¤nkt.`})}}}}const je=Ml();function Al(){const e=parseInt(void 0)||160;return fi({MIN_BUTTON_WIDTH:e})}const mi=Al(),ma={hasNotification:!1,style:null};function $l(){const{subscribe:e,set:n,update:r}=ut(ma);return{subscribe:e,setNotification:s=>{console.log("ðŸŸ¡ [NotificationStore] setNotification called with style:",s),r(a=>{console.log("ðŸŸ¡ [NotificationStore] Previous state:",a);const i={hasNotification:!0,style:s};return console.log("ðŸŸ¡ [NotificationStore] New state:",i),i})},clearNotification:()=>{console.log("ðŸŸ  [NotificationStore] clearNotification called"),console.log("ðŸŸ  [NotificationStore] Clearing notification, setting to initial state:",ma),n(ma)}}}const nr=$l();function Ll(){const{subscribe:e,set:n,update:r}=ut({history:[],messages:[{timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Willkommen bei ecKasse!

Eine Kasse, die hilft â€“ nicht kostet.

ðŸ‘¥ VerfÃ¼gbare Benutzer:
â€¢ Admin (Vollzugriff)
â€¢ Kassier (Kassenfunktionen)
â€¢ Aushilfe (Grundfunktionen)

â° ÃœberprÃ¼fe Systemzeit und ausstehende Transaktionen...

ðŸ’¡ Geben Sie einfach Ihre 4-6 stellige PIN ein - das System erkennt Sie automatisch. Bei neuer oder Testkasse: Admin-PIN ist 1234`}],draftMessage:null,shouldActivatePinpad:!0});return ye.subscribe(s=>{if(s.lastMessage&&s.lastMessage.command==="firstRunAdminCreated"){const a=s.lastMessage.payload;r(i=>({...i,messages:[{timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:a.message||`Willkommen! Admin-Benutzer '${a.username}' wurde erstellt mit PIN: ${a.password}`}]}))}if(s.lastMessage&&s.lastMessage.command==="getEntityJsonResponse"){const a=s.lastMessage.payload;if(a.success&&a.entity){const i=JSON.stringify(a.entity,null,2);r(l=>({...l,messages:[...l.messages,{timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"system",message:`JSON for viewing ${a.entityType} ID ${a.entityId}. For editing, use AI commands like 'update price to 29.99' or 'change name to Super Widget Pro':
\`\`\`json
${i}
\`\`\``}]}))}}}),{subscribe:e,addMessage:s=>{console.log("ðŸ”” [AgentStore] addMessage called:",{timestamp:s.timestamp,type:s.type,message:s.message?.substring(0,100)+(s.message?.length>100?"...":""),style:s.style,hasStyle:!!s.style}),r(a=>({...a,messages:[...a.messages,s]})),s.style?(console.log("ðŸŸ¢ [AgentStore] Message has style, triggering notification:",s.style),nr.setNotification(s.style)):console.log("ðŸ”´ [AgentStore] Message has NO style, no notification triggered")},setHistory:s=>{r(a=>({...a,history:s}))},getHistory:()=>{let s;return e(a=>s=a.history)(),s},clearMessages:()=>{r(s=>({...s,messages:[]}))},startDraftMessage:()=>{r(s=>({...s,draftMessage:{id:"draft-"+Date.now(),timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"user",message:"",isDraft:!0}}))},updateDraftMessage:s=>{r(a=>({...a,draftMessage:a.draftMessage?{...a.draftMessage,message:s}:null}))},finalizeDraftMessage:()=>{r(s=>{if(!s.draftMessage)return s;const a={...s.draftMessage,isDraft:!1};return{...s,messages:[...s.messages,a],draftMessage:null}})},cancelDraftMessage:()=>{r(s=>({...s,draftMessage:null}))},sendMessage:async s=>{if(!(!s||!s.trim()))try{const i=xt(wn).sessionId,l={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"user",message:s};let u;e(f=>u=f)(),r(f=>({...f,messages:[...f.messages,l],draftMessage:null}));const o=await fetch("/api/llm/ping-gemini",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s,history:u.history,sessionId:i})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const c=await o.json(),v={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:c.gemini_response_text};r(f=>({...f,messages:[...f.messages,v],history:c.history}))}catch(a){console.error("Failed to send message to AI:",a);const i={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"Sorry, I encountered an error. Please try again."};r(l=>({...l,messages:[...l.messages,i]}))}},shouldActivatePinpadOnLoad(){let s=!1;return r(a=>(s=a.shouldActivatePinpad,{...a,shouldActivatePinpad:!1})),s}}}const me=Ll(),kn=Object.freeze(Object.defineProperty({__proto__:null,agentStore:me},Symbol.toStringTag,{value:"Module"})),Rl=()=>typeof localStorage<"u"&&localStorage.getItem("app-locale")||"de-DE",lr=ut(Rl());lr.subscribe(e=>{typeof localStorage<"u"&&localStorage.setItem("app-locale",e)});const Ol=e=>{lr.set(e)},Rt=(e,n="EUR")=>{const r=xt(lr);return e==null||isNaN(e)?new Intl.NumberFormat(r,{style:"currency",currency:n}).format(0):new Intl.NumberFormat(r,{style:"currency",currency:n}).format(e)},Nl=(e,n={})=>{const r=xt(lr);if(!e)return"";const s=typeof e=="string"?new Date(e):e;if(isNaN(s.getTime()))return"";const a={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",...n};return new Intl.DateTimeFormat(r,a).format(s)};var Pl=W('<div class="loading svelte-1dtcyze">Loading receipts...</div>'),Dl=W('<div class="error svelte-1dtcyze"> </div>'),Bl=W('<div class="empty svelte-1dtcyze">No receipts found.</div>'),Ul=W('<span class="receipt-table-large svelte-1dtcyze"> </span>'),Fl=W('<div><span class="item-qty svelte-1dtcyze"> </span> <span> </span> <span> </span></div>'),jl=W('<div class="receipt-details svelte-1dtcyze"><div class="items-list svelte-1dtcyze"></div> <div class="receipt-totals svelte-1dtcyze"><div class="total-row svelte-1dtcyze"><span>Tax:</span> <span class="price svelte-1dtcyze"> </span></div> <div class="total-row total svelte-1dtcyze"><span>Total:</span> <span class="price svelte-1dtcyze"> </span></div></div> <div class="receipt-actions svelte-1dtcyze"><button class="action-button svelte-1dtcyze">ðŸ–¨ï¸ Reprint</button></div></div>'),zl=W('<div><button class="receipt-summary svelte-1dtcyze"><div class="receipt-left svelte-1dtcyze"><div class="receipt-main-line svelte-1dtcyze"><span class="receipt-id-large svelte-1dtcyze"> </span> <!></div> <div class="receipt-date svelte-1dtcyze"> </div> <div class="receipt-payment svelte-1dtcyze"> </div></div> <div class="receipt-right svelte-1dtcyze"><div class="receipt-price svelte-1dtcyze"><span class="price svelte-1dtcyze"> </span></div> <div class="receipt-meta svelte-1dtcyze"><div class="receipt-items-count svelte-1dtcyze"> </div></div></div> <div class="expand-icon svelte-1dtcyze"> </div></button> <!></div>'),Gl=W('<div class="receipt-list svelte-1dtcyze"></div>'),ql=W('<div class="receipt-feed svelte-1dtcyze"><!></div>');function Vl(e,n){Et(n,!1);const[r,s]=$r(),a=()=>vt(Jr,"$receiptsStore",r);let i=Fe(n,"autoExpandLatest",8,!1),l=G(null),u=G(!1),o=G();ln(()=>{Jr.loadReceipts()});function c(m){y(u,!0),y(l,t(l)===m?null:m)}function v(m){return Nl(m)}function f(m){return m.notes==="STORNO"&&m.display_names&&m.display_names.menu&&m.display_names.menu.de?`STORNO: ${m.display_names.menu.de}`:m.notes==="DISCOUNT"?"DISCOUNT":m.notes==="SURCHARGE"?"SURCHARGE":m.display_names&&m.display_names.menu&&m.display_names.menu.de?m.display_names.menu.de:"Unnamed Item"}function x(m){return m.notes==="STORNO"||m.notes==="DISCOUNT"||m.notes==="SURCHARGE"}function _(m){if(m.notes==="DISCOUNT"||m.notes==="SURCHARGE")return"";const U=parseFloat(m.quantity);return U===1?"":U+"x"}async function C(m){K("INFO",`Reprint requested for receipt â„–${m.id}`),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Reprint initiated for receipt â„–${m.id}`,style:"info"}),ye.send("reprintReceipt",{transactionId:m.id})}Ge(()=>Q(i()),()=>{i()&&y(u,!1)}),Ge(()=>(Q(i()),t(u),a(),t(l)),()=>{if(i()&&!t(u)&&a().receipts.length>0){const U=a().receipts.sort((k,b)=>new Date(b.fiscal_timestamp||b.updated_at)-new Date(k.fiscal_timestamp||k.updated_at))[0]?.id;U&&t(l)!==U&&y(l,U)}}),xn(),Pt();var S=ql(),O=p(S);{var j=m=>{var U=Pl();E(m,U)},Z=m=>{var U=Ue(),k=Se(U);{var b=M=>{var ee=Dl(),F=p(ee);ce(()=>oe(F,`Error: ${a(),T(()=>a().error)??""}`)),E(M,ee)},g=M=>{var ee=Ue(),F=Se(ee);{var te=N=>{var V=Bl();E(N,V)},J=N=>{var V=Gl();Ot(V,5,()=>(a(),T(()=>a().receipts.sort((A,z)=>new Date(A.fiscal_timestamp||A.updated_at)-new Date(z.fiscal_timestamp||z.updated_at)))),A=>A.id,(A,z)=>{var Ae=zl();let Me;var Be=p(Ae),se=p(Be),D=p(se),I=p(D),H=p(I),ue=w(I,2);{var re=$=>{var P=Ul(),le=p(P);ce(()=>oe(le,`#${t(z),T(()=>t(z).metadata.table)??""}`)),E($,P)};X(ue,$=>{t(z),T(()=>t(z).metadata?.table)&&$(re)})}var ae=w(D,2),fe=p(ae),pe=w(ae,2),ge=p(pe),be=w(se,2),de=p(be),we=p(de),he=p(we),Te=w(de,2),Oe=p(Te),Le=p(Oe),Ce=w(be,2),ve=p(Ce),Ee=w(Be,2);{var xe=$=>{var P=jl(),le=p(P);Ot(le,5,()=>(t(z),T(()=>t(z).items)),at=>at.id,(at,Ne)=>{var Ke=Fl();let nt;var Ct=p(Ke),st=p(Ct),Ft=w(Ct,2);let He;var rt=p(Ft),mt=w(Ft,2);let ct;var Xe=p(mt);ce((en,Gt,dn,jt,tn,fn)=>{nt=it(Ke,1,"item-row svelte-1dtcyze",null,nt,en),oe(st,Gt),He=it(Ft,1,"item-name svelte-1dtcyze",null,He,dn),oe(rt,jt),ct=it(mt,1,"item-price svelte-1dtcyze",null,ct,tn),oe(Xe,fn)},[()=>({"modification-item":x(t(Ne))}),()=>(t(Ne),T(()=>_(t(Ne)))),()=>({"modification-name":x(t(Ne))}),()=>(t(Ne),T(()=>f(t(Ne)))),()=>({"negative-price":parseFloat(t(Ne).total_price)<0}),()=>(Q(Rt),t(Ne),T(()=>Rt(t(Ne).total_price)))]),E(at,Ke)});var _e=w(le,2),Ve=p(_e),yt=w(p(Ve),2),gt=p(yt),_t=w(Ve,2),tt=w(p(_t),2),bt=p(tt),wt=w(_e,2),kt=p(wt);ce((at,Ne)=>{oe(gt,at),oe(bt,Ne)},[()=>(Q(Rt),t(z),T(()=>Rt(t(z).tax_amount))),()=>(Q(Rt),t(z),T(()=>Rt(t(z).total_amount)))]),ne("click",kt,()=>C(t(z))),E($,P)};X(Ee,$=>{t(l),t(z),T(()=>t(l)===t(z).id)&&$(xe)})}ce(($,P,le)=>{Me=it(Ae,1,"receipt-item svelte-1dtcyze",null,Me,$),oe(H,`â„–${t(z),T(()=>t(z).id)??""}`),oe(fe,P),oe(ge,(t(z),T(()=>t(z).payment_type||"Unknown"))),oe(he,le),oe(Le,`${t(z),T(()=>t(z).items?.length||0)??""} items`),oe(ve,(t(l),t(z),T(()=>t(l)===t(z).id?"â–¼":"â–¶")))},[()=>({expanded:t(l)===t(z).id}),()=>(t(z),T(()=>v(t(z).fiscal_timestamp||t(z).updated_at))),()=>(Q(Rt),t(z),T(()=>Rt(t(z).total_amount)))]),ne("click",Be,()=>c(t(z).id)),E(A,Ae)}),bn(V,A=>y(o,A),()=>t(o)),E(N,V)};X(F,N=>{a(),T(()=>a().receipts.length===0)?N(te):N(J,!1)},!0)}E(M,ee)};X(k,M=>{a(),T(()=>a().error)?M(b):M(g,!1)},!0)}E(m,U)};X(O,m=>{a(),T(()=>a().loading)?m(j):m(Z,!1)})}E(e,S),It(),s()}var Hl=W('<button class="order-item svelte-1gswy6n"><div class="table-number svelte-1gswy6n"> </div> <div class="order-stats svelte-1gswy6n"><div class="stat-price svelte-1gswy6n"> </div> <div class="stat-open svelte-1gswy6n"> </div> <div class="stat-activity svelte-1gswy6n"> </div></div></button>'),Wl=W('<div class="parked-orders-container svelte-1gswy6n"><div class="orders-list svelte-1gswy6n"></div></div>');function Zl(e,n){Et(n,!1);let r=G([]),s,a,i=!1;ln(async()=>{s=Xn.subscribe(_=>{y(r,_)}),a=ye.subscribe(async _=>{_.connected&&!i&&(i=!0,await Xn.refreshParkedOrders())})}),vi(()=>{s&&s(),a&&a()});async function l(_){try{let C;if(Je.subscribe(O=>C=O)(),C.transactionId&&C.status==="active"){const O=C.items&&C.items.length>0,j=C.metadata&&C.metadata.table;if(O&&j)await Je.parkCurrentOrder(j,1,!1),await Xn.refreshParkedOrders();else if(O&&!j){lt.set("order"),je.activateTableEntry();return}else Je.resetOrder()}const S=await Xn.activateOrder(_.id,!1);Je.loadOrder(S)}catch(C){console.error("Failed to switch to order:",C)}}function u(_){const S=(_.metadata||{}).table||_.id.toString();return S.length>3?`#${S.substring(0,3)}`:`#${S}`}function o(_){return Zr.formatTimeElapsed(_)}function c(_){const C=o(_.created_at),S=o(_.updated_at);return{price:Rt(_.total_amount),openMinutes:C,activityMinutes:S}}Pt();var v=Ue(),f=Se(v);{var x=_=>{var C=Wl(),S=p(C);Ot(S,5,()=>t(r),O=>O.id,(O,j)=>{var Z=Hl(),m=p(Z),U=p(m),k=w(m,2),b=p(k),g=p(b),M=w(b,2),ee=p(M),F=w(M,2),te=p(F);ce((J,N,V,A)=>{oe(U,J),oe(g,N),oe(ee,`${V??""}min`),oe(te,`${A??""}min`)},[()=>u(t(j)),()=>c(t(j)).price,()=>c(t(j)).openMinutes,()=>c(t(j)).activityMinutes]),ne("click",Z,()=>l(t(j))),E(O,Z)}),E(_,C)};X(f,_=>{t(r).length>0&&_(x)})}E(e,v),It()}var Jl=qa(`<svg viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: 100%;"><defs><filter height="150%" id="sh0" width="150%" x="-0.25" y="-0.25"><feConvolveMatrix id="3_|_y" in="SourceAlpha" result="19y" order="1,17" divisor="6632" bias="0" preserveAlpha="false" kernelMatrix=" 10 30 77 169 320 527 752 931 1000 931 752 527 320 169 77 30 10"></feConvolveMatrix><feConvolveMatrix id="3_|_x" result="19x" order="17,1" divisor="6632" bias="0" preserveAlpha="false" kernelMatrix=" 10 30 77 169 320 527 752 931 1000 931 752 527 320 169 77 30 10"></feConvolveMatrix><feConvolveMatrix id="9_|_y" in="SourceAlpha" result="49y" order="1,47" divisor="19856" bias="0" preserveAlpha="false" kernelMatrix=" 15 21 30 42 57 77 101 132 169 212 263 320 384 453 527 603 678 752 820 881 931 968 992 1000 992 968 931 881 820 752 678 603 527 453 384 320 263 212 169 132 101 77 57 42 30 21 15"></feConvolveMatrix><feConvolveMatrix id="9_|_x" result="49x" order="47,1" divisor="19856" bias="0" preserveAlpha="false" kernelMatrix=" 15 21 30 42 57 77 101 132 169 212 263 320 384 453 527 603 678 752 820 881 931 968 992 1000 992 968 931 881 820 752 678 603 527 453 384 320 263 212 169 132 101 77 57 42 30 21 15"></feConvolveMatrix><feTurbulence class="seed" result="noise" type="fractalNoise" stitchTiles="stitch" seed="43" baseFrequency="0.06 0.08 " numOctaves="3"></feTurbulence><feMorphology operator="erode" radius="1.2"></feMorphology><feComposite in="noise" operator="arithmetic" k1="0" k2="8" k3="0" k4="-3"></feComposite><feComposite in="49x" result="49noise" operator="arithmetic" k1="0" k2="2" k3="-0.2" k4="-1"></feComposite><feComposite in="49noise" in2="19x" operator="arithmetic" k1="0" k2="0.5" k3="1.5" k4="-1"></feComposite><feDiffuseLighting surfaceScale="2" lighting-color="#fff"><feDistantLight azimuth="240" elevation="20"></feDistantLight></feDiffuseLighting><feComposite in2="SourceGraphic" operator="arithmetic" k1="1" k2="0" k3="0" k4="0"></feComposite></filter><filter height="170%" id="sh2" width="170%" x="-0.2" y="-0.2"><feOffset dx="0" dy="0" in="SourceAlpha"></feOffset><feGaussianBlur stdDeviation="1.2"></feGaussianBlur><feColorMatrix result="out" type="matrix" values=" 
               0 0 0 0 0.4         
               0 0 0 0 0.4                    
               0 0 0 0 0.4                
               0 0 0 10 0 "></feColorMatrix><feMerge><feMergeNode in="out"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter><filter height="130%" id="sh1" width="130%" x="-0.2" y="-0.2"><feOffset dx="3" dy="4" in="SourceAlpha"></feOffset><feGaussianBlur stdDeviation="3"></feGaussianBlur><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.8 0"></feColorMatrix><feBlend in="SourceGraphic"></feBlend></filter><linearGradient id="svg_66" x1="0" x2="1" y1="0" y2="0"><stop offset="0" stop-color="hsl(40, 23%, 35%)"></stop><stop offset="0.4" stop-color="hsl(40, 23%, 60%)"></stop><stop offset="0.65" stop-color="hsl(40, 23%, 70%)"></stop><stop offset="0.75" stop-color="hsl(40, 23%, 60%)"></stop><stop offset="1" stop-color="hsl(40, 23%, 35%)"></stop></linearGradient><circle id="bell" fill="#070" stroke="#030" r="5.5" filter="url(#sh0)"></circle><g id="cap" filter="url(#sh2)"><path id="capPath" fill="#070" filter="url(#sh0)" stroke="#030" d="M72,89 C78.6,68 67.2,30.7 89,68 C86.9,37.6 66.91,32 62,61 C58,44.1 67.5,38.8 52,10 C53.6,47 46.91,36.2 45,61 C39.3,43.4 22,46.6 13,43 C32.9,55.8 35.7,66.62 32,89 C35,97.9 68.6,99 72,89 Z"></path><use id="bell1" x="13" y="43" href="#bell"></use><use id="bell2" x="52" y="10" href="#bell"></use><use id="bell3" x="89" y="68" href="#bell"></use><ellipse cx="52.19" cy="90.01" fill="url(#svg_66)" rx="14.76" ry="3.56"></ellipse><path d="M34,86.5C36,82,53.5,81,60,83C54,81,34,81.5,34,86.5Z" fill="none" stroke="hsl(40, 23%, 60%)"></path></g></defs><use href="#cap"></use></svg>`);function Kl(e){var n=Jl();E(e,n)}var Yl=W('<div class="slot-container svelte-12whdgj"><!></div>'),Ql=W('<div class="button-icon-wrapper svelte-12whdgj"><div class="button-icon svelte-12whdgj"><!></div></div>'),Xl=W('<div class="button-icon-wrapper svelte-12whdgj"><span class="button-icon svelte-12whdgj"><!></span></div>'),ec=W("<div></div>"),tc=W("<!> <!>",1),nc=W('<span class="button-text svelte-12whdgj"><!></span>'),rc=W('<button><div class="button-shape svelte-12whdgj"><!></div></button>');function Vt(e,n){const r=tl(n);Et(n,!1);const s=G(),a=G(),i=G();let l=Fe(n,"label",8,""),u=Fe(n,"icon",8,""),o=Fe(n,"component",8,null),c=Fe(n,"color",8,"#666666"),v=Fe(n,"textColor",8,""),f=Fe(n,"backgroundStyle",8,""),x=Fe(n,"customStyle",8,""),_=Fe(n,"disabled",8,!1),C=Fe(n,"data",8,null),S=Fe(n,"width",8,120),O=Fe(n,"height",8,80),j=Fe(n,"shape",8,"rect"),Z=Fe(n,"side",8,""),m=Fe(n,"active",8,!1),U=Fe(n,"showShape",8,""),k=Fe(n,"notificationStyle",8,null);const b=Pn();let g,M=!1;function ee(){!_()&&!M&&(console.log("ðŸ–±ï¸ [Button Click] Clicked button:",l(),"Type:",C()?.type,"ID:",C()?.id),C()?.type==="category"&&console.log("âž¡ï¸ [Navigation] Triggering navigateToCategory for ID:",C().id),b("click",{data:C(),label:l()}))}function F(se){_()||(se.preventDefault(),b("secondaryaction",{data:C(),label:l(),mouseX:se.clientX,mouseY:se.clientY,originalEvent:se}))}function te(se){!_()&&se.button===0&&(M=!1,g=setTimeout(()=>{M=!0,b("secondaryaction",{data:C(),label:l(),mouseX:se.clientX,mouseY:se.clientY,originalEvent:se})},500))}function J(){clearTimeout(g),setTimeout(()=>{M=!1},10)}function N(){clearTimeout(g),M=!1}Ge(()=>Q(Z()),()=>{y(s,Z()==="left"||Z()==="right")}),Ge(()=>Q(l()),()=>{y(a,l())}),Ge(()=>(Q(j()),t(s),Q(Z())),()=>{y(i,j()==="hex"&&t(s)?Z()==="left"?"polygon(0% 0%, 100% 25%, 100% 75%, 0% 100%)":"polygon(0% 25%, 100% 0%, 100% 100%, 0% 75%)":j()==="hex"?"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)":"none")}),xn(),Pt();var V=rc();let A;var z=p(V),Ae=p(z);{var Me=se=>{var D=Yl(),I=p(D);el(I,n,"default",{}),E(se,D)},Be=se=>{var D=Ue(),I=Se(D);{var H=re=>{var ae=tc(),fe=Se(ae);{var pe=we=>{var he=Ql(),Te=p(he),Oe=p(Te);oi(Oe,o,(Le,Ce)=>{Ce(Le,{})}),E(we,he)},ge=we=>{var he=Ue(),Te=Se(he);{var Oe=Le=>{var Ce=Xl(),ve=p(Ce),Ee=p(ve);fs(Ee,u),E(Le,Ce)};X(Te,Le=>{u()&&Le(Oe)},!0)}E(we,he)};X(fe,we=>{o()?we(pe):we(ge,!1)})}var be=w(fe,2);{var de=we=>{var he=ec();ce(()=>it(he,1,`shape-overlay ${U()??""}`,"svelte-12whdgj")),E(we,he)};X(be,we=>{U()&&we(de)})}E(re,ae)},ue=re=>{var ae=Ue(),fe=Se(ae);{var pe=ge=>{var be=nc(),de=p(be);fs(de,()=>t(a)),ce(()=>$n(be,x())),E(ge,be)};X(fe,ge=>{l()&&ge(pe)},!0)}E(re,ae)};X(I,re=>{o()||u()||U()?re(H):re(ue,!1)},!0)}E(se,D)};X(Ae,se=>{T(()=>r.default)?se(Me):se(Be,!1)})}ce(se=>{A=it(V,1,`universal-button ${j()??""}`,"svelte-12whdgj",A,se),$n(V,`
    --button-width: ${S()??""}px; 
    --button-height: ${O()??""}px; 
    --button-color: ${c()??""};
    ${v()?`--button-text-color: ${v()};`:""}
    ${f()?`--button-background-style: ${f()};`:""}
    --clip-path: ${t(i)??""};
    ${x()??""}
  `)},[()=>({disabled:_(),half:t(s),left:Z()==="left",right:Z()==="right",active:m(),notification:!!k(),error:k()==="error",warning:k()==="warning",success:k()==="success",print:k()?.startsWith("print")})]),ne("click",V,ee),ne("contextmenu",V,F),ne("mousedown",V,te),ne("mouseup",V,J),ne("mouseleave",V,N),E(e,V),It()}var ac=W('<span class="table-number svelte-x88uh0"> </span>'),sc=W('<div class="pinpad-error-message svelte-x88uh0"> </div>'),ic=W('<span class="qty svelte-x88uh0"> </span>'),oc=W('<span class="input-overlay svelte-x88uh0"> </span>'),lc=W('<li><!> <div class="name-container svelte-x88uh0"><span> </span> <!></div> <span class="price svelte-x88uh0"> </span></li>'),cc=W('<div class="view-content order-view svelte-x88uh0"><div class="orders-stack svelte-x88uh0"><div class="parked-orders-section svelte-x88uh0"><!></div> <div class="active-order-section svelte-x88uh0"><div class="order-content svelte-x88uh0"><h2 class="svelte-x88uh0"><span class="order-number svelte-x88uh0"> </span><!></h2> <!> <div class="scrollable-items-content svelte-x88uh0"><ul class="item-list svelte-x88uh0"></ul></div> <div class="spacer svelte-x88uh0"></div> <div class="total svelte-x88uh0"><span class="svelte-x88uh0">Total:</span> <span class="price svelte-x88uh0"> </span></div></div></div></div></div>'),uc=W('<div class="view-content receipts-view svelte-x88uh0"><div class="receipts-stack svelte-x88uh0"><!></div></div>'),dc=W('<div class="agent-header-icon svelte-x88uh0"><!></div>'),fc=W('<div class="message-actions svelte-x88uh0"></div>'),vc=W('<div><div class="message-header svelte-x88uh0"><span class="message-timestamp svelte-x88uh0"> </span> <span class="message-type svelte-x88uh0"> </span></div> <div class="message-content svelte-x88uh0"> </div> <!></div>'),pc=W(' <span class="cursor svelte-x88uh0">|</span>',1),gc=W(' <span class="cursor svelte-x88uh0">|</span>',1),mc=W('<span class="cursor svelte-x88uh0">|</span>'),hc=W('<div class="agent-message user draft svelte-x88uh0"><div class="message-header svelte-x88uh0"><span class="message-timestamp svelte-x88uh0"> </span> <span class="message-type svelte-x88uh0">User</span></div> <div class="message-content svelte-x88uh0"><!></div></div>'),yc=W('<div class="view-content agent-view svelte-x88uh0"><!> <div class="scroll-content svelte-x88uh0"><div class="agent-messages svelte-x88uh0"><!> <!></div></div></div>'),_c=W('<div class="console-view svelte-x88uh0"><div class="content-area svelte-x88uh0"><!></div></div>');function bc(e,n){Et(n,!1);const[r,s]=$r(),a=()=>vt(Je,"$orderStore",r),i=()=>vt(lt,"$currentView",r),l=()=>vt(Jr,"$receiptsStore",r),u=()=>vt(me,"$agentStore",r),o=()=>vt(je,"$pinpadStore",r),c=()=>vt(mi,"$uiConstantsStore",r),v=Pn();let f=G(),x=G(),_=G(),C=!1,S=G(!1),O=!1,j=G(!1),Z=G("order"),m=G(!1),U=G(a().status),k=G(a().items.length),b=G(a().transactionId),g=G(a().metadata?.table),M=G(i());ln(()=>{setTimeout(()=>{if(O||(N(),J(),O=!0),i()==="agent"&&me.shouldActivatePinpadOnLoad()&&je.activate("agent",()=>{},()=>{},"numeric"),t(f)){const I=new ResizeObserver(()=>{t(f)&&y(j,t(f).scrollHeight>t(f).clientHeight)});return I.observe(t(f)),y(j,t(f).scrollHeight>t(f).clientHeight),()=>{I.disconnect()}}},200)}),gl(()=>{if(!t(S)){let I=null;i()==="order"?I=t(x):i()==="agent"?I=t(f):i()==="receipts"&&(I=t(_)),I&&setTimeout(()=>{if(I&&!t(S)){if(J(),i()==="agent"&&t(f)){const H=t(f).scrollHeight>t(f).clientHeight;H!==t(j)&&y(j,H)}C||(y(S,!0),I.scrollTop=I.scrollHeight,setTimeout(()=>{y(S,!1),J()},100))}},50)}});function ee(I){if(typeof I=="object"&&I!==null)return I;if(typeof I=="string")try{return JSON.parse(I)}catch{return I}return I}function F(){const H={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"Select language / Sprache auswÃ¤hlen / Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ·Ñ‹Ðº:",actions:[{id:"lang-de",label:"DE",action:"selectLanguage",param:"DE"},{id:"lang-en",label:"EN",action:"selectLanguage",param:"EN"},{id:"lang-ru",label:"RU",action:"selectLanguage",param:"RU"}]};me.addMessage(H),setTimeout(()=>{t(f)&&(Qe(f,t(f).scrollTop=t(f).scrollHeight),J())},100)}function te(I,H){if(I==="selectLanguage"){je.switchLanguage(H);const ue=u().messages.filter(fe=>!fe.actions);me.clearMessages(),ue.forEach(fe=>me.addMessage(fe));const ae={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Language changed to ${H}`};me.addMessage(ae),setTimeout(()=>{t(f)&&(Qe(f,t(f).scrollTop=t(f).scrollHeight),J())},100)}}function J(){if(!t(S)){let I=null;if(i()==="order"?I=t(x):i()==="agent"?I=t(f):i()==="receipts"&&(I=t(_)),I){const ue=I.scrollTop,re=I.clientHeight,ae=I.scrollHeight;C=ue+re>=ae-1}else C=!0;v("scrollstate",C)}}function N(){let I=null;i()==="order"?I=t(x):i()==="agent"?I=t(f):i()==="receipts"&&(I=t(_)),I&&(I.scrollTop=I.scrollHeight,C=!0)}function V(){if(xt(nr).hasNotification){lt.set("agent");return}let H;switch(t(Z)){case"order":H=["order","receipts","agent"];break;case"receipts":H=["receipts","order","agent"];break;case"agent":H=["agent","order","receipts"];break;default:H=["order","receipts","agent"]}const re=(H.indexOf(i())+1)%H.length,ae=H[re];i()==="receipts"&&ae!=="receipts"&&y(m,!1),lt.set(ae)}function A(){return C}ln(()=>{const I=ye.subscribe(H=>{if(H.lastMessage?.command==="menu-import-progress"){const ue=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});me.addMessage({timestamp:ue,type:"agent",message:H.lastMessage.payload.message}),setTimeout(()=>{t(f)&&i()==="agent"&&(Qe(f,t(f).scrollTop=t(f).scrollHeight),J())},100)}});return()=>{I()}}),typeof window<"u"&&window.electronAPI&&window.electronAPI.onImportComplete&&window.electronAPI.onImportComplete((I,H)=>{const ue=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});me.addMessage({timestamp:ue,type:"agent",message:H}),I&&(K("INFO","Refreshing categories after successful menu import"),ye.send({command:"getCategories"}),setTimeout(()=>{const re=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});me.addMessage({timestamp:re,type:"agent",message:"Menu import completed successfully! Your new menu structure is now ready for use. You can navigate back to the selection area to explore the imported categories and products."}),setTimeout(()=>{t(f)&&i()==="agent"&&(Qe(f,t(f).scrollTop=t(f).scrollHeight),J())},100)},1e3)),setTimeout(()=>{t(f)&&i()==="agent"&&(Qe(f,t(f).scrollTop=t(f).scrollHeight),J())},100)}),Ge(()=>(i(),t(M),nr),()=>{i()==="agent"&&t(M)!=="agent"?(console.log("ðŸ”µ [ConsoleView] User switched TO agent view, will clear notification in 100ms"),console.log("ðŸ”µ [ConsoleView] Previous view:",t(M),"Current view:",i()),setTimeout(()=>{console.log("ðŸ”µ [ConsoleView] Clearing notification now"),nr.clearNotification()},100)):i()==="agent"&&t(M)==="agent"?console.log("ðŸ”µ [ConsoleView] Already in agent view, NOT clearing notification"):i()!=="agent"&&console.log("ðŸ”µ [ConsoleView] Not in agent view, NOT clearing notification. Current view:",i()),y(M,i())}),Ge(()=>(t(U),a(),t(_)),()=>{t(U)==="finished"&&a().status==="idle"&&(y(Z,"receipts"),y(m,!0),lt.set("receipts"),Jr.refresh(),setTimeout(()=>{t(_)&&(Qe(_,t(_).scrollTop=t(_).scrollHeight),J())},300)),y(U,a().status)}),Ge(()=>(l(),t(_),i()),()=>{l().receipts&&t(_)&&i()==="receipts"&&setTimeout(()=>{J()},100)}),Ge(()=>(u(),t(f),i(),t(j)),()=>{u().messages&&t(f)&&i()==="agent"&&setTimeout(()=>{if(t(f)){const I=t(f).scrollHeight>t(f).clientHeight;I!==t(j)&&y(j,I)}},100)}),Ge(()=>(i(),t(x),a(),t(k),t(b),t(g)),()=>{if(i()==="order"&&t(x)){const I=a().items.length,H=a().transactionId,ue=a().metadata?.table;(I!==t(k)||H!==t(b)||ue!==t(g))&&setTimeout(()=>{t(x)&&Qe(x,t(x).scrollTop=t(x).scrollHeight)},100),y(k,I),y(b,H),y(g,ue)}}),xn(),Pt();var z=_c(),Ae=p(z),Me=p(Ae);{var Be=I=>{var H=cc(),ue=p(H),re=p(ue),ae=p(re);Zl(ae,{});var fe=w(re,2),pe=p(fe),ge=p(pe),be=p(ge),de=p(be),we=w(be);{var he=$=>{var P=ac(),le=p(P);ce(()=>oe(le,`#${o(),a(),T(()=>o().isActive&&o().mode==="table"?o().liveValue:a().metadata?.table)??""}`)),E($,P)};X(we,$=>{a(),o(),T(()=>a().metadata?.table||o().isActive&&o().mode==="table")&&$(he)})}var Te=w(ge,2);{var Oe=$=>{var P=sc(),le=p(P);ce(()=>oe(le,(o(),T(()=>o().errorMessage)))),E($,P)};X(Te,$=>{o(),T(()=>o().errorMessage)&&$(Oe)})}var Le=w(Te,2),Ce=p(Le);Ot(Ce,5,()=>(a(),T(()=>a().items)),$=>$.id,($,P)=>{var le=lc();let _e;var Ve=p(le);{var yt=Ke=>{var nt=ic(),Ct=p(nt);ce(st=>oe(Ct,`${st??""}x`),[()=>(t(P),T(()=>parseFloat(t(P).quantity)))]),E(Ke,nt)};X(Ve,Ke=>{t(P),T(()=>parseFloat(t(P).quantity)>1)&&Ke(yt)})}var gt=w(Ve,2),_t=p(gt);let tt;var bt=p(_t),wt=w(_t,2);{var kt=Ke=>{var nt=oc(),Ct=p(nt);ce(()=>oe(Ct,(o(),T(()=>o().liveValue)))),E(Ke,nt)};X(wt,Ke=>{a(),t(P),o(),T(()=>a().activeTransactionItemId===t(P).id&&o().isActive&&o().mode!=="agent"&&o().liveValue)&&Ke(kt)})}var at=w(gt,2),Ne=p(at);ce((Ke,nt,Ct,st)=>{_e=it(le,1,"svelte-x88uh0",null,_e,Ke),tt=it(_t,1,"name svelte-x88uh0",null,tt,nt),oe(bt,Ct),oe(Ne,st)},[()=>({active:a().activeTransactionItemId===t(P).id}),()=>({"input-mode":a().activeTransactionItemId===t(P).id&&o().isActive&&o().mode!=="agent"&&o().liveValue}),()=>(t(P),T(()=>t(P).display_names?ee(t(P).display_names).menu.de||"N/A":"Loading...")),()=>(Q(Rt),t(P),T(()=>Rt(parseFloat(t(P).total_price))))]),E($,le)});var ve=w(Le,4),Ee=w(p(ve),2),xe=p(Ee);bn(ue,$=>y(x,$),()=>t(x)),ce($=>{oe(de,`Order â„–${a(),T(()=>a().transactionId||"...")??""}`),oe(xe,$)},[()=>(Q(Rt),a(),T(()=>Rt(a().total)))]),ne("scroll",ue,()=>!t(S)&&J()),E(I,H)},se=I=>{var H=Ue(),ue=Se(H);{var re=fe=>{var pe=uc(),ge=p(pe),be=p(ge);Vl(be,{get autoExpandLatest(){return t(m)}}),bn(ge,de=>y(_,de),()=>t(_)),ne("scroll",ge,()=>!t(S)&&J()),E(fe,pe)},ae=fe=>{var pe=Ue(),ge=Se(pe);{var be=de=>{var we=yc(),he=p(we);{var Te=xe=>{var $=dc(),P=p($);Kl(P),E(xe,$)};X(he,xe=>{t(j)||xe(Te)})}var Oe=w(he,2),Le=p(Oe),Ce=p(Le);Ot(Ce,1,()=>(u(),T(()=>u().messages)),Er,(xe,$)=>{var P=vc();let le;var _e=p(P),Ve=p(_e),yt=p(Ve),gt=w(Ve,2),_t=p(gt),tt=w(_e,2),bt=p(tt),wt=w(tt,2);{var kt=at=>{var Ne=fc();Ot(Ne,5,()=>(t($),T(()=>t($).actions)),Er,(Ke,nt)=>{{let Ct=ot(()=>(t(nt),T(()=>({display:t(nt).label,action:()=>te(t(nt).action,t(nt).param)})))),st=ot(()=>(c(),T(()=>({width:c().MIN_BUTTON_WIDTH,height:Math.round(c().MIN_BUTTON_WIDTH*.4)}))));Vt(Ke,{get content(){return t(Ct)},get size(){return t(st)},style:"rectangular"})}}),E(at,Ne)};X(wt,at=>{t($),T(()=>t($).actions)&&at(kt)})}ce(at=>{le=it(P,1,"agent-message svelte-x88uh0",null,le,at),oe(yt,(t($),T(()=>t($).timestamp))),oe(_t,(t($),T(()=>t($).type==="user"?"User":"Agent"))),oe(bt,(t($),T(()=>t($).message)))},[()=>({user:t($).type==="user",agent:t($).type==="agent",error:t($).style==="error",success:t($).style==="success",warning:t($).style==="warning",print:t($).style?.startsWith("print")})]),E(xe,P)});var ve=w(Ce,2);{var Ee=xe=>{var $=hc(),P=p($),le=p(P),_e=p(le),Ve=w(P,2),yt=p(Ve);{var gt=tt=>{var bt=pc(),wt=Se(bt);ce(kt=>oe(wt,kt),[()=>(o(),T(()=>"*".repeat(o().liveValue.length)))]),E(tt,bt)},_t=tt=>{var bt=Ue(),wt=Se(bt);{var kt=Ne=>{var Ke=gc(),nt=Se(Ke);ce(()=>oe(nt,(u(),T(()=>u().draftMessage.message)))),E(Ne,Ke)},at=Ne=>{var Ke=mc();E(Ne,Ke)};X(wt,Ne=>{o(),u(),T(()=>o().layout==="alpha"&&u().draftMessage)?Ne(kt):Ne(at,!1)},!0)}E(tt,bt)};X(yt,tt=>{o(),T(()=>o().layout==="numeric")?tt(gt):tt(_t,!1)})}ce(tt=>oe(_e,tt),[()=>T(()=>new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}))]),E(xe,$)};X(ve,xe=>{o(),T(()=>o().isActive&&o().mode==="agent")&&xe(Ee)})}bn(Oe,xe=>y(f,xe),()=>t(f)),ne("scroll",Oe,()=>!t(S)&&J()),E(de,we)};X(ge,de=>{i()==="agent"&&de(be)},!0)}E(fe,pe)};X(ue,fe=>{i()==="receipts"?fe(re):fe(ae,!1)},!0)}E(I,H)};X(Me,I=>{i()==="order"?I(Be):I(se,!1)})}E(e,z),Dr(n,"scrollToBottom",N),Dr(n,"cycleViews",V),Dr(n,"getIsAtBottom",A),Dr(n,"displayLanguageSelector",F);var D=It({scrollToBottom:N,cycleViews:V,getIsAtBottom:A,displayLanguageSelector:F});return s(),D}const Wa=ut(!1);function wc(){Wa.update(e=>!e)}function Cc(){Wa.set(!1)}var xc=W('<div class="pinpad-grid numeric svelte-l3qs12"><button class="numpad-key svelte-l3qs12">1</button> <button class="numpad-key svelte-l3qs12">2</button> <button class="numpad-key svelte-l3qs12">3</button> <button class="function-key key-cancel svelte-l3qs12" aria-label="Cancel">X</button> <button class="numpad-key svelte-l3qs12">4</button> <button class="numpad-key svelte-l3qs12">5</button> <button class="numpad-key svelte-l3qs12">6</button> <button class="function-key key-correct svelte-l3qs12" aria-label="Correct">â†</button> <button class="numpad-key svelte-l3qs12">7</button> <button class="numpad-key svelte-l3qs12">8</button> <button class="numpad-key svelte-l3qs12">9</button> <button class="function-key key-enter svelte-l3qs12" aria-label="Enter">â†µ</button> <button class="numpad-key function-key key-plus svelte-l3qs12">.99</button> <button class="numpad-key svelte-l3qs12">0</button> <button class="numpad-key function-key key-minus svelte-l3qs12">.</button></div>'),Sc=W('<button class="alpha-key letter-key svelte-l3qs12"> </button>'),Tc=W('<div class="alpha-row svelte-l3qs12"></div>'),kc=W('<div class="pinpad-grid alpha svelte-l3qs12"><!> <div class="alpha-bottom-row svelte-l3qs12"><button class="alpha-key space-key svelte-l3qs12" aria-label="Space">space</button> <button class="function-key cursor-key svelte-l3qs12" aria-label="Move cursor left">â†</button> <button class="function-key cursor-key svelte-l3qs12" aria-label="Move cursor right">â†’</button> <button class="function-key language-key svelte-l3qs12" aria-label="Switch language"> </button> <button class="function-key key-cancel svelte-l3qs12" aria-label="Cancel">X</button> <button class="function-key key-correct svelte-l3qs12" aria-label="Backspace">âŒ«</button> <button class="function-key key-enter key-enter-large svelte-l3qs12" aria-label="Enter">â†µ</button></div></div>'),Ec=W('<div class="pinpad-wrapper svelte-l3qs12"><!></div>');function Ic(e,n){Et(n,!1);const[r,s]=$r(),a=()=>vt(je,"$pinpadStore",r);let i=Fe(n,"onClose",8,()=>{}),l=Fe(n,"minButtonSize",8,160),u=G(0),o=G(0),c=G(80),v=G(107),f=G(50),x=G(50),_=null,C=null;const S=6;let O=G(0),j=G(null),Z=G(null),m=G(null),U=G(null);function k(se){je.append(se,me)}function b(){je.backspace(me)}function g(){je.confirm()}function M(){je.cancel(me)}function ee(){i()()}function F(se){C=se,_=setTimeout(()=>{C===se&&(je.append(se.toUpperCase(),me),C=null)},500)}function te(){_&&(clearTimeout(_),_=null),C&&(je.append(C.toLowerCase(),me),C=null)}function J(){_&&(clearTimeout(_),_=null),C=null}function N(){je.moveCursorLeft()}function V(){je.moveCursorRight()}function A(){je.switchLanguage()}Ge(()=>(t(o),t(O),t(j)),()=>{t(o)>0&&Math.abs(t(o)-t(O))>5&&(t(j)&&clearTimeout(t(j)),y(j,setTimeout(()=>{y(O,t(o))},50)))}),Ge(()=>(a(),t(O),t(Z),t(m),t(U),Q(l()),t(f),t(v)),()=>{const se=a().layout,D=a().currentLanguage;if(t(O)>0&&(t(Z)!==se||t(m)!==D||t(U)!==l()||t(Z)===null&&t(m)===null)){if(se==="alpha"&&a().layouts&&D){const I=a().layouts[D],H=Math.max(...I.map(fe=>fe.length)),ue=t(O)-S*(H-1);let re=Math.floor(ue/H);const ae=l();re>ae&&(re=ae),y(f,re),y(x,Math.floor(t(f)*(3/4)))}else if(se==="numeric"){const H=t(O)-S*3;let ue=Math.floor(H/4);const re=l();ue>re&&(ue=re),y(v,ue),y(c,Math.floor(t(v)*(3/4)))}y(Z,se),y(m,D),y(U,l())}}),xn(),Pt();var z=Ec(),Ae=p(z);{var Me=se=>{var D=xc(),I=p(D),H=w(I,2),ue=w(H,2),re=w(ue,2),ae=w(re,2),fe=w(ae,2),pe=w(fe,2),ge=w(pe,2),be=w(ge,2),de=w(be,2),we=w(de,2),he=w(we,2),Te=w(he,2),Oe=w(Te,2),Le=w(Oe,2);ce(()=>$n(D,`--button-height: ${t(c)??""}px; --button-width: ${t(v)??""}px;`)),ne("click",I,()=>k("1")),ne("click",H,()=>k("2")),ne("click",ue,()=>k("3")),ne("click",re,M),ne("dblclick",re,ee),ne("click",ae,()=>k("4")),ne("click",fe,()=>k("5")),ne("click",pe,()=>k("6")),ne("click",ge,b),ne("click",be,()=>k("7")),ne("click",de,()=>k("8")),ne("click",we,()=>k("9")),ne("click",he,g),ne("click",Te,()=>k(".99")),ne("click",Oe,()=>k("0")),ne("click",Le,()=>k(".")),E(se,D)},Be=se=>{var D=Ue(),I=Se(D);{var H=ue=>{var re=kc(),ae=p(re);Ot(ae,1,()=>(a(),T(()=>a().layouts[a().currentLanguage])),Er,(Le,Ce)=>{var ve=Tc();Ot(ve,5,()=>t(Ce),Er,(Ee,xe)=>{var $=Sc(),P=p($);ce(()=>{ol($,"aria-label",`Letter ${t(xe)??""}`),oe(P,t(xe))}),ne("mousedown",$,()=>F(t(xe))),ne("mouseup",$,te),ne("mouseleave",$,J),E(Ee,$)}),E(Le,ve)});var fe=w(ae,2),pe=p(fe),ge=w(pe,2),be=w(ge,2),de=w(be,2),we=p(de),he=w(de,2),Te=w(he,2),Oe=w(Te,2);ce(()=>{$n(re,`--alpha-button-width: ${t(f)??""}px; --alpha-button-height: ${t(x)??""}px;`),oe(we,(a(),T(()=>a().currentLanguage)))}),ne("click",pe,()=>k(" ")),ne("click",ge,N),ne("click",be,V),ne("click",de,A),ne("click",he,M),ne("dblclick",he,ee),ne("click",Te,b),ne("click",Oe,g),E(ue,re)};X(I,ue=>{a(),T(()=>a().layout==="alpha")&&ue(H)},!0)}E(se,D)};X(Ae,se=>{a(),T(()=>a().layout==="numeric")?se(Me):se(Be,!1)})}ms(z,"clientHeight",se=>y(u,se)),ms(z,"clientWidth",se=>y(o,se)),E(e,z),It(),s()}var Mc=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Description:</span> <span class="value svelte-yjty9j"> </span></div>'),Ac=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Allergens:</span> <span class="value svelte-yjty9j"> </span></div>'),$c=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Dietary:</span> <span class="value svelte-yjty9j"> </span></div>'),Lc=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Category:</span> <span class="value svelte-yjty9j"> </span></div>'),Rc=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Status:</span> <span class="value svelte-yjty9j"> </span></div>'),Oc=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Last Modified:</span> <span class="value svelte-yjty9j"> </span></div>'),Nc=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Product ID:</span> <span class="value svelte-yjty9j"> </span></div>'),Pc=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Price:</span> <span class="value svelte-yjty9j"> </span></div> <!> <!> <!> <!> <!> <!> <!>',1),Dc=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Type:</span> <span class="value svelte-yjty9j"> </span></div>'),Bc=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Category ID:</span> <span class="value svelte-yjty9j"> </span></div>'),Uc=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Parent Category:</span> <span class="value svelte-yjty9j"> </span></div>'),Fc=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Main Group:</span> <span class="value svelte-yjty9j"> </span></div>'),jc=W('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Source ID:</span> <span class="value svelte-yjty9j"> </span></div>'),zc=W("<!> <!> <!> <!> <!>",1),Gc=W('<div class="context-menu svelte-yjty9j"><div class="menu-header svelte-yjty9j"><h3 class="svelte-yjty9j"><!></h3></div> <div class="menu-content svelte-yjty9j"><!></div> <div class="menu-footer svelte-yjty9j"><button class="edit-button svelte-yjty9j">Edit</button> <button class="advanced-edit-button svelte-yjty9j">View</button> <button class="close-button svelte-yjty9j">Close</button></div></div>');function qc(e,n){Et(n,!1);const r=G(),s=G(),a=G();let i=Fe(n,"item",8,null),l=Fe(n,"x",8,0),u=Fe(n,"y",8,0),o=Fe(n,"visible",8,!1);const c=Pn();let v=G(),f=G(0),x=G(0);ln(()=>{function g(ee){t(v)&&!t(v).contains(ee.target)&&c("close")}function M(ee){ee.key==="Escape"&&c("close")}return o()&&(document.addEventListener("click",g),document.addEventListener("keydown",M)),()=>{document.removeEventListener("click",g),document.removeEventListener("keydown",M)}});function _(g){return typeof g=="number"?`â‚¬${g.toFixed(2)}`:i()&&i().item_price_value&&typeof i().item_price_value=="number"?`â‚¬${i().item_price_value.toFixed(2)}`:g||"N/A"}function C(g){try{const M=JSON.parse(g);return M.menu?.de||M.button?.de||M.de||"Unnamed"}catch{return g||"Unnamed"}}function S(g){try{return JSON.parse(g).de||"Unnamed Category"}catch{return g||"Unnamed Category"}}function O(g){try{return JSON.parse(g)}catch{return{}}}function j(){if(!t(v))return;const g=t(v).getBoundingClientRect(),M=window.innerWidth,ee=window.innerHeight;if(g.width===0||g.height===0){setTimeout(()=>j(),10);return}const F=10,te=10,J=g.width>M-F*2,N=g.height>ee-F*2;let V,A;J&&N?(V=F,A=F):J?(V=F,A=u()+te,A+g.height>ee-F&&(A=u()-g.height-te),A<F&&(A=F)):N?(A=F,V=l()+te,V+g.width>M-F&&(V=l()-g.width-te),V<F&&(V=F)):(V=l()+te,A=u()+te,V+g.width>M-F&&(V=l()-g.width-te),A+g.height>ee-F&&(A=u()-g.height-te),V<F&&(V=F),A<F&&(A=F)),y(f,V),y(x,A)}function Z(){c("edit",{item:i()}),c("close")}function m(){c("advanced-edit",{item:i()}),c("close")}Ge(()=>Q(i()),()=>{y(r,i()&&i().category_names)}),Ge(()=>Q(i()),()=>{y(s,i()&&i().display_names)}),Ge(()=>(t(s),Q(i())),()=>{y(a,t(s)&&i().additional_item_attributes?O(i().additional_item_attributes):{})}),Ge(()=>(Q(o()),t(v)),()=>{o()&&t(v)&&requestAnimationFrame(()=>j())}),xn(),Pt();var U=Ue(),k=Se(U);{var b=g=>{var M=Gc(),ee=p(M),F=p(ee),te=p(F);{var J=I=>{var H=Yt();ce(ue=>oe(H,ue),[()=>(Q(i()),T(()=>S(i().category_names)))]),E(I,H)},N=I=>{var H=Ue(),ue=Se(H);{var re=fe=>{var pe=Yt();ce(ge=>oe(pe,ge),[()=>(Q(i()),T(()=>C(i().display_names)))]),E(fe,pe)},ae=fe=>{var pe=Yt("Item Details");E(fe,pe)};X(ue,fe=>{t(s)?fe(re):fe(ae,!1)},!0)}E(I,H)};X(te,I=>{t(r)?I(J):I(N,!1)})}var V=w(ee,2),A=p(V);{var z=I=>{var H=Pc(),ue=Se(H),re=w(p(ue),2),ae=p(re),fe=w(ue,2);{var pe=$=>{var P=Mc(),le=w(p(P),2),_e=p(le);ce(()=>oe(_e,(t(a),T(()=>t(a).description)))),E($,P)};X(fe,$=>{t(a),T(()=>t(a).description)&&$(pe)})}var ge=w(fe,2);{var be=$=>{var P=Ac(),le=w(p(P),2),_e=p(le);ce(Ve=>oe(_e,Ve),[()=>(t(a),T(()=>t(a).allergens.join(", ")))]),E($,P)};X(ge,$=>{t(a),T(()=>t(a).allergens&&t(a).allergens.length>0)&&$(be)})}var de=w(ge,2);{var we=$=>{var P=$c(),le=w(p(P),2),_e=p(le);ce(Ve=>oe(_e,Ve),[()=>(t(a),T(()=>t(a).dietary_info.join(", ")))]),E($,P)};X(de,$=>{t(a),T(()=>t(a).dietary_info&&t(a).dietary_info.length>0)&&$(we)})}var he=w(de,2);{var Te=$=>{var P=Lc(),le=w(p(P),2),_e=p(le);ce(()=>oe(_e,(Q(i()),T(()=>i().associated_category_unique_identifier)))),E($,P)};X(he,$=>{Q(i()),T(()=>i().associated_category_unique_identifier)&&$(Te)})}var Oe=w(he,2);{var Le=$=>{var P=Rc(),le=w(p(P),2),_e=p(le);ce(()=>oe(_e,(Q(i()),T(()=>i().item_flags.is_sellable?"Available":"Not Available")))),E($,P)};X(Oe,$=>{Q(i()),T(()=>i().item_flags&&i().item_flags.is_sellable!==void 0)&&$(Le)})}var Ce=w(Oe,2);{var ve=$=>{var P=Oc(),le=w(p(P),2),_e=p(le);ce(Ve=>oe(_e,Ve),[()=>(Q(i()),T(()=>new Date(i().audit_trail.updated_at||i().audit_trail.created_at).toLocaleDateString()))]),E($,P)};X(Ce,$=>{Q(i()),T(()=>i().audit_trail)&&$(ve)})}var Ee=w(Ce,2);{var xe=$=>{var P=Nc(),le=w(p(P),2),_e=p(le);ce(()=>oe(_e,(Q(i()),T(()=>i().id)))),E($,P)};X(Ee,$=>{Q(i()),T(()=>i().id)&&$(xe)})}ce($=>oe(ae,$),[()=>(Q(i()),T(()=>_(i().item_price_value)))]),E(I,H)},Ae=I=>{var H=Ue(),ue=Se(H);{var re=ae=>{var fe=zc(),pe=Se(fe);{var ge=ve=>{var Ee=Dc(),xe=w(p(Ee),2),$=p(xe);ce(()=>oe($,(Q(i()),T(()=>i().category_type)))),E(ve,Ee)};X(pe,ve=>{Q(i()),T(()=>i().category_type)&&ve(ge)})}var be=w(pe,2);{var de=ve=>{var Ee=Bc(),xe=w(p(Ee),2),$=p(xe);ce(()=>oe($,(Q(i()),T(()=>i().id)))),E(ve,Ee)};X(be,ve=>{Q(i()),T(()=>i().id)&&ve(de)})}var we=w(be,2);{var he=ve=>{var Ee=Uc(),xe=w(p(Ee),2),$=p(xe);ce(()=>oe($,(Q(i()),T(()=>i().parent_category_unique_identifier)))),E(ve,Ee)};X(we,ve=>{Q(i()),T(()=>i().parent_category_unique_identifier)&&ve(he)})}var Te=w(we,2);{var Oe=ve=>{var Ee=Fc(),xe=w(p(Ee),2),$=p(xe);ce(()=>oe($,(Q(i()),T(()=>i().default_linked_main_group_unique_identifier)))),E(ve,Ee)};X(Te,ve=>{Q(i()),T(()=>i().default_linked_main_group_unique_identifier)&&ve(Oe)})}var Le=w(Te,2);{var Ce=ve=>{var Ee=jc(),xe=w(p(Ee),2),$=p(xe);ce(()=>oe($,(Q(i()),T(()=>i().source_unique_identifier)))),E(ve,Ee)};X(Le,ve=>{Q(i()),T(()=>i().source_unique_identifier)&&ve(Ce)})}E(ae,fe)};X(ue,ae=>{t(r)&&ae(re)},!0)}E(I,H)};X(A,I=>{t(s)?I(z):I(Ae,!1)})}var Me=w(V,2),Be=p(Me),se=w(Be,2),D=w(se,2);bn(M,I=>y(v,I),()=>t(v)),ce(()=>$n(M,`left: ${(t(f)||l())??""}px; top: ${(t(x)||u())??""}px;`)),ne("click",Be,()=>Z()),ne("click",se,()=>m()),ne("click",D,()=>c("close")),E(g,M)};X(k,g=>{o()&&i()&&g(b)})}E(e,U),It()}var Vc=W('<span class="error-message svelte-eqo6fo"> </span>'),Hc=W('<span class="error-message svelte-eqo6fo"> </span>'),Wc=W('<span class="error-message svelte-eqo6fo"> </span>'),Zc=W('<span class="error-message svelte-eqo6fo"> </span>'),Jc=W('<span class="error-message svelte-eqo6fo"> </span>'),Kc=W('<div class="modal-overlay svelte-eqo6fo" role="dialog" tabindex="-1"><div class="modal-content svelte-eqo6fo"><div class="modal-header svelte-eqo6fo"><h2 class="svelte-eqo6fo">Edit Product</h2> <button class="close-button svelte-eqo6fo" aria-label="Close">Ã—</button></div> <form class="product-form svelte-eqo6fo"><div class="form-group svelte-eqo6fo"><label for="product-name-menu" class="svelte-eqo6fo">Name (Menu)</label> <input id="product-name-menu" type="text" placeholder="Enter menu name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-name-button" class="svelte-eqo6fo">Name (Button)</label> <input id="product-name-button" type="text" placeholder="Enter button name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-name-receipt" class="svelte-eqo6fo">Name (Receipt)</label> <input id="product-name-receipt" type="text" placeholder="Enter receipt name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-price" class="svelte-eqo6fo">Price (â‚¬)</label> <input id="product-price" type="number" step="0.01" min="0" placeholder="0.00"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-category" class="svelte-eqo6fo">Category</label> <input id="product-category" type="text" placeholder="Enter category name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-description" class="svelte-eqo6fo">Description</label> <textarea id="product-description" placeholder="Enter product description (optional)" rows="3" class="svelte-eqo6fo"></textarea></div> <div class="form-actions svelte-eqo6fo"><button type="button" class="btn-cancel svelte-eqo6fo">Cancel</button> <button type="submit" class="btn-save svelte-eqo6fo"><!></button></div></form></div></div>');function Yc(e,n){Et(n,!1);const r=Pn();let s=Fe(n,"visible",8,!1),a=Fe(n,"product",8,null),i=G({name_menu:"",name_button:"",name_receipt:"",price:"",categoryName:"",description:""}),l=G({}),u=G(!1),o=G(!1),c=G({});function v(m){if(typeof m=="object"&&m!==null)return m;if(typeof m=="string")try{return JSON.parse(m)}catch{return m}return m}function f(){if(y(c,{}),t(i).name_menu.trim()||Qe(c,t(c).name_menu="Menu name is required"),t(i).name_button.trim()||Qe(c,t(c).name_button="Button name is required"),t(i).name_receipt.trim()||Qe(c,t(c).name_receipt="Receipt name is required"),!t(i).price.trim())Qe(c,t(c).price="Price is required");else{const m=parseFloat(t(i).price);(isNaN(m)||m<0)&&Qe(c,t(c).price="Price must be a valid positive number")}return t(i).categoryName.trim()||Qe(c,t(c).categoryName="Category is required"),Object.keys(t(c)).length===0}async function x(){if(f()){y(o,!0);try{const m={};t(i).name_menu!==t(l).name_menu&&(m.name_menu=t(i).name_menu.trim()),t(i).name_button!==t(l).name_button&&(m.name_button=t(i).name_button.trim()),t(i).name_receipt!==t(l).name_receipt&&(m.name_receipt=t(i).name_receipt.trim()),t(i).price!==t(l).price&&(m.price=parseFloat(t(i).price)),t(i).categoryName!==t(l).categoryName&&(m.categoryName=t(i).categoryName.trim()),t(i).description!==t(l).description&&(m.description=t(i).description.trim()),Object.keys(m).length>0&&r("save",{productId:a().id,updates:m}),_()}catch(m){console.error("Error saving product:",m)}finally{y(o,!1)}}}function _(){r("close")}function C(m){m.target===m.currentTarget&&_()}function S(m){m.key==="Escape"&&_()}Ge(()=>(Q(a()),Q(s()),t(i)),()=>{if(a()&&s()){const m=a().display_names?v(a().display_names):{},U=m.menu?.de||a().name||"",k=m.button?.de||m.menu?.de||a().name||"",b=m.receipt?.de||m.menu?.de||a().name||"";let g="Unknown Category";a().category_name?g=a().category_name:a().categoryName?g=a().categoryName:g=`Category ID: ${a().associated_category_unique_identifier||"N/A"}`,y(i,{name_menu:U,name_button:k,name_receipt:b,price:(a().item_price_value||a().price||0).toString(),categoryName:g,description:a().description||U}),y(l,{...t(i)}),y(u,!1),y(c,{})}}),Ge(()=>(Q(s()),t(i),t(l)),()=>{y(u,s()&&(t(i).name_menu!==t(l).name_menu||t(i).name_button!==t(l).name_button||t(i).name_receipt!==t(l).name_receipt||t(i).price!==t(l).price||t(i).categoryName!==t(l).categoryName||t(i).description!==t(l).description))}),xn(),Pt();var O=Ue();ne("keydown",Tr,S);var j=Se(O);{var Z=m=>{var U=Kc(),k=p(U),b=p(k),g=w(p(b),2),M=w(b,2),ee=p(M),F=w(p(ee),2);let te;var J=w(F,2);{var N=P=>{var le=Vc(),_e=p(le);ce(()=>oe(_e,(t(c),T(()=>t(c).name_menu)))),E(P,le)};X(J,P=>{t(c),T(()=>t(c).name_menu)&&P(N)})}var V=w(ee,2),A=w(p(V),2);let z;var Ae=w(A,2);{var Me=P=>{var le=Hc(),_e=p(le);ce(()=>oe(_e,(t(c),T(()=>t(c).name_button)))),E(P,le)};X(Ae,P=>{t(c),T(()=>t(c).name_button)&&P(Me)})}var Be=w(V,2),se=w(p(Be),2);let D;var I=w(se,2);{var H=P=>{var le=Wc(),_e=p(le);ce(()=>oe(_e,(t(c),T(()=>t(c).name_receipt)))),E(P,le)};X(I,P=>{t(c),T(()=>t(c).name_receipt)&&P(H)})}var ue=w(Be,2),re=w(p(ue),2);let ae;var fe=w(re,2);{var pe=P=>{var le=Zc(),_e=p(le);ce(()=>oe(_e,(t(c),T(()=>t(c).price)))),E(P,le)};X(fe,P=>{t(c),T(()=>t(c).price)&&P(pe)})}var ge=w(ue,2),be=w(p(ge),2);let de;var we=w(be,2);{var he=P=>{var le=Jc(),_e=p(le);ce(()=>oe(_e,(t(c),T(()=>t(c).categoryName)))),E(P,le)};X(we,P=>{t(c),T(()=>t(c).categoryName)&&P(he)})}var Te=w(ge,2),Oe=w(p(Te),2),Le=w(Te,2),Ce=p(Le),ve=w(Ce,2),Ee=p(ve);{var xe=P=>{var le=Yt("Saving...");E(P,le)},$=P=>{var le=Yt("Save Changes");E(P,le)};X(Ee,P=>{t(o)?P(xe):P($,!1)})}ce((P,le,_e,Ve,yt,gt)=>{F.disabled=t(o),te=it(F,1,"svelte-eqo6fo",null,te,P),A.disabled=t(o),z=it(A,1,"svelte-eqo6fo",null,z,le),se.disabled=t(o),D=it(se,1,"svelte-eqo6fo",null,D,_e),re.disabled=t(o),ae=it(re,1,"svelte-eqo6fo",null,ae,Ve),be.disabled=t(o),de=it(be,1,"svelte-eqo6fo",null,de,yt),Oe.disabled=t(o),Ce.disabled=t(o),ve.disabled=gt},[()=>({error:t(c).name_menu}),()=>({error:t(c).name_button}),()=>({error:t(c).name_receipt}),()=>({error:t(c).price}),()=>({error:t(c).categoryName}),()=>(t(u),t(o),t(c),T(()=>!t(u)||t(o)||Object.keys(t(c)).length>0))]),ne("click",g,_),rn(F,()=>t(i).name_menu,P=>Qe(i,t(i).name_menu=P)),rn(A,()=>t(i).name_button,P=>Qe(i,t(i).name_button=P)),rn(se,()=>t(i).name_receipt,P=>Qe(i,t(i).name_receipt=P)),rn(re,()=>t(i).price,P=>Qe(i,t(i).price=P)),rn(be,()=>t(i).categoryName,P=>Qe(i,t(i).categoryName=P)),rn(Oe,()=>t(i).description,P=>Qe(i,t(i).description=P)),ne("click",Ce,_),ne("submit",M,di(x)),ne("click",U,C),ne("keydown",U,S),E(m,U)};X(j,m=>{s()&&a()&&m(Z)})}E(e,O),It()}var Qc=W('<div class="modal-overlay svelte-3d9wpg"><div class="modal-content svelte-3d9wpg"><div class="modal-header svelte-3d9wpg"><h2 class="svelte-3d9wpg">Edit Category</h2> <button class="close-button svelte-3d9wpg">Ã—</button></div> <form class="product-form svelte-3d9wpg"><div class="form-group svelte-3d9wpg"><label for="category-name" class="svelte-3d9wpg">Category Name</label> <input id="category-name" type="text" class="svelte-3d9wpg"/></div> <div class="form-group svelte-3d9wpg"><label for="category-type" class="svelte-3d9wpg">Category Type</label> <select id="category-type" class="svelte-3d9wpg"><option>Food</option><option>Drink</option><option>Other</option></select></div> <div class="form-actions svelte-3d9wpg"><button type="button" class="btn-cancel svelte-3d9wpg">Cancel</button> <button type="submit" class="btn-save svelte-3d9wpg"> </button></div></form></div></div>');function Xc(e,n){Et(n,!1);let r=Fe(n,"visible",8,!1),s=Fe(n,"category",8,null);const a=Pn();let i=G({name:"",type:"food"}),l=G({}),u=G(!1);async function o(){if(!t(i).name.trim()){alert("Category name is required.");return}y(u,!0);const S={};t(i).name!==t(l).name&&(S.name=t(i).name.trim()),t(i).type!==t(l).type&&(S.type=t(i).type),Object.keys(S).length>0&&a("save",{categoryId:s().id,updates:S}),c()}function c(){y(u,!1),a("close")}function v(S){S.target===S.currentTarget&&c()}function f(S){S.key==="Escape"&&c()}Ge(()=>(Q(s()),Q(r()),t(i)),()=>{if(s()&&r()){const S=JSON.parse(s().category_names||"{}");y(i,{name:S.de||"",type:s().category_type||"food"}),y(l,{...t(i)})}}),xn(),Pt();var x=Ue();ne("keydown",Tr,f);var _=Se(x);{var C=S=>{var O=Qc(),j=p(O),Z=p(j),m=w(p(Z),2),U=w(Z,2),k=p(U),b=w(p(k),2),g=w(k,2),M=w(p(g),2);ce(()=>{t(i),Xs(()=>{t(u)})});var ee=p(M);ee.value=ee.__value="food";var F=w(ee);F.value=F.__value="drink";var te=w(F);te.value=te.__value="other";var J=w(g,2),N=p(J),V=w(N,2),A=p(V);ce(()=>{b.disabled=t(u),M.disabled=t(u),N.disabled=t(u),V.disabled=t(u),oe(A,t(u)?"Saving...":"Save Changes")}),ne("click",m,c),rn(b,()=>t(i).name,z=>Qe(i,t(i).name=z)),ci(M,()=>t(i).type,z=>Qe(i,t(i).type=z)),ne("click",N,c),ne("submit",U,di(o)),ne("click",O,v),E(S,O)};X(_,S=>{r()&&s()&&S(C)})}E(e,x),It()}const fr=ut([]),ha=dr(fr,e=>new Set(e.map(n=>n.id))),hi=ut(new Map),Za=70,yi=60,_i=50,eu=3;function Cs(e){console.log("ðŸ”„ [QuantumTree] toggleCategory called for categoryId:",e),fr.update(n=>{const r=n.findIndex(s=>s.id===e);if(r!==-1)if(r===0){console.log("ðŸ”„ [QuantumTree] Closing active category",e,"current history:",n.map(i=>i.id));const s=[...n];s.splice(r,1);const a=bi(s);return console.log("ðŸ”„ [QuantumTree] After close, new history:",a.map(i=>i.id)),a}else{console.log("ðŸ”„ [QuantumTree] Making category active",e,"current history:",n.map(a=>a.id));const s=xs(n,e);return console.log("ðŸ”„ [QuantumTree] After making active, new history:",s.map(a=>a.id)),s}else{console.log("ðŸ”„ [QuantumTree] Opening category",e,"current history:",n.map(a=>a.id));const s=xs(n,e);return console.log("ðŸ”„ [QuantumTree] After open, new history:",s.map(a=>a.id)),s}})}function xs(e,n){const r=Date.now(),s=e.filter(l=>l.id!==n),i=[{id:n,timestamp:r,priority:Za},...s].slice(0,eu);return bi(i)}function bi(e){return e.map((n,r)=>({...n,priority:r===0?Za:r===1?yi:_i}))}function tu(){fr.set([]),hi.set(new Map)}const Kn={LATEST:Za,SECONDARY:yi,TERTIARY:_i},Ss=dr(fr,e=>e.length>0);dr([fr,hi],([e,n])=>({categoryHistory:e,openCategories:e.map(r=>r.id),layouts:Object.fromEntries(n)}));const Ja={TOP_LEVEL_SELECTION:"TOP_LEVEL_SELECTION",QUANTUM_TREE:"QUANTUM_TREE",DEEP_NAVIGATION:"DEEP_NAVIGATION",CHECKOUT_FLOW:"CHECKOUT_FLOW",ADMIN_MODE:"ADMIN_MODE",IDLE_STATE:"IDLE_STATE"},xa=ut(Ja.TOP_LEVEL_SELECTION),ia=ut({breadcrumb:[],currentCategory:null,selectedProduct:null,lastAction:null,timestamp:Date.now()});function nu(e,n={}){if(!Object.values(Ja).includes(e)){console.warn(`Invalid UI state: ${e}`);return}ia.update(r=>({...r,...n,lastAction:e,timestamp:Date.now()})),xa.set(e),console.log(`UI State changed to: ${e}`,n)}function ru(){ia.set({breadcrumb:[],currentCategory:null,selectedProduct:null,lastAction:null,timestamp:Date.now()});try{localStorage.removeItem("breadcrumb"),console.log("ðŸ’¾ [Navigation] Breadcrumb cleared from localStorage")}catch(e){console.warn("âš ï¸ [Navigation] Failed to clear breadcrumb from localStorage:",e)}console.log("âš ï¸ [Navigation] Reset navigation. Breadcrumb cleared."),nu(Ja.TOP_LEVEL_SELECTION)}function au(){try{const e=localStorage.getItem("breadcrumb");if(e){const n=JSON.parse(e);return console.log("ðŸ’¾ [Navigation] Loading breadcrumb from localStorage:",n),ia.update(r=>({...r,breadcrumb:n,currentCategory:n.length>0?n[n.length-1]:null})),n}}catch(e){console.warn("âš ï¸ [Navigation] Failed to load breadcrumb from localStorage:",e),localStorage.removeItem("breadcrumb")}return null}function su(){ru()}var iu=qa(`<svg viewBox="-10 -10 120 120" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: 100%;"><defs><filter height="170%" id="sh2" width="170%" x="-0.2" y="-0.2"><feOffset dx="0" dy="0" in="SourceAlpha"></feOffset><feGaussianBlur stdDeviation="1.2"></feGaussianBlur><feColorMatrix result="out" type="matrix" values=" 
               0 0 0 0 0.2         
               0 0 0 0 0.2                    
               0 0 0 0 0.2                
               0 0 0 10 0 "></feColorMatrix><feMerge><feMergeNode in="out"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter></defs><g filter="url(#sh2)"><path fill="#2c2c2e" stroke="#666" stroke-width="1.5" d="M72,89 C78.6,68 67.2,30.7 89,68 C86.9,37.6 66.91,32 62,61 C58,44.1 67.5,38.8 52,10 C53.6,47 46.91,36.2 45,61 C39.3,43.4 22,46.6 13,43 C32.9,55.8 35.7,66.62 32,89 C35,97.9 68.6,99 72,89 Z"></path><circle fill="#2c2c2e" stroke="#666" stroke-width="1.5" cx="13" cy="43" r="5.5"></circle><circle fill="#2c2c2e" stroke="#666" stroke-width="1.5" cx="52" cy="10" r="5.5"></circle><circle fill="#2c2c2e" stroke="#666" stroke-width="1.5" cx="89" cy="68" r="5.5"></circle></g></svg>`);function ou(e){var n=iu();E(e,n)}var lu=qa('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 96" fill="none" class="svelte-1cmb9l6"><rect x="0" y="0" width="128" height="96" rx="8" ry="8" fill="#2A2A2A" stroke="none"></rect><g><rect x="7" y="6" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="24" y="19" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">1</text><rect x="47" y="6" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="64" y="19" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">2</text><rect x="87" y="6" width="34" height="24" rx="3" fill="#883333" stroke="#555555" stroke-width="0.5"></rect><text x="104" y="19" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">3</text><rect x="7" y="36" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="24" y="49" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">4</text><rect x="47" y="36" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="64" y="49" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">5</text><rect x="87" y="36" width="34" height="24" rx="3" fill="#885533" stroke="#555555" stroke-width="0.5"></rect><text x="104" y="49" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">6</text><rect x="7" y="66" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="24" y="79" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">7</text><rect x="47" y="66" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="64" y="79" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">8</text><rect x="87" y="66" width="34" height="24" rx="3" fill="#385b4a" stroke="#555555" stroke-width="0.5"></rect><text x="104" y="79" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">9</text></g></svg>');function Ts(e){var n=lu();E(e,n)}class cu{constructor(n,r,s=!0){this.row=n,this.col=r,this.content=null,this.isEmpty=!0,this.isUsable=s,this.priority=0,this.id=`slot-${n}-${r}`}setContent(n,r=1){this.content=n,this.isEmpty=!1,this.priority=r}clearContent(){this.content=null,this.isEmpty=!0,this.priority=0}}class uu{constructor(n,r,s="symmetrical"){this.rows=n,this.cols=r,this.layoutType=s,this.slots=[],this.contentSlots=[],this.initializeGrid()}initializeGrid(){for(let n=0;n<this.rows;n++){const r=[];for(let s=0;s<this.cols;s++){let a=n%2!==s%2;this.layoutType==="symmetrical"&&n%2===0&&s===this.cols-1&&(a=!1);const i=new cu(n,s,a);r.push(i),this.contentSlots.push(i)}this.slots.push(r)}}getSlot(n,r){return n>=0&&n<this.rows&&r>=0&&r<this.cols?this.slots[n][r]:null}getAllSlots(){return this.contentSlots}getUsableEmptySlots(){return this.contentSlots.filter(n=>n.isUsable&&n.isEmpty).sort((n,r)=>n.row!==r.row?n.row-r.row:n.col-r.col)}getUsableFilledSlots(){return this.contentSlots.filter(n=>n.isUsable&&!n.isEmpty)}getUsableSlots(){return this.contentSlots.filter(n=>n.isUsable).sort((n,r)=>n.row!==r.row?n.row-r.row:n.col-r.col)}placeContentAt(n,r,s,a){const i=this.getSlot(n,r);return i&&i.isUsable&&(i.isEmpty||a>i.priority)?(i.setContent(s,a),!0):!1}clearAllContent(){this.contentSlots.forEach(n=>{n.clearContent()})}getPrioritizedSlots(){return this.contentSlots.filter(n=>n.isUsable).sort((n,r)=>r.priority-n.priority)}}function du(e,n,r){const{cellWidth:s=120,cellHeight:a=80,buttonGap:i=6,hexOffset:l=.5,shape:u="hex"}=r;return u==="hex"?fu(e,n,s,a,i):vu(e,n,s,a,i)}function fu(e,n,r,s,a,i){const l=n%2===1,u=Math.floor(n/2),o=u*(r+a)+(l?(r+a)/2:0),c=s*.75,v=e*(c+a);return console.log(`ðŸ”® [hexPositioning] row=${e}, col=${n}, isOddCol=${l}, visualCol=${u}, x=${o}, y=${v}, gap=${a}`),{x:o,y:v}}function vu(e,n,r,s,a){const i=n*(r+a),l=e*(s+a);return console.log(`ðŸ”® [rectPositioning] row=${e}, col=${n}, x=${i}, y=${l}, gap=${a}`),{x:i,y:l}}function pu(e){return e?`transform: translate(${e.x}px, ${e.y}px)`:"transform: translate(0px, 0px)"}class gu{constructor(n,r,s){this.id=n,this.type=r,this.logicalPosition=s,this.content=null,this.cssPosition=null,this.cssTransform=null,this.geometryMetadata={}}setContent(n){this.content=n}calculatePhysicalPosition(n){return this.cssPosition=du(this.logicalPosition.row,this.logicalPosition.col,n),this.cssTransform=pu(this.cssPosition),this.cssPosition}}class mu{constructor(n={}){this.options={shape:"hex",cellWidth:n.cellWidth||120,cellHeight:n.cellHeight||80,buttonGap:n.buttonGap||6,...n}}renderContentGrid(n){const r=[],s=n.getUsableSlots();for(const a of s){const i=new gu(a.isEmpty?`empty-slot-${a.row}-${a.col}`:`full-slot-${a.row}-${a.col}`,a.isEmpty?"empty":"full",{row:a.row,col:a.col});a.isEmpty?(i.setContent({type:"empty",disabled:!0}),i.geometryMetadata.priority=0):(i.setContent(a.content),i.geometryMetadata.priority=a.priority),i.calculatePhysicalPosition(this.options),r.push(i)}return r}}function ks(e={}){return new mu(e)}const Sa={TABLE_BUTTON:90,PAYMENT_BUTTON:85,PINPAD_BUTTON:85,NEW_PRODUCTS:82,CATEGORY_PRIORITY:80,CATEGORY_NAVIGATION:70,DEFAULT:50,MIN:1};class hu{constructor(n={}){this.config={dimensions:{rows:4,cols:12},rendering:{shape:"hex",cellWidth:120,cellHeight:80},...n},this.contentGrid=new uu(this.config.dimensions.rows,this.config.dimensions.cols,this.config.layoutType),this.geometryRenderer=ks(this.config.rendering),this.renderCache=null,this.isDirty=!0,console.log("ðŸŽ¯ [GridManager] Initialized ContentGrid",this.config.dimensions)}clearAndReset(){this.contentGrid.clearAllContent(),this.markDirty()}placeItems(n,r=Sa.DEFAULT,s=1/0){if(!n||n.length===0)return[];const a=this.contentGrid.getUsableSlots();a.sort((o,c)=>o.row!==c.row?o.row-c.row:o.col-c.col);let i=0;const l=[],u=[];n.sort((o,c)=>(o.order_index||0)-(c.order_index||0)),console.log("ðŸŽ¯ [GridManager] Placing items with priority-based displacement:",{itemCount:n.length,priority:r,totalUsableSlots:a.length,maxItems:s});for(const o of n){if(i>=s)break;let c=null;for(const v of a)if(this.canPlaceAt(v,r)){c=v;break}if(c){if(!c.isEmpty&&c.priority<r){const v={content:c.content,priority:c.priority};u.push(v),console.log(`ðŸ”„ [PlaceItems] Evicting ${v.content.displayName||"content"} (priority ${v.priority}) from ${c.row},${c.col}`)}console.log(`ðŸŽ¯ [PlaceItems] Placing ${o.displayName} at ${c.row},${c.col} with priority ${r} (was: ${c.isEmpty?"empty":`occupied by priority ${c.priority}`})`),console.log("ðŸ“‹ [Content Grid] Assigned to slot:",`${c.row},${c.col}`,"Type:",o.type||(o.category_names?"category":"product"),"Label:",o.displayName,"Is category:",!!(o.category_names||o.type==="category")),c.setContent(o,r),i++,l.push({item:o,placed:!0,slot:c})}else console.log(`ðŸŽ¯ [PlaceItems] Could not place ${o.displayName} - no available slots for priority ${r}`),l.push({item:o,placed:!1,slot:null})}if(u.length>0){console.log(`ðŸ”„ [PlaceItems] Re-homing ${u.length} evicted items`);const o=this.contentGrid.getUsableEmptySlots();o.sort((v,f)=>v.row!==f.row?v.row-f.row:v.col-f.col);let c=0;for(const v of o){if(c>=u.length)break;const f=u[c];v.setContent(f.content,f.priority),console.log(`ðŸ  [PlaceItems] Re-homed ${f.content.displayName||"content"} to ${v.row},${v.col} with original priority ${f.priority}`),c++}c<u.length&&console.warn(`ðŸ”„ [PlaceItems] Could not re-home ${u.length-c} evicted items - no empty slots available`)}return this.markDirty(),l}placeSystemElements(n){const r=[];for(const s of n){const a=this.contentGrid.placeContentAt(s.row,s.col,s.content,s.priority);r.push({element:s,placed:a})}return this.markDirty(),r}placeItemsAsTree(n){console.log("ðŸŽ„ [GridManager] Starting corrected tree placement for items:",n.length);const r=n.filter(a=>a.isTreeCategory).sort((a,i)=>i.treePriority-a.treePriority);console.log("ðŸŽ„ [GridManager] Categories to place:",r.map(a=>`${a.displayName}(${a.treePriority})`));const s=new Map;n.forEach(a=>{a.isTreeProduct&&s.set(a.parentCategoryId,a.treePriority)});for(const a of r){const i=this.placeItems([a],a.treePriority,1);console.log(`ðŸŽ„ [GridManager] Placed category ${a.displayName} with priority ${a.treePriority}:`,i.length>0?"SUCCESS":"FAILED")}for(const a of r){if(!a.isExpanded)continue;const i=this.findSlotByContent(a);if(!i){console.warn("ðŸŽ„ Category not found in grid after placement:",a.displayName);continue}const l=n.filter(o=>o.isTreeProduct&&o.parentCategoryId===a.id);if(l.length===0)continue;const u=s.get(a.id);console.log("ðŸŽ„ Placing",l.length,"products under",a.displayName,"at",`${i.row},${i.col}`,"with priority",u,"(using saved treePriority)"),this.placeProductsInTreePattern(i,l,u)}this.markDirty()}placeProductsInTreePattern(n,r,s){if(r.length===0)return;console.log("ðŸŽ„ [TreePattern] Starting placement for",r.length,"products from",`${n.row},${n.col}`,"with priority",s);const i=this.contentGrid.getUsableSlots().filter(o=>!(o.row===n.row&&o.col===n.col)).filter(o=>o.isEmpty||o.priority<s).map(o=>({slot:o,distance:Math.abs(o.row-n.row)+Math.abs(o.col-n.col),rowDistance:Math.abs(o.row-n.row),colDistance:Math.abs(o.col-n.col)})).sort((o,c)=>{if(o.distance!==c.distance)return o.distance-c.distance;const v=o.slot.col>=n.col&&o.slot.row>=n.row,f=c.slot.col>=n.col&&c.slot.row>=n.row;return v&&!f?-1:!v&&f?1:o.rowDistance!==c.rowDistance?o.rowDistance-c.rowDistance:o.colDistance-c.colDistance});console.log("ðŸŽ„ [TreePattern] Found",i.length,"available slots sorted by distance from",`${n.row},${n.col}`);let l=0;const u=[];for(const o of i){if(l>=r.length)break;const{slot:c,distance:v}=o;if(this.canPlaceAt(c,s)){if(!c.isEmpty&&c.priority<s){const f={content:c.content,priority:c.priority};u.push(f),console.log(`ðŸ”„ [TreePattern] Evicting ${f.content.displayName||"content"} (priority ${f.priority}) from ${c.row},${c.col}`)}console.log("ðŸ“‹ [Content Grid] Assigned to slot:",`${c.row},${c.col}`,"Type:",r[l].type||"product","Label:",r[l].displayName,"Is category:",!1),c.setContent(r[l],s),console.log("ðŸŽ„ [TreePattern] Placed",r[l].displayName,"at",`${c.row},${c.col}`,`(distance: ${v})`),l++}}if(u.length>0){console.log(`ðŸ”„ [TreePattern] Re-homing ${u.length} evicted items`);const o=this.contentGrid.getUsableEmptySlots();o.sort((v,f)=>v.row!==f.row?v.row-f.row:v.col-f.col);let c=0;for(const v of o){if(c>=u.length)break;const f=u[c];v.setContent(f.content,f.priority),console.log(`ðŸ  [TreePattern] Re-homed ${f.content.displayName||"content"} to ${v.row},${v.col} with original priority ${f.priority}`),c++}c<u.length&&console.warn(`ðŸ”„ [TreePattern] Could not re-home ${u.length-c} evicted items - no empty slots available`)}l<r.length&&console.warn("ðŸŽ„ [TreePattern] Could not place",r.length-l,"products - no more suitable positions available"),console.log("ðŸŽ„ [TreePattern] Completed placement:",l,"of",r.length,"products placed")}expandTreeFromQueue(n,r,s){if(n.length===0||r.length===0){console.log("ðŸŽ„ [ExpandTree] Stopping expansion:",n.length===0?"no queue items":"no remaining products");return}console.log("ðŸŽ„ [ExpandTree] Expanding from",n.length,"positions for",r.length,"remaining products");const a=[];let i=0;for(const l of n){if(i>=r.length)break;const{slot:u,level:o}=l,c=[{row:u.row+1,col:u.col-1,desc:"down-left"},{row:u.row+1,col:u.col+1,desc:"down-right"}];for(const v of c){if(i>=r.length)break;const f=this.contentGrid.getSlot(v.row,v.col);this.canPlaceAt(f,s)&&(f.setContent(r[i],s),a.push({slot:f,level:o+1}),console.log(`ðŸŽ„ Level ${o+1}: Placed`,r[i].displayName,"at",`${v.row},${v.col}`,`(${v.desc})`),i++)}}i<r.length&&a.length>0?(console.log("ðŸŽ„ [ExpandTree] Recursing with",a.length,"new positions"),this.expandTreeFromQueue(a,r.slice(i),s)):i<r.length&&console.warn("ðŸŽ„ [ExpandTree] Cannot expand further:",r.length-i,"products remain unplaced")}canPlaceAt(n,r){return!n||!n.isUsable?!1:n.isEmpty?!0:n.priority<r}findSlotByContent(n){for(let r=0;r<this.contentGrid.rows;r++)for(let s=0;s<this.contentGrid.cols;s++){const a=this.contentGrid.getSlot(r,s);if(a&&a.content===n)return a}return null}getRenderStructure(){return this.renderCache&&!this.isDirty?this.renderCache:(this.contentGrid.getUsableFilledSlots(),this.renderCache=this.geometryRenderer.renderContentGrid(this.contentGrid),this.isDirty=!1,this.renderCache)}getSvelteCompatibleCells(n){return this.geometryRenderer=ks(n),this.getRenderStructure().map(s=>({...s,cssTransform:s.cssTransform,data:s.content.data||s.content,label:s.content.label||s.content.category_names?.de||s.content.display_names?.button?.de}))}getDebugInfo(){return this.contentGrid.getDebugInfo()}getUsableSlotCount(){return this.contentGrid.getUsableSlots().length}markDirty(){this.isDirty=!0}getPriorities(){return Sa}}var yu=W("<div><div><!></div></div>"),_u=W('<p class="status-message svelte-1i1zsgb"> </p>'),bu=W('<div class="empty-category-info svelte-1i1zsgb"><p class="empty-message svelte-1i1zsgb">Diese Kategorie enthÃ¤lt noch keine Produkte.</p> <p class="empty-hint svelte-1i1zsgb">Verwenden Sie das MenÃ¼-Import Tool oder fÃ¼gen Sie Produkte manuell hinzu.</p></div>'),wu=W("<div></div>"),Cu=W('<div class="quantum-button svelte-1i1zsgb"><!></div>'),xu=W("<div><!> <!> <!></div>"),Su=W('<div class="selection-area svelte-1i1zsgb"><!> <!> <!> <!> <div class="grid-container svelte-1i1zsgb"><!></div></div>');function Tu(e,n){Et(n,!1);const[r,s]=$r(),a=()=>vt(wn,"$authStore",r),i=()=>vt(nr,"$notificationStore",r),l=()=>vt(gi,"$currentMinuteTime",r),u=()=>vt(mi,"$uiConstantsStore",r),o=()=>vt(Je,"$orderStore",r),c=()=>vt(je,"$pinpadStore",r),v=G();let f=G([]),x=new Map,_=G("Connecting to backend..."),C=!1,S=G("categories"),O=null,j=G("6-6-6"),Z=G(!1),m=G(null),U=G(0),k=G(0),b=G(!1),g=G(null),M=G(!1),ee=G(null),F=0,te=Fe(n,"isAtBottom",8,!1),J=Fe(n,"consoleViewComponent",8,null),N=0,V=G([]),A=G(null),z=G([]),Ae=Fe(n,"handleSmartAction",8,()=>{}),Me=G(null),Be=G(null),se=G(null),D=null;nr.subscribe(d=>{console.log("ðŸŽ¨ [SelectionArea] NotificationStore changed:",{hasNotification:d.hasNotification,style:d.style,previousStyle:D}),D=d.style}),wn.subscribe(d=>{console.log("ðŸ‘¤ [SelectionArea] AuthStore changed:",{isAuthenticated:d.isAuthenticated,currentUser:d.currentUser?.full_name||"none"})});let I=G(null),H=G();const ue=6,re=6,ae=6,fe=6,pe=6;function ge(d){if(!d)return"Login";const h=d.split(" ");let B;if(h.length===1){const L=h[0];L.length<=4?B=L:B=L.substring(0,4)}else{const L=h[0],Y=h[1]||"";B=L.substring(0,3)+(Y?Y.charAt(0):"")}return"âœ“ "+B}function be(d){if(typeof d=="object"&&d!==null)return d;if(typeof d=="string")try{return JSON.parse(d)}catch{return d}return d}function de(d){d=d.replace("#",""),d.length===3&&(d=d[0]+d[0]+d[1]+d[1]+d[2]+d[2]);const h=/^([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(d);return h?{r:parseInt(h[1],16),g:parseInt(h[2],16),b:parseInt(h[3],16)}:null}function we(d,h,B,L,Y,R,Ye=!1){K("DEBUG","calculateOptimalGrid called",{containerWidth:d,containerHeight:h,minButtonSize:B,targetAspectRatio:L,buttonGap:Y,verticalPadding:R,hasOverlap:Ye});const Ie=d,ie=h-2*R;K("DEBUG","calculateOptimalGrid: calculated available space",{availableWidth:Ie,availableHeight:ie,paddingReduction:2*R});function $e(dt){const Mt=(Ie-(dt+1)*Y)/dt;if(Mt<B)return null;let Tn=Mt*L*.75+Y,ze=Math.floor(ie/Tn),gn=(ie-(ze-1)*Y)/(1+(ze-1)*.75);const At=Mt*(L*.7);let et;gn>=At&&ze>0?et=ze:et=Math.max(1,ze-1);let $t;return Ye?et>0?$t=(ie-(et-1)*Y)/(1+(et-1)*.75):$t=Math.max(ie,At):et>0?$t=(ie-(et-1)*Y)/et:$t=Math.max(ie,At),{columns:dt,rows:et,buttonWidth:Mt,buttonHeight:$t,layout:"symmetrical"}}function Pe(dt){const Mt=(Ie-(dt+1)*Y)/(dt+.5);if(Mt<B)return null;let Tn=Mt*L*.75+Y,ze=Math.floor(ie/Tn),gn=(ie-(ze-1)*Y)/(1+(ze-1)*.75);const At=Mt*(L*.7);let et;gn>=At&&ze>0?et=ze:et=Math.max(1,ze-1);let $t;return Ye?et>0?$t=(ie-(et-1)*Y)/(1+(et-1)*.75):$t=Math.max(ie,At):et>0?$t=(ie-(et-1)*Y)/et:$t=Math.max(ie,At),{columns:dt,rows:et,buttonWidth:Mt,buttonHeight:$t,layout:"asymmetrical"}}let ke=null,Ze=Math.floor((Ie-Y)/B);for(let dt=1;dt<=Ze;dt++){const Mt=$e(dt),mr=Pe(dt),Tn=[Mt,mr].filter(ze=>ze!==null);for(const ze of Tn)ke?(ze.columns>ke.columns||ze.columns===ke.columns&&(ze.layout==="asymmetrical"&&ke.layout==="symmetrical"||ze.buttonWidth>ke.buttonWidth))&&(ke=ze):ke=ze}const q=ke||{columns:1,rows:1,buttonWidth:Math.max(B,Ie-2*Y),buttonHeight:Math.max(B,ie),layout:"symmetrical"};return K("DEBUG","calculateOptimalGrid returning final layout",{finalLayout:q,wasFallback:!ke,totalColumnsTestedUpTo:Math.floor((Ie-Y)/B)}),q}let he=G(t(v)),Te=G(7.5625*16),Oe=1,Le=G(1),Ce=G(t(v)),ve=G(t(v)),Ee=1,xe=G(1),$="symmetrical";function P(){if(console.log("ðŸ”¥ [SelectionArea] rebuildGridAndContent() called!",new Date().toLocaleTimeString()),F<=0||N<=0)return;let d;if(t(j)==="6-6-6")d=we(F,N,t(v),3/4,re,fe,!0),Oe=d.columns,y(Le,d.rows),y(he,d.buttonWidth),y(Te,d.buttonHeight),$=d.layout;else if(t(j)==="4-4-4")d=we(F,N,t(v),3/4,ae,pe,!1),Ee=d.columns,y(xe,d.rows),y(Ce,d.buttonWidth),y(ve,d.buttonHeight),$=d.layout;else return;d.columns>0&&d.rows>0&&(y(A,new hu({dimensions:{rows:d.rows,cols:d.columns*2},layoutType:$,rendering:{shape:t(j)==="6-6-6"?"hex":"rect",cellWidth:d.buttonWidth,cellHeight:d.buttonHeight}})),y(V,tt()),Ne())}let le=G(),_e=G(),Ve=G(),yt=G(null),gt=G(null),_t=G(null);function tt(){K("DEBUG","buildGridStructure called",{layoutType:t(j),chosenLayout:$});const d=[];if(t(j)==="6-6-6"){K("DEBUG","Building hexagonal grid structure",{totalRows:t(Le),itemsPerRow:Oe,buttonSize:`${t(he).toFixed(1)}x${t(Te).toFixed(1)}`});for(let h=0;h<t(Le);h++){const B=d.length;bt(d,h,$);const L=d.length-B;K("DEBUG",`Built hex row ${h}`,{cellsAdded:L,totalCells:d.length})}}else t(j)==="4-4-4"&&(K("DEBUG","Building rectangular grid structure",{rectTotalRows:t(xe),rectItemsPerRow:Ee,buttonSize:`${t(Ce).toFixed(1)}x${t(ve).toFixed(1)}`}),wt(d,$));return K("DEBUG","buildGridStructure completed",{totalCellsGenerated:d.length,layoutType:t(j),chosenLayout:$}),d}function bt(d,h,B){const L=h%2===1;if(B==="symmetrical"){const Y=L?Oe:Oe-1;if(Y<0)return;if(L)for(let R=0;R<Y;R++)d.push({id:`full-${h}-${R}`,type:"full",content:null,rowIndex:h,columnIndex:R});else{d.push({id:`half-start-${h}`,type:"left-half",content:null,rowIndex:h,columnIndex:0});for(let R=0;R<Y;R++)d.push({id:`full-${h}-${R}`,type:"full",content:null,rowIndex:h,columnIndex:R+1});d.push({id:`half-end-${h}`,type:"right-half",content:null,rowIndex:h,columnIndex:Y+1})}}else{const Y=Oe;if(L){for(let R=0;R<Y;R++)d.push({id:`full-${h}-${R}`,type:"full",content:null,rowIndex:h,columnIndex:R});d.push({id:`half-end-${h}`,type:"right-half",content:null,rowIndex:h,columnIndex:Y})}else{d.push({id:`half-start-${h}`,type:"left-half",content:null,rowIndex:h,columnIndex:0});for(let R=0;R<Y;R++)d.push({id:`full-${h}-${R}`,type:"full",content:null,rowIndex:h,columnIndex:R+1})}}}function wt(d,h){for(let B=0;B<t(xe);B++)kt(d,B,h)}function kt(d,h,B){const L=h%2===1;if(B==="symmetrical"){const Y=L?Ee:Ee-1;if(Y<0)return;if(L)for(let R=0;R<Y;R++)d.push({id:`rect-full-${h}-${R}`,type:"rect-grid",content:null,rowIndex:h,columnIndex:R,width:t(Ce),height:t(ve)});else{d.push({id:`rect-half-start-${h}`,type:"left-half-rect",content:null,rowIndex:h,columnIndex:0,width:t(Ce)/2-ae/2,height:t(ve)});for(let R=0;R<Y;R++)d.push({id:`rect-full-${h}-${R}`,type:"rect-grid",content:null,rowIndex:h,columnIndex:R+1,width:t(Ce),height:t(ve)});d.push({id:`rect-half-end-${h}`,type:"right-half-rect",content:null,rowIndex:h,columnIndex:Y+1,width:t(Ce)/2-ae/2,height:t(ve)})}}else{const Y=Ee;if(L){for(let R=0;R<Y;R++)d.push({id:`rect-full-${h}-${R}`,type:"rect-grid",content:null,rowIndex:h,columnIndex:R,width:t(Ce),height:t(ve)});d.push({id:`rect-half-end-${h}`,type:"right-half-rect",content:null,rowIndex:h,columnIndex:Y,width:t(Ce)/2-ae/2,height:t(ve)})}else{d.push({id:`rect-half-start-${h}`,type:"left-half-rect",content:null,rowIndex:h,columnIndex:0,width:t(Ce)/2-ae/2,height:t(ve)});for(let R=0;R<Y;R++)d.push({id:`rect-full-${h}-${R}`,type:"rect-grid",content:null,rowIndex:h,columnIndex:R+1,width:t(Ce),height:t(ve)})}}}function at(){t(V).forEach(d=>{d.content=null})}function Ne(){Ke(),Ct()}function Ke(){if(t(V).length!==0){if(at(),nt(t(V)),xt(xa),t(S)==="products"){const d=t(V).filter(h=>(h.type==="left-half"||h.type==="left-half-rect")&&!h.content);if(d.length>0){d.sort((B,L)=>B.rowIndex-L.rowIndex);const h=d[0];h.content={isBackButton:!0,icon:"â†"}}}y(V,[...t(V)])}}function nt(d){const h=d.filter(L=>L.type==="left-half"||L.type==="left-half-rect");if(h.length>0){if(h.sort((Y,R)=>Y.rowIndex-R.rowIndex),h[0]&&(h[0].content={isHomeButton:!0}),h.length>1){const Y=h[1];Y.content={isUserButton:!0}}h.sort((Y,R)=>R.rowIndex-Y.rowIndex);const L=h[0];L.content={isSmartNavigation:!0}}const B=d.filter(L=>L.type==="right-half"||L.type==="right-half-rect");if(B.length>0){if(B.sort((L,Y)=>L.rowIndex-Y.rowIndex),B[0]){const L=c().currentLanguage,R=(t(j)==="6-6-6"?"rect":"hex")==="rect"?`<svg width="50" height="50" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
            <rect x="2" y="5" width="46" height="40" rx="2" stroke="#666" stroke-width="1.5" fill="none"/>
            <text x="25" y="25" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" dominant-baseline="middle" fill="#666">${L}</text>
          </svg>`:`<svg width="50" height="50" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
            <polygon points="25,2 47.99,12.5 47.99,37.5 25,48 2.01,37.5 2.01,12.5" stroke="#666" stroke-width="1.5" fill="none"/>
            <text x="25" y="25" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" dominant-baseline="middle" fill="#666">${L}</text>
          </svg>`;B[0].content={isLayoutToggle:!0,icon:R,showShape:""}}B[1]&&(B[1].content={isBetrugerCap:!0}),B[2]&&(B[2].content={isKeyboardToggle:!0,icon:`<svg width="72" height="72" viewBox="0 0 24 24" fill="#404040">
            <path d="M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"/>
          </svg>`,color:"#404040",textColor:"#666"}),B.length>1&&(B[B.length-1].content={isTimeButton:!0})}}function Ct(){if(!t(A))return;console.log("ðŸ”„ [UpdateCenterContent] Called! Current view:",t(S),"Open categories:",Array.from(xt(ha))),t(A).clearAndReset();const d=t(A).getPriorities(),h=t(A).config.dimensions.rows,B=t(A).config.dimensions.cols,L=[];if(h>1&&L.push({row:h-2,col:0,content:{type:"tisch",label:"Tisch",onClick:()=>Un()},priority:d.TABLE_BUTTON}),B>0){const ie=Math.floor(B/2);L.push({row:h-1,col:ie,content:{type:"pinpad",label:"Pinpad",onClick:qt},priority:d.PINPAD_BUTTON})}if(o()&&o().total>0&&(L.push({row:h-1,col:B-1,content:{type:"karte",label:"Karte",onClick:()=>vn("card")},priority:d.PAYMENT_BUTTON}),B>2&&L.push({row:h-1,col:B-3,content:{type:"bar",label:"Bar",onClick:()=>vn("cash")},priority:d.PAYMENT_BUTTON}),B>4&&L.push({row:h-1,col:B-5,content:{type:"zwischenrechnung",label:"Zwischenrechnung",onClick:()=>vr()},priority:d.PAYMENT_BUTTON})),L.length>0&&(console.log("ðŸ”§ [DEBUG] System elements to place:",L),console.log("ðŸ”§ [DEBUG] GridManager dimensions:",{gridRows:h,gridCols:B}),console.log("ðŸ”§ [DEBUG] Order store total:",o()?.total||0),t(A).placeSystemElements(L)),t(S)==="categories"){console.log("ðŸŽ„ [MAIN] About to calculate quantum tree layout, currentView:",t(S),"categories.length:",t(f).length);const ie=jt(t(f));console.log("ðŸŽ„ [MAIN] Received treeItems from calculateQuantumTreeLayout:",ie.length),t(A).placeItemsAsTree(ie)}else t(S)==="products"&&t(A).placeItems(products,d.MAX_CONTENT);y(z,t(A).getSvelteCompatibleCells(t(A).config.rendering)),console.log("ðŸ”„ [Virtual Table Update] Full virtual table state:",{totalSlots:t(A).getUsableSlotCount(),filledSlots:t(A).contentGrid.getUsableFilledSlots().length,emptySlots:t(A).contentGrid.getUsableEmptySlots().length,renderableCells:t(z).length,gridDimensions:{rows:t(A).contentGrid.rows,cols:t(A).contentGrid.cols},currentView:t(S)});const Y=t(A).contentGrid.getUsableFilledSlots();console.table(t(z).map((ie,$e)=>{const Pe=Y[$e];return{index:$e,type:ie.content?.type||"content",label:ie.label||ie.content?.label||"N/A",virtualRow:Pe?.row??"N/A",virtualCol:Pe?.col??"N/A",isSystem:["tisch","pinpad","karte","bar","zwischenrechnung"].includes(ie.content?.type),isContent:!["tisch","pinpad","karte","bar","zwischenrechnung"].includes(ie.content?.type),priority:Pe?.priority||ie.priority||"unknown"}}));const R=t(A).contentGrid.slots,Ye=[];for(let ie=0;ie<R.length;ie++)for(let $e=0;$e<R[ie].length;$e++){const Pe=R[ie][$e];(!Pe.isUsable||Pe.isEmpty)&&Ye.push({row:ie,col:$e,isUsable:Pe.isUsable,hasContent:!Pe.isEmpty,reason:Pe.isUsable?"empty":"dead-zone"})}Ye.length>0&&console.log("ðŸš« [Virtual Table] Unusful slots (empty/dead zones):",Ye),console.log("ðŸ“Š [Virtual Table] 2D Array - exactly as stored:"),console.log(`Dimensions: ${t(A).contentGrid.rows} rows Ã— ${t(A).contentGrid.cols} columns`);const Ie=[];for(let ie=0;ie<t(A).contentGrid.rows;ie++){const $e=[];for(let Pe=0;Pe<t(A).contentGrid.cols;Pe++){const ke=t(A).contentGrid.slots[ie][Pe];if(!ke.isUsable)$e.push("xxx");else if(ke.isEmpty)$e.push("___");else{const Ze=ke.content?.category_names?.de||ke.content?.display_names?.button?.de||ke.content?.label||ke.content?.type||"item";$e.push(Ze.substring(0,5).padEnd(5,"_"))}}Ie.push($e)}console.table(Ie),console.log("ðŸ“Š Text representation:"),Ie.forEach((ie,$e)=>{console.log(`Row ${$e}: [${ie.join("][")}]`)})}let st=G(),Ft,He=!1;ln(()=>{t(st)&&setTimeout(()=>{F=t(st).clientWidth,N=t(st).clientHeight,P()},100);const d=()=>{t(st)&&(K("DEBUG","Window resize event triggered"),Ft&&clearTimeout(Ft),Ft=setTimeout(()=>{const B=t(st).clientWidth,L=t(st).clientHeight;K("DEBUG","Window resize: container dimensions detected",{newWidth:B,newHeight:L,previousWidth:F,previousHeight:N}),F!==B||N!==L?(K("INFO","Container size changed, triggering rebuild",{from:`${F}x${N}`,to:`${B}x${L}`}),F=B,N=L,P()):K("DEBUG","Container size unchanged, no rebuild needed")},300))};window.addEventListener("resize",d);const h=()=>{y(S,"categories"),O=null,lt.set("order")};return window.addEventListener("autoCollapseComplete",h),()=>{window.removeEventListener("resize",d),window.removeEventListener("autoCollapseComplete",h),Ft&&clearTimeout(Ft),t(le)&&clearTimeout(t(le)),t(_e)&&clearTimeout(t(_e)),t(Ve)&&clearTimeout(t(Ve)),t(H)&&clearTimeout(t(H))}}),ye.subscribe(d=>{C=d.isConnected,C&&!He&&(He=!0,y(_,"Loading categories..."),setTimeout(()=>{ye.send({command:"getCategories"}).then(B=>{B.status==="success"&&Array.isArray(B.payload)?(y(f,B.payload),y(_,""),Ne()):(y(_,"Error: Could not load categories from backend."),console.error("Failed to load categories:",B))}).catch(B=>{y(_,"Error: Failed to get response for categories."),console.error("Error in getCategories promise:",B)})},500)),d.lastMessage?.command==="getItemsByCategoryResponse"&&(d.lastMessage.status==="success"&&Array.isArray(d.lastMessage.payload)?(x.set(O.id,d.lastMessage.payload),x=x,y(_,""),Ne()):y(_,"Error: Could not load products from backend."))});let rt=G([]);async function mt(d){try{await d()}catch(h){if(h.message&&h.message.includes("User must be authenticated")){lt.set("agent"),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"Aktion erfordert Anmeldung. Bitte geben Sie Ihren PIN-Code ein.",style:"error"}),je.activate("agent",null,null,"numeric");return}throw h}}function ct(d){const h=d.detail?.data||d;h&&h.id&&(xt(ha).has(h.id)?(Cs(h.id),Ne()):(O=h,Cs(h.id),x.has(h.id)?Ne():(y(_,"Loading products..."),ye.send({command:"getItemsByCategory",payload:{categoryId:h.id}}))))}async function Xe(d){const h=d.detail?.data||d;h&&h.id&&await mt(async()=>{await Je.addItem(h.id,1)})}function en(){y(S,"categories"),O=null,x.clear(),x=x,y(_,""),Ne()}function Gt(){tu(),y(S,"categories"),O=null,x.clear(),x=x,y(_,""),su(),Ne()}function dn(){y(j,t(j)==="6-6-6"?"4-4-4":"6-6-6")}function jt(d){const h=[],B=xt(fr),L=xt(ha);console.log("ðŸŽ„ [QuantumTree] calculateQuantumTreeLayout called with",d.length,"categories"),console.log("ðŸŽ„ [QuantumTree] Category history:",B.map(R=>`${R.id}(${R.priority})`).join(", ")),console.log("ðŸŽ„ [QuantumTree] Open categories:",Array.from(L));const Y=[...d].sort((R,Ye)=>R.id-Ye.id);return console.log("ðŸŽ„ [QuantumTree] Categories sorted by ID:",Y.map(R=>`${R.id}:${R.category_names?.de}`).join(", ")),Y.forEach((R,Ye)=>{const Ie=B.find(Pe=>Pe.id===R.id),ie=Ie?Ie.priority:100;console.log(`ðŸŽ„ [QuantumTree] Processing category ${R.id} (${R.category_names?.de}): historyItem=${!!Ie}, priority=${ie}, isOpen=${L.has(R.id)}`);const $e={...R,isTreeCategory:!0,isExpanded:L.has(R.id),displayName:R.category_names?.de||R.name||"Unknown Category",treePriority:Sa.CATEGORY_PRIORITY,isLatest:ie===Kn.LATEST,isSecondary:ie===Kn.SECONDARY,isTertiary:ie===Kn.TERTIARY};if(h.push($e),L.has(R.id)){let Pe=x.get(R.id)||[];console.log(`ðŸŽ„ [QuantumTree] Using products for category ${R.id}:`,Pe.length),console.log(`ðŸŽ„ [QuantumTree] Adding ${Pe.length} products for category ${R.id} with priority ${ie}`),Pe.forEach((ke,Ze)=>{const q={...ke,isTreeProduct:!0,parentCategoryId:R.id,displayName:ke.display_names?.menu?.de||ke.display_names?.button?.de||ke.name||"Unknown Product",treePriority:ie,isLatest:ie===Kn.LATEST,isSecondary:ie===Kn.SECONDARY,isTertiary:ie===Kn.TERTIARY};h.push(q),console.log(`ðŸŽ„ [QuantumTree] Added product ${Ze}: ${q.displayName} (priority=${ie}, parentCategoryId=${R.id})`)})}}),console.log("ðŸŽ„ [QuantumTree] Final treeItems:",h.map(R=>`${R.displayName}(${R.isTreeCategory?"CAT":"PROD"}:${R.treePriority})`).join(", ")),h}async function tn(){await mt(async()=>{wc()})}async function fn(){if(a().isAuthenticated){const d=a().currentUser,h=`ðŸ‘¤ **${d.full_name}** (${d.role})

ðŸ” **Status:** Erfolgreich angemeldet
ðŸ’¡ **Tipp:** Lange drÃ¼cken zum Abmelden`,{agentStore:B}=await Wt(async()=>{const{agentStore:L}=await Promise.resolve().then(()=>kn);return{agentStore:L}},void 0);B.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:h})}}async function Dn(){if(a().isAuthenticated){await wn.logout();const{agentStore:d}=await Wt(async()=>{const{agentStore:h}=await Promise.resolve().then(()=>kn);return{agentStore:h}},void 0);d.clearMessages(),d.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Willkommen bei ecKasse!

ðŸ‘¥ VerfÃ¼gbare Benutzer:
â€¢ Admin (Vollzugriff)
â€¢ Kassier (Kassenfunktionen)
â€¢ Aushilfe (Grundfunktionen)

â° ÃœberprÃ¼fe Systemzeit und ausstehende Transaktionen...

ðŸ’¡ Geben Sie einfach Ihre 4-6 stellige PIN ein - das System erkennt Sie automatisch.

ðŸ”‘ Bei neuer oder Testkasse: Admin-PIN ist 1234`}),je.activate("agent",null,null,"numeric")}}function Bn(d){return d.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}function vn(d){let h;if(Je.subscribe(B=>h=B)(),!(h.total<=0)&&(d==="bar"||d==="karte")){const B={type:d==="bar"?"Bar":"Karte",amount:h.total};Je.finishOrder(B)}}function Un(){Fn()}function vr(){vn("zwischenrechnung")}async function pr(){let d;Je.subscribe(R=>d=R)();const h=d.items&&d.items.length>0,B=d.metadata&&d.metadata.table,L=d.status==="active",Y=d.transactionId;if(L&&Y&&h&&B)try{await Je.parkCurrentOrder(B,!1),await Xn.refresh()}catch(R){throw R}else{if(L&&Y&&h&&!B)throw new Error("FORCE_TABLE_ASSIGNMENT");Y&&Je.resetOrder()}}async function Fn(){await mt(async()=>{lt.set("order");let d;Je.subscribe(R=>d=R)();const h=d.items&&d.items.length>0,B=d.metadata&&d.metadata.table,L=d.status==="active",Y=d.transactionId;if(L&&Y&&(h||B))try{await pr(),Je.resetOrder(),y(S,"categories"),O=null}catch(R){if(R.message==="FORCE_TABLE_ASSIGNMENT"){je.activateTableEntryWithAutoCollapse();return}}else if(Y)je.activateTableEntry();else try{await Je.initializeOrder({}),je.activateTableEntry()}catch{}})}function gr(){lt.set("agent"),je.activateAlphaInput(d=>me.sendMessage(d),()=>{},me)}function qt(){c().isActive?je.deactivate():je.activateAlphaInput(d=>{},()=>{},me)}function ht(d){const{data:h,mouseX:B,mouseY:L}=d.detail;if(h&&h.isUserButton&&h.authenticated){Dn();return}h&&!h.isBackButton&&(y(m,h),y(U,B),y(k,L),y(Z,!0))}function Sn(){y(Z,!1),y(m,null)}function oa(d){const{item:h}=d.detail;if(h.category_names)y(ee,h),y(M,!0);else{let B={...h};if(h.associated_category_unique_identifier&&t(f).length>0){const L=t(f).find(Y=>Y.source_unique_identifier===h.associated_category_unique_identifier);L&&(B.category_name=L.category_names)}y(g,B),y(b,!0)}y(Z,!1)}async function wi(d){const{item:h}=d.detail;try{lt.set("agent");const B=h.category_names?"category":"item";console.log("ðŸ” [handleAdvancedEdit] wsStore:",ye),console.log("ðŸ” [handleAdvancedEdit] get(wsStore):",xt(ye)),console.log("ðŸ” [handleAdvancedEdit] wsStore methods:",Object.keys(xt(ye)||{}));const L=await ye.send({command:"getEntityJson",payload:{entityType:B,entityId:h.id}});if(L&&L.success){console.log("Entity data loaded for advanced editing:",L);const Y=JSON.stringify(L.payload.entity,null,2);me.addMessage({type:"agent",message:`Advanced Edit - ${B==="category"?"Category":"Item"} Data:

${Y}`,timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})}),me.startDraftMessage(),me.updateDraftMessage(Y),je.activateAlphaInput(()=>{},()=>{},me),setTimeout(()=>{je.clear(me);for(let R of Y)je.append(R,me)},50)}}catch(B){console.error("Error loading entity for advanced editing:",B),me.addMessage({type:"agent",message:`Failed to load ${h.category_names?"category":"item"} data for advanced editing: ${B.message}`,style:"error",timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})})}y(Z,!1)}async function Ci(d){const{productId:h,updates:B}=d.detail;try{const L=await ye.send({command:"updateProduct",payload:{productId:h,updates:B,sessionId:"admin-session-placeholder"}});L&&L.success&&t(S)==="products"&&O&&await loadProductsForCategory(O.id)}catch(L){console.error("Error saving product:",L)}y(b,!1),y(g,null)}function xi(){y(b,!1),y(g,null)}async function Si(d){const{categoryId:h,updates:B}=d.detail;try{const L=await ye.send({command:"updateCategory",payload:{categoryId:h,updates:B}});L&&L.success&&t(S)==="categories"&&await loadCategories()}catch(L){console.error("Error saving category:",L)}y(M,!1),y(ee,null)}function Ti(){y(M,!1),y(ee,null)}function pn(d,h=null){const B=t(j)==="6-6-6"?"hex":"rect",L=d.type.includes("half"),Y=d.type.includes("left")?"left":d.type.includes("right")?"right":"";let R,Ye;return t(j)==="6-6-6"?(R=L?t(he)/2-ue/2:t(he),Ye=t(Te)):(R=d.width||t(Ce),Ye=d.height||t(ve)),{shape:B,side:Y,width:R,height:Ye,customStyle:h?.style||""}}function ki(d){if(d.isPinpadTrigger)return{component:Ts,onClick:()=>je.activate("general",null,null),active:!0};if(d.isTableButton)return{icon:'<?xml version="1.0" encoding="utf-8" ?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="128" height="96" viewBox="0 0 128 96"><path fill="#312E2B" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M657.249 45.5326C661.809 44.9168 674.909 47.1424 679.872 47.8092L732.69 55.4381C800.705 65.1855 868.927 73.974 936.595 85.9405C1052.09 106.364 1167.06 129.61 1280.79 158.382C1293.38 161.569 1309.98 164.895 1321.49 170.599C1324.6 172.14 1323.03 212.195 1322.96 216.805C1317.16 219.727 1306.52 222.701 1300.01 224.708L1257.97 237.319L1130.3 276.416L899.334 347.199L803.807 376.657C787.511 381.667 770.045 387.867 753.759 391.908L753.502 400.777C773.208 410.24 765.714 426.758 751.438 436.493C754.672 454.83 760.404 477.222 766.292 495.043C778.312 531.425 788.232 547.55 775.428 586.479C793.644 611.173 788.351 632.852 778.653 658.961C787.232 666.586 790.02 670.215 791.077 681.45C816.727 679.381 846.371 680.664 871.117 688.624C896.232 697.171 921.595 711.801 943.908 726.18C987.586 754.326 1018.17 778.997 1072.77 768.261C1079.02 771.023 1095.27 781.56 1100.36 786.271C1100.42 792.121 1102.19 817.606 1098.13 820.178C1090.59 824.961 1075.24 828.435 1066.09 830.014C1026.48 836.849 984.219 830.616 947.21 815.373C903.854 796.249 890.566 784.975 842.244 781.116C874.83 831.877 906.209 889.241 960.618 920.012C970.24 925.454 980.474 930.082 990.275 935.297C991.235 941.66 992.421 969.949 989.016 974.859C982.424 979.02 920.144 989.34 910.409 990.417C891.68 982.492 859.397 965.44 844.008 953.414C822.81 936.804 809.128 922.88 792.581 901.291C771.86 874.258 756.399 849.065 728.483 828.685C709.892 832.319 688.586 833.255 669.549 831.452C646.125 829.234 618.374 825.196 598.494 811.371C593.269 807.737 589.282 802.843 585.24 798.042C553.887 805.691 525.245 819.378 497.608 835.771C474.784 849.308 452.002 863.701 427.523 874.18C398.834 886.461 367.611 893.439 336.763 897.587C325.42 899.112 313.771 899.376 302.513 900.919C297.191 897.145 279.362 881.142 273.369 875.976C272.239 864.432 272.049 850.606 272.646 839.051C272.945 833.27 288.443 833.361 293.319 832.373C329.846 824.972 357.628 805.289 386.466 782.888C410.121 764.513 433.906 747.931 459.941 733.052C460.128 730.331 460.85 706.908 463.218 706.014C467.046 704.569 477.641 704.496 482.581 704.061C512.165 701.457 535.516 683.606 561.036 670.641C571.404 665.423 582.207 666.893 593.593 660.02C579.677 635.479 573.135 610.932 594.816 588.27C582.616 563.27 588.1 529.223 598.913 504.722C611.77 475.589 613.546 463.845 614.222 432.534C598.269 422.101 596.589 405.793 614.366 396.46C614.916 389.423 615.173 383.967 615.187 376.913C601.03 371.777 575.26 366.981 559.569 363.156L455.12 337.098L149.251 259.442L78.6884 241.856C70.8122 239.899 47.2998 234.635 41.3126 231.387C41.1346 216.556 41.2485 201.692 41.3079 186.857C52.606 182.381 74.5142 177.545 86.9381 174.175L188.572 147.241C344.279 107.555 499.183 74.6893 657.249 45.5326Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M420.229 124.166C424.763 124.387 448.286 130.465 454.175 131.795L556.452 155.95L957.321 252.581C949.04 255.627 938.05 258.529 929.375 261.058L886.853 273.626L854.033 283.277C845.312 285.83 836.648 289.668 827.72 287.599C816.05 284.384 803.289 281.652 791.4 278.686L695.251 254.949L425.023 187.912L321.344 162.553C310.289 159.791 298.633 157.77 287.78 154.656C291.796 153.246 300.364 151.569 304.85 150.555L337.183 143.199C362.773 137.305 394.744 128.962 420.229 124.166Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M265.311 160.166C271.96 159.128 330.655 174.855 340.205 177.175L614.2 245.123L754.377 279.532L791.082 288.479C798.826 290.304 808.42 292.26 815.884 294.598C798.173 298.797 777.535 306.024 759.539 310.801C751.938 312.819 725.345 320.341 719.054 323.255L708.348 320.687L340.92 233.906C278.558 219.097 214.755 204.895 152.712 189.304C178.812 181.738 205.403 175.185 231.74 168.482C242.918 165.638 254.014 162.53 265.311 160.166Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M559.563 94.147C564.323 93.0834 660.812 115.531 674.236 118.506L1032.02 198.855C1052.72 203.552 1074.42 207.6 1094.86 212.553C1086.19 214.072 1075.33 217.458 1066.87 220.121C1037.65 229.314 1007.69 237.298 978.575 246.67C975.46 247.822 967.588 244.868 963.832 244.007C919.197 233.783 874.677 223.11 830.203 212.212L620.593 161.84L486.932 129.495C472.482 126.135 458.327 122.4 443.789 119.363C482.366 111.803 520.981 102.191 559.563 94.147Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M663.851 71.5367C665.361 71.3618 679.991 73.6973 682.831 74.1066L737.389 81.9234C870.666 100.961 1003 122.298 1134.39 151.955C1166.22 159.141 1198.22 165.349 1230.05 172.81L1135.38 200.78C1109.48 208.026 1113.44 210.356 1086.54 204.395L1054.04 197.176L929.57 168.933L577.539 90.2681C586.12 88.0049 598.001 85.7609 606.831 83.8393L663.851 71.5367Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M52.4513 194.985L436.98 287.312L600.468 326.447C638.618 335.571 678.926 345.626 717.219 353.656C717.103 366.111 717.561 379.259 717.876 391.766C706.809 388.47 691.336 385.371 679.717 382.553L609.544 365.177L396.545 311.727L183.856 257.687C140.964 246.728 95.9731 233.944 52.5878 225.461L52.4513 194.985Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M1310.72 180.02L1312.21 180.469C1313.6 183.901 1312.7 204.674 1312.59 209.673L972.38 314.284L809.82 364.294C783.127 372.669 754.979 381.051 728.641 390.189L727.572 390.487L726.69 389.944C725.828 385.97 726.31 359.443 726.343 353.678C780.964 338.681 833.379 322.736 887.61 306.745L1135.88 232.703L1254.47 197.077C1273.01 191.51 1292.19 185.212 1310.72 180.02Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M620.114 722.96C621.643 722.623 620.891 722.602 622.444 723.12C622.867 725.606 622.77 728.103 622.741 730.616C622.549 747.337 622.764 764.048 622.959 780.768C574.546 786.74 534.079 802.224 492.118 826.937C470.122 839.891 454.766 850.731 430.89 861.276C391.069 878.863 355.524 885.432 312.749 890.15C311.688 890.079 311.162 889.92 310.105 889.696C308.486 886.724 309.07 870.789 309.026 866.203C324.133 863.927 337.868 861.939 352.201 856.167C380.696 844.692 405.167 824.332 429.815 806.373C466.157 779.894 502.481 755.26 544.832 739.046C570.655 729.159 593.12 726.328 620.114 722.96Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M755.632 719.582C759.625 719.872 768.079 724.301 771.796 726.34C819.586 752.549 842.732 804.289 872.235 847.142C890.079 873.06 910.745 897.364 935.687 916.069C947.219 924.716 960.753 930.875 973.602 936.757C959.182 938.338 932.528 943.624 918.021 946.509L912.07 947.576C834.474 912.334 812.96 855.779 766.927 789.626C750.539 766.074 724.326 742.584 700.665 726.352C718.289 725.658 738.197 722.499 755.632 719.582Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M821.485 710.951C852.221 708.347 884.956 714.537 913.942 725.293C972.374 746.977 1021.52 805.461 1087.66 797.013C1087.77 802.462 1087.59 807.786 1087.45 813.229C1076.76 817.434 1064.81 820.253 1053.41 821.475C1042.39 823.549 1026.8 822.585 1015.73 821.763C980.762 819.165 951.792 807.816 920.817 791.886C894.666 778.436 866.437 771.502 836.685 771.166C825.545 759.691 814.844 746.427 802.755 735.623C797.587 731.005 791.851 727.062 786.278 722.925L789.31 713.634C798.939 711.881 811.533 711.47 821.485 710.951Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M95.0261 182.731C116.32 188.557 143.894 194.249 165.886 199.507L336.593 239.863C463.935 270.042 589.06 301.282 717.095 328.91C716.776 335.187 716.731 340.867 716.734 347.147L693.992 341.791L236.058 231.946L124.738 205.043C108.661 201.222 80.3098 195.452 65.5004 190.665C75.2858 188.495 85.3474 185.473 95.0261 182.731Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M1242.09 176.022C1246.73 175.263 1270.04 181.6 1275.54 183.259C1254.38 190.189 1230.21 196.641 1208.62 203.142L1064.07 246.452L750.487 339.919L725.918 347.386C725.795 341.295 725.242 334.403 724.878 328.261C746.736 321.377 770.936 314.995 793.127 308.485L933.459 267.212L1242.09 176.022Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M695.761 732.899C698.958 734.483 712.611 744.804 715.668 747.23C729.167 757.941 744.621 772.529 755.221 786.186C787.884 828.27 809.688 877.966 848.808 915.216C866.973 932.513 884.689 942.08 906.427 953.803L906.598 978.022C900.462 975.576 890.438 969.456 884.299 966.347C846.518 947.216 820.24 921.727 795.688 887.524C783.05 869.918 767.037 848.738 751.184 833.937C734.45 818.313 717.172 808.794 696.339 799.489C696.318 777.179 696.242 755.209 695.761 732.899Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M721.095 444.994C721.74 445.951 722.488 454.614 722.652 456.155C726.459 492.003 735.831 527.197 736.827 563.335C737.231 577.963 735.255 592.56 733.562 607.055C722.914 610.092 708.005 611.509 697.122 612.546L680.464 612.967C680.5 557.644 681.317 502.652 682.432 447.351C696.986 447.433 706.687 446.824 721.095 444.994Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M588.97 703.586C592.193 702.961 593.261 703.162 596.019 704.836C602.414 708.718 608.959 712.255 615.652 715.589C587.132 719.987 564.868 722.86 537.899 733.847C487.857 754.234 447.162 785.188 403.854 816.655C374.626 837.891 351.185 853.806 314.422 857.743L307.052 858.553C302.182 853.699 294.161 848.511 288.373 843.907C329.143 834.493 345.626 825.568 379.086 800.995C405.009 781.956 434.016 759.932 461.361 743.611C498.258 721.589 546.592 708.861 588.97 703.586Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M656.567 55.6023L657.409 56.0937C658.357 58.7556 658.624 62.7661 658.951 65.7059C648.279 68.4296 634.069 70.7138 622.84 73.1663L548.785 89.7786L421.401 116.86C365.061 129.132 307.868 142.451 251.912 156.318L189.659 172.309C176.034 175.866 154.816 180.662 142.643 186.858C135.351 185.074 127.925 183.428 120.601 181.743L109.615 178.989C138.051 170.406 167.393 163.831 196.055 156.061C269.859 136.053 343.689 119.588 418.358 103.459L572.15 71.6785C600.203 66.1278 628.345 60.0544 656.567 55.6023Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M641.252 442.601C651.714 444.866 665.945 446.234 676.615 446.787C674.816 501.128 674.068 558.424 674.324 612.834C668.364 612.485 664.376 612.049 658.469 611.15C649.594 610.454 637.87 606.792 629.491 604.056C614.818 567.2 630.007 517.652 637.813 480.931C640.232 469.556 641.017 454.215 641.252 442.601Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M779.771 683.251L780.189 683.675C782.095 688.866 779.558 711.114 778.917 718.025C773.337 715.781 763.388 710.909 757.152 709.766C754.879 709.349 750.562 710.192 748.108 710.627C728.234 714.151 708.361 716.06 688.207 717.135C687.095 728.218 687.256 743.7 687.278 754.971L687.426 804.224C674.376 804.095 628.242 800.449 618.913 792.637L619.421 791.906C623.154 791.049 628.538 791.264 632.492 791.258L632.413 764.037L632.055 714.12C616.543 703.199 603.123 701.101 591.994 688.284L592.961 686.224L591.622 687.785L592.656 686.119C598.33 688.363 604.868 693.598 610.447 695.701C653.524 711.939 743.875 715.997 779.771 683.251Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M664.251 55.7541C678.423 56.86 695.972 59.9207 710.308 62.0055L786.469 72.8571C956.427 96.3677 1125.44 129.586 1291.79 171.529C1294.06 172.1 1299.71 173.229 1301.11 174.721L1299.5 175.508C1294.67 177.05 1289.66 178.259 1284.75 179.518C1239.2 166.941 1193.07 157.955 1146.99 147.874C1077.42 132.657 1006.92 117.785 936.707 105.858C880.631 96.3334 823.473 88.363 767.235 79.4483C733.541 74.1072 699.31 70.5312 665.388 65.1981L664.251 55.7541Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M741.293 440.823L742.032 441.489C743.797 453.106 745.759 463.677 748.938 475.167C759.976 515.06 783.511 554.87 759.018 595.046C757.125 598.151 753.202 599.511 749.999 600.849L739.398 605.053C747.375 570.283 741.722 537.06 736.002 502.546C732.709 482.673 729.837 463.831 727.609 443.81C732.443 442.945 736.55 441.983 741.293 440.823Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M740.782 627.401L742.483 627.433C743.589 628.955 743.434 634.97 743.514 637.103C744.102 652.789 740.595 665.161 732.34 678.439C714.667 682.864 699.742 683.749 681.667 683.92C681.008 683.885 680.289 683.622 679.619 683.435C677.903 679.541 678.966 642.68 679.046 635.734C701.614 635.101 719.044 633.384 740.782 627.401Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M616.749 624.704C634.624 630.932 653.104 633.848 671.905 635.496C671.874 642.688 673.212 680.551 671.078 683.5C652.601 680.996 644.274 679.981 626.619 673.917C624.77 670.297 622.135 666.382 620.119 662.516C613.933 650.652 614.449 637.569 616.749 624.704Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M623.958 437.215C627.785 438.603 631.93 439.914 635.811 441.219C634.967 495.424 605.538 545.766 622.048 601.195C620.497 600.763 618.368 599.559 616.879 598.795C590.594 580.935 596.423 537.379 607.437 512.274C620.805 481.804 623.782 469.698 623.958 437.215Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M771.255 666.621C774.318 668.48 775.015 669.241 777.545 671.722C758.119 712.073 629.311 705.553 597.329 681.511C590.028 673.756 594.335 671.366 601.551 667.225C617.676 686.827 679.013 692.009 703.192 689.554C723.014 687.542 757.739 682.458 771.255 666.621Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M768.644 596.376C770.632 596.972 771.032 598.024 771.772 599.683C771.556 603.803 768.539 607.312 765.202 609.468C726.979 634.172 636.377 636.608 600.992 607.958C598.683 604.721 596.916 601.74 599.454 597.963C603.874 596.325 605.189 600.445 608.42 602.563C643.104 625.302 739.083 626.124 768.644 596.376Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M976.922 944.167C978.571 943.955 978.602 943.792 980.078 944.455C982.004 947.947 981.067 962.735 981.002 967.555L919.234 978.759C917.852 979.071 917.917 979.012 916.51 978.736C914.399 974.99 915.197 959.904 915.249 954.984C933.902 952.829 958.336 947.841 976.922 944.167Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M614.17 407.026C615.452 407.807 619.189 411.832 620.817 412.992C623.518 414.918 628.808 417.37 632.018 418.571C665.01 430.299 704.507 429.811 737.862 419.912C747.567 417.032 748.197 412.212 752.712 410.336L754.126 411.177C755.726 414.35 755.053 417.322 754.164 420.527C732.62 444.282 651.417 440.182 624.027 426.407C615.395 422.066 609.366 416.936 614.17 407.026Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M774.412 609.189C781.051 615.742 773.659 642.773 770.556 650.932C764.339 667.277 758.257 668.853 743.354 675.297C742.389 674.107 744.728 668.486 745.413 666.631C750.508 652.823 750.557 639.171 748.648 624.721C758.268 621.135 767.664 617.17 774.412 609.189Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M641.258 383.544C653.465 386.229 664.999 388.938 677.105 392.038C677.243 401.961 677.199 411.457 677.055 421.365C665.818 420.931 651.853 417.985 640.94 415.364L641.258 383.544Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M596.678 795.928C608.545 796.203 625.876 804.348 638.695 806.761C655.572 809.937 672.5 811.399 689.66 811.139C696.737 811.032 711.109 816.536 715.42 821.118C687.452 824.996 615.436 820.02 596.678 795.928Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M580.188 675.508L581.46 675.494C583.776 678.273 579.785 685.082 585.455 694.253C577.261 696.485 561.604 698.03 551.751 700.191C523.131 706.471 501.262 713.801 474.825 725.257C473.354 726.018 472.844 726.487 471.227 726.194C469.77 723.937 470.91 718.362 471.224 715.376C492.853 715.385 519.52 707.057 538.103 696.08C552.368 687.655 563.264 678.408 580.188 675.508Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M683.607 393.549L719.562 400.983C719.59 405.052 720.527 413.769 719.288 417.675C719.028 418.492 718.198 418.433 717.016 418.771C704.695 420.821 696.355 421.265 683.742 421.799C683.389 412.768 683.05 402.52 683.607 393.549Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M801.597 690.948C829.327 688.55 865.078 696.285 890.612 707.203C886.863 706.625 882.157 705.512 878.369 704.73C845.464 699.93 823.801 700.398 790.465 703.779C790.687 699.892 790.686 695.733 790.748 691.815L801.597 690.948Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M593.423 609.771C594.502 610.503 597.482 613.409 599.077 614.602C603.189 617.681 606.383 619.284 610.893 621.565L610.763 622.069C606.498 639.309 608.892 654.749 617.826 669.801C615.262 669.181 613.141 667.974 610.769 666.802C599.251 648.997 586.795 632.152 593.423 609.771Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M1070.51 779.664C1075.74 780.699 1085.68 785.983 1090.57 788.493C1077.83 790.82 1069.98 790.063 1057.59 787.916C1050.56 786.337 1041.41 784.569 1035.15 781.26C1046.42 781.142 1059.43 781.246 1070.51 779.664Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M282.9 852.231C286.022 853.329 296.217 861.873 299.229 864.317L299.261 884.393C295.513 882.17 286.596 873.322 283.246 870.092C283.284 864.045 283.102 858.268 282.9 852.231Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M624.936 379.015L635.404 381.942C634.891 390.625 635.121 405.552 634.018 413.256C630.293 411.756 626.404 409.313 623.34 406.708C625.179 395.523 625.184 390.478 624.936 379.015Z"/><path fill="#cd853f" transform="matrix(0.0937729 0 0 0.09375 3.05176e-05 0)" d="M743.298 395.403C743.563 395.671 744.025 396.335 744.073 396.699C746.048 411.811 739.731 412.997 727.737 416.59L726.893 416.151C726.136 412.914 726.461 404.344 726.489 400.614C732.119 399.14 737.756 397.208 743.298 395.403Z"/></svg>',onClick:Fn,active:!0,disabled:!1,color:"#3E2723",textColor:"#F5DEB3",backgroundStyle:"radial-gradient(ellipse at center, #4A2F2A 0%, #3E2723 30%, #2E1A16 70%, #1A0F0D 100%)"};if(!d.content)return d.type&&d.type.includes("half")?{disabled:!0}:{disabled:!0,style:"opacity: 0; pointer-events: none;"};if(d.content.isBackButton)return{icon:"â†",onClick:en,active:!0};if(d.content.isHomeButton)return t(se);if(d.content.isLayoutToggle)return{icon:d.content.icon||"",onClick:dn,secondaryaction:()=>{J()&&typeof J().displayLanguageSelector=="function"&&(lt.set("agent"),J().displayLanguageSelector())},active:!0,showShape:d.content.showShape};if(d.content.isUserButton)return t(Me);if(d.content.isSmartNavigation)return t(Be);if(d.content.isTimeButton){const h=Bn(l().time),B=l().time.getDate().toString().padStart(2,"0"),L=(l().time.getMonth()+1).toString().padStart(2,"0"),Y=`${B}.${L}`;return{icon:`<svg width="50" height="50" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
          <!-- Background gear icon - bigger and properly centered -->
          <g transform="translate(25,25) scale(2.2)" opacity="0.3">
            <path d="M0,7.5A1.5,1.5 0 0,1 -1.5,6A1.5,1.5 0 0,1 0,4.5A1.5,1.5 0 0,1 1.5,6A1.5,1.5 0 0,1 0,7.5M7.43,0.97C7.47,-0.35 7.5,-0.67 7.5,-1C7.5,-1.33 7.47,-1.66 7.43,-2L9.54,-3.63C9.73,-3.78 9.78,-4.05 9.66,-4.27L7.66,-7.73C7.54,-7.95 7.27,-8.04 7.05,-7.95L4.56,-6.95C4.04,-7.34 3.5,-7.68 2.87,-7.93L2.5,-10.58C2.46,-10.82 2.25,-11 2,-11H-2C-2.25,-11 -2.46,-10.82 -2.5,-10.58L-2.87,-7.93C-3.5,-7.68 -4.04,-7.34 -4.56,-6.95L-7.05,-7.95C-7.27,-8.04 -7.54,-7.95 -7.66,-7.73L-9.66,-4.27C-9.78,-4.05 -9.73,-3.78 -9.54,-3.63L-7.43,-2C-7.47,-1.66 -7.5,-1.33 -7.5,-1C-7.5,-0.67 -7.47,-0.35 -7.43,0.97L-9.54,2.63C-9.73,2.78 -9.78,3.05 -9.66,3.27L-7.66,6.73C-7.54,6.95 -7.27,7.03 -7.05,6.95L-4.56,5.94C-4.04,6.34 -3.5,6.68 -2.87,6.93L-2.5,9.58C-2.46,9.82 -2.25,10 -2,10H2C2.25,10 2.46,9.82 2.5,9.58L2.87,6.93C3.5,6.68 4.04,6.34 4.56,5.94L7.05,6.95C7.27,7.03 7.54,6.95 7.66,6.73L9.66,3.27C9.78,3.05 9.73,2.78 9.54,2.63L7.43,0.97Z" fill="#999"/>
          </g>
          <!-- Time text on top line -->
          <text x="25" y="20" font-family="Arial, sans-serif" font-size="11" font-weight="700" text-anchor="middle" dominant-baseline="middle" fill="#666">${h}</text>
          <!-- Date text on bottom line -->
          <text x="25" y="32" font-family="Arial, sans-serif" font-size="9" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#777">${Y}</text>
        </svg>`,onClick:tn,active:!0,color:"#2c2c2e"}}return d.content.isBetrugerCap?{isBetrugerCap:!0,label:d.content.label,color:d.content.color,onClick:gr,active:!0}:d.content.isKeyboardToggle?{isKeyboardToggle:!0,label:d.content.label,icon:d.content.icon,color:d.content.color,textColor:d.content.textColor,onClick:qt,active:!0}:{label:d.content?.label||"Content",data:d.content,active:!0,color:"#666666"}}function Ei(d){if(d.content?.type==="tisch")return{label:d.content.label,onClick:d.content.onClick,active:!0,color:"#5a4a3a",backgroundStyle:"radial-gradient(ellipse at center, #6A5A4A 0%, #5a4a3a 30%, #4A3A2A 70%, #3A2A1A 100%)",textColor:"#F5E5C8"};if(d.content?.type==="pinpad")return{label:d.content.label,component:Ts,onClick:d.content.onClick,active:!0};if(d.content?.type==="bar"){const h=o()&&o().total>0;return{label:d.content.label,onClick:d.content.onClick,active:h,disabled:!h,paymentButton:!0,color:h?"#5a7a5a":"#666"}}if(d.content?.type==="karte"){const h=o()&&o().total>0;return{label:d.content.label,onClick:d.content.onClick,active:h,disabled:!h,paymentButton:!0,color:h?"#4a5a7a":"#666",backgroundStyle:h?"radial-gradient(ellipse at center, #5A6A8A 0%, #4a5a7a 30%, #3A4A6A 70%, #2A3A5A 100%)":void 0}}if(d.content?.type==="zwischenrechnung"){const h=o()&&o().total>0;return{label:d.content.label,onClick:d.content.onClick,active:h,disabled:!h,paymentButton:!0,color:h?"#7a6a4a":"#666",backgroundStyle:h?"radial-gradient(ellipse at center, #8A7A5A 0%, #7a6a4a 30%, #6A5A3A 70%, #5A4A2A 100%)":void 0,textColor:h?"#F5E5C8":void 0}}if(d.content&&(d.content.category_names||d.content.display_names)){const h=d.content.category_names&&!d.content.isTreeProduct,L={label:h?be(d.content.category_names).de||"Unnamed":be(d.content.display_names).button.de||"Unnamed Product",data:d.content,active:!0};if(h)L.color="#3A2F20",L.backgroundStyle="radial-gradient(ellipse at center, #645540 0%, #5A4B35 30%, #4A3B28 70%, #3A2F20 100%)",L.textColor="#DDDDD0";else{let Y="#666666",R="#DDDDD0",Ye=1;if(d.content?.additional_item_attributes?.ui_suggestions?.background_color_hex&&(Y=d.content.additional_item_attributes.ui_suggestions.background_color_hex),d.content.isTreeProduct){if(d.content.isSecondary){const Ie=de(Y),ie=de("#3a3a3a");if(Ie&&ie){const Pe=Math.round(Ie.r*.2+ie.r*.8),ke=Math.round(Ie.g*.2+ie.g*.8),Ze=Math.round(Ie.b*.2+ie.b*.8);Y=`rgb(${Pe}, ${ke}, ${Ze})`}else Y="#555555";const $e=de(R);if($e){const Pe=Math.max(0,Math.round($e.r*.5)),ke=Math.max(0,Math.round($e.g*.5)),Ze=Math.max(0,Math.round($e.b*.5));R=`rgb(${Pe}, ${ke}, ${Ze})`}else R="#999999"}else if(d.content.isTertiary){const Ie=de(Y),ie=de("#3a3a3a");if(Ie&&ie){const Pe=Math.round(Ie.r*.1+ie.r*.9),ke=Math.round(Ie.g*.1+ie.g*.9),Ze=Math.round(Ie.b*.1+ie.b*.9);Y=`rgb(${Pe}, ${ke}, ${Ze})`}else Y="#3a3a3a";const $e=de(R);if($e){const Pe=Math.max(0,Math.round($e.r*.4)),ke=Math.max(0,Math.round($e.g*.4)),Ze=Math.max(0,Math.round($e.b*.4));R=`rgb(${Pe}, ${ke}, ${Ze})`}else R="#666666";Ye=.8}}L.color=Y,L.textColor=R,Ye<1&&(L.customStyle=`opacity: ${Ye};`)}return L}return{disabled:!0,color:"#3a3a3a",active:!1}}function Ii(d){d.content?.onClick?d.content.onClick():d.content&&(d.content.category_names||d.content.display_names)&&(t(S)==="categories"&&d.content.id?ct(d.content):t(S)==="products"&&d.content.id&&Xe(d.content))}Ge(()=>(a(),je),()=>{y(Me,(()=>{const d=a().currentUser;return d?{label:ge(d.full_name),data:{isUserButton:!0,authenticated:!0},onClick:fn,active:!0,color:"#28a745",textColor:"#666",customStyle:"font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; line-height: 1.1; white-space: pre-line; text-align: center; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);"}:{label:"Login",data:{isUserButton:!0,authenticated:!1},onClick:()=>je.activate("agent",null,null,"numeric"),active:!0,color:"#6c757d",textColor:"#666",customStyle:"font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; line-height: 1.1; white-space: pre-line; text-align: center; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);"}})())}),Ge(()=>(i(),Q(te()),Q(Ae())),()=>{y(Be,(()=>{let d="#2c2c2e";if(i().style)switch(i().style){case"error":d="#d32f2f";break;case"warning":d="#ffc107";break;case"success":d="#28a745";break;case"print":d="#2196F3";break;default:i().style?.startsWith("print")&&(d="#2196F3");break}return te()?{icon:`<svg width="50" height="50" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="3" y="3" width="12" height="10" rx="1" stroke="#404040" stroke-width="1.5" fill="none"/>
        <rect x="9" y="11" width="12" height="10" rx="1" stroke="#404040" stroke-width="1.5" fill="none"/>
        <line x1="3" y1="7" x2="15" y2="7" stroke="#404040" stroke-width="1.5"/>
        <line x1="9" y1="15" x2="21" y2="15" stroke="#404040" stroke-width="1.5"/>
      </svg>`,onClick:Ae(),active:!0,showShape:"",color:d,notificationStyle:i().style}:{icon:"",onClick:Ae(),active:!0,showShape:"double-arrow-down",color:d,notificationStyle:i().style}})())}),Ge(()=>Ss,()=>{y(se,(()=>{xt(xa);const h=xt(Ss)?"#d32f2f":"#666";return{icon:`<svg width="50" height="50" viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
      <path d="M25 2L2 20h6v25h34V20h6L25 2zm0 6.8L40 18v25H30V30H20v13H10V18L25 8.8z" fill="${h}"/>
    </svg>`,onClick:Gt,active:!0,showShape:"",color:h}})())}),Ge(()=>(l(),t(I),t(V),t(H)),()=>{if(l()){const d=l().minute;t(I)!==null&&t(I)!==d&&t(V).length>0&&(t(H)&&clearTimeout(t(H)),y(H,setTimeout(()=>{t(V).length>0&&y(V,[...t(V)])},200))),y(I,d)}}),Ge(()=>u(),()=>{y(v,u().MIN_BUTTON_WIDTH)}),Ge(()=>t(j),()=>{t(j)&&P()}),Ge(()=>(t(A),t(S),t(f),t(le)),()=>{t(A)&&(t(S)==="categories"&&t(f).length>=0||t(S)==="products"&&products.length>=0)&&(t(le)&&clearTimeout(t(le)),y(le,setTimeout(()=>{Ne()},50)))}),Ge(()=>(t(A),o(),t(_e)),()=>{t(A)&&o()&&(t(_e)&&clearTimeout(t(_e)),y(_e,setTimeout(()=>{Ct()},100)))}),Ge(()=>(t(Me),t(yt),t(Be),t(gt),t(se),t(_t),t(V),t(Ve)),()=>{const d=JSON.stringify(t(Me))!==JSON.stringify(t(yt)),h=JSON.stringify(t(Be))!==JSON.stringify(t(gt)),B=JSON.stringify(t(se))!==JSON.stringify(t(_t));t(V).length>0&&(d||h||B)&&(t(Ve)&&clearTimeout(t(Ve)),y(Ve,setTimeout(()=>{y(yt,t(Me)),y(gt,t(Be)),y(_t,t(se)),y(V,[...t(V)])},150)))}),Ge(()=>(t(V),t(j),t(xe),t(Le)),()=>{const d=[],h=new Map;t(V).forEach(L=>{h.has(L.rowIndex)||h.set(L.rowIndex,[]),h.get(L.rowIndex).push(L)});const B=t(j)==="4-4-4"?t(xe):t(Le);for(let L=0;L<B;L++)h.has(L)&&d.push(h.get(L).sort((Y,R)=>Y.columnIndex-R.columnIndex));y(rt,d)}),xn(),Pt();var la=Su(),Ka=p(la);{var Mi=d=>{var h=yu();let B;var L=p(h);let Y;var R=p(L);{let Ye=ot(()=>t(v)/4*3);Ic(R,{onClose:()=>je.deactivate(),get minButtonSize(){return t(Ye)}})}ce((Ye,Ie)=>{B=it(h,1,"pinpad-overlay svelte-1i1zsgb",null,B,Ye),Y=it(L,1,"pinpad-container svelte-1i1zsgb",null,Y,Ie)},[()=>({numeric:c().layout==="numeric",alpha:c().layout==="alpha"}),()=>({numeric:c().layout==="numeric",alpha:c().layout==="alpha"})]),E(d,h)};X(Ka,d=>{c(),T(()=>c().isActive)&&d(Mi)})}var Ya=w(Ka,2);qc(Ya,{get item(){return t(m)},get x(){return t(U)},get y(){return t(k)},get visible(){return t(Z)},$$events:{close:Sn,edit:oa,"advanced-edit":wi}});var Qa=w(Ya,2);Yc(Qa,{get visible(){return t(b)},get product(){return t(g)},$$events:{save:Ci,close:xi}});var Xa=w(Qa,2);Xc(Xa,{get visible(){return t(M)},get category(){return t(ee)},$$events:{save:Si,close:Ti}});var Ai=w(Xa,2),$i=p(Ai);{var Li=d=>{var h=_u(),B=p(h);ce(()=>oe(B,t(_))),E(d,h)},Ri=d=>{var h=xu();let B;var L=p(h);{var Y=Ie=>{var ie=bu();E(Ie,ie)};X(L,Ie=>{t(S),T(()=>t(S)==="products"&&products.length===0)&&Ie(Y)})}var R=w(L,2);Ot(R,1,()=>t(rt),Er,(Ie,ie)=>{var $e=wu();let Pe;Ot($e,5,()=>t(ie),ke=>`${ke.id}-${t(j)}-${t(he)||t(Ce)}-${t(Te)||t(ve)}`,(ke,Ze)=>{const q=ot(()=>(t(Ze),T(()=>ki(t(Ze)))));var dt=Ue(),Mt=Se(dt);{var mr=ze=>{{let gn=ot(()=>pn(t(Ze),t(q)));Vt(ze,nn(()=>t(gn),{get label(){return Q(t(q)),T(()=>t(q).label)},get color(){return Q(t(q)),T(()=>t(q).color)},get active(){return Q(t(q)),T(()=>t(q).active)},$$events:{click(...At){t(q).onClick?.apply(this,At)}},children:(At,et)=>{ou(At)},$$slots:{default:!0}}))}},Tn=ze=>{var gn=Ue(),At=Se(gn);{var et=jn=>{{let Lr=ot(()=>pn(t(Ze),t(q)));Vt(jn,nn(()=>t(Lr),{get label(){return Q(t(q)),T(()=>t(q).label)},get icon(){return Q(t(q)),T(()=>t(q).icon)},get color(){return Q(t(q)),T(()=>t(q).color)},get textColor(){return Q(t(q)),T(()=>t(q).textColor)},get active(){return Q(t(q)),T(()=>t(q).active)},$$events:{click(...ca){t(q).onClick?.apply(this,ca)}}}))}},$t=jn=>{var Lr=Ue(),ca=Se(Lr);{var Oi=zn=>{{let Rr=ot(()=>pn(t(Ze),t(q)));Vt(zn,nn(()=>t(Rr),{get active(){return Q(t(q)),T(()=>t(q).active)},$$events:{click(...hr){t(q).onClick?.apply(this,hr)}},children:(hr,es)=>{var Or=Ue(),mn=Se(Or);oi(mn,()=>t(q).component,(Gn,yr)=>{yr(Gn,{})}),E(hr,Or)},$$slots:{default:!0}}))}},Ni=zn=>{var Rr=Ue(),hr=Se(Rr);{var es=mn=>{{let Gn=ot(()=>pn(t(Ze),t(q)));Vt(mn,nn(()=>t(Gn),{get label(){return Q(t(q)),T(()=>t(q).label)},get active(){return Q(t(q)),T(()=>t(q).active)},get disabled(){return Q(t(q)),T(()=>t(q).disabled)},get color(){return Q(t(q)),T(()=>t(q).color)},get textColor(){return Q(t(q)),T(()=>t(q).textColor)},get backgroundStyle(){return Q(t(q)),T(()=>t(q).backgroundStyle)},$$events:{click(...yr){t(q).onClick?.apply(this,yr)}}}))}},Or=mn=>{var Gn=Ue(),yr=Se(Gn);{var Pi=qn=>{{let Nr=ot(()=>pn(t(Ze),t(q)));Vt(qn,nn(()=>t(Nr),{disabled:!0}))}},Di=qn=>{var Nr=Ue(),Bi=Se(Nr);{var Ui=Vn=>{{let Pr=ot(()=>pn(t(Ze),t(q)));Vt(Vn,nn(()=>t(Pr),{get icon(){return Q(t(q)),T(()=>t(q).icon)},get active(){return Q(t(q)),T(()=>t(q).active)},get showShape(){return Q(t(q)),T(()=>t(q).showShape)},get color(){return Q(t(q)),T(()=>t(q).color)},get textColor(){return Q(t(q)),T(()=>t(q).textColor)},get backgroundStyle(){return Q(t(q)),T(()=>t(q).backgroundStyle)},get notificationStyle(){return Q(t(q)),T(()=>t(q).notificationStyle)},$$events:{click(...ua){t(q).onClick?.apply(this,ua)}}}))}},Fi=Vn=>{var Pr=Ue(),ua=Se(Pr);{var ji=Hn=>{{let da=ot(()=>pn(t(Ze),t(q)));Vt(Hn,nn(()=>t(da),{get label(){return Q(t(q)),T(()=>t(q).label)},get data(){return Q(t(q)),T(()=>t(q).data)},get active(){return Q(t(q)),T(()=>t(q).active)},get color(){return Q(t(q)),T(()=>t(q).color)},get backgroundStyle(){return Q(t(q)),T(()=>t(q).backgroundStyle)},get textColor(){return Q(t(q)),T(()=>t(q).textColor)},$$events:{click(...Gi){t(q).onClick?.apply(this,Gi)},secondaryaction:ht}}))}},zi=Hn=>{{let da=ot(()=>pn(t(Ze),t(q)));Vt(Hn,nn(()=>t(da),{disabled:!0}))}};X(ua,Hn=>{Q(t(q)),T(()=>t(q).label)?Hn(ji):Hn(zi,!1)},!0)}E(Vn,Pr)};X(Bi,Vn=>{Q(t(q)),T(()=>t(q).icon!==void 0||t(q).showShape)?Vn(Ui):Vn(Fi,!1)},!0)}E(qn,Nr)};X(yr,qn=>{Q(t(q)),T(()=>t(q).disabled)?qn(Pi):qn(Di,!1)},!0)}E(mn,Gn)};X(hr,mn=>{Q(t(q)),T(()=>t(q).label&&!t(q).data)?mn(es):mn(Or,!1)},!0)}E(zn,Rr)};X(ca,zn=>{Q(t(q)),T(()=>t(q).component)?zn(Oi):zn(Ni,!1)},!0)}E(jn,Lr)};X(At,jn=>{Q(t(q)),T(()=>t(q).isKeyboardToggle)?jn(et):jn($t,!1)},!0)}E(ze,gn)};X(Mt,ze=>{Q(t(q)),T(()=>t(q).isBetrugerCap)?ze(mr):ze(Tn,!1)})}E(ke,dt)}),ce(ke=>Pe=it($e,1,"button-row svelte-1i1zsgb",null,Pe,ke),[()=>({"hex-row":t(j)==="6-6-6","rect-row":t(j)==="4-4-4"})]),E(Ie,$e)});var Ye=w(R,2);Ot(Ye,1,()=>t(z),Ie=>Ie.id,(Ie,ie)=>{var $e=Cu(),Pe=p($e);{let ke=ot(()=>t(j)==="6-6-6"?"hex":"rect"),Ze=ot(()=>t(j)==="6-6-6"?t(he):t(Ce)),q=ot(()=>t(j)==="6-6-6"?t(Te):t(ve)),dt=ot(()=>Ei(t(ie)));Vt(Pe,nn({get shape(){return t(ke)},get width(){return t(Ze)},get height(){return t(q)}},()=>t(dt),{$$events:{click:()=>Ii(t(ie)),secondaryaction:ht}}))}ce(()=>$n($e,`${t(ie),T(()=>t(ie).cssTransform)??""}; position: absolute; left: 6px;`)),E(Ie,$e)}),ce(Ie=>{B=it(h,1,"grid-container-unified svelte-1i1zsgb",null,B,Ie),$n(h,`
             --optimal-hex-height: ${t(Te)??""}px; 
             --hex-vertical-padding: 6px;
             --rect-vertical-padding: 6px;
             --optimal-hex-width: ${t(he)??""}px;
             --rect-button-height: ${t(ve)??""}px;
           `)},[()=>({hex:t(j)==="6-6-6",rect:t(j)==="4-4-4"})]),E(d,h)};X($i,d=>{t(_)?d(Li):d(Ri,!1)})}bn(la,d=>y(st,d),()=>t(st)),E(e,la),It(),s()}var ku=W('<input type="file" accept=".pdf,.jpg,.jpeg,.png" multiple style="display: none;" class="svelte-1wvon5f"/>'),Eu=W('<div class="importing-indicator svelte-1wvon5f"><div class="spinner svelte-1wvon5f"></div> <p class="svelte-1wvon5f">Importing menu...</p></div>'),Iu=W('<div class="loading-files svelte-1wvon5f"><div class="spinner svelte-1wvon5f"></div> <p class="svelte-1wvon5f">Loading available files...</p></div>'),Mu=W('<div class="error-message svelte-1wvon5f"><p class="svelte-1wvon5f"> </p> <button class="retry-btn svelte-1wvon5f">Retry</button></div>'),Au=W('<div class="upload-area svelte-1wvon5f"><div class="upload-prompt svelte-1wvon5f"><p class="svelte-1wvon5f">No files selected yet.</p> <button class="upload-btn svelte-1wvon5f"><svg class="upload-icon svelte-1wvon5f" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" class="svelte-1wvon5f"></path></svg> Choose Files</button> <p class="upload-hint svelte-1wvon5f">Select multiple PDF, JPG, or PNG files</p></div></div>'),$u=W('<div class="no-files svelte-1wvon5f"><p class="svelte-1wvon5f">No menu files found in the menu_inputs directory.</p> <p class="svelte-1wvon5f">Please add PDF, JPG, or PNG files to the menu_inputs folder.</p></div>'),Lu=W('<span class="svelte-1wvon5f"> </span>'),Ru=W('<span class="svelte-1wvon5f"> </span>'),Ou=W('<button class="control-btn svelte-1wvon5f">Add More Files</button>'),Nu=W('<div class="size-warning svelte-1wvon5f"></div>'),Pu=W('<div><label class="file-checkbox svelte-1wvon5f"><input type="checkbox" class="svelte-1wvon5f"/> <div class="file-info svelte-1wvon5f"><div class="file-name svelte-1wvon5f"> </div> <div class="file-details svelte-1wvon5f"><span class="file-type svelte-1wvon5f"> </span> <span class="file-date svelte-1wvon5f"> </span></div> <!></div></label></div>'),Du=W('<span class="upload-status uploaded svelte-1wvon5f">âœ“ Uploaded</span>'),Bu=W('<span class="upload-status pending svelte-1wvon5f">Pending upload</span>'),Uu=W('<div><label class="file-checkbox svelte-1wvon5f"><input type="checkbox" class="svelte-1wvon5f"/> <div class="file-info svelte-1wvon5f"><div class="file-name svelte-1wvon5f"> </div> <div class="file-details svelte-1wvon5f"><span class="file-type svelte-1wvon5f"> </span> <!></div></div></label> <button class="remove-btn svelte-1wvon5f" title="Remove file"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-1wvon5f"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" class="svelte-1wvon5f"></path></svg></button></div>'),Fu=W('<div class="file-controls svelte-1wvon5f"><div class="selection-info svelte-1wvon5f"><!></div> <div class="control-buttons svelte-1wvon5f"><!> <button class="control-btn svelte-1wvon5f">Select All Valid</button> <button class="control-btn svelte-1wvon5f">Clear Selection</button></div></div> <div class="file-list svelte-1wvon5f"><!></div> <div class="import-controls svelte-1wvon5f"><button class="import-btn svelte-1wvon5f"> </button></div>',1),ju=W('<div class="file-selector svelte-1wvon5f"><!></div>'),zu=W('<div class="menu-importer svelte-1wvon5f"><h3 class="svelte-1wvon5f">Menu Import</h3> <p class="svelte-1wvon5f"><!></p> <p class="size-limit svelte-1wvon5f"></p> <!> <!></div>');function Gu(e,n){Et(n,!1);const r=Pn();let s=G(!1),a=G([]),i=G(new Set),l=G(!0),u=G(null),o=G([]);const c=50*1024*1024,v=typeof window<"u"&&window.electronAPI,f=!v;let x=G();ln(async()=>{v?await _():y(l,!1)});async function _(){if(v){y(l,!0),y(u,null);try{const D=await window.electronAPI.invoke("list-menu-files");D&&D.error?(y(u,D.error),y(a,[])):Array.isArray(D)?y(a,D):(y(u,"Unexpected response format"),y(a,[]))}catch(D){console.error("Error loading files:",D),y(u,D.message),y(a,[])}finally{y(l,!1)}}}async function C(D){const I=D.target.files;if(!(!I||I.length===0)){for(const H of I){if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(H.type)){me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`File "${H.name}" has unsupported format. Please select PDF, JPG, or PNG files.`});continue}const re=c;if(H.size>re){const fe=Math.round(re/1048576),pe=Math.round(H.size/(1024*1024)*100)/100;me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`File "${H.name}" (${pe}MB) exceeds maximum size of ${fe}MB .`});continue}const ae={file:H,name:H.name,size:Math.round(H.size/(1024*1024)*100)/100,type:H.type.split("/")[1].toUpperCase(),selected:!0,uploaded:!1};y(o,[...t(o),ae])}t(x)&&Qe(x,t(x).value="")}}function S(){t(x)&&t(x).click()}function O(D){y(o,t(o).filter((I,H)=>H!==D))}function j(D){if(v)t(i).has(D.path)?t(i).delete(D.path):t(i).add(D.path),y(i,t(i));else{const I=t(o).findIndex(H=>H.name===D.name);I!==-1&&(Qe(o,t(o)[I].selected=!t(o)[I].selected),y(o,t(o)))}}function Z(){if(v){const D=t(a).filter(I=>I.sizeValid);y(i,new Set(D.map(I=>I.path)))}else y(o,t(o).map(D=>({...D,selected:!0})))}function m(){v?y(i,new Set):y(o,t(o).map(D=>({...D,selected:!1})))}function U(){return v?t(i).size:t(o).filter(D=>D.selected).length}async function k(){const D=U();if(!(t(s)||D===0))if(v){const I=Array.from(t(i));await M(I)}else{const I=t(o).filter(H=>H.selected);await ee(I)}}function b(D){return`${D.type} â€¢ ${D.size}MB`}function g(D){return new Date(D).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}async function M(D){if(t(s))return;y(s,!0),r("close"),lt.set("agent");const I=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),H=Array.isArray(D)?D.length:1,ue=Array.isArray(D)?D.map(re=>re.split("/").pop()).join(", "):D.split("/").pop();me.addMessage({timestamp:I,type:"agent",message:`Starting menu import from ${H} file(s): ${ue}

This process will:
1. Parse the menu(s) with AI
2. Clean existing data
3. Import new menu structure
4. Create optimized layouts

Please wait...`});try{const re=await window.electronAPI.invoke("start-menu-import",D);if(re&&!re.success&&re.message){me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Import failed: ${re.message}`}),y(s,!1);return}}catch(re){console.error("Error starting import:",re),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Import failed: ${re.message}`}),y(s,!1)}}async function ee(D){if(t(s)||D.length===0)return;y(s,!0),r("close"),lt.set("agent");const I=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),H=D.map(ue=>ue.name).join(", ");me.addMessage({timestamp:I,type:"agent",message:`Starting menu import from ${D.length} file(s): ${H}

This process will:
1. Upload files to server
2. Parse the menu(s) with AI
3. Clean existing data
4. Import new menu structure
5. Create optimized layouts

Please wait...`});try{const ue=`${window.location.protocol}//${window.location.host}`;me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Uploading ${D.length} files...`});const re=new FormData;D.forEach((ge,be)=>{re.append("menuFiles",ge.file)});const ae=new XMLHttpRequest,pe=await new Promise((ge,be)=>{ae.upload.addEventListener("progress",de=>{if(de.lengthComputable){const we=Math.round(de.loaded/de.total*100);me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Uploading files: ${we}%`})}}),ae.onload=function(){if(ae.status>=200&&ae.status<300)try{const de=JSON.parse(ae.responseText);ge(de)}catch{be(new Error("Invalid response format"))}else try{const de=JSON.parse(ae.responseText);be(new Error(de.message||`HTTP ${ae.status}`))}catch{be(new Error(`HTTP ${ae.status}: ${ae.statusText}`))}},ae.onerror=function(){be(new Error("Network error occurred"))},ae.open("POST",`${ue}/api/menu/upload-and-import`),ae.send(re)});if(!pe.success)throw new Error(pe.message||"Upload failed");me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`All files uploaded successfully. Processing ${pe.fileCount} files: ${pe.filenames.join(", ")}`}),D.forEach(ge=>{ge.uploaded=!0}),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`âœ… Menu import completed successfully!

You can now navigate back to the selection area to see your new menu items.`}),K("INFO","Refreshing categories after successful menu import"),ye.send({command:"getCategories"})}catch(ue){console.error("Error uploading and importing files:",ue),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Import failed: ${ue.message}`})}finally{y(s,!1)}}typeof window<"u"&&window.electronAPI&&window.electronAPI.onImportProgress&&(window.electronAPI.onImportProgress(D=>{const I=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});me.addMessage({timestamp:I,type:"agent",message:D})}),window.electronAPI.onImportComplete((D,I)=>{const H=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});D&&(K("INFO","Refreshing categories after successful menu import"),ye.send({command:"getCategories"})),me.addMessage({timestamp:H,type:"agent",message:D?`âœ… Import completed successfully!

${I}

You can now navigate back to the selection area to see your new menu items.`:`âŒ Import failed: ${I}`}),y(s,!1)})),Pt();var F=zu(),te=w(p(F),2),J=p(te);{var N=D=>{var I=Yt("Select one or more menu files from the menu_inputs directory");E(D,I)},V=D=>{var I=Yt("Upload and import menu files (PDF, JPG, PNG)");E(D,I)};X(J,D=>{v?D(N):D(V,!1)})}var A=w(te,2);A.textContent="Max file size: 50MB";var z=w(A,2);{var Ae=D=>{var I=ku();bn(I,H=>y(x,H),()=>t(x)),ne("change",I,C),E(D,I)};X(z,D=>{f&&D(Ae)})}var Me=w(z,2);{var Be=D=>{var I=Eu();E(D,I)},se=D=>{var I=Ue(),H=Se(I);{var ue=ae=>{var fe=Iu();E(ae,fe)},re=ae=>{var fe=Ue(),pe=Se(fe);{var ge=de=>{var we=Mu(),he=p(we),Te=p(he),Oe=w(he,2);ce(()=>oe(Te,`Error loading files: ${t(u)??""}`)),ne("click",Oe,_),E(de,we)},be=de=>{var we=ju(),he=p(we);{var Te=Le=>{var Ce=Au(),ve=p(Ce),Ee=w(p(ve),2);ne("click",Ee,S),E(Le,Ce)},Oe=Le=>{var Ce=Ue(),ve=Se(Ce);{var Ee=$=>{var P=$u();E($,P)},xe=$=>{var P=Fu(),le=Se(P),_e=p(le),Ve=p(_e);{var yt=He=>{var rt=Lu(),mt=p(rt);ce(()=>oe(mt,`${t(i).size??""} of ${t(a).length??""} files selected`)),E(He,rt)},gt=He=>{var rt=Ru(),mt=p(rt);ce(ct=>oe(mt,`${ct??""} of ${t(o).length??""} files selected`),[()=>t(o).filter(ct=>ct.selected).length]),E(He,rt)};X(Ve,He=>{v?He(yt):He(gt,!1)})}var _t=w(_e,2),tt=p(_t);{var bt=He=>{var rt=Ou();ne("click",rt,S),E(He,rt)};X(tt,He=>{f&&He(bt)})}var wt=w(tt,2),kt=w(wt,2),at=w(le,2),Ne=p(at);{var Ke=He=>{var rt=Ue(),mt=Se(rt);Ot(mt,1,()=>t(a),ct=>ct.path,(ct,Xe)=>{var en=Pu();let Gt;var dn=p(en),jt=p(dn),tn=w(jt,2),fn=p(tn),Dn=p(fn),Bn=w(fn,2),vn=p(Bn),Un=p(vn),vr=w(vn,2),pr=p(vr),Fn=w(Bn,2);{var gr=qt=>{var ht=Nu();ht.textContent="File too large (max 50MB)",E(qt,ht)};X(Fn,qt=>{t(Xe).sizeValid||qt(gr)})}ce((qt,ht,Sn,oa)=>{Gt=it(en,1,"file-item svelte-1wvon5f",null,Gt,qt),jt.disabled=!t(Xe).sizeValid,ps(jt,ht),oe(Dn,t(Xe).name),oe(Un,Sn),oe(pr,`Modified: ${oa??""}`)},[()=>({invalid:!t(Xe).sizeValid,selected:t(i).has(t(Xe).path)}),()=>t(i).has(t(Xe).path),()=>b(t(Xe)),()=>g(t(Xe).lastModified)]),ne("change",jt,()=>j(t(Xe))),E(ct,en)}),E(He,rt)},nt=He=>{var rt=Ue(),mt=Se(rt);Ot(mt,3,()=>t(o),ct=>ct.name,(ct,Xe,en)=>{var Gt=Uu();let dn;var jt=p(Gt),tn=p(jt),fn=w(tn,2),Dn=p(fn),Bn=p(Dn),vn=w(Dn,2),Un=p(vn),vr=p(Un),pr=w(Un,2);{var Fn=ht=>{var Sn=Du();E(ht,Sn)},gr=ht=>{var Sn=Bu();E(ht,Sn)};X(pr,ht=>{t(Xe).uploaded?ht(Fn):ht(gr,!1)})}var qt=w(jt,2);ce(ht=>{dn=it(Gt,1,"file-item svelte-1wvon5f",null,dn,ht),ps(tn,t(Xe).selected),oe(Bn,t(Xe).name),oe(vr,`${t(Xe).type??""} â€¢ ${t(Xe).size??""}MB`)},[()=>({selected:t(Xe).selected,uploaded:t(Xe).uploaded})]),ne("change",tn,()=>j(t(Xe))),ne("click",qt,()=>O(t(en))),E(ct,Gt)}),E(He,rt)};X(Ne,He=>{v?He(Ke):He(nt,!1)})}var Ct=w(at,2),st=p(Ct),Ft=p(st);ce((He,rt,mt,ct)=>{wt.disabled=He,kt.disabled=rt,st.disabled=mt,oe(Ft,`Import Selected Files (${ct??""})`)},[()=>v?t(a).every(He=>!He.sizeValid):t(o).length===0,()=>U()===0,()=>U()===0,U]),ne("click",wt,Z),ne("click",kt,m),ne("click",st,k),E($,P)};X(ve,$=>{v&&t(a).length===0?$(Ee):$(xe,!1)},!0)}E(Le,Ce)};X(he,Le=>{f&&t(o).length===0?Le(Te):Le(Oe,!1)})}E(de,we)};X(pe,de=>{v&&t(u)?de(ge):de(be,!1)},!0)}E(ae,fe)};X(H,ae=>{v&&t(l)?ae(ue):ae(re,!1)},!0)}E(D,I)};X(Me,D=>{t(s)?D(Be):D(se,!1)})}E(e,F),It()}var qu=W('<button class="download-btn svelte-1dlpwa7">ðŸ“¥ Download Export</button> <button class="reset-btn svelte-1dlpwa7">ðŸ”„ New Export</button>',1),Vu=W('<button class="cancel-btn svelte-1dlpwa7">âŒ Cancel</button>'),Hu=W('<button class="export-btn svelte-1dlpwa7" disabled><!></button> <!>',1),Wu=W('<button class="export-btn svelte-1dlpwa7">ðŸš€ Generate Export</button>'),Zu=W('<div class="error-message svelte-1dlpwa7"> <button class="retry-btn svelte-1dlpwa7">Try Again</button></div>'),Ju=W('<div class="job-info svelte-1dlpwa7"><small> </small></div>'),Ku=W('<div class="dsfinvk-exporter svelte-1dlpwa7"><h3 class="svelte-1dlpwa7">DSFinV-K Export</h3> <div class="date-range-picker svelte-1dlpwa7"><div class="date-input svelte-1dlpwa7"><label for="dsfinvk-start" class="svelte-1dlpwa7">Start Date:</label> <input type="date" id="dsfinvk-start" class="svelte-1dlpwa7"/></div> <div class="date-input svelte-1dlpwa7"><label for="dsfinvk-end" class="svelte-1dlpwa7">End Date:</label> <input type="date" id="dsfinvk-end" class="svelte-1dlpwa7"/></div></div> <div class="export-actions svelte-1dlpwa7"><!></div> <!> <!></div>');function Yu(e,n){Et(n,!1);let r=G(new Date().toISOString().split("T")[0]),s=G(new Date().toISOString().split("T")[0]),a=G(!1),i=G(null),l=G(null),u=G(null),o=null,c=G(null);const v=typeof window<"u"&&window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1";async function f(){y(a,!0),y(i,null),y(u,null),y(c,null),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`ðŸš€ Starting DSFinV-K export for period ${t(r)} to ${t(s)}...`,style:"info"});try{v?await _():await x()}catch(A){me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`âŒ DSFinV-K export failed: ${A.message}`,style:"error"}),y(i,"failed"),y(c,A.message)}finally{v||y(a,!1)}}async function x(){try{const A=await fetch("/api/export/dsfinvk/start",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({startDate:t(r),endDate:t(s)})});if(A.ok&&A.headers.get("content-type")?.includes("application/zip")){const z=await A.blob(),Ae=window.URL.createObjectURL(z),Me=`dsfinvk-export-${t(r)}-to-${t(s)}.zip`,Be=document.createElement("a");Be.href=Ae,Be.download=Me,document.body.appendChild(Be),Be.click(),document.body.removeChild(Be),window.URL.revokeObjectURL(Ae),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`âœ… DSFinV-K export complete! File downloaded as ${Me}`,style:"success"}),y(i,"complete")}else{const z=await A.json();if(!z.success)throw new Error(z.error||"Export failed")}}catch{const z=await ye.send({command:"generateDsfinvkExport",payload:{startDate:t(r),endDate:t(s)}});if(z.status==="success"&&z.payload.success)me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`âœ… DSFinV-K export complete! File available at: ${z.payload.path}`,style:"success"}),y(i,"complete");else throw new Error(z.payload?.message||z.error||"Unknown export error")}}async function _(){const z=await(await fetch("/api/export/dsfinvk/start",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({startDate:t(r),endDate:t(s)})})).json();if(!z.success)throw new Error(z.error||"Failed to start export job");y(l,z.jobId),y(i,z.status),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`ðŸ“Š Export job started (Job ID: ${t(l)}). Generating report...`,style:"info"}),C()}function C(){o&&clearInterval(o),o=setInterval(async()=>{try{const z=await(await fetch(`/api/export/dsfinvk/status/${t(l)}`,{credentials:"include"})).json();if(!z.success)throw new Error(z.error||"Failed to check job status");y(i,z.status.toLowerCase()),t(i)==="complete"?(clearInterval(o),o=null,y(u,z.downloadUrl),y(a,!1),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"âœ… DSFinV-K export complete! Ready for download.",style:"success"})):t(i)==="failed"?(clearInterval(o),o=null,y(a,!1),y(c,z.error||"Export job failed"),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`âŒ DSFinV-K export failed: ${t(c)}`,style:"error"})):t(i)==="processing"&&me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"âš™ï¸ Export job is processing...",style:"info"})}catch(A){console.error("Error polling job status:",A),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`âš ï¸ Error checking export status: ${A.message}`,style:"warning"})}},3e3)}function S(){t(u)&&(window.open(t(u),"_blank"),me.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"ðŸ“¥ Download initiated for DSFinV-K export.",style:"success"}))}function O(){o&&(clearInterval(o),o=null),y(a,!1),y(i,null),y(l,null),y(u,null),y(c,null)}vi(()=>{o&&clearInterval(o)}),Pt();var j=Ku(),Z=w(p(j),2),m=p(Z),U=w(p(m),2),k=w(m,2),b=w(p(k),2),g=w(Z,2),M=p(g);{var ee=A=>{var z=qu(),Ae=Se(z),Me=w(Ae,2);ne("click",Ae,S),ne("click",Me,O),E(A,z)},F=A=>{var z=Ue(),Ae=Se(z);{var Me=se=>{var D=Hu(),I=Se(D),H=p(I);{var ue=pe=>{var ge=Yt("â³ Queued...");E(pe,ge)},re=pe=>{var ge=Ue(),be=Se(ge);{var de=he=>{var Te=Yt("âš™ï¸ Processing...");E(he,Te)},we=he=>{var Te=Yt("ðŸ”„ Generating...");E(he,Te)};X(be,he=>{t(i)==="processing"?he(de):he(we,!1)},!0)}E(pe,ge)};X(H,pe=>{t(i)==="pending"?pe(ue):pe(re,!1)})}var ae=w(I,2);{var fe=pe=>{var ge=Vu();ne("click",ge,O),E(pe,ge)};X(ae,pe=>{v&&pe(fe)})}E(se,D)},Be=se=>{var D=Wu();ne("click",D,f),E(se,D)};X(Ae,se=>{t(a)||t(i)==="pending"||t(i)==="processing"?se(Me):se(Be,!1)},!0)}E(A,z)};X(M,A=>{t(i)==="complete"&&t(u)?A(ee):A(F,!1)})}var te=w(g,2);{var J=A=>{var z=Zu(),Ae=p(z),Me=w(Ae);ce(()=>oe(Ae,`âŒ Export failed: ${t(c)??""} `)),ne("click",Me,O),E(A,z)};X(te,A=>{t(i)==="failed"&&t(c)&&A(J)})}var N=w(te,2);{var V=A=>{var z=Ju(),Ae=p(z),Me=p(Ae);ce(()=>oe(Me,`Job ID: ${t(l)??""}`)),E(A,z)};X(N,A=>{v&&t(l)&&A(V)})}ce(()=>{U.disabled=t(a),b.disabled=t(a)}),rn(U,()=>t(r),A=>y(r,A)),rn(b,()=>t(s),A=>y(s,A)),E(e,j),It()}var Qu=W('<div class="control-center-overlay svelte-mpduov"><div class="control-center-panel svelte-mpduov"><div class="panel-header svelte-mpduov"><h2 class="svelte-mpduov">Control Center</h2> <button class="close-btn svelte-mpduov">Ã—</button></div> <div class="panel-content svelte-mpduov"><div class="section svelte-mpduov"><h3 class="svelte-mpduov">System Time</h3> <div class="time-display svelte-mpduov"> </div> <p class="time-description svelte-mpduov">Current system time. Time synchronization is managed automatically.</p></div> <div class="section svelte-mpduov"><h3 class="svelte-mpduov">Language & Region</h3> <div class="locale-settings svelte-mpduov"><label for="locale-select" class="locale-label svelte-mpduov">Display Locale:</label> <select id="locale-select" class="locale-select svelte-mpduov"><option class="svelte-mpduov">Deutsch (Deutschland)</option><option class="svelte-mpduov">English (United States)</option><option class="svelte-mpduov">English (United Kingdom)</option></select></div> <p class="locale-description svelte-mpduov">Changes how numbers, currencies, and dates are displayed in the interface.</p></div> <div class="section svelte-mpduov"><!></div> <div class="section svelte-mpduov"><!></div> <div class="section svelte-mpduov"><h3 class="svelte-mpduov">System Information</h3> <div class="system-info svelte-mpduov"><div class="info-item svelte-mpduov"><span class="label svelte-mpduov">Status:</span> <span class="value connected svelte-mpduov">Connected</span></div> <div class="info-item svelte-mpduov"><span class="label svelte-mpduov">Mode:</span> <span class="value svelte-mpduov">Development</span></div></div></div></div></div></div>');function Xu(e,n){Et(n,!1);const[r,s]=$r(),a=()=>vt(Wa,"$controlCenterVisible",r),i=()=>vt(gi,"$currentMinuteTime",r),l=()=>vt(lr,"$localeStore",r);Pn();function u(){Cc()}function o(S){return S.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}function c(){u()}function v(S){const O=S.target.value;Ol(O)}function f(S){S.key==="Escape"&&u()}Pt();var x=Ue();ne("keydown",Tr,f);var _=Se(x);{var C=S=>{var O=Qu(),j=p(O),Z=p(j),m=w(p(Z),2),U=w(Z,2),k=p(U),b=w(p(k),2),g=p(b),M=w(k,2),ee=w(p(M),2),F=w(p(ee),2);ce(()=>{l(),Xs(()=>{})});var te=p(F);te.value=te.__value="de-DE";var J=w(te);J.value=J.__value="en-US";var N=w(J);N.value=N.__value="en-GB";var V=w(M,2),A=p(V);Gu(A,{$$events:{close:c}});var z=w(V,2),Ae=p(z);Yu(Ae,{}),ce(Me=>oe(g,Me),[()=>o(i().time)]),ne("click",m,u),ci(F,l,Me=>dl(lr,Me)),ne("change",F,v),ne("click",O,ul(u)),E(S,O)};X(_,S=>{a()&&S(C)})}E(e,x),It(),s()}var ed=W('<main class="pos-grid svelte-1ji6e50"><div class="grid-item-display svelte-1ji6e50"><!></div> <div class="grid-selection-area svelte-1ji6e50"><!></div></main> <!>',1);function td(e,n){Et(n,!1);let r=G(),s=G(!1);ln(async()=>{au(),await wn.checkSession();const _=ye.subscribe(S=>{S.lastMessage?.command==="sessionEstablished"&&(console.log("Demo mode: Received session established message"),wn.establishSession(S.lastMessage.payload))});typeof window<"u"&&window.electronAPI&&window.electronAPI.onUiRefreshRequest&&window.electronAPI.onUiRefreshRequest(()=>{console.log("UI refresh requested - switching to selection view and refreshing data"),K("INFO","UI refresh requested after menu import"),lt.set("selection"),ye.send({command:"getCategories"}),setTimeout(()=>{window.location.reload()},1e3)});function C(){let S;ia.subscribe(O=>S=O.breadcrumb)(),console.log("ðŸ“ [Resize] Window resized. Current breadcrumb:",S)}return window.addEventListener("resize",C),()=>{_(),window.removeEventListener("resize",C)}});function a(_){y(s,_.detail)}function i(){t(r)&&typeof t(r).getIsAtBottom=="function"&&(t(r).getIsAtBottom()&&typeof t(r).cycleViews=="function"?t(r).cycleViews():typeof t(r).scrollToBottom=="function"&&t(r).scrollToBottom())}Pt();var l=ed(),u=Se(l),o=p(u),c=p(o);bn(bc(c,{$$events:{scrollstate:a},$$legacy:!0}),_=>y(r,_),()=>t(r));var v=w(o,2),f=p(v);Tu(f,{handleSmartAction:i,get isAtBottom(){return t(s)},get consoleViewComponent(){return t(r)}});var x=w(u,2);Xu(x,{}),E(e,l),It()}window.onerror=function(e,n,r,s,a){return K("ERROR","Unhandled Frontend Exception",{type:"window.onerror",message:e,source:n,lineno:r,colno:s,error:a?a.stack:"N/A"}),!0};window.addEventListener("unhandledrejection",e=>{K("ERROR","Unhandled Promise Rejection",{type:"unhandledrejection",reason:e.reason?e.reason.message||e.reason:"No reason provided",stack:e.reason?e.reason.stack:"N/A"})});Jo(td,{target:document.getElementById("app")});
