(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const bs=!1;var Vn=Array.isArray,ua=Array.prototype.indexOf,Er=Array.from,Qn=Object.defineProperty,zt=Object.getOwnPropertyDescriptor,ws=Object.getOwnPropertyDescriptors,da=Object.prototype,fa=Array.prototype,Ir=Object.getPrototypeOf,Qr=Object.isExtensible;function Nn(e){return typeof e=="function"}const Zt=()=>{};function va(e){return e()}function Zn(e){for(var t=0;t<e.length;t++)e[t]()}function pa(){var e,t,n=new Promise((r,s)=>{e=r,t=s});return{promise:n,resolve:e,reject:t}}const bt=2,Mr=4,or=8,Gn=16,Ht=32,dn=64,Ss=128,xt=256,er=512,et=1024,kt=2048,Jt=4096,Mt=8192,fn=16384,Ar=32768,Or=65536,Zr=1<<17,ma=1<<18,Nr=1<<19,Rr=1<<20,wr=1<<21,$r=1<<22,sn=1<<23,Dt=Symbol("$state"),xs=Symbol("legacy props"),Pr=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function ga(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function lr(e){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function ha(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function _a(e){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ya(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function ba(e){throw new Error("https://svelte.dev/e/effect_orphan")}function wa(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Sa(e){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function xa(e){throw new Error("https://svelte.dev/e/props_invalid_value")}function ka(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ta(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ca(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const cr=1,ur=2,ks=4,Ea=8,Ia=16,Ma=2,Aa=4,Oa=8,Na=1,Ra=2,Qe=Symbol(),$a="http://www.w3.org/1999/xhtml";function Pa(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let Da=!1;function Ts(e){return e===this.v}function Cs(e,t){return e!=e?t==t:e!==t||e!==null&&typeof e=="object"||typeof e=="function"}function Es(e){return!Cs(e,this.v)}let In=!1,La=!1;function Ba(){In=!0}let Re=null;function tr(e){Re=e}function vt(e,t=!1,n){Re={p:Re,c:null,e:null,s:e,x:null,l:In&&!t?{s:null,u:null,$:[]}:null}}function pt(e){var t=Re,n=t.e;if(n!==null){t.e=null;for(var r of n)Fs(r)}return e!==void 0&&(t.x=e),Re=t.p,e??{}}function Mn(){return!In||Re!==null&&Re.l===null}const Ua=new WeakMap;function Fa(e){var t=we;if(t===null)return Te.f|=sn,e;if((t.f&Ar)===0){if((t.f&Ss)===0)throw!t.parent&&e instanceof Error&&Is(e),e;t.b.error(e)}else Dr(e,t)}function Dr(e,t){for(;t!==null;){if((t.f&Ss)!==0)try{t.b.error(e);return}catch(n){e=n}t=t.parent}throw e instanceof Error&&Is(e),e}function Is(e){const t=Ua.get(e);t&&(Qn(e,"message",{value:t.message}),Qn(e,"stack",{value:t.stack}))}let nr=[];function ja(){var e=nr;nr=[],Zn(e)}function Lr(e){nr.length===0&&queueMicrotask(ja),nr.push(e)}function qa(){for(var e=we.b;e!==null&&!e.has_pending_snippet();)e=e.parent;return e===null&&ga(),e}function Br(e){var t=bt|kt,n=Te!==null&&(Te.f&bt)!==0?Te:null;return we===null||n!==null&&(n.f&xt)!==0?t|=xt:we.f|=Nr,{ctx:Re,deps:null,effects:null,equals:Ts,f:t,fn:e,reactions:null,rv:0,v:Qe,wv:0,parent:n??we,ac:null}}function za(e,t){let n=we;n===null&&ha();var r=n.b,s=void 0,a=Un(Qe),l=null,c=!Te;return ni(()=>{try{var o=e()}catch(m){o=Promise.reject(m)}var u=()=>o;s=l?.then(u,u)??Promise.resolve(o),l=s;var g=Pe,p=r.pending;c&&(r.update_pending_count(1),p||g.increment());const S=(m,w=void 0)=>{l=null,p||g.activate(),w?w!==Pr&&(a.f|=sn,Tn(a,w)):((a.f&sn)!==0&&(a.f^=sn),Tn(a,m)),c&&(r.update_pending_count(-1),p||g.decrement()),Os()};if(s.then(S,m=>S(null,m||"unknown")),g)return()=>{queueMicrotask(()=>g.neuter())}}),new Promise(o=>{function u(g){function p(){g===s?o(a):u(s)}g.then(p,p)}u(s)})}function Rt(e){const t=Br(e);return t.equals=Es,t}function Ms(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)Gt(t[n])}}function Va(e){for(var t=e.parent;t!==null;){if((t.f&bt)===0)return t;t=t.parent}return null}function Ur(e){var t,n=we;tn(Va(e));try{Ms(e),t=Qs(e)}finally{tn(n)}return t}function As(e){var t=Ur(e);if(e.equals(t)||(e.v=t,e.wv=Ys()),!vn)if(xn!==null)xn.set(e,e.v);else{var n=(Qt||(e.f&xt)!==0)&&e.deps!==null?Jt:et;lt(e,n)}}function Ga(e,t,n){const r=Mn()?Br:Rt;if(t.length===0){n(e.map(r));return}var s=Pe,a=we,l=Wa(),c=qa();Promise.all(t.map(o=>za(o))).then(o=>{s?.activate(),l();try{n([...e.map(r),...o])}catch(u){(a.f&fn)===0&&Dr(u,a)}s?.deactivate(),Os()}).catch(o=>{c.error(o)})}function Wa(){var e=we,t=Te,n=Re;return function(){tn(e),Bt(t),tr(n)}}function Os(){tn(null),Bt(null),tr(null)}const Rn=new Set;let Pe=null,Xn=null,xn=null,es=new Set,rr=[];function Ns(){const e=rr.shift();rr.length>0&&queueMicrotask(Ns),e()}let Bn=[],Fr=null,Sr=!1;class kn{current=new Map;#e=new Map;#n=new Set;#t=0;#s=null;#u=!1;#a=[];#o=[];#i=[];#r=[];#l=[];#d=[];#f=[];skipped_effects=new Set;process(t){Bn=[],Xn=null;var n=null;if(Rn.size>1){n=new Map,xn=new Map;for(const[a,l]of this.current)n.set(a,{v:a.v,wv:a.wv}),a.v=l;for(const a of Rn)if(a!==this)for(const[l,c]of a.#e)n.has(l)||(n.set(l,{v:l.v,wv:l.wv}),l.v=c)}for(const a of t)this.#p(a);if(this.#a.length===0&&this.#t===0){this.#v();var r=this.#i,s=this.#r;this.#i=[],this.#r=[],this.#l=[],Xn=Pe,Pe=null,ts(r),ts(s),Pe===null?Pe=this:Rn.delete(this),this.#s?.resolve()}else this.#c(this.#i),this.#c(this.#r),this.#c(this.#l);if(n){for(const[a,{v:l,wv:c}]of n)a.wv<=c&&(a.v=l);xn=null}for(const a of this.#a)wn(a);for(const a of this.#o)wn(a);this.#a=[],this.#o=[]}#p(t){t.f^=et;for(var n=t.first;n!==null;){var r=n.f,s=(r&(Ht|dn))!==0,a=s&&(r&et)!==0,l=a||(r&Mt)!==0||this.skipped_effects.has(n);if(!l&&n.fn!==null){if(s)n.f^=et;else if((r&et)===0)if((r&Mr)!==0)this.#r.push(n);else if((r&$r)!==0){var c=n.b?.pending?this.#o:this.#a;c.push(n)}else Wn(n)&&((n.f&Gn)!==0&&this.#l.push(n),wn(n));var o=n.first;if(o!==null){n=o;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}}#c(t){for(const n of t)((n.f&kt)!==0?this.#d:this.#f).push(n),lt(n,et);t.length=0}capture(t,n){this.#e.has(t)||this.#e.set(t,n),this.current.set(t,t.v)}activate(){Pe=this}deactivate(){Pe=null,Xn=null;for(const t of es)if(es.delete(t),t(),Pe!==null)break}neuter(){this.#u=!0}flush(){Bn.length>0?Ha():this.#v(),Pe===this&&(this.#t===0&&Rn.delete(this),this.deactivate())}#v(){if(!this.#u)for(const t of this.#n)t();this.#n.clear()}increment(){this.#t+=1}decrement(){if(this.#t-=1,this.#t===0){for(const t of this.#d)lt(t,kt),ln(t);for(const t of this.#f)lt(t,Jt),ln(t);this.#i=[],this.#r=[],this.flush()}else this.deactivate()}add_callback(t){this.#n.add(t)}settled(){return(this.#s??=pa()).promise}static ensure(){if(Pe===null){const t=Pe=new kn;Rn.add(Pe),kn.enqueue(()=>{Pe===t&&t.flush()})}return Pe}static enqueue(t){rr.length===0&&queueMicrotask(Ns),rr.unshift(t)}}function Ha(){var e=bn;Sr=!0;try{var t=0;for(ss(!0);Bn.length>0;){var n=kn.ensure();if(t++>1e3){var r,s;Ja()}n.process(Bn),an.clear()}}finally{Sr=!1,ss(e),Fr=null}}function Ja(){try{wa()}catch(e){Dr(e,Fr)}}function ts(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if((r.f&(fn|Mt))===0&&Wn(r)){var s=Pe?Pe.current.size:0;if(wn(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Gs(r):r.fn=null),Pe!==null&&Pe.current.size>s&&(r.f&Rr)!==0)break}}for(;n<t;)ln(e[n++])}}function ln(e){for(var t=Fr=e;t.parent!==null;){t=t.parent;var n=t.f;if(Sr&&t===we&&(n&Gn)!==0)return;if((n&(dn|Ht))!==0){if((n&et)===0)return;t.f^=et}}Bn.push(t)}const an=new Map;function Un(e,t){var n={f:0,v:e,reactions:null,equals:Ts,rv:0,wv:0};return n}function Yt(e,t){const n=Un(e);return ai(n),n}function V(e,t=!1,n=!0){const r=Un(e);return t||(r.equals=Es),In&&n&&Re!==null&&Re.l!==null&&(Re.l.s??=[]).push(r),r}function Fe(e,t){return _(e,P(()=>i(e))),t}function _(e,t,n=!1){Te!==null&&(!$t||(Te.f&Zr)!==0)&&Mn()&&(Te.f&(bt|Gn|$r|Zr))!==0&&!Vt?.includes(e)&&Ca();let r=n?yn(t):t;return Tn(e,r)}function Tn(e,t){if(!e.equals(t)){var n=e.v;vn?an.set(e,t):an.set(e,n),e.v=t;var r=kn.ensure();r.capture(e,n),(e.f&bt)!==0&&((e.f&kt)!==0&&Ur(e),lt(e,(e.f&xt)===0?et:Jt)),e.wv=Ys(),Rs(e,kt),Mn()&&we!==null&&(we.f&et)!==0&&(we.f&(Ht|dn))===0&&(St===null?ii([e]):St.push(e))}return t}function gr(e){_(e,e.v+1)}function Rs(e,t){var n=e.reactions;if(n!==null)for(var r=Mn(),s=n.length,a=0;a<s;a++){var l=n[a],c=l.f;if(!(!r&&l===we)){var o=(c&kt)===0;o&&lt(l,t),(c&bt)!==0?Rs(l,Jt):o&&ln(l)}}}function yn(e){if(typeof e!="object"||e===null||Dt in e)return e;const t=Ir(e);if(t!==da&&t!==fa)return e;var n=new Map,r=Vn(e),s=Yt(0),a=on,l=c=>{if(on===a)return c();var o=Te,u=on;Bt(null),is(a);var g=c();return Bt(o),is(u),g};return r&&n.set("length",Yt(e.length)),new Proxy(e,{defineProperty(c,o,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&ka();var g=n.get(o);return g===void 0?g=l(()=>{var p=Yt(u.value);return n.set(o,p),p}):_(g,u.value,!0),!0},deleteProperty(c,o){var u=n.get(o);if(u===void 0){if(o in c){const g=l(()=>Yt(Qe));n.set(o,g),gr(s)}}else _(u,Qe),gr(s);return!0},get(c,o,u){if(o===Dt)return e;var g=n.get(o),p=o in c;if(g===void 0&&(!p||zt(c,o)?.writable)&&(g=l(()=>{var m=yn(p?c[o]:Qe),w=Yt(m);return w}),n.set(o,g)),g!==void 0){var S=i(g);return S===Qe?void 0:S}return Reflect.get(c,o,u)},getOwnPropertyDescriptor(c,o){var u=Reflect.getOwnPropertyDescriptor(c,o);if(u&&"value"in u){var g=n.get(o);g&&(u.value=i(g))}else if(u===void 0){var p=n.get(o),S=p?.v;if(p!==void 0&&S!==Qe)return{enumerable:!0,configurable:!0,value:S,writable:!0}}return u},has(c,o){if(o===Dt)return!0;var u=n.get(o),g=u!==void 0&&u.v!==Qe||Reflect.has(c,o);if(u!==void 0||we!==null&&(!g||zt(c,o)?.writable)){u===void 0&&(u=l(()=>{var S=g?yn(c[o]):Qe,m=Yt(S);return m}),n.set(o,u));var p=i(u);if(p===Qe)return!1}return g},set(c,o,u,g){var p=n.get(o),S=o in c;if(r&&o==="length")for(var m=u;m<p.v;m+=1){var w=n.get(m+"");w!==void 0?_(w,Qe):m in c&&(w=l(()=>Yt(Qe)),n.set(m+"",w))}if(p===void 0)(!S||zt(c,o)?.writable)&&(p=l(()=>Yt(void 0)),_(p,yn(u)),n.set(o,p));else{S=p.v!==Qe;var k=l(()=>yn(u));_(p,k)}var A=Reflect.getOwnPropertyDescriptor(c,o);if(A?.set&&A.set.call(g,u),!S){if(r&&typeof o=="string"){var B=n.get("length"),q=Number(o);Number.isInteger(q)&&q>=B.v&&_(B,q+1)}gr(s)}return!0},ownKeys(c){i(s);var o=Reflect.ownKeys(c).filter(p=>{var S=n.get(p);return S===void 0||S.v!==Qe});for(var[u,g]of n)g.v!==Qe&&!(u in c)&&o.push(u);return o},setPrototypeOf(){Ta()}})}function ns(e){try{if(e!==null&&typeof e=="object"&&Dt in e)return e[Dt]}catch{}return e}function Ka(e,t){return Object.is(ns(e),ns(t))}var Fn,$s,Ps,Ds;function Ya(){if(Fn===void 0){Fn=window,$s=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;Ps=zt(t,"firstChild").get,Ds=zt(t,"nextSibling").get,Qr(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Qr(n)&&(n.__t=void 0)}}function An(e=""){return document.createTextNode(e)}function Pt(e){return Ps.call(e)}function dr(e){return Ds.call(e)}function d(e,t){return Pt(e)}function Ce(e,t){{var n=Pt(e);return n instanceof Comment&&n.data===""?dr(n):n}}function y(e,t=1,n=!1){let r=e;for(;t--;)r=dr(r);return r}function Xa(e){e.textContent=""}function Ls(){return!1}let rs=!1;function Qa(){rs||(rs=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function fr(e){var t=Te,n=we;Bt(null),tn(null);try{return e()}finally{Bt(t),tn(n)}}function Bs(e,t,n,r=n){e.addEventListener(t,()=>fr(n));const s=e.__on_r;s?e.__on_r=()=>{s(),r(!0)}:e.__on_r=()=>r(!0),Qa()}function Us(e){we===null&&Te===null&&ba(),Te!==null&&(Te.f&xt)!==0&&we===null&&ya(),vn&&_a()}function Za(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Ut(e,t,n,r=!0){var s=we;s!==null&&(s.f&Mt)!==0&&(e|=Mt);var a={ctx:Re,deps:null,nodes_start:null,nodes_end:null,f:e|kt,first:null,fn:t,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{wn(a),a.f|=Ar}catch(o){throw Gt(a),o}else t!==null&&ln(a);var l=n&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&Nr)===0;if(!l&&r&&(s!==null&&Za(a,s),Te!==null&&(Te.f&bt)!==0&&(e&dn)===0)){var c=Te;(c.effects??=[]).push(a)}return a}function vr(e){const t=Ut(or,null,!1);return lt(t,et),t.teardown=e,t}function xr(e){Us();var t=we.f,n=!Te&&(t&Ht)!==0&&(t&Ar)===0;if(n){var r=Re;(r.e??=[]).push(e)}else return Fs(e)}function Fs(e){return Ut(Mr|Rr,e,!1)}function ei(e){return Us(),Ut(or|Rr,e,!0)}function ti(e){kn.ensure();const t=Ut(dn,e,!0);return(n={})=>new Promise(r=>{n.outro?qr(t,()=>{Gt(t),r(void 0)}):(Gt(t),r(void 0))})}function jr(e){return Ut(Mr,e,!1)}function De(e,t){var n=Re,r={effect:null,ran:!1,deps:e};n.l.$.push(r),r.effect=pr(()=>{e(),!r.ran&&(r.ran=!0,P(t))})}function nn(){var e=Re;pr(()=>{for(var t of e.l.$){t.deps();var n=t.effect;(n.f&et)!==0&&lt(n,Jt),Wn(n)&&wn(n),t.ran=!1}})}function ni(e){return Ut($r|Nr,e,!0)}function pr(e,t=0){return Ut(or|t,e,!0)}function te(e,t=[],n=[]){Ga(t,n,r=>{Ut(or,()=>e(...r.map(i)),!0)})}function js(e,t=0){var n=Ut(Gn|t,e,!0);return n}function jn(e,t=!0){return Ut(Ht,e,!0,t)}function qs(e){var t=e.teardown;if(t!==null){const n=vn,r=Te;as(!0),Bt(null);try{t.call(null)}finally{as(n),Bt(r)}}}function zs(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){const s=n.ac;s!==null&&fr(()=>{s.abort(Pr)});var r=n.next;(n.f&dn)!==0?n.parent=null:Gt(n,t),n=r}}function ri(e){for(var t=e.first;t!==null;){var n=t.next;(t.f&Ht)===0&&Gt(t),t=n}}function Gt(e,t=!0){var n=!1;(t||(e.f&ma)!==0)&&e.nodes_start!==null&&e.nodes_end!==null&&(Vs(e.nodes_start,e.nodes_end),n=!0),zs(e,t&&!n),sr(e,0),lt(e,fn);var r=e.transitions;if(r!==null)for(const a of r)a.stop();qs(e);var s=e.parent;s!==null&&s.first!==null&&Gs(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Vs(e,t){for(;e!==null;){var n=e===t?null:dr(e);e.remove(),e=n}}function Gs(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function qr(e,t){var n=[];zr(e,n,!0),Ws(n,()=>{Gt(e),t&&t()})}function Ws(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var s of e)s.out(r)}else t()}function zr(e,t,n){if((e.f&Mt)===0){if(e.f^=Mt,e.transitions!==null)for(const l of e.transitions)(l.is_global||n)&&t.push(l);for(var r=e.first;r!==null;){var s=r.next,a=(r.f&Or)!==0||(r.f&Ht)!==0;zr(r,t,a?n:!1),r=s}}}function Vr(e){Hs(e,!0)}function Hs(e,t){if((e.f&Mt)!==0){e.f^=Mt,(e.f&et)===0&&(lt(e,kt),ln(e));for(var n=e.first;n!==null;){var r=n.next,s=(n.f&Or)!==0||(n.f&Ht)!==0;Hs(n,s?t:!1),n=r}if(e.transitions!==null)for(const a of e.transitions)(a.is_global||t)&&a.in()}}let _n=null;function si(e){var t=_n;try{if(_n=new Set,P(e),t!==null)for(var n of _n)t.add(n);return _n}finally{_n=t}}function Js(e){for(var t of si(e))Tn(t,t.v)}let bn=!1;function ss(e){bn=e}let vn=!1;function as(e){vn=e}let Te=null,$t=!1;function Bt(e){Te=e}let we=null;function tn(e){we=e}let Vt=null;function ai(e){Te!==null&&(Vt===null?Vt=[e]:Vt.push(e))}let ot=null,_t=0,St=null;function ii(e){St=e}let Ks=1,qn=0,on=qn;function is(e){on=e}let Qt=!1;function Ys(){return++Ks}function Wn(e){var t=e.f;if((t&kt)!==0)return!0;if((t&Jt)!==0){var n=e.deps,r=(t&xt)!==0;if(n!==null){var s,a,l=(t&er)!==0,c=r&&we!==null&&!Qt,o=n.length;if((l||c)&&(we===null||(we.f&fn)===0)){var u=e,g=u.parent;for(s=0;s<o;s++)a=n[s],(l||!a?.reactions?.includes(u))&&(a.reactions??=[]).push(u);l&&(u.f^=er),c&&g!==null&&(g.f&xt)===0&&(u.f^=xt)}for(s=0;s<o;s++)if(a=n[s],Wn(a)&&As(a),a.wv>e.wv)return!0}(!r||we!==null&&!Qt)&&lt(e,et)}return!1}function Xs(e,t,n=!0){var r=e.reactions;if(r!==null&&!Vt?.includes(e))for(var s=0;s<r.length;s++){var a=r[s];(a.f&bt)!==0?Xs(a,t,!1):t===a&&(n?lt(a,kt):(a.f&et)!==0&&lt(a,Jt),ln(a))}}function Qs(e){var t=ot,n=_t,r=St,s=Te,a=Qt,l=Vt,c=Re,o=$t,u=on,g=e.f;ot=null,_t=0,St=null,Qt=(g&xt)!==0&&($t||!bn||Te===null),Te=(g&(Ht|dn))===0?e:null,Vt=null,tr(e.ctx),$t=!1,on=++qn,e.ac!==null&&(fr(()=>{e.ac.abort(Pr)}),e.ac=null);try{e.f|=wr;var p=e.fn,S=p(),m=e.deps;if(ot!==null){var w;if(sr(e,_t),m!==null&&_t>0)for(m.length=_t+ot.length,w=0;w<ot.length;w++)m[_t+w]=ot[w];else e.deps=m=ot;if(!Qt||(g&bt)!==0&&e.reactions!==null)for(w=_t;w<m.length;w++)(m[w].reactions??=[]).push(e)}else m!==null&&_t<m.length&&(sr(e,_t),m.length=_t);if(Mn()&&St!==null&&!$t&&m!==null&&(e.f&(bt|Jt|kt))===0)for(w=0;w<St.length;w++)Xs(St[w],e);return s!==null&&s!==e&&(qn++,St!==null&&(r===null?r=St:r.push(...St))),(e.f&sn)!==0&&(e.f^=sn),S}catch(k){return Fa(k)}finally{e.f^=wr,ot=t,_t=n,St=r,Te=s,Qt=a,Vt=l,tr(c),$t=o,on=u}}function oi(e,t){let n=t.reactions;if(n!==null){var r=ua.call(n,e);if(r!==-1){var s=n.length-1;s===0?n=t.reactions=null:(n[r]=n[s],n.pop())}}n===null&&(t.f&bt)!==0&&(ot===null||!ot.includes(t))&&(lt(t,Jt),(t.f&(xt|er))===0&&(t.f^=er),Ms(t),sr(t,0))}function sr(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)oi(e,n[r])}function wn(e){var t=e.f;if((t&fn)===0){lt(e,et);var n=we,r=bn;we=e,bn=!0;try{(t&Gn)!==0?ri(e):zs(e),qs(e);var s=Qs(e);e.teardown=typeof s=="function"?s:null,e.wv=Ks;var a;bs&&La&&(e.f&kt)!==0&&e.deps}finally{bn=r,we=n}}}function i(e){var t=e.f,n=(t&bt)!==0;if(_n?.add(e),Te!==null&&!$t){var r=we!==null&&(we.f&fn)!==0;if(!r&&!Vt?.includes(e)){var s=Te.deps;if((Te.f&wr)!==0)e.rv<qn&&(e.rv=qn,ot===null&&s!==null&&s[_t]===e?_t++:ot===null?ot=[e]:(!Qt||!ot.includes(e))&&ot.push(e));else{(Te.deps??=[]).push(e);var a=e.reactions;a===null?e.reactions=[Te]:a.includes(Te)||a.push(Te)}}}else if(n&&e.deps===null&&e.effects===null){var l=e,c=l.parent;c!==null&&(c.f&xt)===0&&(l.f^=xt)}if(vn){if(an.has(e))return an.get(e);if(n){l=e;var o=l.v;return((l.f&et)===0&&l.reactions!==null||Zs(l))&&(o=Ur(l)),an.set(l,o),o}}else if(n){if(l=e,xn?.has(l))return xn.get(l);Wn(l)&&As(l)}if((e.f&sn)!==0)throw e.v;return e.v}function Zs(e){if(e.v===Qe)return!0;if(e.deps===null)return!1;for(const t of e.deps)if(an.has(t)||(t.f&bt)!==0&&Zs(t))return!0;return!1}function P(e){var t=$t;try{return $t=!0,e()}finally{$t=t}}const li=-7169;function lt(e,t){e.f=e.f&li|t}function ue(e){if(!(typeof e!="object"||!e||e instanceof EventTarget)){if(Dt in e)kr(e);else if(!Array.isArray(e))for(let t in e){const n=e[t];typeof n=="object"&&n&&Dt in n&&kr(n)}}}function kr(e,t=new Set){if(typeof e=="object"&&e!==null&&!(e instanceof EventTarget)&&!t.has(e)){t.add(e),e instanceof Date&&e.getTime();for(let r in e)try{kr(e[r],t)}catch{}const n=Ir(e);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const r=ws(n);for(let s in r){const a=r[s].get;if(a)try{a.call(e)}catch{}}}}}const ci=["touchstart","touchmove"];function ui(e){return ci.includes(e)}const di=new Set,os=new Set;function fi(e,t,n,r={}){function s(a){if(r.capture||$n.call(t,a),!a.cancelBubble)return fr(()=>n?.call(this,a))}return e.startsWith("pointer")||e.startsWith("touch")||e==="wheel"?Lr(()=>{t.addEventListener(e,s,r)}):t.addEventListener(e,s,r),s}function X(e,t,n,r,s){var a={capture:r,passive:s},l=fi(e,t,n,a);(t===document.body||t===window||t===document||t instanceof HTMLMediaElement)&&vr(()=>{t.removeEventListener(e,l,a)})}let ls=null;function $n(e){var t=this,n=t.ownerDocument,r=e.type,s=e.composedPath?.()||[],a=s[0]||e.target;ls=e;var l=0,c=ls===e&&e.__root;if(c){var o=s.indexOf(c);if(o!==-1&&(t===document||t===window)){e.__root=t;return}var u=s.indexOf(t);if(u===-1)return;o<=u&&(l=o)}if(a=s[l]||e.target,a!==t){Qn(e,"currentTarget",{configurable:!0,get(){return a||n}});var g=Te,p=we;Bt(null),tn(null);try{for(var S,m=[];a!==null;){var w=a.assignedSlot||a.parentNode||a.host||null;try{var k=a["__"+r];if(k!=null&&(!a.disabled||e.target===a))if(Vn(k)){var[A,...B]=k;A.apply(a,[e,...B])}else k.call(a,e)}catch(q){S?m.push(q):S=q}if(e.cancelBubble||w===t||w===null)break;a=w}if(S){for(let q of m)queueMicrotask(()=>{throw q});throw S}}finally{e.__root=t,delete e.currentTarget,Bt(g),tn(p)}}}function Gr(e){var t=document.createElement("template");return t.innerHTML=e.replaceAll("<!>","<!---->"),t.content}function Cn(e,t){var n=we;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function U(e,t){var n=(t&Na)!==0,r=(t&Ra)!==0,s,a=!e.startsWith("<!>");return()=>{s===void 0&&(s=Gr(a?e:"<!>"+e),n||(s=Pt(s)));var l=r||$s?document.importNode(s,!0):s.cloneNode(!0);if(n){var c=Pt(l),o=l.lastChild;Cn(c,o)}else Cn(l,l);return l}}function vi(e,t,n="svg"){var r=!e.startsWith("<!>"),s=`<${n}>${r?e:"<!>"+e}</${n}>`,a;return()=>{if(!a){var l=Gr(s),c=Pt(l);a=Pt(c)}var o=a.cloneNode(!0);return Cn(o,o),o}}function Wr(e,t){return vi(e,t,"svg")}function Lt(e=""){{var t=An(e+"");return Cn(t,t),t}}function qe(){var e=document.createDocumentFragment(),t=document.createComment(""),n=An();return e.append(t,n),Cn(t,n),e}function C(e,t){e!==null&&e.before(t)}function ee(e,t){var n=t==null?"":typeof t=="object"?t+"":t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+"")}function pi(e,t){return mi(e,t)}const mn=new Map;function mi(e,{target:t,anchor:n,props:r={},events:s,context:a,intro:l=!0}){Ya();var c=new Set,o=p=>{for(var S=0;S<p.length;S++){var m=p[S];if(!c.has(m)){c.add(m);var w=ui(m);t.addEventListener(m,$n,{passive:w});var k=mn.get(m);k===void 0?(document.addEventListener(m,$n,{passive:w}),mn.set(m,1)):mn.set(m,k+1)}}};o(Er(di)),os.add(o);var u=void 0,g=ti(()=>{var p=n??t.appendChild(An());return jn(()=>{if(a){vt({});var S=Re;S.c=a}s&&(r.$$events=s),u=e(p,r)||{},a&&pt()}),()=>{for(var S of c){t.removeEventListener(S,$n);var m=mn.get(S);--m===0?(document.removeEventListener(S,$n),mn.delete(S)):mn.set(S,m)}os.delete(o),p!==n&&p.parentNode?.removeChild(p)}});return gi.set(u,g),u}let gi=new WeakMap;function J(e,t,n=!1){var r=e,s=null,a=null,l=Qe,c=n?Or:0,o=!1;const u=(m,w=!0)=>{o=!0,S(w,m)};var g=null;function p(){g!==null&&(g.lastChild.remove(),r.before(g),g=null);var m=l?s:a,w=l?a:s;m&&Vr(m),w&&qr(w,()=>{l?a=null:s=null})}const S=(m,w)=>{if(l!==(l=m)){var k=Ls(),A=r;if(k&&(g=document.createDocumentFragment(),g.append(A=An())),l?s??=w&&jn(()=>w(A)):a??=w&&jn(()=>w(A)),k){var B=Pe,q=l?s:a,v=l?a:s;q&&B.skipped_effects.delete(q),v&&B.skipped_effects.add(v),B.add_callback(p)}else p()}};js(()=>{o=!1,t(u),o||S(null,null)},c)}function ar(e,t){return t}function hi(e,t,n){for(var r=e.items,s=[],a=t.length,l=0;l<a;l++)zr(t[l].e,s,!0);var c=a>0&&s.length===0&&n!==null;if(c){var o=n.parentNode;Xa(o),o.append(n),r.clear(),Nt(e,t[0].prev,t[a-1].next)}Ws(s,()=>{for(var u=0;u<a;u++){var g=t[u];c||(r.delete(g.k),Nt(e,g.prev,g.next)),Gt(g.e,!c)}})}function At(e,t,n,r,s,a=null){var l=e,c={flags:t,items:new Map,first:null},o=(t&ks)!==0;if(o){var u=e;l=u.appendChild(An())}var g=null,p=!1,S=new Map,m=Rt(()=>{var B=n();return Vn(B)?B:B==null?[]:Er(B)}),w,k;function A(){_i(k,w,c,S,l,s,t,r,n),a!==null&&(w.length===0?g?Vr(g):g=jn(()=>a(l)):g!==null&&qr(g,()=>{g=null}))}js(()=>{k??=we,w=i(m);var B=w.length;if(!(p&&B===0)){p=B===0;var q,v,N,x;if(Ls()){var h=new Set,f=Pe;for(v=0;v<B;v+=1){N=w[v],x=r(N,v);var E=c.items.get(x)??S.get(x);E?(t&(cr|ur))!==0&&ea(E,N,v,t):(q=ta(null,c,null,null,N,x,v,s,t,n,!0),S.set(x,q)),h.add(x)}for(const[W,D]of c.items)h.has(W)||f.skipped_effects.add(D.e);f.add_callback(A)}else A();i(m)}})}function _i(e,t,n,r,s,a,l,c,o){var u=(l&Ea)!==0,g=(l&(cr|ur))!==0,p=t.length,S=n.items,m=n.first,w=m,k,A=null,B,q=[],v=[],N,x,h,f;if(u)for(f=0;f<p;f+=1)N=t[f],x=c(N,f),h=S.get(x),h!==void 0&&(h.a?.measure(),(B??=new Set).add(h));for(f=0;f<p;f+=1){if(N=t[f],x=c(N,f),h=S.get(x),h===void 0){var E=r.get(x);if(E!==void 0){r.delete(x),S.set(x,E);var W=A?A.next:w;Nt(n,A,E),Nt(n,E,W),hr(E,W,s),A=E}else{var D=w?w.e.nodes_start:s;A=ta(D,n,A,A===null?n.first:A.next,N,x,f,a,l,o)}S.set(x,A),q=[],v=[],w=A.next;continue}if(g&&ea(h,N,f,l),(h.e.f&Mt)!==0&&(Vr(h.e),u&&(h.a?.unfix(),(B??=new Set).delete(h))),h!==w){if(k!==void 0&&k.has(h)){if(q.length<v.length){var H=v[0],R;A=H.prev;var I=q[0],K=q[q.length-1];for(R=0;R<q.length;R+=1)hr(q[R],H,s);for(R=0;R<v.length;R+=1)k.delete(v[R]);Nt(n,I.prev,K.next),Nt(n,A,I),Nt(n,K,H),w=H,A=K,f-=1,q=[],v=[]}else k.delete(h),hr(h,w,s),Nt(n,h.prev,h.next),Nt(n,h,A===null?n.first:A.next),Nt(n,A,h),A=h;continue}for(q=[],v=[];w!==null&&w.k!==x;)(w.e.f&Mt)===0&&(k??=new Set).add(w),v.push(w),w=w.next;if(w===null)continue;h=w}q.push(h),A=h,w=h.next}if(w!==null||k!==void 0){for(var F=k===void 0?[]:Er(k);w!==null;)(w.e.f&Mt)===0&&F.push(w),w=w.next;var L=F.length;if(L>0){var Se=(l&ks)!==0&&p===0?s:null;if(u){for(f=0;f<L;f+=1)F[f].a?.measure();for(f=0;f<L;f+=1)F[f].a?.fix()}hi(n,F,Se)}}u&&Lr(()=>{if(B!==void 0)for(h of B)h.a?.apply()}),e.first=n.first&&n.first.e,e.last=A&&A.e;for(var xe of r.values())Gt(xe.e);r.clear()}function ea(e,t,n,r){(r&cr)!==0&&Tn(e.v,t),(r&ur)!==0?Tn(e.i,n):e.i=n}function ta(e,t,n,r,s,a,l,c,o,u,g){var p=(o&cr)!==0,S=(o&Ia)===0,m=p?S?V(s,!1,!1):Un(s):s,w=(o&ur)===0?l:Un(l),k={i:w,v:m,k:a,a:null,e:null,prev:n,next:r};try{if(e===null){var A=document.createDocumentFragment();A.append(e=An())}return k.e=jn(()=>c(e,m,w,u),Da),k.e.prev=n&&n.e,k.e.next=r&&r.e,n===null?g||(t.first=k):(n.next=k,n.e.next=k.e),r!==null&&(r.prev=k,r.e.prev=k.e),k}finally{}}function hr(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,s=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==null&&a!==r;){var l=dr(a);s.before(a),a=l}}function Nt(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function cs(e,t,n=!1,r=!1,s=!1){var a=e,l="";te(()=>{var c=we;if(l!==(l=t()??"")&&(c.nodes_start!==null&&(Vs(c.nodes_start,c.nodes_end),c.nodes_start=c.nodes_end=null),l!=="")){var o=l+"";n?o=`<svg>${o}</svg>`:r&&(o=`<math>${o}</math>`);var u=Gr(o);if((n||r)&&(u=Pt(u)),Cn(Pt(u),u.lastChild),n||r)for(;Pt(u);)a.before(Pt(u));else a.before(u)}})}function yi(e,t,n,r,s){var a=t.$$slots?.[n],l=!1;a===!0&&(a=t.children,l=!0),a===void 0||a(e,l?()=>r:r)}function bi(e){const t={};e.children&&(t.default=!0);for(const n in e.$$slots)t[n]=!0;return t}const us=[...` 	
\r\f \v\uFEFF`];function wi(e,t,n){var r=e==null?"":""+e;if(t&&(r=r?r+" "+t:t),n){for(var s in n)if(n[s])r=r?r+" "+s:s;else if(r.length)for(var a=s.length,l=0;(l=r.indexOf(s,l))>=0;){var c=l+a;(l===0||us.includes(r[l-1]))&&(c===r.length||us.includes(r[c]))?r=(l===0?"":r.substring(0,l))+r.substring(c+1):l=c}}return r===""?null:r}function Si(e,t){return e==null?null:String(e)}function Ye(e,t,n,r,s,a){var l=e.__className;if(l!==n||l===void 0){var c=wi(n,r,a);c==null?e.removeAttribute("class"):e.className=c,e.__className=n}else if(a&&s!==a)for(var o in a){var u=!!a[o];(s==null||u!==!!s[o])&&e.classList.toggle(o,u)}return a}function cn(e,t,n,r){var s=e.__style;if(s!==t){var a=Si(t);a==null?e.removeAttribute("style"):e.style.cssText=a,e.__style=t}return r}function na(e,t,n=!1){if(e.multiple){if(t==null)return;if(!Vn(t))return Pa();for(var r of e.options)r.selected=t.includes(Ln(r));return}for(r of e.options){var s=Ln(r);if(Ka(s,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function xi(e){var t=new MutationObserver(()=>{na(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),vr(()=>{t.disconnect()})}function ra(e,t,n=t){var r=!0;Bs(e,"change",s=>{var a=s?"[selected]":":checked",l;if(e.multiple)l=[].map.call(e.querySelectorAll(a),Ln);else{var c=e.querySelector(a)??e.querySelector("option:not([disabled])");l=c&&Ln(c)}n(l)}),jr(()=>{var s=t();if(na(e,s,r),r&&s===void 0){var a=e.querySelector(":checked");a!==null&&(s=Ln(a),n(s))}e.__value=s,r=!1}),xi(e)}function Ln(e){return"__value"in e?e.__value:e.value}const ki=Symbol("is custom element"),Ti=Symbol("is html");function ds(e,t){var n=sa(e);n.checked!==(n.checked=t??void 0)&&(e.checked=t)}function Ci(e,t,n,r){var s=sa(e);s[t]!==(s[t]=n)&&(n==null?e.removeAttribute(t):typeof n!="string"&&Ei(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function sa(e){return e.__attributes??={[ki]:e.nodeName.includes("-"),[Ti]:e.namespaceURI===$a}}var fs=new Map;function Ei(e){var t=fs.get(e.nodeName);if(t)return t;fs.set(e.nodeName,t=[]);for(var n,r=e,s=Element.prototype;s!==r;){n=ws(r);for(var a in n)n[a].set&&t.push(a);r=Ir(r)}return t}function qt(e,t,n=t){var r=Mn(),s=new WeakSet;Bs(e,"input",a=>{var l=a?e.defaultValue:e.value;if(l=_r(e)?yr(l):l,n(l),Pe!==null&&s.add(Pe),r&&l!==(l=t())){var c=e.selectionStart,o=e.selectionEnd;e.value=l??"",o!==null&&(e.selectionStart=c,e.selectionEnd=Math.min(o,e.value.length))}}),P(t)==null&&e.value&&(n(_r(e)?yr(e.value):e.value),Pe!==null&&s.add(Pe)),pr(()=>{var a=t();if(e===document.activeElement){var l=Xn??Pe;if(s.has(l))return}_r(e)&&a===yr(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function _r(e){var t=e.type;return t==="number"||t==="range"}function yr(e){return e===""?null:+e}function Jn(e,t,n){var r=zt(e,t);r&&r.set&&(e[t]=n,vr(()=>{e[t]=null}))}class Hr{#e=new WeakMap;#n;#t;static entries=new WeakMap;constructor(t){this.#t=t}observe(t,n){var r=this.#e.get(t)||new Set;return r.add(n),this.#e.set(t,r),this.#s().observe(t,this.#t),()=>{var s=this.#e.get(t);s.delete(n),s.size===0&&(this.#e.delete(t),this.#n.unobserve(t))}}#s(){return this.#n??(this.#n=new ResizeObserver(t=>{for(var n of t){Hr.entries.set(n.target,n);for(var r of this.#e.get(n.target)||[])r(n)}}))}}var Ii=new Hr({box:"border-box"});function vs(e,t,n){var r=Ii.observe(e,()=>n(e[t]));jr(()=>(P(()=>n(e[t])),r))}function ps(e,t){return e===t||e?.[Dt]===t}function en(e={},t,n,r){return jr(()=>{var s,a;return pr(()=>{s=a,a=[],P(()=>{e!==n(...a)&&(t(e,...a),s&&ps(n(...s),e)&&t(null,...s))})}),()=>{Lr(()=>{a&&ps(n(...a),e)&&t(null,...a)})}}),e}function Mi(e){return function(...t){var n=t[0];n.target===this&&e?.apply(this,t)}}function aa(e){return function(...t){var n=t[0];return n.preventDefault(),e?.apply(this,t)}}function wt(e=!1){const t=Re,n=t.l.u;if(!n)return;let r=()=>ue(t.s);if(e){let s=0,a={};const l=Br(()=>{let c=!1;const o=t.s;for(const u in o)o[u]!==a[u]&&(a[u]=o[u],c=!0);return c&&s++,s});r=()=>i(l)}n.b.length&&ei(()=>{ms(t,r),Zn(n.b)}),xr(()=>{const s=P(()=>n.m.map(va));return()=>{for(const a of s)typeof a=="function"&&a()}}),n.a.length&&xr(()=>{ms(t,r),Zn(n.a)})}function ms(e,t){if(e.l.s)for(const n of e.l.s)i(n);t()}function Jr(e,t,n){if(e==null)return t(void 0),n&&n(void 0),Zt;const r=P(()=>e.subscribe(t,n));return r.unsubscribe?()=>r.unsubscribe():r}const gn=[];function ia(e,t){return{subscribe:mt(e,t).subscribe}}function mt(e,t=Zt){let n=null;const r=new Set;function s(c){if(Cs(e,c)&&(e=c,n)){const o=!gn.length;for(const u of r)u[1](),gn.push(u,e);if(o){for(let u=0;u<gn.length;u+=2)gn[u][0](gn[u+1]);gn.length=0}}}function a(c){s(c(e))}function l(c,o=Zt){const u=[c,o];return r.add(u),r.size===1&&(n=t(s,a)||Zt),c(e),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:s,update:a,subscribe:l}}function Kr(e,t,n){const r=!Array.isArray(e),s=r?[e]:e;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=t.length<2;return ia(n,(l,c)=>{let o=!1;const u=[];let g=0,p=Zt;const S=()=>{if(g)return;p();const w=t(r?u[0]:u,l,c);a?l(w):p=typeof w=="function"?w:Zt},m=s.map((w,k)=>Jr(w,A=>{u[k]=A,g&=~(1<<k),o&&S()},()=>{g|=1<<k}));return o=!0,S(),function(){Zn(m),p(),o=!1}})}function On(e){let t;return Jr(e,n=>t=n)(),t}let Kn=!1,Tr=Symbol();function Ze(e,t,n){const r=n[t]??={store:null,source:V(void 0),unsubscribe:Zt};if(r.store!==e&&!(Tr in n))if(r.unsubscribe(),r.store=e??null,e==null)r.source.v=void 0,r.unsubscribe=Zt;else{var s=!0;r.unsubscribe=Jr(e,a=>{s?r.source.v=a:_(r.source,a)}),s=!1}return e&&Tr in n?On(e):i(r.source)}function Ai(e,t){return e.set(t),t}function Hn(){const e={};function t(){vr(()=>{for(var n in e)e[n].unsubscribe();Qn(e,Tr,{enumerable:!1,value:!0})})}return[e,t]}function Oi(e){var t=Kn;try{return Kn=!1,[e(),Kn]}finally{Kn=t}}const Ni={get(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(Nn(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r)return r[t]}},set(e,t,n){let r=e.props.length;for(;r--;){let s=e.props[r];Nn(s)&&(s=s());const a=zt(s,t);if(a&&a.set)return a.set(n),!0}return!1},getOwnPropertyDescriptor(e,t){let n=e.props.length;for(;n--;){let r=e.props[n];if(Nn(r)&&(r=r()),typeof r=="object"&&r!==null&&t in r){const s=zt(r,t);return s&&!s.configurable&&(s.configurable=!0),s}}},has(e,t){if(t===Dt||t===xs)return!1;for(let n of e.props)if(Nn(n)&&(n=n()),n!=null&&t in n)return!0;return!1},ownKeys(e){const t=[];for(let n of e.props)if(Nn(n)&&(n=n()),!!n){for(const r in n)t.includes(r)||t.push(r);for(const r of Object.getOwnPropertySymbols(n))t.includes(r)||t.push(r)}return t}};function Ri(...e){return new Proxy({props:e},Ni)}function Ie(e,t,n,r){var s=!In||(n&Ma)!==0,a=(n&Oa)!==0,l=r,c=!0,o=()=>(c&&(c=!1,l=r),l),u;{var g=Dt in e||xs in e;u=zt(e,t)?.set??(g&&t in e?q=>e[t]=q:void 0)}var p,S=!1;[p,S]=Oi(()=>e[t]),p===void 0&&r!==void 0&&(p=o(),u&&(s&&xa(),u(p)));var m;if(s?m=()=>{var q=e[t];return q===void 0?o():(c=!0,q)}:m=()=>{var q=e[t];return q!==void 0&&(l=void 0),q===void 0?l:q},s&&(n&Aa)===0)return m;if(u){var w=e.$$legacy;return(function(q,v){return arguments.length>0?((!s||!v||w||S)&&u(v?m():q),q):m()})}var k=!1,A=Rt(()=>(k=!1,m()));i(A);var B=we;return(function(q,v){if(arguments.length>0){const N=v?i(A):s&&a?yn(q):q;return _(A,N),k=!0,l!==void 0&&(l=N),q}return vn&&k||(B.f&fn)!==0?A.v:i(A)})}function Wt(e){Re===null&&lr(),In&&Re.l!==null?oa(Re).m.push(e):xr(()=>{const t=P(e);if(typeof t=="function")return t})}function Yr(e){Re===null&&lr(),Wt(()=>()=>P(e))}function $i(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}function pn(){const e=Re;return e===null&&lr(),(t,n,r)=>{const s=e.s.$$events?.[t];if(s){const a=Vn(s)?s.slice():[s],l=$i(t,n,r);for(const c of a)c.call(e.x,l);return!l.defaultPrevented}return!0}}function Pi(e){Re===null&&lr(),Re.l===null&&Sa(),oa(Re).a.push(e)}function oa(e){var t=e.l;return t.u??={a:[],b:[],m:[]}}const Di="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Di);Ba();const Li="modulepreload",Bi=function(e){return"/"+e},gs={},Xt=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let u=function(g){return Promise.all(g.map(p=>Promise.resolve(p).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};var l=u;document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),o=c?.nonce||c?.getAttribute("nonce");s=u(n.map(g=>{if(g=Bi(g),g in gs)return;gs[g]=!0;const p=g.endsWith(".css"),S=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${S}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":Li,p||(m.as="script"),m.crossOrigin="",m.href=g,o&&m.setAttribute("nonce",o),document.head.appendChild(m),p)return new Promise((w,k)=>{m.addEventListener("load",w),m.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(c){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=c,window.dispatchEvent(o),!o.defaultPrevented)throw c}return s.then(c=>{for(const o of c||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};class Ui{constructor(){this.store=mt({serverTime:null,clientTime:null,timeOffset:0,lastSync:null}),this.subscribe=this.store.subscribe,this.update=this.store.update,this.set=this.store.set}updateServerTime(t){const n=new Date(t),r=new Date,s=n.getTime()-r.getTime();this.update(a=>({...a,serverTime:n,clientTime:r,timeOffset:s,lastSync:r}))}getServerTime(){let t;if(this.subscribe(r=>t=r)(),!t.lastSync)return new Date;const n=new Date;return new Date(n.getTime()+t.timeOffset)}formatTimeElapsed(t){const n=new Date,r=new Date(t),s=n.getTime()-r.getTime(),a=Math.floor(s/(1e3*60));return a>0?a:0}resetTimeOffset(){this.update(t=>({...t,timeOffset:0,lastSync:null}))}}const zn=new Ui,Cr=Kr(zn,(e,t)=>{const n=()=>{const s=zn.getServerTime();t(s)};n();const r=setInterval(n,1e3);return()=>clearInterval(r)},new Date),Fi=Kr(Cr,(e,t)=>{let n=null;return Cr.subscribe(r=>{const s=r.getMinutes();n!==s&&(n=s,t({time:r,minute:s}))})},{time:new Date,minute:new Date().getMinutes()});function ji(){const{subscribe:e,set:t,update:n}=mt({connected:!1,isConnected:!1,lastMessage:null,error:null,sessionId:null,currentServer:null,serverIndex:0,connectionAttempts:0}),r=()=>{const h=window.location.hostname;return window.location.protocol==="https:"?[h]:[`${h}:3030`]};let s=null,a=null,l=0,c=0,o=null;const u=new Map,g=10,p=new Map;function S(){r().forEach(f=>{p.has(f)||p.set(f,{successfulConnections:0,failedConnections:0,averageResponseTime:0,lastConnectionTime:null,reliability:1})})}function m(h){const f=h.successfulConnections+h.failedConnections;if(f===0)return 1;const E=h.successfulConnections/f,W=h.averageResponseTime<1e3?.1:0;return Math.min(E+W,1)}function w(){const h=r();if(h.length===1)return 0;const f=h.map(D=>{const H=p.get(D);return H?H.reliability:1}),E=f.reduce((D,H)=>D+H,0);let W=Math.random()*E;for(let D=0;D<f.length;D++)if(W-=f[D],W<=0)return D;return Math.floor(Math.random()*h.length)}function k(){S(),l=w();const h=r();console.log(`Initialized with smart-selected server index: ${l} (${h[l]})`),console.log("Server reliability scores:",Array.from(p.entries()).map(([f,E])=>`${f}: ${(E.reliability*100).toFixed(1)}%`).join(", "))}function A(){const h=localStorage.getItem("ecKasse-session-id");h?a=h:(a=N(),localStorage.setItem("ecKasse-session-id",a)),n(f=>({...f,sessionId:a})),console.log("Session ID initialized:",a)}function B(){const h=r(),f=h[l];return l=(l+1)%h.length,f}function q(h=0){if(o&&(clearTimeout(o),o=null),h>=g){console.error("Max reconnection attempts reached. Stopping reconnection."),n(f=>({...f,connected:!1,isConnected:!1,error:"Failed to connect to any server after maximum attempts",connectionAttempts:h}));return}try{const f=B(),W=`${window.location.protocol==="https:"?"wss:":"ws:"}//${f}`;console.log(`Attempting WebSocket connection to ${W} (attempt ${h+1}/${g})`),n(R=>({...R,currentServer:f,serverIndex:l,connectionAttempts:h+1,error:null})),s=new WebSocket(W);const D=Date.now();s.onopen=()=>{const R=Date.now()-D;if(console.log(`WebSocket connected to ${f} (${R}ms)`),p.has(f)){const I=p.get(f);I.successfulConnections++,I.lastConnectionTime=R,I.averageResponseTime=I.averageResponseTime===0?R:(I.averageResponseTime+R)/2,I.reliability=m(I),p.set(f,I)}c=0,n(I=>({...I,connected:!0,isConnected:!0,error:null,connectionAttempts:0}))},s.onmessage=R=>{try{const I=JSON.parse(R.data);if(console.log("WebSocket message received:",I),I.serverTime&&zn.updateServerTime(I.serverTime),n(K=>({...K,lastMessage:I})),I.command==="ui-refresh-request"){console.log("UI refresh request received, reloading page..."),window.location.reload();return}if(I.command==="displayAgentMessage"){console.log("🌐 [WebSocket] Received displayAgentMessage:",{timestamp:I.payload?.timestamp,type:I.payload?.type,message:I.payload?.message?.substring(0,100)+(I.payload?.message?.length>100?"...":""),style:I.payload?.style,hasStyle:!!I.payload?.style,fullPayload:I.payload}),Xt(async()=>{const{agentStore:K}=await Promise.resolve().then(()=>Dn);return{agentStore:K}},void 0).then(({agentStore:K})=>{console.log("🌐 [WebSocket] Calling agentStore.addMessage with payload"),K.addMessage(I.payload)});return}if(I.operationId&&u.has(I.operationId)){const K=u.get(I.operationId);u.delete(I.operationId),K(I)}}catch(I){console.error("Error parsing WebSocket message:",I)}},s.onclose=R=>{if(console.log(`WebSocket disconnected from ${f} (code: ${R.code}, reason: ${R.reason})`),R.code!==1e3&&p.has(f)){const K=p.get(f);K.failedConnections++,K.reliability=m(K),p.set(f,K),console.log(`Updated reliability for ${f}: ${(K.reliability*100).toFixed(1)}%`)}n(K=>({...K,connected:!1,isConnected:!1}));const I=Math.min(1e3*Math.pow(2,Math.floor(h/3)),3e4);console.log(`Reconnecting in ${I}ms to next server...`),o=setTimeout(()=>{q(h+1)},I)},s.onerror=R=>{if(console.error(`WebSocket error on ${f}:`,R),p.has(f)){const I=p.get(f);I.failedConnections++,I.reliability=m(I),p.set(f,I)}n(I=>({...I,error:`Connection error: ${f}`}))};const H=setTimeout(()=>{s&&s.readyState===WebSocket.CONNECTING&&(console.log(`Connection timeout for ${f}, trying next server...`),s.close())},1e4);s.onopen=(R=>function(...I){return clearTimeout(H),R.apply(this,I)})(s.onopen)}catch(f){console.error("Failed to create WebSocket connection:",f),n(E=>({...E,error:f.message})),o=setTimeout(()=>{q(h+1)},2e3)}}function v(h){if(console.log("[wsStore] send() called with:",h),console.log("[wsStore] WebSocket state:",{exists:!!s,readyState:s?s.readyState:"N/A",readyStateText:s?s.readyState===0?"CONNECTING":s.readyState===1?"OPEN":s.readyState===2?"CLOSING":"CLOSED":"N/A",sessionId:a}),s&&s.readyState===WebSocket.OPEN){const f={operationId:N(),...h,payload:{...h.payload,sessionId:a}};return h.command==="getCategories"&&(console.log("🔍 [wsStore] SENDING getCategories command:",f),console.log("🔍 [wsStore] WebSocket ready state confirmed OPEN for getCategories")),console.log("Sending WebSocket message:",f),s.send(JSON.stringify(f)),new Promise(E=>{u.set(f.operationId,E),setTimeout(()=>{u.has(f.operationId)&&(u.delete(f.operationId),h.command==="getCategories"&&console.error("❌ [wsStore] getCategories TIMEOUT after 10 seconds"),E({error:"Timeout waiting for response"}))},1e4),h.command==="getCategories"&&console.log("🔍 [wsStore] getCategories promise created, waiting for response...")})}else{const f="WebSocket not connected";return console.log(`❌ [wsStore] ${f}:`,{command:h.command,wsExists:!!s,readyState:s?s.readyState:"N/A"}),h.command==="getCategories"&&console.error("❌ [wsStore] getCategories FAILED - WebSocket not connected!"),Promise.resolve({error:f})}}function N(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(h){const f=Math.random()*16|0;return(h==="x"?f:f&3|8).toString(16)})}return k(),A(),q(),{subscribe:e,send:v,connect:q,getSessionId:()=>a,getCurrentServer:()=>x({subscribe:e}).currentServer,getConnectionStats:()=>{const h=x({subscribe:e});return{currentServer:h.currentServer,serverIndex:h.serverIndex,connectionAttempts:h.connectionAttempts,availableServers:r(),serverStats:Array.from(p.entries()).map(([f,E])=>({server:f,reliability:Math.round(E.reliability*100),successfulConnections:E.successfulConnections,failedConnections:E.failedConnections,averageResponseTime:Math.round(E.averageResponseTime),lastConnectionTime:E.lastConnectionTime}))}},forceReconnect:()=>{s&&s.close(),l=0,c=0,q()},switchToBestServer:()=>{s&&s.close(),l=w(),c=0,console.log("Switching to best performing server..."),q()},resetServerStats:()=>{p.clear(),S(),console.log("Server statistics reset")}};function x(h){let f;return h.subscribe(E=>f=E)(),f}}const ce=ji(),qi=Object.freeze(Object.defineProperty({__proto__:null,wsStore:ce},Symbol.toStringTag,{value:"Module"})),zi=mt([]);function Vi(e){if(!e||typeof e!="object")return{};const t={};for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];["string","number","boolean"].includes(typeof r)?t[n]=r:r instanceof Error?t[n]={message:r.message,stack:r.stack}:t[n]=JSON.stringify(r,null,2)}return t}function G(e,t,n={}){const r=new Date().toISOString().slice(0,19).replace("T"," ");zi.update(a=>[...a.slice(-100),{timestamp:r,level:e,message:t,context:n}]);let s;ce.subscribe(a=>s=a)(),ce&&s&&s.connected&&ce.send({command:"logClientEvent",payload:{level:e,message:t,context:Vi(n)}})}const Yn={isAuthenticated:!1,currentUser:null,sessionId:null,users:[],selectedUser:null,loginState:"user_selection",error:null,isLoading:!1};function Gi(){const{subscribe:e,set:t,update:n}=mt(Yn);return{subscribe:e,async fetchUsers(){try{n(s=>({...s,isLoading:!0,error:null}));const r=await ce.send({command:"getLoginUsers",payload:{}});if(r.status==="success")n(s=>({...s,users:r.payload||[],isLoading:!1})),G("INFO",`Fetched ${r.payload?.length||0} users for login`);else throw new Error(r.payload?.error||"Failed to fetch users")}catch(r){G("ERROR",`Failed to fetch users: ${r.message}`),n(s=>({...s,error:r.message,isLoading:!1}))}},selectUser(r){n(s=>({...s,selectedUser:r,loginState:"pin_entry",error:null})),G("INFO",`Selected user: ${r.username}`)},backToUserSelection(){n(r=>({...r,selectedUser:null,loginState:"user_selection",error:null}))},async login(r,s){try{n(l=>({...l,isLoading:!0,loginState:"authenticating",error:null}));const a=await ce.send({command:"login",payload:{username:r,password:s,ipAddress:"localhost",userAgent:navigator.userAgent}});if(a.status==="success"&&a.payload.success){const{user:l,session:c}=a.payload;try{await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:r,password:s})})}catch(u){G("WARN",`HTTP session establishment failed: ${u.message}`)}const o={...l,permissions:["all","order.change_price","order.reduce_quantity"]};return n(u=>({...u,isAuthenticated:!0,currentUser:o,sessionId:c.sessionId,loginState:"authenticated",isLoading:!1,error:null,selectedUser:null})),G("SUCCESS",`User ${r} authenticated successfully`),{success:!0}}else{const l=a.payload?.error||"Authentication failed";throw new Error(l)}}catch(a){return G("ERROR",`Authentication failed: ${a.message}`),n(l=>({...l,error:a.message,loginState:"pin_entry",isLoading:!1})),{success:!1,error:a.message}}},async logout(){try{const r={...Yn};let s=null;if(n(a=>(s=a.sessionId,r)),s)try{await ce.send({command:"logout",payload:{sessionId:s}}),G("INFO","User logged out successfully")}catch(a){G("WARN",`Logout request failed: ${a.message}`)}try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"})}catch(a){G("WARN",`HTTP logout failed: ${a.message}`)}return t(r),{success:!0}}catch(r){return G("ERROR",`Logout failed: ${r.message}`),t(Yn),{success:!1,error:r.message}}},async getCurrentUser(){try{let r=null;if(n(a=>(r=a.sessionId,a)),!r)throw new Error("No active session");const s=await ce.send({command:"getCurrentUser",payload:{sessionId:r}});if(s.status==="success"&&s.payload.success)return n(a=>({...a,currentUser:s.payload.user})),{success:!0,user:s.payload.user};throw new Error(s.payload?.error||"Failed to get current user")}catch(r){return G("ERROR",`Failed to get current user: ${r.message}`),{success:!1,error:r.message}}},clearError(){n(r=>({...r,error:null}))},reset(){t(Yn)},async checkSession(){try{n(s=>({...s,isLoading:!0}));const r=await fetch("/api/session/status",{credentials:"include"});if(r.ok){const s=await r.json();if(s.authenticated&&s.user){const a={...s.user,permissions:["all","order.change_price","order.reduce_quantity"]};return n(l=>({...l,isAuthenticated:!0,currentUser:a,sessionId:null,loginState:"authenticated",isLoading:!1,error:null,selectedUser:null})),G("SUCCESS",`Session restored for user: ${s.user.username}`),{success:!0,user:s.user}}}return n(s=>({...s,isLoading:!1})),{success:!1,error:"No valid session"}}catch(r){return G("ERROR",`Failed to check session: ${r.message}`),n(s=>({...s,isLoading:!1,error:r.message})),{success:!1,error:r.message}}},establishSession(r){try{const{user:s,session:a}=r,l={...s,permissions:["all","order.change_price","order.reduce_quantity"]};return n(c=>({...c,isAuthenticated:!0,currentUser:l,sessionId:a.sessionId,loginState:"authenticated",isLoading:!1,error:null,selectedUser:null})),G("SUCCESS",`Demo mode: Auto-authenticated as ${s.username}`),{success:!0}}catch(s){return G("ERROR",`Failed to establish demo session: ${s.message}`),{success:!1,error:s.message}}}}}const un=Gi(),hs=Object.freeze(Object.defineProperty({__proto__:null,authStore:un},Symbol.toStringTag,{value:"Module"})),ft=mt("agent");Kr(ft,e=>{const t=["order","receipts","agent"],n=t.indexOf(e);return[...t.slice(n),...t.slice(0,n)]});function Wi(){const{subscribe:e,set:t,update:n}=mt({transactionId:null,uuid:null,items:[],total:0,tax:0,status:"idle",paymentType:null,paymentAmount:null,metadata:{},activeTransactionItemId:null});let r=null,s=[];function a(){t({transactionId:null,uuid:null,items:[],total:0,tax:0,status:"idle",paymentType:null,paymentAmount:null,metadata:{},activeTransactionItemId:null}),r=null,s=[],G("INFO","Order reset and ready for new transaction.")}ce.subscribe(v=>{let N;if(e(x=>N=x)(),v.lastMessage?.command==="orderUpdated"&&v.lastMessage.status==="success"&&v.lastMessage.payload){const x=v.lastMessage.payload,h=(x.items||[]).map(D=>{const H=N.items.find(R=>R.id===D.id);return{...D,isEdited:H?.isEdited||!1}}),f=D=>{const H=[];return D.created_at&&H.push(new Date(D.created_at)),D.updated_at&&H.push(new Date(D.updated_at)),H.length>0?Math.max(...H):0};let E=null;h.length>0&&(E=[...h].sort((H,R)=>{const I=f(H),K=f(R);return I!==K?K-I:R.id-H.id})[0].id);const W=[...h].sort((D,H)=>{const R=f(D),I=f(H);return R!==I?R-I:D.id-H.id});if(n(D=>({...D,transactionId:x.id,uuid:x.uuid,items:W,total:parseFloat(x.total_amount),tax:parseFloat(x.tax_amount),status:"active",metadata:x.metadata?typeof x.metadata=="string"?JSON.parse(x.metadata):x.metadata:{},activeTransactionItemId:E})),G("INFO",`Order ${x.id} updated.`),N.status==="initializing"&&s.length>0){const D=[...s];s=[],D.forEach(({itemId:H,quantity:R,userId:I})=>{G("INFO",`Adding queued item ${H} to transaction ${x.id}`),ce.send({command:"addItemToTransaction",payload:{transactionId:x.id,itemId:H,quantity:R,userId:I}})})}}else if(v.lastMessage?.command==="transactionFinished"&&v.lastMessage.status==="success"){const x=v.lastMessage.payload;x.printStatus&&(x.printStatus.status==="failed"?G("ERROR",`Receipt print failed: ${x.printStatus.error}`):x.printStatus.status==="success"&&G("SUCCESS","Receipt printed successfully")),x.transaction?(n(h=>({...h,transactionId:x.transaction.id,uuid:x.transaction.uuid,items:x.transaction.items||[],total:parseFloat(x.transaction.total_amount),tax:parseFloat(x.transaction.tax_amount),status:"finished",paymentType:x.transaction.payment_type,paymentAmount:parseFloat(x.transaction.payment_amount),metadata:x.transaction.metadata?typeof x.transaction.metadata=="string"?JSON.parse(x.transaction.metadata):x.transaction.metadata:{},activeTransactionItemId:null})),G("SUCCESS",`Transaction ${x.transaction.id} finished successfully.`)):(G("SUCCESS",`Transaction ${N.transactionId} finished successfully.`),n(h=>({...h,status:"finished"}))),setTimeout(()=>{G("INFO","Auto-resetting order for next transaction."),a()},2e3)}});function l(){const v=On(un)?.currentUser;if(!v?.id)throw new Error("User must be authenticated to perform this action");return v.id}async function c(v={}){if(r)return r;const N=l();return n(x=>({...x,status:"initializing"})),G("INFO","Initializing new order..."),r=new Promise((x,h)=>{let f;f=ce.subscribe(E=>{E.lastMessage?.command==="orderUpdated"&&E.lastMessage.status==="success"?(f&&f(),x(E.lastMessage.payload)):E.lastMessage?.command==="orderUpdated"&&E.lastMessage.status==="error"&&(f&&f(),n(W=>({...W,status:"error"})),h(new Error(E.lastMessage.payload?.message||"Failed to initialize order")))})}),ce.send({command:"findOrCreateActiveTransaction",payload:{criteria:{metadata:v},userId:N}}),r}async function o(v,N=1){ft.set("order");const x=l();let h;if(e(f=>h=f)(),h.status==="idle"){G("INFO",`First item click detected. Initializing order and queuing item ${v}...`),s.push({itemId:v,quantity:N,userId:x});try{await c(x)}catch(f){G("ERROR",`Failed to initialize order: ${f.message}`),s=[];return}return}if(h.status==="initializing"){G("INFO",`Order initializing. Queuing item ${v}...`),s.push({itemId:v,quantity:N,userId:x});return}if(h.status==="active"&&h.transactionId){const f=h.items.find(E=>E.item_id===v&&!E.notes?.includes("Custom price:")&&!E.isEdited);if(f){const E=parseFloat(f.quantity)+N;G("INFO",`Item ${v} already exists and not edited, updating quantity to ${E}`),A(f.id,E,!1);return}G("INFO",`Adding new item ${v} to transaction ${h.transactionId}`),ce.send({command:"addItemToTransaction",payload:{transactionId:h.transactionId,itemId:v,quantity:N,userId:x}});return}G("ERROR","Cannot add item: invalid order state.")}async function u(v){const N=l();let x;if(e(h=>x=h)(),!x.transactionId||x.status!=="active"){G("ERROR","No active order to finish.");return}G("INFO",`Finishing transaction ${x.transactionId}...`),ce.send({command:"finishTransaction",payload:{transactionId:x.transactionId,paymentData:v,userId:N}})}async function g(v,N=!0){const x=l();let h;if(e(f=>h=f)(),!h.transactionId||h.status!=="active"){G("ERROR","No active order to park.");return}return G("INFO",`Parking transaction ${h.transactionId} to table ${v} (updateTime: ${N})...`),new Promise(async(f,E)=>{const W=ce.subscribe(async D=>{D.lastMessage?.command==="parkTransactionResponse"&&D.lastMessage.status==="success"?(W(),a(),G("SUCCESS",`Order parked to table ${v}`),f(D.lastMessage.payload)):D.lastMessage?.command==="parkTransactionResponse"&&D.lastMessage.status==="error"&&(W(),G("ERROR",`Failed to park order: ${D.lastMessage.payload?.message||"Unknown error"}`),E(new Error(D.lastMessage.payload?.message||"Failed to park order")))});ce.send({command:"parkTransaction",payload:{transactionId:h.transactionId,tableIdentifier:v,userId:x,updateTimestamp:N}})})}function p(v){ft.set("order"),G("INFO",`Loading order ${v.id}...`),n(N=>({...N,transactionId:v.id,uuid:v.uuid,items:v.items||[],total:parseFloat(v.total_amount),tax:parseFloat(v.tax_amount),status:"active",metadata:v.metadata?typeof v.metadata=="string"?JSON.parse(v.metadata):v.metadata:{},activeTransactionItemId:null})),G("SUCCESS",`Order ${v.id} loaded successfully`)}async function S(v){const N=l();let x;if(e(h=>x=h)(),!x.transactionId||x.status!=="active")throw G("ERROR","No active order to assign table number to."),new Error("No active order to assign table number to.");G("INFO",`Checking availability and assigning table ${v} to transaction ${x.transactionId}...`);try{const h=Math.random().toString(36).substring(2,15),f=await new Promise((W,D)=>{const H=setTimeout(()=>{R&&R(),D(new Error("Table availability check timeout"))},5e3);let R;R=ce.subscribe(I=>{I.lastMessage?.command==="checkTableAvailabilityResponse"&&I.lastMessage?.operationId===h&&(clearTimeout(H),R&&R(),W(I.lastMessage))}),ce.send({operationId:h,command:"checkTableAvailability",payload:{tableNumber:v,excludeTransactionId:x.transactionId}})});if(console.log("Table availability check result:",f),f.status==="success"&&f.payload.isInUse)return G("ERROR",`Table ${v} is already in use by another order`),{tableInUse:!0};n(W=>({...W,metadata:{...W.metadata,table:v}}));const E=Math.random().toString(36).substring(2,15);await new Promise((W,D)=>{const H=setTimeout(()=>{R&&R(),D(new Error("Metadata update timeout"))},5e3);let R;R=ce.subscribe(I=>{I.lastMessage?.command==="updateTransactionMetadataResponse"&&I.lastMessage?.operationId===E&&(clearTimeout(H),R&&R(),I.lastMessage.status==="success"?W(I.lastMessage):D(new Error(I.lastMessage.payload?.message||"Failed to update metadata")))}),ce.send({operationId:E,command:"updateTransactionMetadata",payload:{transactionId:x.transactionId,metadata:{...x.metadata,table:v},userId:N}})}),G("SUCCESS",`Table ${v} assigned to order`)}catch(h){throw G("ERROR",`Failed to assign table ${v}: ${h.message}`),h}}async function m(){G("INFO","Clearing active order view"),a()}function w(v,N){const x=l();let h;if(e(f=>h=f)(),h.status!=="active"||!h.transactionId){G("ERROR","Cannot update quantity: no active transaction");return}G("INFO",`Updating item quantity for item ${v} to ${N}`),ce.send({command:"updateItemQuantity",payload:{transactionId:h.transactionId,transactionItemId:v,newQuantity:N,userId:x}})}function k(v,N,x=1){const h=l();let f;if(e(E=>f=E)(),f.status!=="active"||!f.transactionId){G("ERROR","Cannot add custom price item: no active transaction");return}G("INFO",`Adding custom price item ${v} with price ${N} and quantity ${x}`),ce.send({command:"addCustomPriceItem",payload:{transactionId:f.transactionId,itemId:v,customPrice:N,quantity:x,userId:h}})}async function A(v,N,x=!0){const h=l();let f;if(e(E=>f=E)(),f.status!=="active"||!f.transactionId){G("ERROR","Cannot update quantity: no active transaction");return}x&&n(E=>({...E,items:E.items.map(W=>W.id===v?{...W,isEdited:!0}:W)})),G("INFO",`Updating item quantity for item ${v} to ${N}${x?" (marked as edited)":""}`),ce.send({command:"updateItemQuantity",payload:{transactionId:f.transactionId,transactionItemId:v,newQuantity:N,userId:h}})}async function B(v,N,x=!1){const h=l();let f;if(e(E=>f=E)(),f.status!=="active"||!f.transactionId){G("ERROR","Cannot update price: no active transaction");return}n(E=>({...E,items:E.items.map(W=>W.id===v?{...W,isEdited:!0}:W)})),G("INFO",`Updating item price for item ${v} to ${N} (marked as edited)`),ce.send({command:"updateItemPrice",payload:{transactionId:f.transactionId,transactionItemId:v,newPrice:N,isTotalPrice:x,userId:h}})}function q(){n(v=>({...v,activeTransactionItemId:null})),G("INFO","Item deselected from order view")}return{subscribe:e,set:t,update:n,initializeOrder:c,addItem:o,updateQuantity:w,updateItemQuantity:A,updateItemPrice:B,addWithCustomPrice:k,finishOrder:u,resetOrder:a,parkCurrentOrder:g,assignTableNumber:S,loadOrder:p,clearActiveOrderView:m,deselectItem:q}}const Ke=Wi();function Hi(e){if(typeof e=="object"&&e!==null)return e;if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}function Ji(){const{subscribe:e,set:t,update:n}=mt({receipts:[],loading:!1,error:null,lastUpdated:null});ce.subscribe(a=>{if(a.lastMessage?.command==="getRecentReceiptsResponse")if(a.lastMessage.status==="success"){const l=a.lastMessage.payload;if(l.success&&l.transactions){const c=l.transactions.map(o=>({...o,metadata:o.metadata?Hi(o.metadata):{}}));n(o=>({...o,receipts:c,loading:!1,error:null,lastUpdated:new Date})),G("INFO",`Loaded ${l.transactions.length} recent receipts.`)}else n(c=>({...c,loading:!1,error:l.message||"Failed to load receipts"})),G("ERROR",`Failed to load receipts: ${l.message||"Unknown error"}`)}else n(l=>({...l,loading:!1,error:a.lastMessage.payload?.message||"Failed to load receipts"})),G("ERROR",`Failed to load receipts: ${a.lastMessage.payload?.message||"Unknown error"}`)});function r(a=20){n(c=>({...c,loading:!0,error:null})),G("INFO",`Loading recent receipts (limit: ${a})...`);let l;ce.subscribe(c=>l=c)(),l&&l.connected?ce.send({command:"getRecentReceipts",payload:{limit:a}}):(G("WARNING","WebSocket not connected, skipping receipt load"),n(c=>({...c,loading:!1,error:"WebSocket connection not available"})))}function s(){G("INFO","Refreshing receipts..."),r()}return{subscribe:e,loadReceipts:r,refresh:s}}const ir=Ji();class Ki{constructor(){this.store=mt([]),this.subscribe=this.store.subscribe,this.set=this.store.set,this.update=this.store.update}async refreshParkedOrders(){try{G("DEBUG","Requesting parked transactions...");const t=this.generateUUID();G("DEBUG",`Generated operationId: ${t}`);const n=await this.sendRequestWithFallback(t,"getParkedTransactions",{});G("DEBUG",`Parked transactions response: ${JSON.stringify(n)}`),n.status==="success"?(G("DEBUG",`Setting parked orders: ${JSON.stringify(n.payload)}`),this.set(n.payload||[])):(G("ERROR",`Failed to fetch parked orders: ${JSON.stringify(n)}`),this.set([]))}catch(t){G("ERROR",`Error fetching parked orders: ${t.message}`),this.set([])}}async sendRequestWithFallback(t,n,r){try{return await this.sendWebSocketRequest(t,n,r)}catch(s){G("WARNING",`WebSocket request failed, trying HTTP fallback: ${s.message}`);try{return await this.sendHttpRequest(t,n,r)}catch(a){throw G("ERROR",`Both WebSocket and HTTP requests failed: ${a.message}`),a}}}sendWebSocketRequest(t,n,r){return new Promise((s,a)=>{let l;if(ce.subscribe(u=>l=u)(),!l||!l.connected){a(new Error("WebSocket is not connected"));return}const c=setTimeout(()=>{o(),a(new Error("WebSocket request timeout"))},3e3),o=ce.subscribe(u=>{u.lastMessage&&u.lastMessage.operationId===t&&(clearTimeout(c),o(),s(u.lastMessage))});ce.send({operationId:t,command:n,payload:r})})}async sendHttpRequest(t,n,r){const s=await fetch("/api/websocket-fallback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operationId:t,command:n,payload:r})});if(!s.ok)throw new Error(`HTTP request failed: ${s.status}`);return await s.json()}refresh(){return this.refreshParkedOrders()}async activateOrder(t,n=!1){try{const r=this.generateUUID(),s=await this.sendRequestWithFallback(r,"activateTransaction",{transactionId:t,userId:1,updateTimestamp:n});if(s.status==="success")return n&&await this.refreshParkedOrders(),s.payload;throw new Error(s.payload?.message||"Failed to activate order")}catch(r){throw G("ERROR",`Error activating order: ${r.message}`),r}}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const n=Math.random()*16|0;return(t==="x"?n:n&3|8).toString(16)})}}const Pn=new Ki,hn={DE:[["q","w","e","r","t","z","u","i","o","p","ü","ß"],["a","s","d","f","g","h","j","k","l","ö","ä"],["y","x","c","v","b","n","m"]],EN:[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["z","x","c","v","b","n","m"]],RU:[["й","ц","у","к","е","н","г","ш","щ","з","х","ъ"],["ф","ы","в","а","п","р","о","л","д","ж","э"],["я","ч","с","м","и","т","ь","б","ю"]]};function Yi(){const{subscribe:e,set:t,update:n}=mt({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:hn});return{subscribe:e,activate(r,s,a,l="numeric"){t({isActive:!0,mode:r,layout:l,liveValue:l==="alpha"?{text:"",cursor:0}:"",confirmCallback:s,cancelCallback:a,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:hn})},deactivate(){t({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:hn})},append(r,s=null){n(a=>{if(!a.isActive)return a;if(a.layout==="alpha"){const l=a.liveValue.text,c=a.liveValue.cursor,o=l.slice(0,c)+r+l.slice(c),u={text:o,cursor:c+1};return a.mode==="agent"&&s&&s.updateDraftMessage(o),{...a,liveValue:u,errorMessage:null}}else return{...a,liveValue:a.liveValue+r,errorMessage:null}})},backspace(r=null){n(s=>{if(!s.isActive)return s;if(s.layout==="alpha"){const a=s.liveValue.text,l=s.liveValue.cursor;if(l>0){const c=a.slice(0,l-1)+a.slice(l),o={text:c,cursor:l-1};return s.mode==="agent"&&r&&r.updateDraftMessage(c),{...s,liveValue:o,errorMessage:null}}return{...s,errorMessage:null}}else return{...s,liveValue:s.liveValue.slice(0,-1),errorMessage:null}})},clear(r=null){n(s=>s.isActive?(s.mode==="agent"&&r&&r.updateDraftMessage(""),{...s,liveValue:s.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null}):s)},async confirm(){let r,s;if(n(c=>(r=c,c)),!r.isActive)return;s=r.layout==="alpha"?r.liveValue.text:r.liveValue;let a;if(Ke.subscribe(c=>a=c)(),a.activeTransactionItemId&&r.layout==="numeric"&&r.mode!=="agent"&&r.mode!=="table"){const c=s.trim();if(!c){this.deactivate();return}const o=a.items.find(u=>u.id===a.activeTransactionItemId);if(o){const{authStore:u}=await Xt(async()=>{const{authStore:S}=await Promise.resolve().then(()=>hs);return{authStore:S}},void 0);let g;u.subscribe(S=>g=S)();const p=g.currentUser?.permissions||[];if(c.includes(".")||c.includes(",")){const S=parseFloat(c.replace(",","."));if(!isNaN(S)&&S>0){const m=parseFloat(o.unit_price);let w=null;if(S<m&&(w="order.change_price"),p.includes("all")||(w?p.includes(w):!0)){const B=parseFloat(o.quantity)>1;Ke.updateItemPrice(o.id,S,B),Ke.deselectItem()}else{n(A=>({...A,errorMessage:"Permission denied to change price."}));return}}}else{const S=parseInt(c);if(!isNaN(S)&&S>0){const m=parseFloat(o.quantity);let w=null;if(S<m&&(w="order.reduce_quantity"),p.includes("all")||(w?p.includes(w):!0))Ke.updateItemQuantity(o.id,S),Ke.deselectItem();else{n(A=>({...A,errorMessage:"Permission denied to reduce quantity."}));return}}}}n(u=>({...u,liveValue:u.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null})),this.deactivate();return}if(r.mode==="agent"){if(r.layout==="numeric"&&/^\d{4,6}$/.test(s)){const{authStore:o}=await Xt(async()=>{const{authStore:u}=await Promise.resolve().then(()=>hs);return{authStore:u}},void 0);try{if((await o.login(null,s)).success){const{agentStore:g}=await Xt(async()=>{const{agentStore:m}=await Promise.resolve().then(()=>Dn);return{agentStore:m}},void 0);let p;o.subscribe(m=>p=m)();const S=`✅ Erfolgreich angemeldet als ${p.currentUser.full_name}!

⏰ Überprüfe Systemzeit...
🔍 Prüfe ausstehende Transaktionen...

Bitte warten Sie einen Moment...`;g.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:S}),g.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`🤖 KI-Assistent bereit!

Verfügbare Tools:
• findProduct - Produkte suchen und finden
• createProduct - Neue Produkte erstellen
• updateProduct - Produktdaten aktualisieren
• getSalesReport - Verkaufsberichte abrufen
• generateDsfinvkExport - DSFinV-K konforme Datenexporte erstellen

Ich wähle automatisch das richtige Tool für Ihre Anfrage aus. Stellen Sie einfach Ihre Frage!`}),setTimeout(async()=>{await this.checkSystemStatus(p.currentUser,g)},1e3),n(m=>({...m,liveValue:m.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null})),this.deactivate();return}else{const{agentStore:g}=await Xt(async()=>{const{agentStore:p}=await Promise.resolve().then(()=>Dn);return{agentStore:p}},void 0);g.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`❌ Ungültige PIN-Eingabe!

Bitte überprüfen Sie Ihre PIN und versuchen Sie es erneut. Sie können eine 4-6 stellige PIN über das Tastenfeld eingeben.`}),n(p=>({...p,liveValue:p.layout==="alpha"?{text:"",cursor:0}:"",errorMessage:null}));return}}catch{console.log("Direct login failed, falling back to agent message")}}const{agentStore:c}=await Xt(async()=>{const{agentStore:o}=await Promise.resolve().then(()=>Dn);return{agentStore:o}},void 0);try{await c.sendMessage(s),n(o=>({...o,liveValue:o.layout==="alpha"?{text:"",cursor:0}:""}))}catch(o){console.error("Agent message send failed:",o),n(u=>({...u,liveValue:u.layout==="alpha"?{text:"",cursor:0}:""}))}return}if(!r.confirmCallback)return;const l=r.confirmCallback;try{await l(s),n(()=>({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:hn}))}catch(c){console.error("Pinpad confirm callback failed:",c),n(()=>({isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:hn}))}},cancel(r=null){n(s=>{const a=Date.now();if(a-s.lastRedClickTime<300){const c=s.cancelCallback;s.mode==="agent"&&Xt(async()=>{const{agentStore:u}=await Promise.resolve().then(()=>Dn);return{agentStore:u}},void 0).then(({agentStore:u})=>{u.cancelDraftMessage()});const o={isActive:!1,mode:null,layout:"numeric",liveValue:{text:"",cursor:0},confirmCallback:null,cancelCallback:null,lastRedClickTime:0,errorMessage:null,currentLanguage:"DE",layouts:hn};return c&&setTimeout(()=>c(),0),o}else return s.mode==="agent"&&r&&r.updateDraftMessage(""),{...s,liveValue:s.layout==="alpha"?{text:"",cursor:0}:"",lastRedClickTime:a,errorMessage:null}})},activateTableEntry(){ft.set("order"),this.activate("table",async r=>{if(r&&r.trim())try{const s=await Ke.assignTableNumber(r.trim());if(s&&s.tableInUse){n(a=>({...a,liveValue:a.layout==="alpha"?{text:"",cursor:0}:""}));return}return s}catch(s){throw s}},()=>{})},activateTableEntryWithAutoCollapse(){ft.set("order"),this.activate("table",async r=>{if(r&&r.trim())try{const s=await Ke.assignTableNumber(r.trim());if(s&&s.tableInUse){n(o=>({...o,liveValue:o.layout==="alpha"?{text:"",cursor:0}:""}));return}let a;Ke.subscribe(o=>a=o)();const l=a.items&&a.items.length>0,c=a.metadata&&a.metadata.table;return l&&c?(await Ke.parkCurrentOrder(c,1,!1),await Pn.refresh(),Ke.resetOrder(),window.dispatchEvent(new CustomEvent("autoCollapseComplete")),{autoCollapsed:!0}):s}catch(s){throw s}},()=>{})},activateAlphaInput(r,s,a=null){a&&a.startDraftMessage(),this.activate("agent",r,s,"alpha")},moveCursorLeft(){n(r=>{if(!r.isActive||r.layout!=="alpha")return r;const s=Math.max(0,r.liveValue.cursor-1);return{...r,liveValue:{...r.liveValue,cursor:s}}})},moveCursorRight(){n(r=>{if(!r.isActive||r.layout!=="alpha")return r;const s=Math.min(r.liveValue.text.length,r.liveValue.cursor+1);return{...r,liveValue:{...r.liveValue,cursor:s}}})},switchLanguage(r=null){n(s=>{const a=Object.keys(s.layouts);if(r&&a.includes(r))return{...s,currentLanguage:r};if(!s.isActive||s.layout!=="alpha"){const u=(a.indexOf(s.currentLanguage)+1)%a.length;return{...s,currentLanguage:a[u]}}const c=(a.indexOf(s.currentLanguage)+1)%a.length;return{...s,currentLanguage:a[c]}})},async checkSystemStatus(r,s){try{const{wsStore:a}=await Xt(async()=>{const{wsStore:u}=await Promise.resolve().then(()=>qi);return{wsStore:u}},void 0);let l=0,c=!0;try{const u=await a.send({command:"systemTimeCheck",payload:{clientTime:new Date().toISOString()}});u.status==="success"?(l=u.payload.timeDifferenceSeconds,c=Math.abs(l)<=30):c=!1}catch{c=!1}if(c){s.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`✅ Erfolgreich angemeldet als ${r.full_name}!`});return}let o=`🎉 Willkommen zurück, ${r.full_name}!

`;if(c||(l!==0?o+=`⚠️ Zeitabweichung erkannt: ${Math.abs(l)} Sekunden ${l>0?"voraus":"zurück"}
`:o+=`⚠️ Zeitprüfung fehlgeschlagen
`),r.permissions.includes("all")||r.permissions.includes("manage_transactions"))try{const u=await a.send({command:"getPendingTransactions",payload:{}});u.status==="success"&&u.payload.length>0?(o+=`
🔄 ${u.payload.length} ausstehende Transaktionen gefunden!

`,o+=`Als ${r.role} können Sie diese Transaktionen verwalten:
`,o+=`• Fiskalisieren (abschließen)
`,o+=`• Stornieren (rückgängig machen)
`,o+=`• Verschieben (später bearbeiten)

`,o+="Möchten Sie diese jetzt bearbeiten? Verwenden Sie die entsprechenden Schaltflächen oder fragen Sie mich nach Hilfe."):o+=`
✅ Keine ausstehenden Transaktionen
`}catch{o+=`
⚠️ Konnte ausstehende Transaktionen nicht überprüfen
`}else o+=`
📋 Ihre Rolle: ${r.role}
`,o+=`Sie haben Zugriff auf grundlegende Kassenfunktionen.
`;o+=`
🚀 System ist bereit! Sie können mit der Arbeit beginnen.`,s.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:o})}catch(a){s.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`❌ Systemprüfung fehlgeschlagen: ${a.message}

Sie können trotzdem mit der Arbeit beginnen, aber einige Funktionen sind möglicherweise eingeschränkt.`})}}}}const He=Yi();function Xi(){const e=parseInt(void 0)||160;return ia({MIN_BUTTON_WIDTH:e})}const la=Xi(),br={hasNotification:!1,style:null};function Qi(){const{subscribe:e,set:t,update:n}=mt(br);return{subscribe:e,setNotification:r=>{console.log("🟡 [NotificationStore] setNotification called with style:",r),n(s=>{console.log("🟡 [NotificationStore] Previous state:",s);const a={hasNotification:!0,style:r};return console.log("🟡 [NotificationStore] New state:",a),a})},clearNotification:()=>{console.log("🟠 [NotificationStore] clearNotification called"),console.log("🟠 [NotificationStore] Clearing notification, setting to initial state:",br),t(br)}}}const Sn=Qi();function Zi(){const{subscribe:e,set:t,update:n}=mt({history:[],messages:[{timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Willkommen bei ecKasse!

Eine Kasse, die hilft – nicht kostet.

👥 Verfügbare Benutzer:
• Admin (Vollzugriff)
• Kassier (Kassenfunktionen)
• Aushilfe (Grundfunktionen)

⏰ Überprüfe Systemzeit und ausstehende Transaktionen...

💡 Geben Sie einfach Ihre 4-6 stellige PIN ein - das System erkennt Sie automatisch. Bei neuer oder Testkasse: Admin-PIN ist 1234`}],draftMessage:null,shouldActivatePinpad:!0});return ce.subscribe(r=>{if(r.lastMessage&&r.lastMessage.command==="firstRunAdminCreated"){const s=r.lastMessage.payload;n(a=>({...a,messages:[{timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:s.message||`Willkommen! Admin-Benutzer '${s.username}' wurde erstellt mit PIN: ${s.password}`}]}))}if(r.lastMessage&&r.lastMessage.command==="getEntityJsonResponse"){const s=r.lastMessage.payload;if(s.success&&s.entity){const a=JSON.stringify(s.entity,null,2);n(l=>({...l,messages:[...l.messages,{timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"system",message:`JSON for viewing ${s.entityType} ID ${s.entityId}. For editing, use AI commands like 'update price to 29.99' or 'change name to Super Widget Pro':
\`\`\`json
${a}
\`\`\``}]}))}}}),{subscribe:e,addMessage:r=>{console.log("🔔 [AgentStore] addMessage called:",{timestamp:r.timestamp,type:r.type,message:r.message?.substring(0,100)+(r.message?.length>100?"...":""),style:r.style,hasStyle:!!r.style}),n(s=>({...s,messages:[...s.messages,r]})),r.style?(console.log("🟢 [AgentStore] Message has style, triggering notification:",r.style),Sn.setNotification(r.style)):console.log("🔴 [AgentStore] Message has NO style, no notification triggered")},setHistory:r=>{n(s=>({...s,history:r}))},getHistory:()=>{let r;return e(s=>r=s.history)(),r},clearMessages:()=>{n(r=>({...r,messages:[]}))},startDraftMessage:()=>{n(r=>({...r,draftMessage:{id:"draft-"+Date.now(),timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"user",message:"",isDraft:!0}}))},updateDraftMessage:r=>{n(s=>({...s,draftMessage:s.draftMessage?{...s.draftMessage,message:r}:null}))},finalizeDraftMessage:()=>{n(r=>{if(!r.draftMessage)return r;const s={...r.draftMessage,isDraft:!1};return{...r,messages:[...r.messages,s],draftMessage:null}})},cancelDraftMessage:()=>{n(r=>({...r,draftMessage:null}))},sendMessage:async r=>{if(!(!r||!r.trim()))try{const a=On(un).sessionId,l={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"user",message:r};let c;e(p=>c=p)(),n(p=>({...p,messages:[...p.messages,l],draftMessage:null}));const o=await fetch("/api/llm/ping-gemini",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:r,history:c.history,sessionId:a})});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const u=await o.json(),g={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:u.gemini_response_text};n(p=>({...p,messages:[...p.messages,g],history:u.history}))}catch(s){console.error("Failed to send message to AI:",s);const a={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"Sorry, I encountered an error. Please try again."};n(l=>({...l,messages:[...l.messages,a]}))}},shouldActivatePinpadOnLoad(){let r=!1;return n(s=>(r=s.shouldActivatePinpad,{...s,shouldActivatePinpad:!1})),r}}}const fe=Zi(),Dn=Object.freeze(Object.defineProperty({__proto__:null,agentStore:fe},Symbol.toStringTag,{value:"Module"})),eo=()=>typeof localStorage<"u"&&localStorage.getItem("app-locale")||"de-DE",En=mt(eo());En.subscribe(e=>{typeof localStorage<"u"&&localStorage.setItem("app-locale",e)});const to=e=>{En.set(e)},yt=(e,t="EUR")=>{const n=On(En);return e==null||isNaN(e)?new Intl.NumberFormat(n,{style:"currency",currency:t}).format(0):new Intl.NumberFormat(n,{style:"currency",currency:t}).format(e)},no=(e,t={})=>{const n=On(En);if(!e)return"";const r=typeof e=="string"?new Date(e):e;if(isNaN(r.getTime()))return"";const s={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",...t};return new Intl.DateTimeFormat(n,s).format(r)};var ro=U('<div class="loading svelte-1dtcyze">Loading receipts...</div>'),so=U('<div class="error svelte-1dtcyze"> </div>'),ao=U('<div class="empty svelte-1dtcyze">No receipts found.</div>'),io=U('<span class="receipt-table-large svelte-1dtcyze"> </span>'),oo=U('<div><span class="item-qty svelte-1dtcyze"> </span> <span> </span> <span> </span></div>'),lo=U('<div class="receipt-details svelte-1dtcyze"><div class="items-list svelte-1dtcyze"></div> <div class="receipt-totals svelte-1dtcyze"><div class="total-row svelte-1dtcyze"><span>Tax:</span> <span class="price svelte-1dtcyze"> </span></div> <div class="total-row total svelte-1dtcyze"><span>Total:</span> <span class="price svelte-1dtcyze"> </span></div></div> <div class="receipt-actions svelte-1dtcyze"><button class="action-button svelte-1dtcyze">🖨️ Reprint</button></div></div>'),co=U('<div><button class="receipt-summary svelte-1dtcyze"><div class="receipt-left svelte-1dtcyze"><div class="receipt-main-line svelte-1dtcyze"><span class="receipt-id-large svelte-1dtcyze"> </span> <!></div> <div class="receipt-date svelte-1dtcyze"> </div> <div class="receipt-payment svelte-1dtcyze"> </div></div> <div class="receipt-right svelte-1dtcyze"><div class="receipt-price svelte-1dtcyze"><span class="price svelte-1dtcyze"> </span></div> <div class="receipt-meta svelte-1dtcyze"><div class="receipt-items-count svelte-1dtcyze"> </div></div></div> <div class="expand-icon svelte-1dtcyze"> </div></button> <!></div>'),uo=U('<div class="receipt-list svelte-1dtcyze"></div>'),fo=U('<div class="receipt-feed svelte-1dtcyze"><!></div>');function vo(e,t){vt(t,!1);const[n,r]=Hn(),s=()=>Ze(ir,"$receiptsStore",n);let a=Ie(t,"autoExpandLatest",8,!1),l=V(null),c=V(!1),o=V();Wt(()=>{ir.loadReceipts()});function u(v){_(c,!0),_(l,i(l)===v?null:v)}function g(v){return no(v)}function p(v){return v.notes==="STORNO"&&v.display_names&&v.display_names.menu&&v.display_names.menu.de?`STORNO: ${v.display_names.menu.de}`:v.notes==="DISCOUNT"?"DISCOUNT":v.notes==="SURCHARGE"?"SURCHARGE":v.display_names&&v.display_names.menu&&v.display_names.menu.de?v.display_names.menu.de:"Unnamed Item"}function S(v){return v.notes==="STORNO"||v.notes==="DISCOUNT"||v.notes==="SURCHARGE"}function m(v){if(v.notes==="DISCOUNT"||v.notes==="SURCHARGE")return"";const N=parseFloat(v.quantity);return N===1?"":N+"x"}async function w(v){G("INFO",`Reprint requested for receipt №${v.id}`),fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Reprint initiated for receipt №${v.id}`,style:"info"}),ce.send("reprintReceipt",{transactionId:v.id})}De(()=>ue(a()),()=>{a()&&_(c,!1)}),De(()=>(ue(a()),i(c),s(),i(l)),()=>{if(a()&&!i(c)&&s().receipts.length>0){const N=s().receipts.sort((x,h)=>new Date(h.fiscal_timestamp||h.updated_at)-new Date(x.fiscal_timestamp||x.updated_at))[0]?.id;N&&i(l)!==N&&_(l,N)}}),nn(),wt();var k=fo(),A=d(k);{var B=v=>{var N=ro();C(v,N)},q=v=>{var N=qe(),x=Ce(N);{var h=E=>{var W=so(),D=d(W);te(()=>ee(D,`Error: ${s(),P(()=>s().error)??""}`)),C(E,W)},f=E=>{var W=qe(),D=Ce(W);{var H=I=>{var K=ao();C(I,K)},R=I=>{var K=uo();At(K,5,()=>(s(),P(()=>s().receipts.sort((F,L)=>new Date(F.fiscal_timestamp||F.updated_at)-new Date(L.fiscal_timestamp||L.updated_at)))),F=>F.id,(F,L)=>{var Se=co();let xe;var de=d(Se),oe=d(de),$=d(oe),T=d($),j=d(T),Q=y(T,2);{var Y=O=>{var M=io(),ne=d(M);te(()=>ee(ne,`#${i(L),P(()=>i(L).metadata.table)??""}`)),C(O,M)};J(Q,O=>{i(L),P(()=>i(L).metadata?.table)&&O(Y)})}var Z=y($,2),re=d(Z),ae=y(Z,2),ie=d(ae),le=y(oe,2),se=d(le),be=d(se),_e=d(be),Ee=y(se,2),$e=d(Ee),Le=d($e),Me=y(le,2),me=d(Me),ge=y(de,2);{var he=O=>{var M=lo(),ne=d(M);At(ne,5,()=>(i(L),P(()=>i(L).items)),Ge=>Ge.id,(Ge,Ae)=>{var Be=oo();let Ve;var dt=d(Be),ht=d(dt),Ft=y(dt,2);let Oe;var We=d(Ft),at=y(Ft,2);let Je;var Ue=d(at);te((jt,Ot,Kt,Tt,b,z)=>{Ve=Ye(Be,1,"item-row svelte-1dtcyze",null,Ve,jt),ee(ht,Ot),Oe=Ye(Ft,1,"item-name svelte-1dtcyze",null,Oe,Kt),ee(We,Tt),Je=Ye(at,1,"item-price svelte-1dtcyze",null,Je,b),ee(Ue,z)},[()=>({"modification-item":S(i(Ae))}),()=>(i(Ae),P(()=>m(i(Ae)))),()=>({"modification-name":S(i(Ae))}),()=>(i(Ae),P(()=>p(i(Ae)))),()=>({"negative-price":parseFloat(i(Ae).total_price)<0}),()=>(ue(yt),i(Ae),P(()=>yt(i(Ae).total_price)))]),C(Ge,Be)});var ve=y(ne,2),je=d(ve),gt=y(d(je),2),tt=d(gt),ct=y(je,2),ze=y(d(ct),2),rt=d(ze),st=y(ve,2),ut=d(st);te((Ge,Ae)=>{ee(tt,Ge),ee(rt,Ae)},[()=>(ue(yt),i(L),P(()=>yt(i(L).tax_amount))),()=>(ue(yt),i(L),P(()=>yt(i(L).total_amount)))]),X("click",ut,()=>w(i(L))),C(O,M)};J(ge,O=>{i(l),i(L),P(()=>i(l)===i(L).id)&&O(he)})}te((O,M,ne)=>{xe=Ye(Se,1,"receipt-item svelte-1dtcyze",null,xe,O),ee(j,`№${i(L),P(()=>i(L).id)??""}`),ee(re,M),ee(ie,(i(L),P(()=>i(L).payment_type||"Unknown"))),ee(_e,ne),ee(Le,`${i(L),P(()=>i(L).items?.length||0)??""} items`),ee(me,(i(l),i(L),P(()=>i(l)===i(L).id?"▼":"▶")))},[()=>({expanded:i(l)===i(L).id}),()=>(i(L),P(()=>g(i(L).fiscal_timestamp||i(L).updated_at))),()=>(ue(yt),i(L),P(()=>yt(i(L).total_amount)))]),X("click",de,()=>u(i(L).id)),C(F,Se)}),en(K,F=>_(o,F),()=>i(o)),C(I,K)};J(D,I=>{s(),P(()=>s().receipts.length===0)?I(H):I(R,!1)},!0)}C(E,W)};J(x,E=>{s(),P(()=>s().error)?E(h):E(f,!1)},!0)}C(v,N)};J(A,v=>{s(),P(()=>s().loading)?v(B):v(q,!1)})}C(e,k),pt(),r()}var po=U('<button class="order-item svelte-1gswy6n"><div class="table-number svelte-1gswy6n"> </div> <div class="order-stats svelte-1gswy6n"><div class="stat-price svelte-1gswy6n"> </div> <div class="stat-open svelte-1gswy6n"> </div> <div class="stat-activity svelte-1gswy6n"> </div></div></button>'),mo=U('<div class="parked-orders-container svelte-1gswy6n"><div class="orders-list svelte-1gswy6n"></div></div>');function go(e,t){vt(t,!1);let n=V([]),r,s,a=!1;Wt(async()=>{r=Pn.subscribe(m=>{_(n,m)}),s=ce.subscribe(async m=>{m.connected&&!a&&(a=!0,await Pn.refreshParkedOrders())})}),Yr(()=>{r&&r(),s&&s()});async function l(m){try{let w;if(Ke.subscribe(A=>w=A)(),w.transactionId&&w.status==="active"){const A=w.items&&w.items.length>0,B=w.metadata&&w.metadata.table;if(A&&B)await Ke.parkCurrentOrder(B,1,!1),await Pn.refreshParkedOrders();else if(A&&!B){ft.set("order"),He.activateTableEntry();return}else Ke.resetOrder()}const k=await Pn.activateOrder(m.id,!1);Ke.loadOrder(k)}catch(w){console.error("Failed to switch to order:",w)}}function c(m){const k=(m.metadata||{}).table||m.id.toString();return k.length>3?`#${k.substring(0,3)}`:`#${k}`}function o(m){return zn.formatTimeElapsed(m)}function u(m){const w=o(m.created_at),k=o(m.updated_at);return{price:yt(m.total_amount),openMinutes:w,activityMinutes:k}}wt();var g=qe(),p=Ce(g);{var S=m=>{var w=mo(),k=d(w);At(k,5,()=>i(n),A=>A.id,(A,B)=>{var q=po(),v=d(q),N=d(v),x=y(v,2),h=d(x),f=d(h),E=y(h,2),W=d(E),D=y(E,2),H=d(D);te((R,I,K,F)=>{ee(N,R),ee(f,I),ee(W,`${K??""}min`),ee(H,`${F??""}min`)},[()=>c(i(B)),()=>u(i(B)).price,()=>u(i(B)).openMinutes,()=>u(i(B)).activityMinutes]),X("click",q,()=>l(i(B))),C(A,q)}),C(m,w)};J(p,m=>{i(n).length>0&&m(S)})}C(e,g),pt()}var ho=Wr(`<svg viewBox="0 0 100 100" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: 100%;"><defs><filter height="150%" id="sh0" width="150%" x="-0.25" y="-0.25"><feConvolveMatrix id="3_|_y" in="SourceAlpha" result="19y" order="1,17" divisor="6632" bias="0" preserveAlpha="false" kernelMatrix=" 10 30 77 169 320 527 752 931 1000 931 752 527 320 169 77 30 10"></feConvolveMatrix><feConvolveMatrix id="3_|_x" result="19x" order="17,1" divisor="6632" bias="0" preserveAlpha="false" kernelMatrix=" 10 30 77 169 320 527 752 931 1000 931 752 527 320 169 77 30 10"></feConvolveMatrix><feConvolveMatrix id="9_|_y" in="SourceAlpha" result="49y" order="1,47" divisor="19856" bias="0" preserveAlpha="false" kernelMatrix=" 15 21 30 42 57 77 101 132 169 212 263 320 384 453 527 603 678 752 820 881 931 968 992 1000 992 968 931 881 820 752 678 603 527 453 384 320 263 212 169 132 101 77 57 42 30 21 15"></feConvolveMatrix><feConvolveMatrix id="9_|_x" result="49x" order="47,1" divisor="19856" bias="0" preserveAlpha="false" kernelMatrix=" 15 21 30 42 57 77 101 132 169 212 263 320 384 453 527 603 678 752 820 881 931 968 992 1000 992 968 931 881 820 752 678 603 527 453 384 320 263 212 169 132 101 77 57 42 30 21 15"></feConvolveMatrix><feTurbulence class="seed" result="noise" type="fractalNoise" stitchTiles="stitch" seed="43" baseFrequency="0.06 0.08 " numOctaves="3"></feTurbulence><feMorphology operator="erode" radius="1.2"></feMorphology><feComposite in="noise" operator="arithmetic" k1="0" k2="8" k3="0" k4="-3"></feComposite><feComposite in="49x" result="49noise" operator="arithmetic" k1="0" k2="2" k3="-0.2" k4="-1"></feComposite><feComposite in="49noise" in2="19x" operator="arithmetic" k1="0" k2="0.5" k3="1.5" k4="-1"></feComposite><feDiffuseLighting surfaceScale="2" lighting-color="#fff"><feDistantLight azimuth="240" elevation="20"></feDistantLight></feDiffuseLighting><feComposite in2="SourceGraphic" operator="arithmetic" k1="1" k2="0" k3="0" k4="0"></feComposite></filter><filter height="170%" id="sh2" width="170%" x="-0.2" y="-0.2"><feOffset dx="0" dy="0" in="SourceAlpha"></feOffset><feGaussianBlur stdDeviation="1.2"></feGaussianBlur><feColorMatrix result="out" type="matrix" values=" 
               0 0 0 0 0.4         
               0 0 0 0 0.4                    
               0 0 0 0 0.4                
               0 0 0 10 0 "></feColorMatrix><feMerge><feMergeNode in="out"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter><filter height="130%" id="sh1" width="130%" x="-0.2" y="-0.2"><feOffset dx="3" dy="4" in="SourceAlpha"></feOffset><feGaussianBlur stdDeviation="3"></feGaussianBlur><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.8 0"></feColorMatrix><feBlend in="SourceGraphic"></feBlend></filter><linearGradient id="svg_66" x1="0" x2="1" y1="0" y2="0"><stop offset="0" stop-color="hsl(40, 23%, 35%)"></stop><stop offset="0.4" stop-color="hsl(40, 23%, 60%)"></stop><stop offset="0.65" stop-color="hsl(40, 23%, 70%)"></stop><stop offset="0.75" stop-color="hsl(40, 23%, 60%)"></stop><stop offset="1" stop-color="hsl(40, 23%, 35%)"></stop></linearGradient><circle id="bell" fill="#070" stroke="#030" r="5.5" filter="url(#sh0)"></circle><g id="cap" filter="url(#sh2)"><path id="capPath" fill="#070" filter="url(#sh0)" stroke="#030" d="M72,89 C78.6,68 67.2,30.7 89,68 C86.9,37.6 66.91,32 62,61 C58,44.1 67.5,38.8 52,10 C53.6,47 46.91,36.2 45,61 C39.3,43.4 22,46.6 13,43 C32.9,55.8 35.7,66.62 32,89 C35,97.9 68.6,99 72,89 Z"></path><use id="bell1" x="13" y="43" href="#bell"></use><use id="bell2" x="52" y="10" href="#bell"></use><use id="bell3" x="89" y="68" href="#bell"></use><ellipse cx="52.19" cy="90.01" fill="url(#svg_66)" rx="14.76" ry="3.56"></ellipse><path d="M34,86.5C36,82,53.5,81,60,83C54,81,34,81.5,34,86.5Z" fill="none" stroke="hsl(40, 23%, 60%)"></path></g></defs><use href="#cap"></use></svg>`);function _o(e){var t=ho();C(e,t)}var yo=U('<div class="slot-container svelte-12whdgj"><!></div>'),bo=U('<div class="button-icon-wrapper svelte-12whdgj"><span class="button-icon svelte-12whdgj"><!></span></div>'),wo=U("<div></div>"),So=U("<!> <!>",1),xo=U('<span class="button-text svelte-12whdgj"><!></span>'),ko=U('<button><div class="button-shape svelte-12whdgj"><!></div></button>');function ca(e,t){const n=bi(t);vt(t,!1);const r=V(),s=V(),a=V();let l=Ie(t,"label",8,""),c=Ie(t,"icon",8,""),o=Ie(t,"color",8,"#666666"),u=Ie(t,"textColor",8,""),g=Ie(t,"backgroundStyle",8,""),p=Ie(t,"customStyle",8,""),S=Ie(t,"disabled",8,!1),m=Ie(t,"data",8,null),w=Ie(t,"width",8,120),k=Ie(t,"height",8,80),A=Ie(t,"shape",8,"rect"),B=Ie(t,"side",8,""),q=Ie(t,"active",8,!1),v=Ie(t,"showShape",8,""),N=Ie(t,"notificationStyle",8,null);const x=pn();let h,f=!1;function E(){!S()&&!f&&x("click",{data:m(),label:l()})}function W(de){S()||(de.preventDefault(),x("secondaryaction",{data:m(),label:l(),mouseX:de.clientX,mouseY:de.clientY,originalEvent:de}))}function D(de){!S()&&de.button===0&&(f=!1,h=setTimeout(()=>{f=!0,x("secondaryaction",{data:m(),label:l(),mouseX:de.clientX,mouseY:de.clientY,originalEvent:de})},500))}function H(){clearTimeout(h),setTimeout(()=>{f=!1},10)}function R(){clearTimeout(h),f=!1}De(()=>ue(B()),()=>{_(r,B()==="left"||B()==="right")}),De(()=>ue(l()),()=>{_(s,l())}),De(()=>(ue(A()),i(r),ue(B())),()=>{_(a,A()==="hex"&&i(r)?B()==="left"?"polygon(0% 0%, 100% 25%, 100% 75%, 0% 100%)":"polygon(0% 25%, 100% 0%, 100% 100%, 0% 75%)":A()==="hex"?"polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)":"none")}),nn(),wt();var I=ko();let K;var F=d(I),L=d(F);{var Se=de=>{var oe=yo(),$=d(oe);yi($,t,"default",{}),C(de,oe)},xe=de=>{var oe=qe(),$=Ce(oe);{var T=Q=>{var Y=So(),Z=Ce(Y);{var re=le=>{var se=bo(),be=d(se),_e=d(be);cs(_e,c),C(le,se)};J(Z,le=>{c()&&le(re)})}var ae=y(Z,2);{var ie=le=>{var se=wo();te(()=>Ye(se,1,`shape-overlay ${v()??""}`,"svelte-12whdgj")),C(le,se)};J(ae,le=>{v()&&le(ie)})}C(Q,Y)},j=Q=>{var Y=qe(),Z=Ce(Y);{var re=ae=>{var ie=xo(),le=d(ie);cs(le,()=>i(s)),te(()=>cn(ie,p())),C(ae,ie)};J(Z,ae=>{l()&&ae(re)},!0)}C(Q,Y)};J($,Q=>{c()||v()?Q(T):Q(j,!1)},!0)}C(de,oe)};J(L,de=>{P(()=>n.default)?de(Se):de(xe,!1)})}te(de=>{K=Ye(I,1,`universal-button ${A()??""}`,"svelte-12whdgj",K,de),cn(I,`
    --button-width: ${w()??""}px; 
    --button-height: ${k()??""}px; 
    --button-color: ${o()??""};
    ${u()?`--button-text-color: ${u()};`:""}
    ${g()?`--button-background-style: ${g()};`:""}
    --clip-path: ${i(a)??""};
  `)},[()=>({disabled:S(),half:i(r),left:B()==="left",right:B()==="right",active:q(),notification:!!N(),error:N()==="error",warning:N()==="warning",success:N()==="success",print:N()?.startsWith("print")})]),X("click",I,E),X("contextmenu",I,W),X("mousedown",I,D),X("mouseup",I,H),X("mouseleave",I,R),C(e,I),pt()}var To=U('<span class="table-number svelte-x88uh0"> </span>'),Co=U('<div class="pinpad-error-message svelte-x88uh0"> </div>'),Eo=U('<span class="qty svelte-x88uh0"> </span>'),Io=U('<span class="input-overlay svelte-x88uh0"> </span>'),Mo=U('<li><!> <div class="name-container svelte-x88uh0"><span> </span> <!></div> <span class="price svelte-x88uh0"> </span></li>'),Ao=U('<div class="view-content order-view svelte-x88uh0"><div class="orders-stack svelte-x88uh0"><div class="parked-orders-section svelte-x88uh0"><!></div> <div class="active-order-section svelte-x88uh0"><div class="order-content svelte-x88uh0"><h2 class="svelte-x88uh0"><span class="order-number svelte-x88uh0"> </span><!></h2> <!> <div class="scrollable-items-content svelte-x88uh0"><ul class="item-list svelte-x88uh0"></ul></div> <div class="spacer svelte-x88uh0"></div> <div class="total svelte-x88uh0"><span class="svelte-x88uh0">Total:</span> <span class="price svelte-x88uh0"> </span></div></div></div></div></div>'),Oo=U('<div class="view-content receipts-view svelte-x88uh0"><div class="receipts-stack svelte-x88uh0"><!></div></div>'),No=U('<div class="agent-header-icon svelte-x88uh0"><!></div>'),Ro=U('<div class="message-actions svelte-x88uh0"></div>'),$o=U('<div><div class="message-header svelte-x88uh0"><span class="message-timestamp svelte-x88uh0"> </span> <span class="message-type svelte-x88uh0"> </span></div> <div class="message-content svelte-x88uh0"> </div> <!></div>'),Po=U(' <span class="cursor svelte-x88uh0">|</span>',1),Do=U(' <span class="cursor svelte-x88uh0">|</span>',1),Lo=U('<span class="cursor svelte-x88uh0">|</span>'),Bo=U('<div class="agent-message user draft svelte-x88uh0"><div class="message-header svelte-x88uh0"><span class="message-timestamp svelte-x88uh0"> </span> <span class="message-type svelte-x88uh0">User</span></div> <div class="message-content svelte-x88uh0"><!></div></div>'),Uo=U('<div class="view-content agent-view svelte-x88uh0"><!> <div class="scroll-content svelte-x88uh0"><div class="agent-messages svelte-x88uh0"><!> <!></div></div></div>'),Fo=U('<div class="console-view svelte-x88uh0"><div class="content-area svelte-x88uh0"><!></div></div>');function jo(e,t){vt(t,!1);const[n,r]=Hn(),s=()=>Ze(Ke,"$orderStore",n),a=()=>Ze(ft,"$currentView",n),l=()=>Ze(ir,"$receiptsStore",n),c=()=>Ze(fe,"$agentStore",n),o=()=>Ze(He,"$pinpadStore",n),u=()=>Ze(la,"$uiConstantsStore",n),g=pn();let p=V(),S=V(),m=V(),w=!1,k=V(!1),A=!1,B=V(!1),q=V("order"),v=V(!1),N=V(s().status),x=V(s().items.length),h=V(s().transactionId),f=V(s().metadata?.table),E=V(a());Wt(()=>{setTimeout(()=>{if(A||(I(),R(),A=!0),a()==="agent"&&fe.shouldActivatePinpadOnLoad()&&He.activate("agent",()=>{},()=>{},"numeric"),i(p)){const T=new ResizeObserver(()=>{i(p)&&_(B,i(p).scrollHeight>i(p).clientHeight)});return T.observe(i(p)),_(B,i(p).scrollHeight>i(p).clientHeight),()=>{T.disconnect()}}},200)}),Pi(()=>{if(!i(k)){let T=null;a()==="order"?T=i(S):a()==="agent"?T=i(p):a()==="receipts"&&(T=i(m)),T&&setTimeout(()=>{if(T&&!i(k)){if(R(),a()==="agent"&&i(p)){const j=i(p).scrollHeight>i(p).clientHeight;j!==i(B)&&_(B,j)}w||(_(k,!0),T.scrollTop=T.scrollHeight,setTimeout(()=>{_(k,!1),R()},100))}},50)}});function W(T){if(typeof T=="object"&&T!==null)return T;if(typeof T=="string")try{return JSON.parse(T)}catch{return T}return T}function D(){const j={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"Select language / Sprache auswählen / Выберите язык:",actions:[{id:"lang-de",label:"DE",action:"selectLanguage",param:"DE"},{id:"lang-en",label:"EN",action:"selectLanguage",param:"EN"},{id:"lang-ru",label:"RU",action:"selectLanguage",param:"RU"}]};fe.addMessage(j),setTimeout(()=>{i(p)&&(Fe(p,i(p).scrollTop=i(p).scrollHeight),R())},100)}function H(T,j){if(T==="selectLanguage"){He.switchLanguage(j);const Q=c().messages.filter(re=>!re.actions);fe.clearMessages(),Q.forEach(re=>fe.addMessage(re));const Z={timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Language changed to ${j}`};fe.addMessage(Z),setTimeout(()=>{i(p)&&(Fe(p,i(p).scrollTop=i(p).scrollHeight),R())},100)}}function R(){if(!i(k)){let T=null;if(a()==="order"?T=i(S):a()==="agent"?T=i(p):a()==="receipts"&&(T=i(m)),T){const Q=T.scrollTop,Y=T.clientHeight,Z=T.scrollHeight;w=Q+Y>=Z-1}else w=!0;g("scrollstate",w)}}function I(){let T=null;a()==="order"?T=i(S):a()==="agent"?T=i(p):a()==="receipts"&&(T=i(m)),T&&(T.scrollTop=T.scrollHeight,w=!0)}function K(){if(On(Sn).hasNotification){ft.set("agent");return}let j;switch(i(q)){case"order":j=["order","receipts","agent"];break;case"receipts":j=["receipts","order","agent"];break;case"agent":j=["agent","order","receipts"];break;default:j=["order","receipts","agent"]}const Y=(j.indexOf(a())+1)%j.length,Z=j[Y];a()==="receipts"&&Z!=="receipts"&&_(v,!1),ft.set(Z)}function F(){return w}Wt(()=>{const T=ce.subscribe(j=>{if(j.lastMessage?.command==="menu-import-progress"){const Q=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});fe.addMessage({timestamp:Q,type:"agent",message:j.lastMessage.payload.message}),setTimeout(()=>{i(p)&&a()==="agent"&&(Fe(p,i(p).scrollTop=i(p).scrollHeight),R())},100)}});return()=>{T()}}),typeof window<"u"&&window.electronAPI&&window.electronAPI.onImportComplete&&window.electronAPI.onImportComplete((T,j)=>{const Q=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});fe.addMessage({timestamp:Q,type:"agent",message:j}),T&&(G("INFO","Refreshing categories after successful menu import"),ce.send({command:"getCategories"}),setTimeout(()=>{const Y=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});fe.addMessage({timestamp:Y,type:"agent",message:"Menu import completed successfully! Your new menu structure is now ready for use. You can navigate back to the selection area to explore the imported categories and products."}),setTimeout(()=>{i(p)&&a()==="agent"&&(Fe(p,i(p).scrollTop=i(p).scrollHeight),R())},100)},1e3)),setTimeout(()=>{i(p)&&a()==="agent"&&(Fe(p,i(p).scrollTop=i(p).scrollHeight),R())},100)}),De(()=>(a(),i(E),Sn),()=>{a()==="agent"&&i(E)!=="agent"?(console.log("🔵 [ConsoleView] User switched TO agent view, will clear notification in 100ms"),console.log("🔵 [ConsoleView] Previous view:",i(E),"Current view:",a()),setTimeout(()=>{console.log("🔵 [ConsoleView] Clearing notification now"),Sn.clearNotification()},100)):a()==="agent"&&i(E)==="agent"?console.log("🔵 [ConsoleView] Already in agent view, NOT clearing notification"):a()!=="agent"&&console.log("🔵 [ConsoleView] Not in agent view, NOT clearing notification. Current view:",a()),_(E,a())}),De(()=>(i(N),s(),i(m)),()=>{i(N)==="finished"&&s().status==="idle"&&(_(q,"receipts"),_(v,!0),ft.set("receipts"),ir.refresh(),setTimeout(()=>{i(m)&&(Fe(m,i(m).scrollTop=i(m).scrollHeight),R())},300)),_(N,s().status)}),De(()=>(l(),i(m),a()),()=>{l().receipts&&i(m)&&a()==="receipts"&&setTimeout(()=>{R()},100)}),De(()=>(c(),i(p),a(),i(B)),()=>{c().messages&&i(p)&&a()==="agent"&&setTimeout(()=>{if(i(p)){const T=i(p).scrollHeight>i(p).clientHeight;T!==i(B)&&_(B,T)}},100)}),De(()=>(a(),i(S),s(),i(x),i(h),i(f)),()=>{if(a()==="order"&&i(S)){const T=s().items.length,j=s().transactionId,Q=s().metadata?.table;(T!==i(x)||j!==i(h)||Q!==i(f))&&setTimeout(()=>{i(S)&&Fe(S,i(S).scrollTop=i(S).scrollHeight)},100),_(x,T),_(h,j),_(f,Q)}}),nn(),wt();var L=Fo(),Se=d(L),xe=d(Se);{var de=T=>{var j=Ao(),Q=d(j),Y=d(Q),Z=d(Y);go(Z,{});var re=y(Y,2),ae=d(re),ie=d(ae),le=d(ie),se=d(le),be=y(le);{var _e=O=>{var M=To(),ne=d(M);te(()=>ee(ne,`#${o(),s(),P(()=>o().isActive&&o().mode==="table"?o().liveValue:s().metadata?.table)??""}`)),C(O,M)};J(be,O=>{s(),o(),P(()=>s().metadata?.table||o().isActive&&o().mode==="table")&&O(_e)})}var Ee=y(ie,2);{var $e=O=>{var M=Co(),ne=d(M);te(()=>ee(ne,(o(),P(()=>o().errorMessage)))),C(O,M)};J(Ee,O=>{o(),P(()=>o().errorMessage)&&O($e)})}var Le=y(Ee,2),Me=d(Le);At(Me,5,()=>(s(),P(()=>s().items)),O=>O.id,(O,M)=>{var ne=Mo();let ve;var je=d(ne);{var gt=Be=>{var Ve=Eo(),dt=d(Ve);te(ht=>ee(dt,`${ht??""}x`),[()=>(i(M),P(()=>parseFloat(i(M).quantity)))]),C(Be,Ve)};J(je,Be=>{i(M),P(()=>parseFloat(i(M).quantity)>1)&&Be(gt)})}var tt=y(je,2),ct=d(tt);let ze;var rt=d(ct),st=y(ct,2);{var ut=Be=>{var Ve=Io(),dt=d(Ve);te(()=>ee(dt,(o(),P(()=>o().liveValue)))),C(Be,Ve)};J(st,Be=>{s(),i(M),o(),P(()=>s().activeTransactionItemId===i(M).id&&o().isActive&&o().mode!=="agent"&&o().liveValue)&&Be(ut)})}var Ge=y(tt,2),Ae=d(Ge);te((Be,Ve,dt,ht)=>{ve=Ye(ne,1,"svelte-x88uh0",null,ve,Be),ze=Ye(ct,1,"name svelte-x88uh0",null,ze,Ve),ee(rt,dt),ee(Ae,ht)},[()=>({active:s().activeTransactionItemId===i(M).id}),()=>({"input-mode":s().activeTransactionItemId===i(M).id&&o().isActive&&o().mode!=="agent"&&o().liveValue}),()=>(i(M),P(()=>i(M).display_names?W(i(M).display_names).menu.de||"N/A":"Loading...")),()=>(ue(yt),i(M),P(()=>yt(parseFloat(i(M).total_price))))]),C(O,ne)});var me=y(Le,4),ge=y(d(me),2),he=d(ge);en(Q,O=>_(S,O),()=>i(S)),te(O=>{ee(se,`Order №${s(),P(()=>s().transactionId||"...")??""}`),ee(he,O)},[()=>(ue(yt),s(),P(()=>yt(s().total)))]),X("scroll",Q,()=>!i(k)&&R()),C(T,j)},oe=T=>{var j=qe(),Q=Ce(j);{var Y=re=>{var ae=Oo(),ie=d(ae),le=d(ie);vo(le,{get autoExpandLatest(){return i(v)}}),en(ie,se=>_(m,se),()=>i(m)),X("scroll",ie,()=>!i(k)&&R()),C(re,ae)},Z=re=>{var ae=qe(),ie=Ce(ae);{var le=se=>{var be=Uo(),_e=d(be);{var Ee=he=>{var O=No(),M=d(O);_o(M),C(he,O)};J(_e,he=>{i(B)||he(Ee)})}var $e=y(_e,2),Le=d($e),Me=d(Le);At(Me,1,()=>(c(),P(()=>c().messages)),ar,(he,O)=>{var M=$o();let ne;var ve=d(M),je=d(ve),gt=d(je),tt=y(je,2),ct=d(tt),ze=y(ve,2),rt=d(ze),st=y(ze,2);{var ut=Ge=>{var Ae=Ro();At(Ae,5,()=>(i(O),P(()=>i(O).actions)),ar,(Be,Ve)=>{{let dt=Rt(()=>(i(Ve),P(()=>({display:i(Ve).label,action:()=>H(i(Ve).action,i(Ve).param)})))),ht=Rt(()=>(u(),P(()=>({width:u().MIN_BUTTON_WIDTH,height:Math.round(u().MIN_BUTTON_WIDTH*.4)}))));ca(Be,{get content(){return i(dt)},get size(){return i(ht)},style:"rectangular"})}}),C(Ge,Ae)};J(st,Ge=>{i(O),P(()=>i(O).actions)&&Ge(ut)})}te(Ge=>{ne=Ye(M,1,"agent-message svelte-x88uh0",null,ne,Ge),ee(gt,(i(O),P(()=>i(O).timestamp))),ee(ct,(i(O),P(()=>i(O).type==="user"?"User":"Agent"))),ee(rt,(i(O),P(()=>i(O).message)))},[()=>({user:i(O).type==="user",agent:i(O).type==="agent",error:i(O).style==="error",success:i(O).style==="success",warning:i(O).style==="warning",print:i(O).style?.startsWith("print")})]),C(he,M)});var me=y(Me,2);{var ge=he=>{var O=Bo(),M=d(O),ne=d(M),ve=d(ne),je=y(M,2),gt=d(je);{var tt=ze=>{var rt=Po(),st=Ce(rt);te(ut=>ee(st,ut),[()=>(o(),P(()=>"*".repeat(o().liveValue.length)))]),C(ze,rt)},ct=ze=>{var rt=qe(),st=Ce(rt);{var ut=Ae=>{var Be=Do(),Ve=Ce(Be);te(()=>ee(Ve,(c(),P(()=>c().draftMessage.message)))),C(Ae,Be)},Ge=Ae=>{var Be=Lo();C(Ae,Be)};J(st,Ae=>{o(),c(),P(()=>o().layout==="alpha"&&c().draftMessage)?Ae(ut):Ae(Ge,!1)},!0)}C(ze,rt)};J(gt,ze=>{o(),P(()=>o().layout==="numeric")?ze(tt):ze(ct,!1)})}te(ze=>ee(ve,ze),[()=>P(()=>new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}))]),C(he,O)};J(me,he=>{o(),P(()=>o().isActive&&o().mode==="agent")&&he(ge)})}en($e,he=>_(p,he),()=>i(p)),X("scroll",$e,()=>!i(k)&&R()),C(se,be)};J(ie,se=>{a()==="agent"&&se(le)},!0)}C(re,ae)};J(Q,re=>{a()==="receipts"?re(Y):re(Z,!1)},!0)}C(T,j)};J(xe,T=>{a()==="order"?T(de):T(oe,!1)})}C(e,L),Jn(t,"scrollToBottom",I),Jn(t,"cycleViews",K),Jn(t,"getIsAtBottom",F),Jn(t,"displayLanguageSelector",D);var $=pt({scrollToBottom:I,cycleViews:K,getIsAtBottom:F,displayLanguageSelector:D});return r(),$}const Xr=mt(!1);function qo(){Xr.update(e=>!e)}function zo(){Xr.set(!1)}var Vo=U('<div class="pinpad-grid numeric svelte-l3qs12"><button class="numpad-key svelte-l3qs12">1</button> <button class="numpad-key svelte-l3qs12">2</button> <button class="numpad-key svelte-l3qs12">3</button> <button class="function-key key-cancel svelte-l3qs12" aria-label="Cancel">X</button> <button class="numpad-key svelte-l3qs12">4</button> <button class="numpad-key svelte-l3qs12">5</button> <button class="numpad-key svelte-l3qs12">6</button> <button class="function-key key-correct svelte-l3qs12" aria-label="Correct">←</button> <button class="numpad-key svelte-l3qs12">7</button> <button class="numpad-key svelte-l3qs12">8</button> <button class="numpad-key svelte-l3qs12">9</button> <button class="function-key key-enter svelte-l3qs12" aria-label="Enter">↵</button> <button class="numpad-key function-key key-plus svelte-l3qs12">.99</button> <button class="numpad-key svelte-l3qs12">0</button> <button class="numpad-key function-key key-minus svelte-l3qs12">.</button></div>'),Go=U('<button class="alpha-key letter-key svelte-l3qs12"> </button>'),Wo=U('<div class="alpha-row svelte-l3qs12"></div>'),Ho=U('<div class="pinpad-grid alpha svelte-l3qs12"><!> <div class="alpha-bottom-row svelte-l3qs12"><button class="alpha-key space-key svelte-l3qs12" aria-label="Space">space</button> <button class="function-key cursor-key svelte-l3qs12" aria-label="Move cursor left">←</button> <button class="function-key cursor-key svelte-l3qs12" aria-label="Move cursor right">→</button> <button class="function-key language-key svelte-l3qs12" aria-label="Switch language"> </button> <button class="function-key key-cancel svelte-l3qs12" aria-label="Cancel">X</button> <button class="function-key key-correct svelte-l3qs12" aria-label="Backspace">⌫</button> <button class="function-key key-enter key-enter-large svelte-l3qs12" aria-label="Enter">↵</button></div></div>'),Jo=U('<div class="pinpad-wrapper svelte-l3qs12"><!></div>');function Ko(e,t){vt(t,!1);const[n,r]=Hn(),s=()=>Ze(He,"$pinpadStore",n);let a=Ie(t,"onClose",8,()=>{}),l=Ie(t,"minButtonSize",8,160),c=V(0),o=V(0),u=V(80),g=V(107),p=V(50),S=V(50),m=null,w=null;const k=6;let A=V(0),B=V(null),q=V(null),v=V(null),N=V(null);function x(oe){He.append(oe,fe)}function h(){He.backspace(fe)}function f(){He.confirm()}function E(){He.cancel(fe)}function W(){a()()}function D(oe){w=oe,m=setTimeout(()=>{w===oe&&(He.append(oe.toUpperCase(),fe),w=null)},500)}function H(){m&&(clearTimeout(m),m=null),w&&(He.append(w.toLowerCase(),fe),w=null)}function R(){m&&(clearTimeout(m),m=null),w=null}function I(){He.moveCursorLeft()}function K(){He.moveCursorRight()}function F(){He.switchLanguage()}De(()=>(i(o),i(A),i(B)),()=>{i(o)>0&&Math.abs(i(o)-i(A))>5&&(i(B)&&clearTimeout(i(B)),_(B,setTimeout(()=>{_(A,i(o))},50)))}),De(()=>(s(),i(A),i(q),i(v),i(N),ue(l()),i(p),i(g)),()=>{const oe=s().layout,$=s().currentLanguage;if(i(A)>0&&(i(q)!==oe||i(v)!==$||i(N)!==l()||i(q)===null&&i(v)===null)){if(oe==="alpha"&&s().layouts&&$){const T=s().layouts[$],j=Math.max(...T.map(re=>re.length)),Q=i(A)-k*(j-1);let Y=Math.floor(Q/j);const Z=l();Y>Z&&(Y=Z),_(p,Y),_(S,Math.floor(i(p)*(3/4)))}else if(oe==="numeric"){const j=i(A)-k*3;let Q=Math.floor(j/4);const Y=l();Q>Y&&(Q=Y),_(g,Q),_(u,Math.floor(i(g)*(3/4)))}_(q,oe),_(v,$),_(N,l())}}),nn(),wt();var L=Jo(),Se=d(L);{var xe=oe=>{var $=Vo(),T=d($),j=y(T,2),Q=y(j,2),Y=y(Q,2),Z=y(Y,2),re=y(Z,2),ae=y(re,2),ie=y(ae,2),le=y(ie,2),se=y(le,2),be=y(se,2),_e=y(be,2),Ee=y(_e,2),$e=y(Ee,2),Le=y($e,2);te(()=>cn($,`--button-height: ${i(u)??""}px; --button-width: ${i(g)??""}px;`)),X("click",T,()=>x("1")),X("click",j,()=>x("2")),X("click",Q,()=>x("3")),X("click",Y,E),X("dblclick",Y,W),X("click",Z,()=>x("4")),X("click",re,()=>x("5")),X("click",ae,()=>x("6")),X("click",ie,h),X("click",le,()=>x("7")),X("click",se,()=>x("8")),X("click",be,()=>x("9")),X("click",_e,f),X("click",Ee,()=>x(".99")),X("click",$e,()=>x("0")),X("click",Le,()=>x(".")),C(oe,$)},de=oe=>{var $=qe(),T=Ce($);{var j=Q=>{var Y=Ho(),Z=d(Y);At(Z,1,()=>(s(),P(()=>s().layouts[s().currentLanguage])),ar,(Le,Me)=>{var me=Wo();At(me,5,()=>i(Me),ar,(ge,he)=>{var O=Go(),M=d(O);te(()=>{Ci(O,"aria-label",`Letter ${i(he)??""}`),ee(M,i(he))}),X("mousedown",O,()=>D(i(he))),X("mouseup",O,H),X("mouseleave",O,R),C(ge,O)}),C(Le,me)});var re=y(Z,2),ae=d(re),ie=y(ae,2),le=y(ie,2),se=y(le,2),be=d(se),_e=y(se,2),Ee=y(_e,2),$e=y(Ee,2);te(()=>{cn(Y,`--alpha-button-width: ${i(p)??""}px; --alpha-button-height: ${i(S)??""}px;`),ee(be,(s(),P(()=>s().currentLanguage)))}),X("click",ae,()=>x(" ")),X("click",ie,I),X("click",le,K),X("click",se,F),X("click",_e,E),X("dblclick",_e,W),X("click",Ee,h),X("click",$e,f),C(Q,Y)};J(T,Q=>{s(),P(()=>s().layout==="alpha")&&Q(j)},!0)}C(oe,$)};J(Se,oe=>{s(),P(()=>s().layout==="numeric")?oe(xe):oe(de,!1)})}vs(L,"clientHeight",oe=>_(c,oe)),vs(L,"clientWidth",oe=>_(o,oe)),C(e,L),pt(),r()}var Yo=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Description:</span> <span class="value svelte-yjty9j"> </span></div>'),Xo=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Allergens:</span> <span class="value svelte-yjty9j"> </span></div>'),Qo=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Dietary:</span> <span class="value svelte-yjty9j"> </span></div>'),Zo=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Category:</span> <span class="value svelte-yjty9j"> </span></div>'),el=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Status:</span> <span class="value svelte-yjty9j"> </span></div>'),tl=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Last Modified:</span> <span class="value svelte-yjty9j"> </span></div>'),nl=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Product ID:</span> <span class="value svelte-yjty9j"> </span></div>'),rl=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Price:</span> <span class="value svelte-yjty9j"> </span></div> <!> <!> <!> <!> <!> <!> <!>',1),sl=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Type:</span> <span class="value svelte-yjty9j"> </span></div>'),al=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Category ID:</span> <span class="value svelte-yjty9j"> </span></div>'),il=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Parent Category:</span> <span class="value svelte-yjty9j"> </span></div>'),ol=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Main Group:</span> <span class="value svelte-yjty9j"> </span></div>'),ll=U('<div class="detail-row svelte-yjty9j"><span class="label svelte-yjty9j">Source ID:</span> <span class="value svelte-yjty9j"> </span></div>'),cl=U("<!> <!> <!> <!> <!>",1),ul=U('<div class="context-menu svelte-yjty9j"><div class="menu-header svelte-yjty9j"><h3 class="svelte-yjty9j"><!></h3></div> <div class="menu-content svelte-yjty9j"><!></div> <div class="menu-footer svelte-yjty9j"><button class="edit-button svelte-yjty9j">Edit</button> <button class="advanced-edit-button svelte-yjty9j">View</button> <button class="close-button svelte-yjty9j">Close</button></div></div>');function dl(e,t){vt(t,!1);const n=V(),r=V(),s=V();let a=Ie(t,"item",8,null),l=Ie(t,"x",8,0),c=Ie(t,"y",8,0),o=Ie(t,"visible",8,!1);const u=pn();let g=V(),p=V(0),S=V(0);Wt(()=>{function f(W){i(g)&&!i(g).contains(W.target)&&u("close")}function E(W){W.key==="Escape"&&u("close")}return o()&&(document.addEventListener("click",f),document.addEventListener("keydown",E)),()=>{document.removeEventListener("click",f),document.removeEventListener("keydown",E)}});function m(f){return typeof f=="number"?`€${f.toFixed(2)}`:a()&&a().item_price_value&&typeof a().item_price_value=="number"?`€${a().item_price_value.toFixed(2)}`:f||"N/A"}function w(f){try{const E=JSON.parse(f);return E.menu?.de||E.button?.de||E.de||"Unnamed"}catch{return f||"Unnamed"}}function k(f){try{return JSON.parse(f).de||"Unnamed Category"}catch{return f||"Unnamed Category"}}function A(f){try{return JSON.parse(f)}catch{return{}}}function B(){if(!i(g))return;const f=i(g).getBoundingClientRect(),E=window.innerWidth,W=window.innerHeight;if(f.width===0||f.height===0){setTimeout(()=>B(),10);return}const D=10,H=10,R=f.width>E-D*2,I=f.height>W-D*2;let K,F;R&&I?(K=D,F=D):R?(K=D,F=c()+H,F+f.height>W-D&&(F=c()-f.height-H),F<D&&(F=D)):I?(F=D,K=l()+H,K+f.width>E-D&&(K=l()-f.width-H),K<D&&(K=D)):(K=l()+H,F=c()+H,K+f.width>E-D&&(K=l()-f.width-H),F+f.height>W-D&&(F=c()-f.height-H),K<D&&(K=D),F<D&&(F=D)),_(p,K),_(S,F)}function q(){u("edit",{item:a()}),u("close")}function v(){u("advanced-edit",{item:a()}),u("close")}De(()=>ue(a()),()=>{_(n,a()&&a().category_names)}),De(()=>ue(a()),()=>{_(r,a()&&a().display_names)}),De(()=>(i(r),ue(a())),()=>{_(s,i(r)&&a().additional_item_attributes?A(a().additional_item_attributes):{})}),De(()=>(ue(o()),i(g)),()=>{o()&&i(g)&&requestAnimationFrame(()=>B())}),nn(),wt();var N=qe(),x=Ce(N);{var h=f=>{var E=ul(),W=d(E),D=d(W),H=d(D);{var R=T=>{var j=Lt();te(Q=>ee(j,Q),[()=>(ue(a()),P(()=>k(a().category_names)))]),C(T,j)},I=T=>{var j=qe(),Q=Ce(j);{var Y=re=>{var ae=Lt();te(ie=>ee(ae,ie),[()=>(ue(a()),P(()=>w(a().display_names)))]),C(re,ae)},Z=re=>{var ae=Lt("Item Details");C(re,ae)};J(Q,re=>{i(r)?re(Y):re(Z,!1)},!0)}C(T,j)};J(H,T=>{i(n)?T(R):T(I,!1)})}var K=y(W,2),F=d(K);{var L=T=>{var j=rl(),Q=Ce(j),Y=y(d(Q),2),Z=d(Y),re=y(Q,2);{var ae=O=>{var M=Yo(),ne=y(d(M),2),ve=d(ne);te(()=>ee(ve,(i(s),P(()=>i(s).description)))),C(O,M)};J(re,O=>{i(s),P(()=>i(s).description)&&O(ae)})}var ie=y(re,2);{var le=O=>{var M=Xo(),ne=y(d(M),2),ve=d(ne);te(je=>ee(ve,je),[()=>(i(s),P(()=>i(s).allergens.join(", ")))]),C(O,M)};J(ie,O=>{i(s),P(()=>i(s).allergens&&i(s).allergens.length>0)&&O(le)})}var se=y(ie,2);{var be=O=>{var M=Qo(),ne=y(d(M),2),ve=d(ne);te(je=>ee(ve,je),[()=>(i(s),P(()=>i(s).dietary_info.join(", ")))]),C(O,M)};J(se,O=>{i(s),P(()=>i(s).dietary_info&&i(s).dietary_info.length>0)&&O(be)})}var _e=y(se,2);{var Ee=O=>{var M=Zo(),ne=y(d(M),2),ve=d(ne);te(()=>ee(ve,(ue(a()),P(()=>a().associated_category_unique_identifier)))),C(O,M)};J(_e,O=>{ue(a()),P(()=>a().associated_category_unique_identifier)&&O(Ee)})}var $e=y(_e,2);{var Le=O=>{var M=el(),ne=y(d(M),2),ve=d(ne);te(()=>ee(ve,(ue(a()),P(()=>a().item_flags.is_sellable?"Available":"Not Available")))),C(O,M)};J($e,O=>{ue(a()),P(()=>a().item_flags&&a().item_flags.is_sellable!==void 0)&&O(Le)})}var Me=y($e,2);{var me=O=>{var M=tl(),ne=y(d(M),2),ve=d(ne);te(je=>ee(ve,je),[()=>(ue(a()),P(()=>new Date(a().audit_trail.updated_at||a().audit_trail.created_at).toLocaleDateString()))]),C(O,M)};J(Me,O=>{ue(a()),P(()=>a().audit_trail)&&O(me)})}var ge=y(Me,2);{var he=O=>{var M=nl(),ne=y(d(M),2),ve=d(ne);te(()=>ee(ve,(ue(a()),P(()=>a().id)))),C(O,M)};J(ge,O=>{ue(a()),P(()=>a().id)&&O(he)})}te(O=>ee(Z,O),[()=>(ue(a()),P(()=>m(a().item_price_value)))]),C(T,j)},Se=T=>{var j=qe(),Q=Ce(j);{var Y=Z=>{var re=cl(),ae=Ce(re);{var ie=me=>{var ge=sl(),he=y(d(ge),2),O=d(he);te(()=>ee(O,(ue(a()),P(()=>a().category_type)))),C(me,ge)};J(ae,me=>{ue(a()),P(()=>a().category_type)&&me(ie)})}var le=y(ae,2);{var se=me=>{var ge=al(),he=y(d(ge),2),O=d(he);te(()=>ee(O,(ue(a()),P(()=>a().id)))),C(me,ge)};J(le,me=>{ue(a()),P(()=>a().id)&&me(se)})}var be=y(le,2);{var _e=me=>{var ge=il(),he=y(d(ge),2),O=d(he);te(()=>ee(O,(ue(a()),P(()=>a().parent_category_unique_identifier)))),C(me,ge)};J(be,me=>{ue(a()),P(()=>a().parent_category_unique_identifier)&&me(_e)})}var Ee=y(be,2);{var $e=me=>{var ge=ol(),he=y(d(ge),2),O=d(he);te(()=>ee(O,(ue(a()),P(()=>a().default_linked_main_group_unique_identifier)))),C(me,ge)};J(Ee,me=>{ue(a()),P(()=>a().default_linked_main_group_unique_identifier)&&me($e)})}var Le=y(Ee,2);{var Me=me=>{var ge=ll(),he=y(d(ge),2),O=d(he);te(()=>ee(O,(ue(a()),P(()=>a().source_unique_identifier)))),C(me,ge)};J(Le,me=>{ue(a()),P(()=>a().source_unique_identifier)&&me(Me)})}C(Z,re)};J(Q,Z=>{i(n)&&Z(Y)},!0)}C(T,j)};J(F,T=>{i(r)?T(L):T(Se,!1)})}var xe=y(K,2),de=d(xe),oe=y(de,2),$=y(oe,2);en(E,T=>_(g,T),()=>i(g)),te(()=>cn(E,`left: ${(i(p)||l())??""}px; top: ${(i(S)||c())??""}px;`)),X("click",de,()=>q()),X("click",oe,()=>v()),X("click",$,()=>u("close")),C(f,E)};J(x,f=>{o()&&a()&&f(h)})}C(e,N),pt()}var fl=U('<span class="error-message svelte-eqo6fo"> </span>'),vl=U('<span class="error-message svelte-eqo6fo"> </span>'),pl=U('<span class="error-message svelte-eqo6fo"> </span>'),ml=U('<span class="error-message svelte-eqo6fo"> </span>'),gl=U('<span class="error-message svelte-eqo6fo"> </span>'),hl=U('<div class="modal-overlay svelte-eqo6fo" role="dialog" tabindex="-1"><div class="modal-content svelte-eqo6fo"><div class="modal-header svelte-eqo6fo"><h2 class="svelte-eqo6fo">Edit Product</h2> <button class="close-button svelte-eqo6fo" aria-label="Close">×</button></div> <form class="product-form svelte-eqo6fo"><div class="form-group svelte-eqo6fo"><label for="product-name-menu" class="svelte-eqo6fo">Name (Menu)</label> <input id="product-name-menu" type="text" placeholder="Enter menu name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-name-button" class="svelte-eqo6fo">Name (Button)</label> <input id="product-name-button" type="text" placeholder="Enter button name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-name-receipt" class="svelte-eqo6fo">Name (Receipt)</label> <input id="product-name-receipt" type="text" placeholder="Enter receipt name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-price" class="svelte-eqo6fo">Price (€)</label> <input id="product-price" type="number" step="0.01" min="0" placeholder="0.00"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-category" class="svelte-eqo6fo">Category</label> <input id="product-category" type="text" placeholder="Enter category name"/> <!></div> <div class="form-group svelte-eqo6fo"><label for="product-description" class="svelte-eqo6fo">Description</label> <textarea id="product-description" placeholder="Enter product description (optional)" rows="3" class="svelte-eqo6fo"></textarea></div> <div class="form-actions svelte-eqo6fo"><button type="button" class="btn-cancel svelte-eqo6fo">Cancel</button> <button type="submit" class="btn-save svelte-eqo6fo"><!></button></div></form></div></div>');function _l(e,t){vt(t,!1);const n=pn();let r=Ie(t,"visible",8,!1),s=Ie(t,"product",8,null),a=V({name_menu:"",name_button:"",name_receipt:"",price:"",categoryName:"",description:""}),l=V({}),c=V(!1),o=V(!1),u=V({});function g(v){if(typeof v=="object"&&v!==null)return v;if(typeof v=="string")try{return JSON.parse(v)}catch{return v}return v}function p(){if(_(u,{}),i(a).name_menu.trim()||Fe(u,i(u).name_menu="Menu name is required"),i(a).name_button.trim()||Fe(u,i(u).name_button="Button name is required"),i(a).name_receipt.trim()||Fe(u,i(u).name_receipt="Receipt name is required"),!i(a).price.trim())Fe(u,i(u).price="Price is required");else{const v=parseFloat(i(a).price);(isNaN(v)||v<0)&&Fe(u,i(u).price="Price must be a valid positive number")}return i(a).categoryName.trim()||Fe(u,i(u).categoryName="Category is required"),Object.keys(i(u)).length===0}async function S(){if(p()){_(o,!0);try{const v={};i(a).name_menu!==i(l).name_menu&&(v.name_menu=i(a).name_menu.trim()),i(a).name_button!==i(l).name_button&&(v.name_button=i(a).name_button.trim()),i(a).name_receipt!==i(l).name_receipt&&(v.name_receipt=i(a).name_receipt.trim()),i(a).price!==i(l).price&&(v.price=parseFloat(i(a).price)),i(a).categoryName!==i(l).categoryName&&(v.categoryName=i(a).categoryName.trim()),i(a).description!==i(l).description&&(v.description=i(a).description.trim()),Object.keys(v).length>0&&n("save",{productId:s().id,updates:v}),m()}catch(v){console.error("Error saving product:",v)}finally{_(o,!1)}}}function m(){n("close")}function w(v){v.target===v.currentTarget&&m()}function k(v){v.key==="Escape"&&m()}De(()=>(ue(s()),ue(r()),i(a)),()=>{if(s()&&r()){const v=s().display_names?g(s().display_names):{},N=v.menu?.de||s().name||"",x=v.button?.de||v.menu?.de||s().name||"",h=v.receipt?.de||v.menu?.de||s().name||"";let f="Unknown Category";s().category_name?f=s().category_name:s().categoryName?f=s().categoryName:f=`Category ID: ${s().associated_category_unique_identifier||"N/A"}`,_(a,{name_menu:N,name_button:x,name_receipt:h,price:(s().item_price_value||s().price||0).toString(),categoryName:f,description:s().description||N}),_(l,{...i(a)}),_(c,!1),_(u,{})}}),De(()=>(ue(r()),i(a),i(l)),()=>{_(c,r()&&(i(a).name_menu!==i(l).name_menu||i(a).name_button!==i(l).name_button||i(a).name_receipt!==i(l).name_receipt||i(a).price!==i(l).price||i(a).categoryName!==i(l).categoryName||i(a).description!==i(l).description))}),nn(),wt();var A=qe();X("keydown",Fn,k);var B=Ce(A);{var q=v=>{var N=hl(),x=d(N),h=d(x),f=y(d(h),2),E=y(h,2),W=d(E),D=y(d(W),2);let H;var R=y(D,2);{var I=M=>{var ne=fl(),ve=d(ne);te(()=>ee(ve,(i(u),P(()=>i(u).name_menu)))),C(M,ne)};J(R,M=>{i(u),P(()=>i(u).name_menu)&&M(I)})}var K=y(W,2),F=y(d(K),2);let L;var Se=y(F,2);{var xe=M=>{var ne=vl(),ve=d(ne);te(()=>ee(ve,(i(u),P(()=>i(u).name_button)))),C(M,ne)};J(Se,M=>{i(u),P(()=>i(u).name_button)&&M(xe)})}var de=y(K,2),oe=y(d(de),2);let $;var T=y(oe,2);{var j=M=>{var ne=pl(),ve=d(ne);te(()=>ee(ve,(i(u),P(()=>i(u).name_receipt)))),C(M,ne)};J(T,M=>{i(u),P(()=>i(u).name_receipt)&&M(j)})}var Q=y(de,2),Y=y(d(Q),2);let Z;var re=y(Y,2);{var ae=M=>{var ne=ml(),ve=d(ne);te(()=>ee(ve,(i(u),P(()=>i(u).price)))),C(M,ne)};J(re,M=>{i(u),P(()=>i(u).price)&&M(ae)})}var ie=y(Q,2),le=y(d(ie),2);let se;var be=y(le,2);{var _e=M=>{var ne=gl(),ve=d(ne);te(()=>ee(ve,(i(u),P(()=>i(u).categoryName)))),C(M,ne)};J(be,M=>{i(u),P(()=>i(u).categoryName)&&M(_e)})}var Ee=y(ie,2),$e=y(d(Ee),2),Le=y(Ee,2),Me=d(Le),me=y(Me,2),ge=d(me);{var he=M=>{var ne=Lt("Saving...");C(M,ne)},O=M=>{var ne=Lt("Save Changes");C(M,ne)};J(ge,M=>{i(o)?M(he):M(O,!1)})}te((M,ne,ve,je,gt,tt)=>{D.disabled=i(o),H=Ye(D,1,"svelte-eqo6fo",null,H,M),F.disabled=i(o),L=Ye(F,1,"svelte-eqo6fo",null,L,ne),oe.disabled=i(o),$=Ye(oe,1,"svelte-eqo6fo",null,$,ve),Y.disabled=i(o),Z=Ye(Y,1,"svelte-eqo6fo",null,Z,je),le.disabled=i(o),se=Ye(le,1,"svelte-eqo6fo",null,se,gt),$e.disabled=i(o),Me.disabled=i(o),me.disabled=tt},[()=>({error:i(u).name_menu}),()=>({error:i(u).name_button}),()=>({error:i(u).name_receipt}),()=>({error:i(u).price}),()=>({error:i(u).categoryName}),()=>(i(c),i(o),i(u),P(()=>!i(c)||i(o)||Object.keys(i(u)).length>0))]),X("click",f,m),qt(D,()=>i(a).name_menu,M=>Fe(a,i(a).name_menu=M)),qt(F,()=>i(a).name_button,M=>Fe(a,i(a).name_button=M)),qt(oe,()=>i(a).name_receipt,M=>Fe(a,i(a).name_receipt=M)),qt(Y,()=>i(a).price,M=>Fe(a,i(a).price=M)),qt(le,()=>i(a).categoryName,M=>Fe(a,i(a).categoryName=M)),qt($e,()=>i(a).description,M=>Fe(a,i(a).description=M)),X("click",Me,m),X("submit",E,aa(S)),X("click",N,w),X("keydown",N,k),C(v,N)};J(B,v=>{r()&&s()&&v(q)})}C(e,A),pt()}var yl=U('<div class="modal-overlay svelte-3d9wpg"><div class="modal-content svelte-3d9wpg"><div class="modal-header svelte-3d9wpg"><h2 class="svelte-3d9wpg">Edit Category</h2> <button class="close-button svelte-3d9wpg">×</button></div> <form class="product-form svelte-3d9wpg"><div class="form-group svelte-3d9wpg"><label for="category-name" class="svelte-3d9wpg">Category Name</label> <input id="category-name" type="text" class="svelte-3d9wpg"/></div> <div class="form-group svelte-3d9wpg"><label for="category-type" class="svelte-3d9wpg">Category Type</label> <select id="category-type" class="svelte-3d9wpg"><option>Food</option><option>Drink</option><option>Other</option></select></div> <div class="form-actions svelte-3d9wpg"><button type="button" class="btn-cancel svelte-3d9wpg">Cancel</button> <button type="submit" class="btn-save svelte-3d9wpg"> </button></div></form></div></div>');function bl(e,t){vt(t,!1);let n=Ie(t,"visible",8,!1),r=Ie(t,"category",8,null);const s=pn();let a=V({name:"",type:"food"}),l=V({}),c=V(!1);async function o(){if(!i(a).name.trim()){alert("Category name is required.");return}_(c,!0);const k={};i(a).name!==i(l).name&&(k.name=i(a).name.trim()),i(a).type!==i(l).type&&(k.type=i(a).type),Object.keys(k).length>0&&s("save",{categoryId:r().id,updates:k}),u()}function u(){_(c,!1),s("close")}function g(k){k.target===k.currentTarget&&u()}function p(k){k.key==="Escape"&&u()}De(()=>(ue(r()),ue(n()),i(a)),()=>{if(r()&&n()){const k=JSON.parse(r().category_names||"{}");_(a,{name:k.de||"",type:r().category_type||"food"}),_(l,{...i(a)})}}),nn(),wt();var S=qe();X("keydown",Fn,p);var m=Ce(S);{var w=k=>{var A=yl(),B=d(A),q=d(B),v=y(d(q),2),N=y(q,2),x=d(N),h=y(d(x),2),f=y(x,2),E=y(d(f),2);te(()=>{i(a),Js(()=>{i(c)})});var W=d(E);W.value=W.__value="food";var D=y(W);D.value=D.__value="drink";var H=y(D);H.value=H.__value="other";var R=y(f,2),I=d(R),K=y(I,2),F=d(K);te(()=>{h.disabled=i(c),E.disabled=i(c),I.disabled=i(c),K.disabled=i(c),ee(F,i(c)?"Saving...":"Save Changes")}),X("click",v,u),qt(h,()=>i(a).name,L=>Fe(a,i(a).name=L)),ra(E,()=>i(a).type,L=>Fe(a,i(a).type=L)),X("click",I,u),X("submit",N,aa(o)),X("click",A,g),C(k,A)};J(m,k=>{n()&&r()&&k(w)})}C(e,S),pt()}var wl=Wr(`<svg viewBox="-10 -10 120 120" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: 100%;"><defs><filter height="170%" id="sh2" width="170%" x="-0.2" y="-0.2"><feOffset dx="0" dy="0" in="SourceAlpha"></feOffset><feGaussianBlur stdDeviation="1.2"></feGaussianBlur><feColorMatrix result="out" type="matrix" values=" 
               0 0 0 0 0.2         
               0 0 0 0 0.2                    
               0 0 0 0 0.2                
               0 0 0 10 0 "></feColorMatrix><feMerge><feMergeNode in="out"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter></defs><g filter="url(#sh2)"><path fill="#2c2c2e" stroke="#666" stroke-width="1.5" d="M72,89 C78.6,68 67.2,30.7 89,68 C86.9,37.6 66.91,32 62,61 C58,44.1 67.5,38.8 52,10 C53.6,47 46.91,36.2 45,61 C39.3,43.4 22,46.6 13,43 C32.9,55.8 35.7,66.62 32,89 C35,97.9 68.6,99 72,89 Z"></path><circle fill="#2c2c2e" stroke="#666" stroke-width="1.5" cx="13" cy="43" r="5.5"></circle><circle fill="#2c2c2e" stroke="#666" stroke-width="1.5" cx="52" cy="10" r="5.5"></circle><circle fill="#2c2c2e" stroke="#666" stroke-width="1.5" cx="89" cy="68" r="5.5"></circle></g></svg>`);function Sl(e){var t=wl();C(e,t)}var xl=Wr('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 96" fill="none" class="svelte-1cmb9l6"><rect x="0" y="0" width="128" height="96" rx="8" ry="8" fill="#2A2A2A" stroke="none"></rect><g><rect x="7" y="6" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="24" y="19" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">1</text><rect x="47" y="6" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="64" y="19" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">2</text><rect x="87" y="6" width="34" height="24" rx="3" fill="#883333" stroke="#555555" stroke-width="0.5"></rect><text x="104" y="19" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">3</text><rect x="7" y="36" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="24" y="49" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">4</text><rect x="47" y="36" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="64" y="49" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">5</text><rect x="87" y="36" width="34" height="24" rx="3" fill="#885533" stroke="#555555" stroke-width="0.5"></rect><text x="104" y="49" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">6</text><rect x="7" y="66" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="24" y="79" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">7</text><rect x="47" y="66" width="34" height="24" rx="3" fill="#3A3A3A" stroke="#555555" stroke-width="0.5"></rect><text x="64" y="79" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">8</text><rect x="87" y="66" width="34" height="24" rx="3" fill="#385b4a" stroke="#555555" stroke-width="0.5"></rect><text x="104" y="79" font-family="Arial, sans-serif" font-size="14" font-weight="600" text-anchor="middle" dominant-baseline="middle" fill="#BBBBBB">9</text></g></svg>');function kl(e){var t=xl();C(e,t)}class Tl{constructor(t,n,r=!0){this.row=t,this.col=n,this.content=null,this.isEmpty=!0,this.isUsable=r,this.priority=0,this.id=`slot-${t}-${n}`}setContent(t,n=1){this.content=t,this.isEmpty=!1,this.priority=n}clearContent(){this.content=null,this.isEmpty=!0,this.priority=0}}class Cl{constructor(t,n){this.rows=t,this.cols=n,this.slots=[],this.contentSlots=[],this.initializeGrid()}initializeGrid(){for(let t=0;t<this.rows;t++){const n=[];for(let r=0;r<this.cols;r++){const s=t%2!==r%2,a=new Tl(t,r,s);n.push(a),this.contentSlots.push(a)}this.slots.push(n)}}getSlot(t,n){return t>=0&&t<this.rows&&n>=0&&n<this.cols?this.slots[t][n]:null}getAllSlots(){return this.contentSlots}getUsableEmptySlots(){return this.contentSlots.filter(t=>t.isUsable&&t.isEmpty)}getUsableFilledSlots(){return this.contentSlots.filter(t=>t.isUsable&&!t.isEmpty)}getUsableSlots(){return this.contentSlots.filter(t=>t.isUsable)}placeContentAt(t,n,r,s){const a=this.getSlot(t,n);return a&&a.isUsable&&(a.isEmpty||s>a.priority)?(a.setContent(r,s),!0):!1}clearAllContent(){this.contentSlots.forEach(t=>{t.clearContent()})}getPrioritizedSlots(){return this.contentSlots.filter(t=>t.isUsable).sort((t,n)=>n.priority-t.priority)}}function El(e,t,n){const{cellWidth:r=120,cellHeight:s=80,buttonGap:a=6,hexOffset:l=.5,shape:c="hex"}=n;return c==="hex"?Il(e,t,r,s,a):Ml(e,t,r,s,a)}function Il(e,t,n,r,s,a){const l=t%2===1,c=Math.floor(t/2),o=c*(n+s)+(l?(n+s)/2:0),u=r*.75,g=e*(u+s);return console.log(`🔮 [hexPositioning] row=${e}, col=${t}, isOddCol=${l}, visualCol=${c}, x=${o}, y=${g}, gap=${s}`),{x:o,y:g}}function Ml(e,t,n,r,s){const a=t*(n+s),l=e*(r+s);return console.log(`🔮 [rectPositioning] row=${e}, col=${t}, x=${a}, y=${l}, gap=${s}`),{x:a,y:l}}function Al(e){return e?`translate(${e.x}px, ${e.y}px)`:"translate(0px, 0px)"}class Ol{constructor(t,n,r){this.id=t,this.type=n,this.logicalPosition=r,this.content=null,this.cssPosition=null,this.cssTransform=null,this.geometryMetadata={}}setContent(t){this.content=t}calculatePhysicalPosition(t){return this.cssPosition=El(this.logicalPosition.row,this.logicalPosition.col,t),this.cssTransform=Al(this.cssPosition),this.cssPosition}}class Nl{constructor(t={}){this.options={shape:"hex",cellWidth:t.cellWidth||120,cellHeight:t.cellHeight||80,buttonGap:t.buttonGap||6,...t}}renderContentGrid(t){const n=[],r=t.getUsableFilledSlots();for(const s of r){const a=new Ol(`full-slot-${s.row}-${s.col}`,"full",{row:s.row,col:s.col});a.setContent(s.content),a.geometryMetadata.priority=s.priority,a.calculatePhysicalPosition(this.options),n.push(a)}return n}}function _s(e={}){return new Nl(e)}const ys={MAX_CONTENT:100,PAYMENT_BUTTON:90,TABLE_BUTTON:85,PINPAD_BUTTON:80,CATEGORY_NAVIGATION:70,DEFAULT:50,MIN:1};class Rl{constructor(t={}){this.config={dimensions:{rows:4,cols:12},rendering:{shape:"hex",cellWidth:120,cellHeight:80},...t},this.contentGrid=new Cl(this.config.dimensions.rows,this.config.dimensions.cols),this.geometryRenderer=_s(this.config.rendering),this.renderCache=null,this.isDirty=!0,console.log("🎯 [GridManager] Initialized ContentGrid",this.config.dimensions)}clearAndReset(){this.contentGrid.clearAllContent(),this.markDirty()}placeItems(t,n=ys.DEFAULT,r=1/0){if(!t||t.length===0)return[];const s=this.contentGrid.getUsableEmptySlots();let a=0;const l=[];t.sort((c,o)=>(c.order_index||0)-(o.order_index||0));for(const c of t){if(a>=r)break;const o=s[a];o&&(o.setContent(c,n),a++,l.push({item:c,placed:!0,slot:o}))}return this.markDirty(),l}placeSystemElements(t){const n=[];for(const r of t){const s=this.contentGrid.placeContentAt(r.row,r.col,r.content,r.priority);n.push({element:r,placed:s})}return this.markDirty(),n}getRenderStructure(){return this.renderCache&&!this.isDirty?this.renderCache:(this.contentGrid.getUsableFilledSlots(),this.renderCache=this.geometryRenderer.renderContentGrid(this.contentGrid),this.isDirty=!1,this.renderCache)}getSvelteCompatibleCells(t){return this.geometryRenderer=_s(t),this.getRenderStructure().map(r=>({...r,cssTransform:r.cssTransform,data:r.content.data||r.content,label:r.content.label||r.content.category_names?.de||r.content.display_names?.button?.de}))}getDebugInfo(){return this.contentGrid.getDebugInfo()}getUsableSlotCount(){return this.contentGrid.getUsableSlots().length}markDirty(){this.isDirty=!0}getPriorities(){return ys}}var $l=U("<div><div><!></div></div>"),Pl=U('<p class="status-message svelte-lb1vpy"> </p>'),Dl=U('<div class="empty-category-info svelte-lb1vpy"><p class="empty-message svelte-lb1vpy">No products in this category.</p> <p class="empty-hint svelte-lb1vpy">Try a different category or check the product catalog.</p></div>'),Ll=U('<div class="quantum-button svelte-lb1vpy"><!></div>'),Bl=U("<div><!> <!></div>"),Ul=U('<div class="selection-area svelte-lb1vpy"><!> <!> <!> <!> <div class="grid-container svelte-lb1vpy"><!></div></div>');function Fl(e,t){vt(t,!1);const[n,r]=Hn(),s=()=>Ze(un,"$authStore",n),a=()=>Ze(Sn,"$notificationStore",n),l=()=>Ze(la,"$uiConstantsStore",n),c=()=>Ze(Ke,"$orderStore",n),o=()=>Ze(He,"$pinpadStore",n),u=()=>Ze(Fi,"$currentMinuteTime",n),g=V();let p=V([]),S=V([]),m=V("Connecting to backend..."),w=!1,k=V("categories"),A=null,B=V("6-6-6"),q=V(!1),v=V(null),N=V(0),x=V(0),h=V(!1),f=V(null),E=V(!1),W=V(null),D=0;Ie(t,"isAtBottom",8,!1),Ie(t,"consoleViewComponent",8,null);let H=0,R=V(null),I=V([]),K=Ie(t,"handleSmartAction",8,()=>{}),F=V(null),L=V(null);const Se=6,xe=6,de=6,oe=6;let $=V(i(g)),T=V(i(g)*.866),j=V(i(g)),Q=V(i(g)),Y=1,Z=1,re=V(),ae,ie,le=!1,se;function be(b){if(!b)return{};if(typeof b=="string")try{return JSON.parse(b)}catch{return{}}return b}function _e(b){if(!b)return"Login";const z=b.split(" ");let ke;if(z.length===1)ke=z[0].length>12?z[0].substring(0,12)+"...":z[0];else if(z.length===2){const pe=z[0].length>8?z[0].substring(0,8)+".":z[0],Ne=z[1].length>8?z[1].substring(0,8)+".":z[1];ke=`${pe} ${Ne}`}else{const pe=z[0].length>6?z[0].substring(0,6)+".":z[0],Ne=z[z.length-1].length>6?z[z.length-1].substring(0,6)+".":z[z.length-1];ke=`${pe} ${Ne}`}return`Angemeldet als
${ke}`}function Ee(){se&&clearInterval(se),se=setInterval(()=>{const b=new Date;new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes()+1,0,0),zn.update(z=>({...z,time:b})),ge()},6e4),ge()}Yr(()=>{se&&clearInterval(se)});function $e(){const b=D,z=i(B)==="6-6-6"?de:oe,ke=H-2*z,pe=i(B)==="6-6-6"?Se:xe,Ne=i(g),nt=i(B)==="6-6-6"?.866:.75;let ye=Math.floor((b-pe)/(Ne+pe));ye<1&&(ye=1);const Xe=(b-(ye+1)*pe)/ye,Ct=Xe*nt;let Et=Math.floor((ke+pe)/(Ct+pe));Et<1&&(Et=1);const It=(ke-(Et-1)*pe)/Et;return{columns:ye,rows:Et,buttonWidth:Xe,buttonHeight:It}}function Le(){const b=$e();Y=b.columns,Z=b.rows,i(B)==="6-6-6"?(_($,b.buttonWidth),_(T,b.buttonHeight)):(_(j,b.buttonWidth),_(Q,b.buttonHeight)),_(R,new Rl({dimensions:{rows:Z,cols:Y*2},rendering:{shape:i(B)==="6-6-6"?"hex":"rect",cellWidth:i(B)==="6-6-6"?i($):i(j),cellHeight:i(B)==="6-6-6"?i(T):i(Q)}})),ge()}function Me(){Le()}function me(){const b=[];return i(F)&&b.push({row:0,col:0,content:i(F),priority:i(R).getPriorities().TABLE_BUTTON}),i(L)&&b.push({row:0,col:2,content:i(L),priority:i(R).getPriorities().PINPAD_BUTTON}),b}function ge(){if(!i(R))return;i(R).clearAndReset();const b=i(R).getPriorities(),z=me();if(z.length>0&&i(R).placeSystemElements(z),c()&&c().items&&c().items.length>0){const pe=[{row:Z-1,col:Y*2-2,content:{type:"bar",label:"Bar",onClick:()=>tt("cash")},priority:b.PAYMENT_BUTTON},{row:Z-1,col:Y*2-4,content:{type:"karte",label:"Karte",onClick:()=>tt("card")},priority:b.PAYMENT_BUTTON}];i(R).placeSystemElements(pe)}const ke=[{row:Z-1,col:0,content:{type:"pinpad",label:"Pinpad"},priority:b.PINPAD_BUTTON}];i(R).placeSystemElements(ke),i(k)==="categories"?i(R).placeItems(i(p),b.CATEGORY_NAVIGATION):i(k)==="products"&&i(R).placeItems(i(S),b.MAX_CONTENT),_(I,i(R).getSvelteCompatibleCells(i(R).config.rendering))}function he(b){b.content?.onClick?b.content.onClick():b.data&&(i(k)==="categories"&&b.data.id?O({detail:{data:b.data}}):i(k)==="products"&&b.data.id&&M({detail:{data:b.data}}))}function O({detail:b}){b.data?.id&&(A=b.data,_(m,"Loading..."),ce.send({command:"getItemsByCategory",payload:{categoryId:b.data.id}}))}async function M({detail:b}){b.data?.id&&await Ke.addItem(b.data.id,1)}function ne(){_(k,"categories"),A=null,_(S,[]),_(m,"")}function ve(){_(B,i(B)==="6-6-6"?"4-4-4":"6-6-6")}function je(){qo()}async function gt(){if(s().isAuthenticated){const b=s().currentUser,z=`👤 **${b.full_name}** (${b.role})

🔐 **Status:** Erfolgreich angemeldet
💡 **Tipp:** Lange drücken zum Abmelden`;fe.addMessage({type:"agent",message:z}),G("INFO",`User ${b.username} viewed profile information`)}}function tt(b){let z;Ke.subscribe(ke=>z=ke)(),z&&z.total>0&&Ke.finishOrder({type:b.charAt(0).toUpperCase()+b.slice(1),amount:z.total})}function ct(){o().isActive?He.deactivate():He.activateAlphaInput(()=>{},()=>{},fe)}function ze({detail:b}){b.data&&!b.data.isBackButton&&(_(v,b.data),_(N,b.mouseX),_(x,b.mouseY),_(q,!0))}function rt(){_(q,!1)}function st({detail:b}){b.item.category_names?(_(W,b.item),_(E,!0)):(_(f,b.item),_(h,!0)),_(q,!1)}async function ut({detail:b}){G("DEBUG",`Advanced edit requested for item: ${b.item.id}`),_(q,!1);const z=b.item,ke=!!z.category_names;let pe=`🔧 **Advanced Edit Mode**

`;if(pe+=`📝 **Type:** ${ke?"Category":"Product"}
`,pe+=`🆔 **ID:** ${z.id}
`,ke){const Ne=be(z.category_names);pe+=`📛 **Name:** ${Ne.de||"Unnamed"}
`,z.category_type&&(pe+=`🏷️ **Type:** ${z.category_type}
`)}else{const Ne=be(z.display_names);pe+=`📛 **Name:** ${Ne.button?.de||"Unnamed Product"}
`,z.price&&(pe+=`💰 **Price:** €${z.price}
`)}pe+=`
💡 **Available Actions:**
`,pe+=`• Standard Edit (Right-click → Edit)
`,pe+=`• Database Direct Access
`,pe+=`• Bulk Operations
`,pe+="• Advanced Properties",fe.addMessage({type:"agent",message:pe}),ke?(_(W,z),_(E,!0)):(_(f,z),_(h,!0))}async function Ge({detail:b}){try{(await ce.send({command:"updateProduct",payload:{productId:b.productId,updates:b.updates,sessionId:"admin-session-placeholder"}})).status==="success"&&(G("INFO",`Product ${b.productId} updated successfully`),i(k)==="products"&&A&&ce.send({command:"getItemsByCategory",payload:{categoryId:A.id}}))}catch(z){console.error("Product update error:",z),G("ERROR",`Failed to update product ${b.productId}: ${z.message}`)}_(h,!1)}async function Ae({detail:b}){try{(await ce.send({command:"updateCategory",payload:{categoryId:b.categoryId,updates:b.updates}})).status==="success"&&(G("INFO",`Category ${b.categoryId} updated successfully`),i(k)==="categories"&&ce.send({command:"getCategories"}))}catch(z){console.error("Category update error:",z),G("ERROR",`Failed to update category ${b.categoryId}: ${z.message}`)}_(E,!1)}function Be(){_(h,!1)}function Ve(){_(E,!1)}Sn.subscribe(b=>{b.style}),un.subscribe(b=>{}),Wt(()=>{i(re)&&(ae=new ResizeObserver(z=>{ie&&clearTimeout(ie),ie=setTimeout(()=>{for(let ke of z){const pe=ke.contentRect.width,Ne=ke.contentRect.height;(D!==pe||H!==Ne)&&(D=pe,H=Ne,Me())}},150)}),ae.observe(i(re)),setTimeout(()=>{D=i(re).clientWidth,H=i(re).clientHeight,Me()},100));const b=()=>{_(k,"categories"),A=null,ft.set("order")};return window.addEventListener("autoCollapseComplete",b),Ee(),()=>{ae?.disconnect(),window.removeEventListener("autoCollapseComplete",b),se&&clearInterval(se)}}),ce.subscribe(b=>{w=b.isConnected,w&&!le&&(le=!0,_(m,"Loading categories..."),setTimeout(()=>{ce.send({command:"getCategories"}).then(z=>{z.status==="success"&&Array.isArray(z.payload)?(_(p,z.payload),_(m,""),ge()):(_(m,"Error: Could not load categories from backend."),console.error("Failed to load categories:",z))}).catch(z=>{_(m,"Error: Failed to get response for categories."),console.error("Error in getCategories promise:",z)})},500)),b.lastMessage?.command==="getItemsByCategoryResponse"&&(b.lastMessage.status==="success"&&Array.isArray(b.lastMessage.payload)?(_(S,b.lastMessage.payload),_(k,"products"),_(m,"")):(_(m,"Error: Could not load products from backend."),console.error("Failed to load products:",b.lastMessage)))});function dt(b){return b.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}function ht(b){if(b.content?.type==="pinpad")return{label:b.content.label,icon:kl,onClick:ct,active:!0};if(b.content?.type==="bar"||b.content?.type==="karte"){const ye=c()&&c().total>0&&c().status==="active";return{label:b.content.label,onClick:b.content.onClick,active:ye,disabled:!ye,paymentButton:!0,color:ye?b.content.type==="bar"?"#28a745":"#007bff":"#666"}}if(b.content.isUserButton)return i(F);if(b.content.isSmartNavigation)return i(L);if(b.content.isTimeButton){const ye=dt(u().time),Xe=u().time.getDate().toString().padStart(2,"0"),Ct=(u().time.getMonth()+1).toString().padStart(2,"0");return{label:`${ye}
${Xe}.${Ct}`,onClick:je,active:!0,customStyle:"font-family: monospace; font-size: 14px; font-weight: bold; line-height: 1.2; text-align: center; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);"}}if(b.content.isLayoutToggle)return{label:i(B)==="6-6-6"?"6⬡6⬡6":"4▢4▢4",onClick:ve,active:!0,customStyle:"font-family: monospace; font-size: 16px; font-weight: bold; text-align: center;"};if(b.content.isBackButton)return{label:"⬅ Categories",onClick:ne,active:!0,data:{isBackButton:!0},color:"#6c757d"};if(b.content.isKeyboardToggle)return{label:b.content.label||"⌨",icon:b.content.icon,color:b.content.color,textColor:b.content.textColor,onClick:ct,active:!0};if(b.content.isPaymentButton){const ye=c().total>0&&c().status==="active";return{label:b.content.label,onClick:ye?()=>tt(b.content.paymentType):void 0,active:ye,disabled:!ye,paymentButton:!0,color:ye?b.content.color:"#666",icon:b.content.icon,textColor:ye?b.content.textColor:void 0,backgroundStyle:ye?b.content.backgroundStyle:void 0}}const z=i(k)==="categories",ke=z?be(b.content.category_names).de||"Unnamed":be(b.content.display_names).button.de||"Unnamed Product",pe=z?O:M;let Ne;!z&&b.content?.additional_item_attributes?.ui_suggestions?.background_color_hex?Ne=b.content.additional_item_attributes.ui_suggestions.background_color_hex:z||(Ne="#666666");const nt={label:ke,data:b.content,onClick:pe,active:!0};return z?(nt.color="#3A2F20",nt.backgroundStyle="radial-gradient(ellipse at center, #645540 0%, #5A4B35 30%, #4A3B28 70%, #3A2F20 100%)",nt.textColor="#DDDDD0"):Ne&&(nt.color=Ne),nt}De(()=>(s(),He),()=>{_(F,(()=>{const b=s().currentUser;return b?{label:_e(b.full_name),data:{isUserButton:!0,authenticated:!0},onClick:gt,active:!0,color:"#28a745",textColor:"#666",customStyle:"font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; line-height: 1.1; white-space: pre-line; text-align: center; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);"}:{label:"Login",data:{isUserButton:!0,authenticated:!1},onClick:()=>He.activate("agent",null,null,"numeric"),active:!0,color:"#6c757d",textColor:"#666",customStyle:"font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; line-height: 1.1; white-space: pre-line; text-align: center; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);"}})())}),De(()=>(a(),ue(K())),()=>{_(L,(()=>{let b="#2c2c2e";if(a().style)switch(a().style){case"error":b="#d32f2f";break;case"warning":b="#f57c00";break;case"info":b="#1976d2";break;case"success":b="#388e3c";break;default:b="#2c2c2e"}return{icon:Sl,showShape:!0,color:b,onClick:()=>K()("betrugerCap"),active:!0}})())}),De(()=>l(),()=>{_(g,l().MIN_BUTTON_WIDTH)}),De(()=>i(B),()=>{i(B)&&Me()}),De(()=>(i(R),i(k),i(p),i(S)),()=>{i(R)&&(i(k)==="categories"&&i(p).length>=0||i(k)==="products"&&i(S).length>=0)&&ge()}),De(()=>(i(R),c()),()=>{i(R)&&c()&&ge()}),De(()=>(i(R),i(F),i(L)),()=>{i(R)&&(i(F)||i(L))&&ge()}),nn(),wt();var Ft=Ul(),Oe=d(Ft);{var We=b=>{var z=$l();let ke;var pe=d(z);let Ne;var nt=d(pe);{let ye=Rt(()=>i(g)/4*3);Ko(nt,{onClose:()=>He.deactivate(),get minButtonSize(){return i(ye)}})}te((ye,Xe)=>{ke=Ye(z,1,"pinpad-overlay svelte-lb1vpy",null,ke,ye),Ne=Ye(pe,1,"pinpad-container svelte-lb1vpy",null,Ne,Xe)},[()=>({numeric:o().layout==="numeric",alpha:o().layout==="alpha"}),()=>({numeric:o().layout==="numeric",alpha:o().layout==="alpha"})]),C(b,z)};J(Oe,b=>{o(),P(()=>o().isActive)&&b(We)})}var at=y(Oe,2);dl(at,{get item(){return i(v)},get x(){return i(N)},get y(){return i(x)},get visible(){return i(q)},$$events:{close:rt,edit:st,"advanced-edit":ut}});var Je=y(at,2);_l(Je,{get visible(){return i(h)},get product(){return i(f)},$$events:{save:Ge,close:Be}});var Ue=y(Je,2);bl(Ue,{get visible(){return i(E)},get category(){return i(W)},$$events:{save:Ae,close:Ve}});var jt=y(Ue,2),Ot=d(jt);{var Kt=b=>{var z=Pl(),ke=d(z);te(()=>ee(ke,i(m))),C(b,z)},Tt=b=>{var z=Bl();let ke;cn(z,"padding: 6px 0;");var pe=d(z);{var Ne=ye=>{var Xe=Dl();C(ye,Xe)};J(pe,ye=>{i(k),i(S),P(()=>i(k)==="products"&&i(S).length===0)&&ye(Ne)})}var nt=y(pe,2);At(nt,1,()=>i(I),ye=>ye.id,(ye,Xe)=>{var Ct=Ll(),Et=d(Ct);{let It=Rt(()=>i(B)==="6-6-6"?"hex":"rect"),it=Rt(()=>i(B)==="6-6-6"?i($):i(j)),rn=Rt(()=>i(B)==="6-6-6"?i(T):i(Q)),mr=Rt(()=>ht(i(Xe)));ca(Et,Ri({get shape(){return i(It)},get width(){return i(it)},get height(){return i(rn)}},()=>i(mr),{$$events:{click:()=>he(i(Xe)),secondaryaction:ze}}))}te(()=>cn(Ct,`${i(Xe),P(()=>i(Xe).cssTransform)??""}; position: absolute;`)),C(ye,Ct)}),te(ye=>ke=Ye(z,1,"grid-container-unified svelte-lb1vpy",null,ke,ye),[()=>({hex:i(B)==="6-6-6"})]),C(b,z)};J(Ot,b=>{i(m)?b(Kt):b(Tt,!1)})}en(Ft,b=>_(re,b),()=>i(re)),C(e,Ft),pt(),r()}var jl=U('<input type="file" accept=".pdf,.jpg,.jpeg,.png" multiple style="display: none;" class="svelte-1wvon5f"/>'),ql=U('<div class="importing-indicator svelte-1wvon5f"><div class="spinner svelte-1wvon5f"></div> <p class="svelte-1wvon5f">Importing menu...</p></div>'),zl=U('<div class="loading-files svelte-1wvon5f"><div class="spinner svelte-1wvon5f"></div> <p class="svelte-1wvon5f">Loading available files...</p></div>'),Vl=U('<div class="error-message svelte-1wvon5f"><p class="svelte-1wvon5f"> </p> <button class="retry-btn svelte-1wvon5f">Retry</button></div>'),Gl=U('<div class="upload-area svelte-1wvon5f"><div class="upload-prompt svelte-1wvon5f"><p class="svelte-1wvon5f">No files selected yet.</p> <button class="upload-btn svelte-1wvon5f"><svg class="upload-icon svelte-1wvon5f" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" class="svelte-1wvon5f"></path></svg> Choose Files</button> <p class="upload-hint svelte-1wvon5f">Select multiple PDF, JPG, or PNG files</p></div></div>'),Wl=U('<div class="no-files svelte-1wvon5f"><p class="svelte-1wvon5f">No menu files found in the menu_inputs directory.</p> <p class="svelte-1wvon5f">Please add PDF, JPG, or PNG files to the menu_inputs folder.</p></div>'),Hl=U('<span class="svelte-1wvon5f"> </span>'),Jl=U('<span class="svelte-1wvon5f"> </span>'),Kl=U('<button class="control-btn svelte-1wvon5f">Add More Files</button>'),Yl=U('<div class="size-warning svelte-1wvon5f"></div>'),Xl=U('<div><label class="file-checkbox svelte-1wvon5f"><input type="checkbox" class="svelte-1wvon5f"/> <div class="file-info svelte-1wvon5f"><div class="file-name svelte-1wvon5f"> </div> <div class="file-details svelte-1wvon5f"><span class="file-type svelte-1wvon5f"> </span> <span class="file-date svelte-1wvon5f"> </span></div> <!></div></label></div>'),Ql=U('<span class="upload-status uploaded svelte-1wvon5f">✓ Uploaded</span>'),Zl=U('<span class="upload-status pending svelte-1wvon5f">Pending upload</span>'),ec=U('<div><label class="file-checkbox svelte-1wvon5f"><input type="checkbox" class="svelte-1wvon5f"/> <div class="file-info svelte-1wvon5f"><div class="file-name svelte-1wvon5f"> </div> <div class="file-details svelte-1wvon5f"><span class="file-type svelte-1wvon5f"> </span> <!></div></div></label> <button class="remove-btn svelte-1wvon5f" title="Remove file"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-1wvon5f"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" class="svelte-1wvon5f"></path></svg></button></div>'),tc=U('<div class="file-controls svelte-1wvon5f"><div class="selection-info svelte-1wvon5f"><!></div> <div class="control-buttons svelte-1wvon5f"><!> <button class="control-btn svelte-1wvon5f">Select All Valid</button> <button class="control-btn svelte-1wvon5f">Clear Selection</button></div></div> <div class="file-list svelte-1wvon5f"><!></div> <div class="import-controls svelte-1wvon5f"><button class="import-btn svelte-1wvon5f"> </button></div>',1),nc=U('<div class="file-selector svelte-1wvon5f"><!></div>'),rc=U('<div class="menu-importer svelte-1wvon5f"><h3 class="svelte-1wvon5f">Menu Import</h3> <p class="svelte-1wvon5f"><!></p> <p class="size-limit svelte-1wvon5f"></p> <!> <!></div>');function sc(e,t){vt(t,!1);const n=pn();let r=V(!1),s=V([]),a=V(new Set),l=V(!0),c=V(null),o=V([]);const u=50*1024*1024,g=typeof window<"u"&&window.electronAPI,p=!g;let S=V();Wt(async()=>{g?await m():_(l,!1)});async function m(){if(g){_(l,!0),_(c,null);try{const $=await window.electronAPI.invoke("list-menu-files");$&&$.error?(_(c,$.error),_(s,[])):Array.isArray($)?_(s,$):(_(c,"Unexpected response format"),_(s,[]))}catch($){console.error("Error loading files:",$),_(c,$.message),_(s,[])}finally{_(l,!1)}}}async function w($){const T=$.target.files;if(!(!T||T.length===0)){for(const j of T){if(!["application/pdf","image/jpeg","image/png","image/jpg"].includes(j.type)){fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`File "${j.name}" has unsupported format. Please select PDF, JPG, or PNG files.`});continue}const Y=u;if(j.size>Y){const re=Math.round(Y/1048576),ae=Math.round(j.size/(1024*1024)*100)/100;fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`File "${j.name}" (${ae}MB) exceeds maximum size of ${re}MB .`});continue}const Z={file:j,name:j.name,size:Math.round(j.size/(1024*1024)*100)/100,type:j.type.split("/")[1].toUpperCase(),selected:!0,uploaded:!1};_(o,[...i(o),Z])}i(S)&&Fe(S,i(S).value="")}}function k(){i(S)&&i(S).click()}function A($){_(o,i(o).filter((T,j)=>j!==$))}function B($){if(g)i(a).has($.path)?i(a).delete($.path):i(a).add($.path),_(a,i(a));else{const T=i(o).findIndex(j=>j.name===$.name);T!==-1&&(Fe(o,i(o)[T].selected=!i(o)[T].selected),_(o,i(o)))}}function q(){if(g){const $=i(s).filter(T=>T.sizeValid);_(a,new Set($.map(T=>T.path)))}else _(o,i(o).map($=>({...$,selected:!0})))}function v(){g?_(a,new Set):_(o,i(o).map($=>({...$,selected:!1})))}function N(){return g?i(a).size:i(o).filter($=>$.selected).length}async function x(){const $=N();if(!(i(r)||$===0))if(g){const T=Array.from(i(a));await E(T)}else{const T=i(o).filter(j=>j.selected);await W(T)}}function h($){return`${$.type} • ${$.size}MB`}function f($){return new Date($).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}async function E($){if(i(r))return;_(r,!0),n("close"),ft.set("agent");const T=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),j=Array.isArray($)?$.length:1,Q=Array.isArray($)?$.map(Y=>Y.split("/").pop()).join(", "):$.split("/").pop();fe.addMessage({timestamp:T,type:"agent",message:`Starting menu import from ${j} file(s): ${Q}

This process will:
1. Parse the menu(s) with AI
2. Clean existing data
3. Import new menu structure
4. Create optimized layouts

Please wait...`});try{const Y=await window.electronAPI.invoke("start-menu-import",$);if(Y&&!Y.success&&Y.message){fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Import failed: ${Y.message}`}),_(r,!1);return}}catch(Y){console.error("Error starting import:",Y),fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Import failed: ${Y.message}`}),_(r,!1)}}async function W($){if(i(r)||$.length===0)return;_(r,!0),n("close"),ft.set("agent");const T=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),j=$.map(Q=>Q.name).join(", ");fe.addMessage({timestamp:T,type:"agent",message:`Starting menu import from ${$.length} file(s): ${j}

This process will:
1. Upload files to server
2. Parse the menu(s) with AI
3. Clean existing data
4. Import new menu structure
5. Create optimized layouts

Please wait...`});try{const Q=`${window.location.protocol}//${window.location.host}`;fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Uploading ${$.length} files...`});const Y=new FormData;$.forEach((ie,le)=>{Y.append("menuFiles",ie.file)});const Z=new XMLHttpRequest,ae=await new Promise((ie,le)=>{Z.upload.addEventListener("progress",se=>{if(se.lengthComputable){const be=Math.round(se.loaded/se.total*100);fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Uploading files: ${be}%`})}}),Z.onload=function(){if(Z.status>=200&&Z.status<300)try{const se=JSON.parse(Z.responseText);ie(se)}catch{le(new Error("Invalid response format"))}else try{const se=JSON.parse(Z.responseText);le(new Error(se.message||`HTTP ${Z.status}`))}catch{le(new Error(`HTTP ${Z.status}: ${Z.statusText}`))}},Z.onerror=function(){le(new Error("Network error occurred"))},Z.open("POST",`${Q}/api/menu/upload-and-import`),Z.send(Y)});if(!ae.success)throw new Error(ae.message||"Upload failed");fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`All files uploaded successfully. Processing ${ae.fileCount} files: ${ae.filenames.join(", ")}`}),$.forEach(ie=>{ie.uploaded=!0}),fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`✅ Menu import completed successfully!

You can now navigate back to the selection area to see your new menu items.`}),G("INFO","Refreshing categories after successful menu import"),ce.send({command:"getCategories"})}catch(Q){console.error("Error uploading and importing files:",Q),fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`Import failed: ${Q.message}`})}finally{_(r,!1)}}typeof window<"u"&&window.electronAPI&&window.electronAPI.onImportProgress&&(window.electronAPI.onImportProgress($=>{const T=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});fe.addMessage({timestamp:T,type:"agent",message:$})}),window.electronAPI.onImportComplete(($,T)=>{const j=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"});$&&(G("INFO","Refreshing categories after successful menu import"),ce.send({command:"getCategories"})),fe.addMessage({timestamp:j,type:"agent",message:$?`✅ Import completed successfully!

${T}

You can now navigate back to the selection area to see your new menu items.`:`❌ Import failed: ${T}`}),_(r,!1)})),wt();var D=rc(),H=y(d(D),2),R=d(H);{var I=$=>{var T=Lt("Select one or more menu files from the menu_inputs directory");C($,T)},K=$=>{var T=Lt("Upload and import menu files (PDF, JPG, PNG)");C($,T)};J(R,$=>{g?$(I):$(K,!1)})}var F=y(H,2);F.textContent="Max file size: 50MB";var L=y(F,2);{var Se=$=>{var T=jl();en(T,j=>_(S,j),()=>i(S)),X("change",T,w),C($,T)};J(L,$=>{p&&$(Se)})}var xe=y(L,2);{var de=$=>{var T=ql();C($,T)},oe=$=>{var T=qe(),j=Ce(T);{var Q=Z=>{var re=zl();C(Z,re)},Y=Z=>{var re=qe(),ae=Ce(re);{var ie=se=>{var be=Vl(),_e=d(be),Ee=d(_e),$e=y(_e,2);te(()=>ee(Ee,`Error loading files: ${i(c)??""}`)),X("click",$e,m),C(se,be)},le=se=>{var be=nc(),_e=d(be);{var Ee=Le=>{var Me=Gl(),me=d(Me),ge=y(d(me),2);X("click",ge,k),C(Le,Me)},$e=Le=>{var Me=qe(),me=Ce(Me);{var ge=O=>{var M=Wl();C(O,M)},he=O=>{var M=tc(),ne=Ce(M),ve=d(ne),je=d(ve);{var gt=Oe=>{var We=Hl(),at=d(We);te(()=>ee(at,`${i(a).size??""} of ${i(s).length??""} files selected`)),C(Oe,We)},tt=Oe=>{var We=Jl(),at=d(We);te(Je=>ee(at,`${Je??""} of ${i(o).length??""} files selected`),[()=>i(o).filter(Je=>Je.selected).length]),C(Oe,We)};J(je,Oe=>{g?Oe(gt):Oe(tt,!1)})}var ct=y(ve,2),ze=d(ct);{var rt=Oe=>{var We=Kl();X("click",We,k),C(Oe,We)};J(ze,Oe=>{p&&Oe(rt)})}var st=y(ze,2),ut=y(st,2),Ge=y(ne,2),Ae=d(Ge);{var Be=Oe=>{var We=qe(),at=Ce(We);At(at,1,()=>i(s),Je=>Je.path,(Je,Ue)=>{var jt=Xl();let Ot;var Kt=d(jt),Tt=d(Kt),b=y(Tt,2),z=d(b),ke=d(z),pe=y(z,2),Ne=d(pe),nt=d(Ne),ye=y(Ne,2),Xe=d(ye),Ct=y(pe,2);{var Et=It=>{var it=Yl();it.textContent="File too large (max 50MB)",C(It,it)};J(Ct,It=>{i(Ue).sizeValid||It(Et)})}te((It,it,rn,mr)=>{Ot=Ye(jt,1,"file-item svelte-1wvon5f",null,Ot,It),Tt.disabled=!i(Ue).sizeValid,ds(Tt,it),ee(ke,i(Ue).name),ee(nt,rn),ee(Xe,`Modified: ${mr??""}`)},[()=>({invalid:!i(Ue).sizeValid,selected:i(a).has(i(Ue).path)}),()=>i(a).has(i(Ue).path),()=>h(i(Ue)),()=>f(i(Ue).lastModified)]),X("change",Tt,()=>B(i(Ue))),C(Je,jt)}),C(Oe,We)},Ve=Oe=>{var We=qe(),at=Ce(We);At(at,3,()=>i(o),Je=>Je.name,(Je,Ue,jt)=>{var Ot=ec();let Kt;var Tt=d(Ot),b=d(Tt),z=y(b,2),ke=d(z),pe=d(ke),Ne=y(ke,2),nt=d(Ne),ye=d(nt),Xe=y(nt,2);{var Ct=it=>{var rn=Ql();C(it,rn)},Et=it=>{var rn=Zl();C(it,rn)};J(Xe,it=>{i(Ue).uploaded?it(Ct):it(Et,!1)})}var It=y(Tt,2);te(it=>{Kt=Ye(Ot,1,"file-item svelte-1wvon5f",null,Kt,it),ds(b,i(Ue).selected),ee(pe,i(Ue).name),ee(ye,`${i(Ue).type??""} • ${i(Ue).size??""}MB`)},[()=>({selected:i(Ue).selected,uploaded:i(Ue).uploaded})]),X("change",b,()=>B(i(Ue))),X("click",It,()=>A(i(jt))),C(Je,Ot)}),C(Oe,We)};J(Ae,Oe=>{g?Oe(Be):Oe(Ve,!1)})}var dt=y(Ge,2),ht=d(dt),Ft=d(ht);te((Oe,We,at,Je)=>{st.disabled=Oe,ut.disabled=We,ht.disabled=at,ee(Ft,`Import Selected Files (${Je??""})`)},[()=>g?i(s).every(Oe=>!Oe.sizeValid):i(o).length===0,()=>N()===0,()=>N()===0,N]),X("click",st,q),X("click",ut,v),X("click",ht,x),C(O,M)};J(me,O=>{g&&i(s).length===0?O(ge):O(he,!1)},!0)}C(Le,Me)};J(_e,Le=>{p&&i(o).length===0?Le(Ee):Le($e,!1)})}C(se,be)};J(ae,se=>{g&&i(c)?se(ie):se(le,!1)},!0)}C(Z,re)};J(j,Z=>{g&&i(l)?Z(Q):Z(Y,!1)},!0)}C($,T)};J(xe,$=>{i(r)?$(de):$(oe,!1)})}C(e,D),pt()}var ac=U('<button class="download-btn svelte-1dlpwa7">📥 Download Export</button> <button class="reset-btn svelte-1dlpwa7">🔄 New Export</button>',1),ic=U('<button class="cancel-btn svelte-1dlpwa7">❌ Cancel</button>'),oc=U('<button class="export-btn svelte-1dlpwa7" disabled><!></button> <!>',1),lc=U('<button class="export-btn svelte-1dlpwa7">🚀 Generate Export</button>'),cc=U('<div class="error-message svelte-1dlpwa7"> <button class="retry-btn svelte-1dlpwa7">Try Again</button></div>'),uc=U('<div class="job-info svelte-1dlpwa7"><small> </small></div>'),dc=U('<div class="dsfinvk-exporter svelte-1dlpwa7"><h3 class="svelte-1dlpwa7">DSFinV-K Export</h3> <div class="date-range-picker svelte-1dlpwa7"><div class="date-input svelte-1dlpwa7"><label for="dsfinvk-start" class="svelte-1dlpwa7">Start Date:</label> <input type="date" id="dsfinvk-start" class="svelte-1dlpwa7"/></div> <div class="date-input svelte-1dlpwa7"><label for="dsfinvk-end" class="svelte-1dlpwa7">End Date:</label> <input type="date" id="dsfinvk-end" class="svelte-1dlpwa7"/></div></div> <div class="export-actions svelte-1dlpwa7"><!></div> <!> <!></div>');function fc(e,t){vt(t,!1);let n=V(new Date().toISOString().split("T")[0]),r=V(new Date().toISOString().split("T")[0]),s=V(!1),a=V(null),l=V(null),c=V(null),o=null,u=V(null);const g=typeof window<"u"&&window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1";async function p(){_(s,!0),_(a,null),_(c,null),_(u,null),fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`🚀 Starting DSFinV-K export for period ${i(n)} to ${i(r)}...`,style:"info"});try{g?await m():await S()}catch(F){fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`❌ DSFinV-K export failed: ${F.message}`,style:"error"}),_(a,"failed"),_(u,F.message)}finally{g||_(s,!1)}}async function S(){try{const F=await fetch("/api/export/dsfinvk/start",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({startDate:i(n),endDate:i(r)})});if(F.ok&&F.headers.get("content-type")?.includes("application/zip")){const L=await F.blob(),Se=window.URL.createObjectURL(L),xe=`dsfinvk-export-${i(n)}-to-${i(r)}.zip`,de=document.createElement("a");de.href=Se,de.download=xe,document.body.appendChild(de),de.click(),document.body.removeChild(de),window.URL.revokeObjectURL(Se),fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`✅ DSFinV-K export complete! File downloaded as ${xe}`,style:"success"}),_(a,"complete")}else{const L=await F.json();if(!L.success)throw new Error(L.error||"Export failed")}}catch{const L=await ce.send({command:"generateDsfinvkExport",payload:{startDate:i(n),endDate:i(r)}});if(L.status==="success"&&L.payload.success)fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`✅ DSFinV-K export complete! File available at: ${L.payload.path}`,style:"success"}),_(a,"complete");else throw new Error(L.payload?.message||L.error||"Unknown export error")}}async function m(){const L=await(await fetch("/api/export/dsfinvk/start",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({startDate:i(n),endDate:i(r)})})).json();if(!L.success)throw new Error(L.error||"Failed to start export job");_(l,L.jobId),_(a,L.status),fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`📊 Export job started (Job ID: ${i(l)}). Generating report...`,style:"info"}),w()}function w(){o&&clearInterval(o),o=setInterval(async()=>{try{const L=await(await fetch(`/api/export/dsfinvk/status/${i(l)}`,{credentials:"include"})).json();if(!L.success)throw new Error(L.error||"Failed to check job status");_(a,L.status.toLowerCase()),i(a)==="complete"?(clearInterval(o),o=null,_(c,L.downloadUrl),_(s,!1),fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"✅ DSFinV-K export complete! Ready for download.",style:"success"})):i(a)==="failed"?(clearInterval(o),o=null,_(s,!1),_(u,L.error||"Export job failed"),fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`❌ DSFinV-K export failed: ${i(u)}`,style:"error"})):i(a)==="processing"&&fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"⚙️ Export job is processing...",style:"info"})}catch(F){console.error("Error polling job status:",F),fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:`⚠️ Error checking export status: ${F.message}`,style:"warning"})}},3e3)}function k(){i(c)&&(window.open(i(c),"_blank"),fe.addMessage({timestamp:new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),type:"agent",message:"📥 Download initiated for DSFinV-K export.",style:"success"}))}function A(){o&&(clearInterval(o),o=null),_(s,!1),_(a,null),_(l,null),_(c,null),_(u,null)}Yr(()=>{o&&clearInterval(o)}),wt();var B=dc(),q=y(d(B),2),v=d(q),N=y(d(v),2),x=y(v,2),h=y(d(x),2),f=y(q,2),E=d(f);{var W=F=>{var L=ac(),Se=Ce(L),xe=y(Se,2);X("click",Se,k),X("click",xe,A),C(F,L)},D=F=>{var L=qe(),Se=Ce(L);{var xe=oe=>{var $=oc(),T=Ce($),j=d(T);{var Q=ae=>{var ie=Lt("⏳ Queued...");C(ae,ie)},Y=ae=>{var ie=qe(),le=Ce(ie);{var se=_e=>{var Ee=Lt("⚙️ Processing...");C(_e,Ee)},be=_e=>{var Ee=Lt("🔄 Generating...");C(_e,Ee)};J(le,_e=>{i(a)==="processing"?_e(se):_e(be,!1)},!0)}C(ae,ie)};J(j,ae=>{i(a)==="pending"?ae(Q):ae(Y,!1)})}var Z=y(T,2);{var re=ae=>{var ie=ic();X("click",ie,A),C(ae,ie)};J(Z,ae=>{g&&ae(re)})}C(oe,$)},de=oe=>{var $=lc();X("click",$,p),C(oe,$)};J(Se,oe=>{i(s)||i(a)==="pending"||i(a)==="processing"?oe(xe):oe(de,!1)},!0)}C(F,L)};J(E,F=>{i(a)==="complete"&&i(c)?F(W):F(D,!1)})}var H=y(f,2);{var R=F=>{var L=cc(),Se=d(L),xe=y(Se);te(()=>ee(Se,`❌ Export failed: ${i(u)??""} `)),X("click",xe,A),C(F,L)};J(H,F=>{i(a)==="failed"&&i(u)&&F(R)})}var I=y(H,2);{var K=F=>{var L=uc(),Se=d(L),xe=d(Se);te(()=>ee(xe,`Job ID: ${i(l)??""}`)),C(F,L)};J(I,F=>{g&&i(l)&&F(K)})}te(()=>{N.disabled=i(s),h.disabled=i(s)}),qt(N,()=>i(n),F=>_(n,F)),qt(h,()=>i(r),F=>_(r,F)),C(e,B),pt()}var vc=U('<div class="control-center-overlay svelte-mpduov"><div class="control-center-panel svelte-mpduov"><div class="panel-header svelte-mpduov"><h2 class="svelte-mpduov">Control Center</h2> <button class="close-btn svelte-mpduov">×</button></div> <div class="panel-content svelte-mpduov"><div class="section svelte-mpduov"><h3 class="svelte-mpduov">System Time</h3> <div class="time-display svelte-mpduov"> </div> <p class="time-description svelte-mpduov">Current system time. Time synchronization is managed automatically.</p></div> <div class="section svelte-mpduov"><h3 class="svelte-mpduov">Language & Region</h3> <div class="locale-settings svelte-mpduov"><label for="locale-select" class="locale-label svelte-mpduov">Display Locale:</label> <select id="locale-select" class="locale-select svelte-mpduov"><option class="svelte-mpduov">Deutsch (Deutschland)</option><option class="svelte-mpduov">English (United States)</option><option class="svelte-mpduov">English (United Kingdom)</option></select></div> <p class="locale-description svelte-mpduov">Changes how numbers, currencies, and dates are displayed in the interface.</p></div> <div class="section svelte-mpduov"><!></div> <div class="section svelte-mpduov"><!></div> <div class="section svelte-mpduov"><h3 class="svelte-mpduov">System Information</h3> <div class="system-info svelte-mpduov"><div class="info-item svelte-mpduov"><span class="label svelte-mpduov">Status:</span> <span class="value connected svelte-mpduov">Connected</span></div> <div class="info-item svelte-mpduov"><span class="label svelte-mpduov">Mode:</span> <span class="value svelte-mpduov">Development</span></div></div></div></div></div></div>');function pc(e,t){vt(t,!1);const[n,r]=Hn(),s=()=>Ze(Xr,"$controlCenterVisible",n),a=()=>Ze(Cr,"$currentTime",n),l=()=>Ze(En,"$localeStore",n);pn();function c(){zo()}function o(k){return k.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}function u(){c()}function g(k){const A=k.target.value;to(A)}function p(k){k.key==="Escape"&&c()}wt();var S=qe();X("keydown",Fn,p);var m=Ce(S);{var w=k=>{var A=vc(),B=d(A),q=d(B),v=y(d(q),2),N=y(q,2),x=d(N),h=y(d(x),2),f=d(h),E=y(x,2),W=y(d(E),2),D=y(d(W),2);te(()=>{l(),Js(()=>{})});var H=d(D);H.value=H.__value="de-DE";var R=y(H);R.value=R.__value="en-US";var I=y(R);I.value=I.__value="en-GB";var K=y(E,2),F=d(K);sc(F,{$$events:{close:u}});var L=y(K,2),Se=d(L);fc(Se,{}),te(xe=>ee(f,xe),[()=>o(a())]),X("click",v,c),ra(D,l,xe=>Ai(En,xe)),X("change",D,g),X("click",A,Mi(c)),C(k,A)};J(m,k=>{s()&&k(w)})}C(e,S),pt(),r()}var mc=U('<main class="pos-grid svelte-1ji6e50"><div class="grid-item-display svelte-1ji6e50"><!></div> <div class="grid-selection-area svelte-1ji6e50"><!></div></main> <!>',1);function gc(e,t){vt(t,!1);let n=V(),r=V(!1);Wt(async()=>{await un.checkSession();const m=ce.subscribe(w=>{w.lastMessage?.command==="sessionEstablished"&&(console.log("Demo mode: Received session established message"),un.establishSession(w.lastMessage.payload))});return typeof window<"u"&&window.electronAPI&&window.electronAPI.onUiRefreshRequest&&window.electronAPI.onUiRefreshRequest(()=>{console.log("UI refresh requested - switching to selection view and refreshing data"),G("INFO","UI refresh requested after menu import"),ft.set("selection"),ce.send({command:"getCategories"}),setTimeout(()=>{window.location.reload()},1e3)}),()=>{m()}});function s(m){_(r,m.detail)}function a(){i(n)&&typeof i(n).getIsAtBottom=="function"&&(i(n).getIsAtBottom()&&typeof i(n).cycleViews=="function"?i(n).cycleViews():typeof i(n).scrollToBottom=="function"&&i(n).scrollToBottom())}wt();var l=mc(),c=Ce(l),o=d(c),u=d(o);en(jo(u,{$$events:{scrollstate:s},$$legacy:!0}),m=>_(n,m),()=>i(n));var g=y(o,2),p=d(g);Fl(p,{handleSmartAction:a,get isAtBottom(){return i(r)},get consoleViewComponent(){return i(n)}});var S=y(c,2);pc(S,{}),C(e,l),pt()}window.onerror=function(e,t,n,r,s){return G("ERROR","Unhandled Frontend Exception",{type:"window.onerror",message:e,source:t,lineno:n,colno:r,error:s?s.stack:"N/A"}),!0};window.addEventListener("unhandledrejection",e=>{G("ERROR","Unhandled Promise Rejection",{type:"unhandledrejection",reason:e.reason?e.reason.message||e.reason:"No reason provided",stack:e.reason?e.reason.stack:"N/A"})});pi(gc,{target:document.getElementById("app")});
